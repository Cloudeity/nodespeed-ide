!function(e){function r(){e(t).each(function(){i(e(this)).removeClass("open")})}function i(t){var n=t.attr("data-target"),r;n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),r=n&&e(n);if(!r||!r.length)r=t.parent();return r}var t="[data-toggle=dropdown]",n=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),s,o;if(n.is(".disabled, :disabled"))return;return s=i(n),o=s.hasClass("open"),r(),o||s.toggleClass("open"),n.focus(),!1},keydown:function(n){var r,s,o,u,a,f;if(!/(38|40|27)/.test(n.keyCode))return;r=e(this),n.preventDefault(),n.stopPropagation();if(r.is(".disabled, :disabled"))return;u=i(r),a=u.hasClass("open");if(!a||a&&n.keyCode==27)return n.which==27&&u.find(t).focus(),r.click();s=e("[role=menu] li:not(.divider):visible a",u);if(!s.length)return;f=s.index(s.filter(":focus")),n.keyCode==38&&f>0&&f--,n.keyCode==40&&f<s.length-1&&f++,~f||(f=0),s.eq(f).focus()}};var s=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data("dropdown");i||r.data("dropdown",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.dropdown.Constructor=n,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on("click.dropdown.data-api",r).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown-menu",function(e){e.stopPropagation()}).on("click.dropdown.data-api",t,n.prototype.toggle).on("keydown.dropdown.data-api",t+", [role=menu]",n.prototype.keydown)}(window.jQuery),define("widgets/bootstrap-dropdown",function(){}),!function(e){var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(this.options.selector),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(this.options.selector),this.$backdrop.click(this.options.backdrop=="static"?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t):t()):t&&t()}};var n=e.fn.modal;e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0,selector:"body"},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s).one("hide",function(){n.focus()})})}(window.jQuery),define("widgets/bootstrap-modal",function(){}),!function(e){"use strict";function i(e,t,n){return typeof e=="function"?e.apply(t,n):e}var t;e(window).focus(function(){t=!0}).blur(function(){t=!1});var n;e(document).ready(function(){e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}(),e.support.transition&&(n=e.support.transition.end)});var r=function(t,n){this.$element=e(t),this.options=n,this.enabled=!0,this.autoHideTimeout=null,this.fixTitle()};r.prototype={show:function(){var n,r=this;if(this.hasContent()&&this.enabled){n=this.tip(),this.setContent(),this.options.animate&&n.addClass("fade"),n.remove().css({top:0,left:0,display:"block"}).prependTo(document.body),this.updatePosition(),e(window).off("resize",this.resizeHandler),this.resizeHandler=function(e){r.updatePosition()},e(window).on("resize",this.resizeHandler);if(this.options.autoHideDelay){var i=function(){window.clearTimeout(r.autoHideTimeout),r.autoHideTimeout=window.setTimeout(function(){r.hide()},r.options.autoHideDelay)};t?i():e(window).one("focus",i)}n.addClass("in")}},updatePosition:function(){var t,n,r,s,o,u,a,f,l,c,h,p=this;l=this.tip(),t=e.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),s=parseInt(this.$element.css("padding-left"),10),o=parseInt(this.$element.css("padding-right"),10),t.left+=s,t.width-=s+o,n=l[0].offsetWidth,r=l[0].offsetHeight,f=i(this.options.placement,this,[l[0],this.$element[0]]),l.addClass(f);switch(f){case"below":h={top:t.top+t.height+this.options.offset,left:t.left+t.width/2-n/2};break;case"above":h={top:t.top-r-this.options.offset,left:t.left+t.width/2-n/2};break;case"left":h={top:t.top+t.height+20-r,left:t.left-n-this.options.offset};break;case"right":h={top:t.top+t.height+20-r,left:t.left+t.width+this.options.offset}}a=0,u=h.left+n-e(document.body).width(),u>0?(a=u,h.left-=u):h.left<0&&(a=h.left,h.left=0),u>0&&(c=l.find(".tooltip-arrow"),this.defaultMargin||(this.defaultMargin=parseInt(c.css("margin-left"),10)),c.css("margin-left",this.defaultMargin+a)),l.css(h)},setContent:function(){var e=this.tip();e.find(".tooltip-inner")[this.options.html?"html":"text"](this.getTitle()),e[0].className="tooltip"},hide:function(){function i(){r.remove()}var t=this,r=this.tip();r.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?r.bind(n,i):i(),window.clearTimeout(this.autoHideTimeout),e(window).off("resize",this.resizeHandler)},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getTitle:function(){var e,t=this.$element,n=this.options;return this.fixTitle(),typeof n.title=="string"?e=t.attr(n.title=="title"?"data-original-title":n.title):typeof n.title=="function"&&(e=n.title.call(t[0])),e=(""+e).replace(/(^\s*|\s*$)/,""),e||n.fallback},tip:function(){return this.$tip=this.$tip||e('<div class="tooltip" />').html(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}},e.fn.twipsy=function(t){return e.fn.twipsy.initWith.call(this,t,r,"twipsy"),this},e.fn.twipsy.initWith=function(t,n,r){function a(i){var s=e.data(i,r);return s||(s=new n(i,e.fn.twipsy.elementOptions(i,t)),e.data(i,r,s)),s}function f(){var e=a(this);e.hoverState="in",t.delayIn==0?e.show():(e.fixTitle(),setTimeout(function(){e.hoverState=="in"&&e.show()},t.delayIn))}function l(){var e=a(this);e.hoverState="out",t.delayOut==0?e.hide():setTimeout(function(){e.hoverState=="out"&&e.hide()},t.delayOut)}var i,s,o,u;return t===!0?this.data(r):typeof t=="string"?(i=this.data(r),i&&i[t](),this):(t=e.extend({},e.fn[r].defaults,t),t.live||this.each(function(){a(this)}),t.trigger!="manual"&&(s=t.live?"live":"bind",o=t.trigger=="hover"?"mouseenter":"focus",u=t.trigger=="hover"?"mouseleave":"blur",this[s](o,f)[s](u,l)),this)},e.fn.twipsy.Twipsy=r,e.fn.twipsy.defaults={animate:!0,delayIn:0,delayOut:0,fallback:"",placement:"above",html:!1,live:!1,offset:0,title:"title",trigger:"hover",template:'<div class="tooltip-arrow"></div><div class="tooltip-inner"></div>'},e.fn.twipsy.rejectAttrOptions=["title"],e.fn.twipsy.elementOptions=function(t,n){var r=e(t).data(),i=e.fn.twipsy.rejectAttrOptions,s=i.length;while(s--)delete r[i[s]];return e.extend({},n,r)}}(window.jQuery||window.ender),define("widgets/bootstrap-twipsy-mod",function(){}),function(e){function t(e){return function(t){return n.parseUrl(t)[e]}}var n={urlParseRE:/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#\.]*(?:\.[^\?#\.]+)*(\.[^\?#\.]+)|[^\?#]*)))?(\?[^#]+)?)(#.*)?/,parsedUrlPropNames:"href,hrefNoHash,hrefNoSearch,domain,protocol,doubleSlash,authority,userinfo,username,password,host,hostname,port,pathname,directory,filename,filenameExtension,search,hash".split(","),defaultPorts:{http:"80",https:"443",ftp:"20",ftps:"990"},parseUrl:function(e){if(e&&typeof e=="object")return e;var e=n.urlParseRE.exec(e||"")||[],t=n.parsedUrlPropNames,r=t.length,i={},s;for(s=0;s<r;s++)i[t[s]]=e[s]||"";return i},port:function(e){return e=n.parseUrl(e),e.port||n.defaultPorts[e.protocol]},isSameDomain:function(e,t){return n.parseUrl(e).domain===n.parseUrl(t).domain},isRelativeUrl:function(e){return n.parseUrl(e).protocol===""},isAbsoluteUrl:function(e){return n.parseUrl(e).protocol!==""},makePathAbsolute:function(e,t){if(e&&e.charAt(0)==="/")return e;for(var e=e||"",n=(t=t?t.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"")?t.split("/"):[],r=e.split("/"),i=0;i<r.length;i++){var s=r[i];switch(s){case".":break;case"..":n.length&&n.pop();break;default:n.push(s)}}return"/"+n.join("/")},makePathRelative:function(e,t){for(var t=t?t.replace(/^\/|\/?[^\/]*$/g,""):"",e=e?e.replace(/^\//,""):"",n=t?t.split("/"):[],r=e.split("/"),i=[],s=n.length,o=!1,u=0;u<s;u++)(o=o||r[0]!==n[u])?i.push(".."):r.shift();return i.concat(r).join("/")},makeUrlAbsolute:function(e,t){if(!n.isRelativeUrl(e))return e;var r=n.parseUrl(e),i=n.parseUrl(t),s=r.protocol||i.protocol,o=r.protocol?r.doubleSlash:r.doubleSlash||i.doubleSlash,u=r.authority||i.authority,a=r.pathname!=="",f=n.makePathAbsolute(r.pathname||i.filename,i.pathname);return s+o+u+f+(r.search||!a&&i.search||"")+r.hash}},r,i,s=n.parsedUrlPropNames,o=s.length;for(r=0;r<o;r++)i=s[r],n[i]||(n[i]=t(i));e.PathUtils=n}(window),define("thirdparty/path-utils/path-utils.min",function(){}),function(e){e.fn.smartAutoComplete=function(){if(arguments.length<1){var t=this[0];return e(t).data("smart-autocomplete")}var n=function(t,n,r){var i=new RegExp(t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");return e.grep(n,function(e){return i.test(e)})},r={minCharLimit:1,maxCharLimit:null,maxResults:null,delay:0,disabled:!1,forceSelect:!1,typeAhead:!1,resultElement:"li",resultFormatter:function(e){return"<li>"+e+"</li>"},filter:function(t,r){var i=this,s=e(i).data("smart-autocomplete");if(e.type(r)==="array"){var o=n(t,r,i);return o}if(e.type(r)==="string")return e.Deferred(function(s){e.ajax({url:r,data:{term:t},dataType:"json"}).done(function(e){s.resolve(n(t,e,i))})}).promise()},alignResultsContainer:!1,clearResults:function(){var t=e(this.context).prev(".smart_autocomplete_type_ahead_field");e(this.context).css({background:t.css("background")}),t.remove(),e(this.resultsContainer).html("")},setCurrentSelectionToContext:function(){this.rawResults.length>0&&this.currentSelection>=0&&e(this.context).val(this.rawResults[this.currentSelection])},setItemSelected:function(e){this.itemSelected=e},autocompleteFocused:!1,setAutocompleteFocused:function(e){this.autocompleteFocused=e}};e.event.special.keyIn={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=r.source||null,s=r.filter,o=r.maxCharLimit>0?r.maxCharLimit:Number.POSITIVE_INFINITY,u=t.smartAutocompleteData.query;if(r.disabled||u.length>o)return e(n).trigger("lostFocus"),!1;r.setItemSelected(!1),r.setAutocompleteFocused(!0),setTimeout(function(){e.when(s.apply(r,[u,r.source])).done(function(t){var i=r.maxResults>0?t.splice(0,r.maxResults):t;e(n).trigger("resultsReady",[i])})},r.delay)}},e.event.special.resultsReady={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=t.smartAutocompleteData.results;if(r.disabled)return!1;e(n).smartAutoComplete().clearResults(),r.rawResults=i;if(i.length<1)return e(n).trigger("noResults"),!1;var s=e.map(i,function(e){return r.resultFormatter.apply(r,[e])}),o=s.join("");r.resultsContainer&&e(r.resultsContainer).append(o),e(n).trigger("showResults",[i])}},e.event.special.showResults={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=e(r.resultsContainer),s=t.smartAutocompleteData.results;if(r.typeAhead&&s[0].substr(0,e(n).val().length)==e(n).val()){var o=s[0];e(n).before("<input class='smart_autocomplete_type_ahead_field' type='text' autocomplete='off' disabled='disabled' value='"+o+"'/>"),e(n).css({position:"relative",zIndex:2,background:"transparent"});var u=e(n).prev("input");u.css({position:"absolute",zIndex:1,overflow:"hidden",background:e(n).css("background"),borderColor:"transparent",width:e(n).width(),color:"silver"}),r.currentSelection=0,i&&e(n).trigger("itemFocus",i.children()[r.currentSelection])}i&&(r.alignResultsContainer&&i.css({position:"absolute",top:function(){return e(n).offset().top+e(n).height()},left:function(){return e(n).offset().left},width:function(){return e(n).width()},zIndex:1e3}),i.show())}},e.event.special.noResults={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=e(r.resultsContainer);i&&r.clearResults()}},e.event.special.itemSelect={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=t.smartAutocompleteData.item,s=e(i).text()||e(i).val();e(n).val(s),r.setItemSelected(!0),r.originalCharCount=e(n).val().length,e(n).trigger("lostFocus")}},e.event.special.itemFocus={setup:function(){return!1},_default:function(t){var n=t.smartAutocompleteData.item;e(n).addClass("smart_autocomplete_highlight")}},e.event.special.itemUnfocus={setup:function(){return!1},_default:function(t){var n=t.smartAutocompleteData.item;e(n).removeClass("smart_autocomplete_highlight")}},e.event.special.lostFocus={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete");r.forceSelect&&!r.itemSelected&&e(r.context).val(""),r.setAutocompleteFocused(!1),r.clearResults(),r.resultsContainer&&e(r.resultsContainer).hide(),r.currentSelection=null}};var i=arguments[0];return this.each(function(t){var n=e.extend(r,e(this).data("smart-autocomplete"),i);n.context=this;if(e.type(n.resultsContainer)==="undefined"){var s=e("<ul class='smart_autocomplete_container' style='display:none'></ul>");s.appendTo("body"),n.resultsContainer=s,n.alignResultsContainer=!0}e(this).data("smart-autocomplete",n),e(this).on("keyup",function(t){var n=e(this).data("smart-autocomplete");if(t.keyCode===38){if(n.resultsContainer){var r=n.currentSelection||0,i=e(n.resultsContainer).children();r>0?(e(n.context).trigger("itemUnfocus",i[r]),r--):r-1<0&&(e(n.context).trigger("itemUnfocus",i[r]),r=i.length-1),n.currentSelection=r,e(n.context).trigger("itemFocus",[i[r]])}}else if(t.keyCode===40)if(n.resultsContainer&&n.resultsContainer.is(":visible")){var r=n.currentSelection,i=e(n.resultsContainer).children();r>=0&&e(n.context).trigger("itemUnfocus",i[r]);if(isNaN(r)||null==r||++r>=i.length)r=0;n.currentSelection=r,e(n.context).trigger("itemFocus",[i[r]])}else e(n.context).trigger("keyIn",[e(this).val()]);else{if(t.keyCode===39||t.keyCode===13){var s=e(n.context).prev(".smart_autocomplete_type_ahead_field");if(n.resultsContainer&&e(n.resultsContainer).is(":visible")){var r=n.currentSelection,i=e(n.resultsContainer).children();e(n.context).trigger("itemSelect",[i[r]])}else n.typeAhead&&s.is(":visible")&&e(n.context).trigger("itemSelect",[s]);return!1}if(t.keyCode!==255){var o=e(n.context).val().length;if(n.originalCharCount==o)return;o>=n.minCharLimit?e(n.context).trigger("keyIn",[e(this).val()]):n.autocompleteFocused&&(n.currentSelection=null,e(n.context).trigger("lostFocus"))}}}),e(this).focus(function(){e(this).closest("form").bind("keydown.block_for_smart_autocomplete",function(t){var r=e(n.context).prev(".smart_autocomplete_type_ahead_field");if(t.keyCode===13){if(n.resultsContainer&&e(n.resultsContainer).is(":visible")){var i=n.currentSelection,s=e(n.resultsContainer).children();return e(n.context).trigger("itemSelect",[s[i]]),!1}if(n.typeAhead&&r.is(":visible"))return e(n.context).trigger("itemSelect",[r]),!1}}),n.forceSelect&&e(this).select()}),e(document).bind("focusin click",function(t){if(n.autocompleteFocused){var r=e.contains(n.resultsContainer[0],t.target);if(t.target==n.resultsContainer[0]||t.target==n.context||r)return;e(n.context).closest("form").unbind("keydown.block_for_smart_autocomplete"),e(n.context).trigger("lostFocus")}}),e(n.resultsContainer).delegate(n.resultElement,"mousedown.smart_autocomplete",function(){return e(n.context).trigger("itemSelect",[this]),!1}),e(this).bind({keyIn:function(e,t){e.smartAutocompleteData={query:t}},resultsReady:function(e,t){e.smartAutocompleteData={results:t}},showResults:function(e,t){e.smartAutocompleteData={results:t}},noResults:function(){},lostFocus:function(){},itemSelect:function(e,t){e.smartAutocompleteData={item:t}},itemFocus:function(e,t){e.smartAutocompleteData={item:t}},itemUnfocus:function(e,t){e.smartAutocompleteData={item:t}}})})}}(jQuery),define("thirdparty/smart-auto-complete-local/jquery.smart_autocomplete",function(){}),function(e){if(typeof exports=="object"&&typeof module=="object")module.exports=e();else{if(typeof define=="function"&&define.amd)return define("thirdparty/CodeMirror2/lib/codemirror",[],e);this.CodeMirror=e()}}(function(){function S(e,t){if(!(this instanceof S))return new S(e,t);this.options=t=t||{},Uo(li,t,!1),B(t);var n=t.value;typeof n=="string"&&(n=new Bs(n,t.mode)),this.doc=n;var s=this.display=new x(e,n);s.wrapper.CodeMirror=this,_(this),O(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),t.autofocus&&!d&&tr(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,draggingText:!1,highlight:new _o},r&&i<11&&setTimeout(zo(er,this,!0),20),ir(this),au();var o=this;jn(this,function(){o.curOp.forceUpdate=!0,qs(o,n),t.autofocus&&!d||tu()==s.input?setTimeout(zo(Pr,o),20):Hr(o);for(var e in ci)ci.hasOwnProperty(e)&&ci[e](o,t[e],pi);U(o);for(var r=0;r<gi.length;++r)gi[r](o)})}function x(e,t){var n=this,o=n.input=Qo("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");s?o.style.width="1000px":o.setAttribute("wrap","off"),p&&(o.style.border="1px solid black"),o.setAttribute("autocorrect","off"),o.setAttribute("autocapitalize","off"),o.setAttribute("spellcheck","false"),n.inputDiv=Qo("div",[o],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),n.scrollbarH=Qo("div",[Qo("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar"),n.scrollbarV=Qo("div",[Qo("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),n.scrollbarFiller=Qo("div",null,"CodeMirror-scrollbar-filler"),n.gutterFiller=Qo("div",null,"CodeMirror-gutter-filler"),n.lineDiv=Qo("div",null,"CodeMirror-code"),n.selectionDiv=Qo("div",null,null,"position: relative; z-index: 1"),n.cursorDiv=Qo("div",null,"CodeMirror-cursors"),n.measure=Qo("div",null,"CodeMirror-measure"),n.lineMeasure=Qo("div",null,"CodeMirror-measure"),n.lineSpace=Qo("div",[n.measure,n.lineMeasure,n.selectionDiv,n.cursorDiv,n.lineDiv],null,"position: relative; outline: none"),n.mover=Qo("div",[Qo("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=Qo("div",[n.mover],"CodeMirror-sizer"),n.heightForcer=Qo("div",null,null,"position: absolute; height: "+ko+"px; width: 1px;"),n.gutters=Qo("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=Qo("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=Qo("div",[n.inputDiv,n.scrollbarH,n.scrollbarV,n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),r&&i<8&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),p&&(o.style.width="0px"),s||(n.scroller.draggable=!0),l&&(n.inputDiv.style.height="1px",n.inputDiv.style.position="absolute"),r&&i<8&&(n.scrollbarH.style.minHeight=n.scrollbarV.style.minWidth="18px"),e.appendChild?e.appendChild(n.wrapper):e(n.wrapper),n.viewFrom=n.viewTo=t.first,n.view=[],n.externalMeasured=null,n.viewOffset=0,n.lastSizeC=0,n.updateLineNumbers=null,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.prevInput="",n.alignWidgets=!1,n.pollingFast=!1,n.poll=new _o,n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.inaccurateSelection=!1,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n.shift=!1,n.selForContextMenu=null}function T(e){e.doc.mode=S.getMode(e.options,e.doc.modeOption),N(e)}function N(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,Vt(e,100),e.state.modeGen++,e.curOp&&zn(e)}function C(e){e.options.lineWrapping?(iu(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth=""):(ru(e.display.wrapper,"CodeMirror-wrap"),H(e)),L(e),zn(e),hn(e),setTimeout(function(){I(e)},100)}function k(e){var t=Tn(e.display),n=e.options.lineWrapping,r=n&&Math.max(5,e.display.scroller.clientWidth/Nn(e.display)-3);return function(i){if(ss(e.doc,i))return 0;var s=0;if(i.widgets)for(var o=0;o<i.widgets.length;o++)i.widgets[o].height&&(s+=i.widgets[o].height);return n?s+(Math.ceil(i.text.length/r)||1)*t:s+t}}function L(e){var t=e.doc,n=k(e);t.iter(function(e){var t=n(e);t!=e.height&&Ws(e,t)})}function A(e){var t=Si[e.options.keyMap],n=t.style;e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(n?" cm-keymap-"+n:"")}function O(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),hn(e)}function M(e){_(e),zn(e),setTimeout(function(){R(e)},20)}function _(e){var t=e.display.gutters,n=e.options.gutters;Yo(t);for(var r=0;r<n.length;++r){var i=n[r],s=t.appendChild(Qo("div",null,"CodeMirror-gutter "+i));i=="CodeMirror-linenumbers"&&(e.display.lineGutter=s,s.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=r?"":"none",D(e)}function D(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px",e.display.scrollbarH.style.left=e.options.fixedGutter?t+"px":0}function P(e){if(e.height==0)return 0;var t=e.text.length,n,r=e;while(n=Yi(r)){var i=n.find(0,!0);r=i.from.line,t+=i.from.ch-i.to.ch}r=e;while(n=Zi(r)){var i=n.find(0,!0);t-=r.text.length-i.from.ch,r=i.to.line,t+=r.text.length-i.to.ch}return t}function H(e){var t=e.display,n=e.doc;t.maxLine=Rs(n,n.first),t.maxLineLength=P(t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var n=P(e);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=e)})}function B(e){var t=Io(e.gutters,"CodeMirror-linenumbers");t==-1&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function j(e){return e.display.scroller.clientHeight-e.display.wrapper.clientHeight<ko-3}function F(e){var t=e.display.scroller;return{clientHeight:t.clientHeight,barHeight:e.display.scrollbarV.clientHeight,scrollWidth:t.scrollWidth,clientWidth:t.clientWidth,hScrollbarTakesSpace:j(e),barWidth:e.display.scrollbarH.clientWidth,docHeight:Math.round(e.doc.height+Gt(e.display))}}function I(e,t){t||(t=F(e));var n=e.display,r=hu(n.measure),i=t.docHeight+ko,s=t.scrollWidth>t.clientWidth;s&&t.scrollWidth<=t.clientWidth+1&&r>0&&!t.hScrollbarTakesSpace&&(s=!1);var o=i>t.clientHeight;o?(n.scrollbarV.style.display="block",n.scrollbarV.style.bottom=s?r+"px":"0",n.scrollbarV.firstChild.style.height=Math.max(0,i-t.clientHeight+(t.barHeight||n.scrollbarV.clientHeight))+"px"):(n.scrollbarV.style.display="",n.scrollbarV.firstChild.style.height="0"),s?(n.scrollbarH.style.display="block",n.scrollbarH.style.right=o?r+"px":"0",n.scrollbarH.firstChild.style.width=t.scrollWidth-t.clientWidth+(t.barWidth||n.scrollbarH.clientWidth)+"px"):(n.scrollbarH.style.display="",n.scrollbarH.firstChild.style.width="0"),s&&o?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=n.scrollbarFiller.style.width=r+"px"):n.scrollbarFiller.style.display="",s&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=r+"px",n.gutterFiller.style.width=n.gutters.offsetWidth+"px"):n.gutterFiller.style.display="";if(!e.state.checkedOverlayScrollbar&&t.clientHeight>0){if(r===0){var u=v&&!c?"12px":"18px";n.scrollbarV.style.minWidth=n.scrollbarH.style.minHeight=u;var a=function(t){vo(t)!=n.scrollbarV&&vo(t)!=n.scrollbarH&&Fn(e,ar)(t)};go(n.scrollbarV,"mousedown",a),go(n.scrollbarH,"mousedown",a)}e.state.checkedOverlayScrollbar=!0}}function q(e,t,n){var r=n&&n.top!=null?Math.max(0,n.top):e.scroller.scrollTop;r=Math.floor(r-Qt(e));var i=n&&n.bottom!=null?n.bottom:r+e.wrapper.clientHeight,s=Vs(t,r),o=Vs(t,i);if(n&&n.ensure){var u=n.ensure.from.line,a=n.ensure.to.line;if(u<s)return{from:u,to:Vs(t,$s(Rs(t,u))+e.wrapper.clientHeight)};if(Math.min(a,t.lastLine())>=o)return{from:Vs(t,$s(Rs(t,a))-e.wrapper.clientHeight),to:a}}return{from:s,to:Math.max(o,s+1)}}function R(e){var t=e.display,n=t.view;if(!t.alignWidgets&&(!t.gutters.firstChild||!e.options.fixedGutter))return;var r=W(t)-t.scroller.scrollLeft+e.doc.scrollLeft,i=t.gutters.offsetWidth,s=r+"px";for(var o=0;o<n.length;o++)if(!n[o].hidden){e.options.fixedGutter&&n[o].gutter&&(n[o].gutter.style.left=s);var u=n[o].alignable;if(u)for(var a=0;a<u.length;a++)u[a].style.left=s}e.options.fixedGutter&&(t.gutters.style.left=r+i+"px")}function U(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=z(e.options,t.first+t.size-1),r=e.display;if(n.length!=r.lineNumChars){var i=r.measure.appendChild(Qo("div",[Qo("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),s=i.firstChild.offsetWidth,o=i.offsetWidth-s;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(s,r.lineGutter.offsetWidth-o),r.lineNumWidth=r.lineNumInnerWidth+o,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",D(e),!0}return!1}function z(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function W(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function X(e,t,n){var r=e.display;this.viewport=t,this.visible=q(r,e.doc,t),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.oldViewFrom=r.viewFrom,this.oldViewTo=r.viewTo,this.oldScrollerWidth=r.scroller.clientWidth,this.force=n,this.dims=Z(e)}function V(e,t){var n=e.display,r=e.doc;if(t.editorIsHidden)return Xn(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(n.updateLineNumbers==null||n.updateLineNumbers>=n.viewTo)&&Kn(e)==0)return!1;U(e)&&(Xn(e),t.dims=Z(e));var i=r.first+r.size,s=Math.max(t.visible.from-e.options.viewportMargin,r.first),o=Math.min(i,t.visible.to+e.options.viewportMargin);n.viewFrom<s&&s-n.viewFrom<20&&(s=Math.max(r.first,n.viewFrom)),n.viewTo>o&&n.viewTo-o<20&&(o=Math.min(i,n.viewTo)),E&&(s=rs(e.doc,s),o=is(e.doc,o));var u=s!=n.viewFrom||o!=n.viewTo||n.lastSizeC!=t.wrapperHeight;Jn(e,s,o),n.viewOffset=$s(Rs(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";var a=Kn(e);if(!u&&a==0&&!t.force&&(n.updateLineNumbers==null||n.updateLineNumbers>=n.viewTo))return!1;var f=tu();return a>4&&(n.lineDiv.style.display="none"),et(e,n.updateLineNumbers,t.dims),a>4&&(n.lineDiv.style.display=""),f&&tu()!=f&&f.offsetHeight&&f.focus(),Yo(n.cursorDiv),Yo(n.selectionDiv),u&&(n.lastSizeC=t.wrapperHeight,Vt(e,400)),n.updateLineNumbers=null,!0}function $(e,t){var n=t.force,r=t.viewport;for(var i=!0;;i=!1){if(i&&e.options.lineWrapping&&t.oldScrollerWidth!=e.display.scroller.clientWidth)n=!0;else{n=!1,r&&r.top!=null&&(r={top:Math.min(e.doc.height+Gt(e.display)-ko-e.display.scroller.clientHeight,r.top)}),t.visible=q(e.display,e.doc,r);if(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break}if(!V(e,t))break;G(e);var s=F(e);Ut(e),K(e,s),I(e,s)}Eo(e,"update",e),(e.display.viewFrom!=t.oldViewFrom||e.display.viewTo!=t.oldViewTo)&&Eo(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo)}function J(e,t){var n=new X(e,t);if(V(e,n)){G(e),$(e,n);var r=F(e);Ut(e),K(e,r),I(e,r)}}function K(e,t){e.display.sizer.style.minHeight=e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=Math.max(t.docHeight,t.clientHeight-ko)+"px"}function Q(e,t){e.display.sizer.offsetWidth+e.display.gutters.offsetWidth<e.display.scroller.clientWidth-1&&(e.display.sizer.style.minHeight=e.display.heightForcer.style.top="0px",e.display.gutters.style.height=t.docHeight+"px")}function G(e){var t=e.display,n=t.lineDiv.offsetTop;for(var s=0;s<t.view.length;s++){var o=t.view[s],u;if(o.hidden)continue;if(r&&i<8){var a=o.node.offsetTop+o.node.offsetHeight;u=a-n,n=a}else{var f=o.node.getBoundingClientRect();u=f.bottom-f.top}var l=o.line.height-u;u<2&&(u=Tn(t));if(l>.001||l<-0.001){Ws(o.line,u),Y(o.line);if(o.rest)for(var c=0;c<o.rest.length;c++)Y(o.rest[c])}}}function Y(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.offsetHeight}function Z(e){var t=e.display,n={},r={};for(var i=t.gutters.firstChild,s=0;i;i=i.nextSibling,++s)n[e.options.gutters[s]]=i.offsetLeft,r[e.options.gutters[s]]=i.offsetWidth;return{fixedPos:W(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function et(e,t,n){function a(t){var n=t.nextSibling;return s&&v&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),n}var r=e.display,i=e.options.lineNumbers,o=r.lineDiv,u=o.firstChild,f=r.view,l=r.viewFrom;for(var c=0;c<f.length;c++){var h=f[c];if(!h.hidden)if(!h.node){var p=ft(e,h,l,n);o.insertBefore(p,u)}else{while(u!=h.node)u=a(u);var d=i&&t!=null&&t<=l&&h.lineNumber;h.changes&&(Io(h.changes,"gutter")>-1&&(d=!1),tt(e,h,l,n)),d&&(Yo(h.lineNumber),h.lineNumber.appendChild(document.createTextNode(z(e.options,l)))),u=h.node.nextSibling}l+=h.size}while(u)u=a(u)}function tt(e,t,n,r){for(var i=0;i<t.changes.length;i++){var s=t.changes[i];s=="text"?st(e,t):s=="gutter"?ut(e,t,n,r):s=="class"?ot(t):s=="widget"&&at(t,r)}t.changes=null}function nt(e){return e.node==e.text&&(e.node=Qo("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),r&&i<8&&(e.node.style.zIndex=2)),e.node}function rt(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;t&&(t+=" CodeMirror-linebackground");if(e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var n=nt(e);e.background=n.insertBefore(Qo("div",null,t),n.firstChild)}}function it(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):Ts(e,t)}function st(e,t){var n=t.text.className,r=it(e,t);t.text==t.node&&(t.node=r.pre),t.text.parentNode.replaceChild(r.pre,t.text),t.text=r.pre,r.bgClass!=t.bgClass||r.textClass!=t.textClass?(t.bgClass=r.bgClass,t.textClass=r.textClass,ot(t)):n&&(t.text.className=n)}function ot(e){rt(e),e.line.wrapClass?nt(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function ut(e,t,n,r){t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null);var i=t.line.gutterMarkers;if(e.options.lineNumbers||i){var s=nt(t),o=t.gutter=s.insertBefore(Qo("div",null,"CodeMirror-gutter-wrapper","position: absolute; left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px"),t.text);e.options.lineNumbers&&(!i||!i["CodeMirror-linenumbers"])&&(t.lineNumber=o.appendChild(Qo("div",z(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px")));if(i)for(var u=0;u<e.options.gutters.length;++u){var a=e.options.gutters[u],f=i.hasOwnProperty(a)&&i[a];f&&o.appendChild(Qo("div",[f],"CodeMirror-gutter-elt","left: "+r.gutterLeft[a]+"px; width: "+r.gutterWidth[a]+"px"))}}}function at(e,t){e.alignable&&(e.alignable=null);for(var n=e.node.firstChild,r;n;n=r){var r=n.nextSibling;n.className=="CodeMirror-linewidget"&&e.node.removeChild(n)}lt(e,t)}function ft(e,t,n,r){var i=it(e,t);return t.text=t.node=i.pre,i.bgClass&&(t.bgClass=i.bgClass),i.textClass&&(t.textClass=i.textClass),ot(t),ut(e,t,n,r),lt(t,r),t.node}function lt(e,t){ct(e.line,e,t,!0);if(e.rest)for(var n=0;n<e.rest.length;n++)ct(e.rest[n],e,t,!1)}function ct(e,t,n,r){if(!e.widgets)return;var i=nt(t);for(var s=0,o=e.widgets;s<o.length;++s){var u=o[s],a=Qo("div",[u.node],"CodeMirror-linewidget");u.handleMouseEvents||(a.ignoreEvents=!0),ht(u,a,t,n),r&&u.above?i.insertBefore(a,t.gutter||t.text):i.appendChild(a),Eo(u,"redraw")}}function ht(e,t,n,r){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var i=r.wrapperWidth;t.style.left=r.fixedPos+"px",e.coverGutter||(i-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px"),t.style.width=i+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function vt(e){return pt(e.line,e.ch)}function mt(e,t){return dt(e,t)<0?t:e}function gt(e,t){return dt(e,t)<0?e:t}function yt(e,t){this.ranges=e,this.primIndex=t}function bt(e,t){this.anchor=e,this.head=t}function wt(e,t){var n=e[t];e.sort(function(e,t){return dt(e.from(),t.from())}),t=Io(e,n);for(var r=1;r<e.length;r++){var i=e[r],s=e[r-1];if(dt(s.to(),i.from())>=0){var o=gt(s.from(),i.from()),u=mt(s.to(),i.to()),a=s.empty()?i.from()==i.head:s.from()==s.head;r<=t&&--t,e.splice(--r,2,new bt(a?u:o,a?o:u))}}return new yt(e,t)}function Et(e,t){return new yt([new bt(e,t||e)],0)}function St(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function xt(e,t){if(t.line<e.first)return pt(e.first,0);var n=e.first+e.size-1;return t.line>n?pt(n,Rs(e,n).text.length):Tt(t,Rs(e,t.line).text.length)}function Tt(e,t){var n=e.ch;return n==null||n>t?pt(e.line,t):n<0?pt(e.line,0):e}function Nt(e,t){return t>=e.first&&t<e.first+e.size}function Ct(e,t){for(var n=[],r=0;r<t.length;r++)n[r]=xt(e,t[r]);return n}function kt(e,t,n,r){if(e.cm&&e.cm.display.shift||e.extend){var i=t.anchor;if(r){var s=dt(n,i)<0;s!=dt(r,i)<0?(i=n,n=r):s!=dt(n,r)<0&&(n=r)}return new bt(i,n)}return new bt(r||n,n)}function Lt(e,t,n,r){Pt(e,new yt([kt(e,e.sel.primary(),t,n)],0),r)}function At(e,t,n){for(var r=[],i=0;i<e.sel.ranges.length;i++)r[i]=kt(e,e.sel.ranges[i],t[i],null);var s=wt(r,e.sel.primIndex);Pt(e,s,n)}function Ot(e,t,n,r){var i=e.sel.ranges.slice(0);i[t]=n,Pt(e,wt(i,e.sel.primIndex),r)}function Mt(e,t,n,r){Pt(e,Et(t,n),r)}function _t(e,t){var n={ranges:t.ranges,update:function(t){this.ranges=[];for(var n=0;n<t.length;n++)this.ranges[n]=new bt(xt(e,t[n].anchor),xt(e,t[n].head))}};return bo(e,"beforeSelectionChange",e,n),e.cm&&bo(e.cm,"beforeSelectionChange",e.cm,n),n.ranges!=t.ranges?wt(n.ranges,n.ranges.length-1):t}function Dt(e,t,n){var r=e.history.done,i=jo(r);i&&i.ranges?(r[r.length-1]=t,Ht(e,t,n)):Pt(e,t,n)}function Pt(e,t,n){Ht(e,t,n),to(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function Ht(e,t,n){if(No(e,"beforeSelectionChange")||e.cm&&No(e.cm,"beforeSelectionChange"))t=_t(e,t);var r=n&&n.bias||(dt(t.primary().head,e.sel.primary().head)<0?-1:1);Bt(e,Ft(e,t,r,!0)),(!n||n.scroll!==!1)&&e.cm&&ni(e.cm)}function Bt(e,t){if(t.equals(e.sel))return;e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,To(e.cm)),Eo(e,"cursorActivity",e)}function jt(e){Bt(e,Ft(e,e.sel,null,!1),Ao)}function Ft(e,t,n,r){var i;for(var s=0;s<t.ranges.length;s++){var o=t.ranges[s],u=It(e,o.anchor,n,r),a=It(e,o.head,n,r);if(i||u!=o.anchor||a!=o.head)i||(i=t.ranges.slice(0,s)),i[s]=new bt(u,a)}return i?wt(i,t.primIndex):t}function It(e,t,n,r){var i=!1,s=t,o=n||1;e.cantEdit=!1;e:for(;;){var u=Rs(e,s.line);if(u.markedSpans)for(var a=0;a<u.markedSpans.length;++a){var f=u.markedSpans[a],l=f.marker;if((f.from==null||(l.inclusiveLeft?f.from<=s.ch:f.from<s.ch))&&(f.to==null||(l.inclusiveRight?f.to>=s.ch:f.to>s.ch))){if(r){bo(l,"beforeCursorEnter");if(l.explicitlyCleared){if(!u.markedSpans)break;--a;continue}}if(!l.atomic)continue;var c=l.find(o<0?-1:1);if(dt(c,s)==0){c.ch+=o,c.ch<0?c.line>e.first?c=xt(e,pt(c.line-1)):c=null:c.ch>u.text.length&&(c.line<e.first+e.size-1?c=pt(c.line+1,0):c=null);if(!c){if(i)return r?(e.cantEdit=!0,pt(e.first,0)):It(e,t,n,!0);i=!0,c=t,o=-o}}s=c;continue e}}return s}}function qt(e){var t=e.display,n=e.doc,r={},i=r.cursors=document.createDocumentFragment(),s=r.selection=document.createDocumentFragment();for(var o=0;o<n.sel.ranges.length;o++){var u=n.sel.ranges[o],a=u.empty();(a||e.options.showCursorWhenSelecting)&&zt(e,u,i),a||Wt(e,u,s)}if(e.options.moveInputWithCursor){var f=yn(e,n.sel.primary().head,"div"),l=t.wrapper.getBoundingClientRect(),c=t.lineDiv.getBoundingClientRect();r.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,f.top+c.top-l.top)),r.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,f.left+c.left-l.left))}return r}function Rt(e,t){Zo(e.display.cursorDiv,t.cursors),Zo(e.display.selectionDiv,t.selection),t.teTop!=null&&(e.display.inputDiv.style.top=t.teTop+"px",e.display.inputDiv.style.left=t.teLeft+"px")}function Ut(e){Rt(e,qt(e))}function zt(e,t,n){var r=yn(e,t.head,"div",null,null,!e.options.singleCursorHeightPerLine),i=n.appendChild(Qo("div"," ","CodeMirror-cursor"));i.style.left=r.left+"px",i.style.top=r.top+"px",i.style.height=Math.max(0,r.bottom-r.top)*e.options.cursorHeight+"px";if(r.other){var s=n.appendChild(Qo("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));s.style.display="",s.style.left=r.other.left+"px",s.style.top=r.other.top+"px",s.style.height=(r.other.bottom-r.other.top)*.85+"px"}}function Wt(e,t,n){function f(e,t,n,r){t<0&&(t=0),t=Math.round(t),r=Math.round(r),s.appendChild(Qo("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(n==null?a-e:n)+"px; height: "+(r-t)+"px"))}function l(t,n,r){function h(n,r){return gn(e,pt(t,n),"div",s,r)}var s=Rs(i,t),o=s.text.length,l,c;return xu(Js(s),n||0,r==null?o:r,function(e,t,i){var s=h(e,"left"),p,d,v;if(e==t)p=s,d=v=s.left;else{p=h(t-1,"right");if(i=="rtl"){var m=s;s=p,p=m}d=s.left,v=p.right}n==null&&e==0&&(d=u),p.top-s.top>3&&(f(d,s.top,null,s.bottom),d=u,s.bottom<p.top&&f(d,s.bottom,null,p.top)),r==null&&t==o&&(v=a);if(!l||s.top<l.top||s.top==l.top&&s.left<l.left)l=s;if(!c||p.bottom>c.bottom||p.bottom==c.bottom&&p.right>c.right)c=p;d<u+1&&(d=u),f(d,p.top,v-d,p.bottom)}),{start:l,end:c}}var r=e.display,i=e.doc,s=document.createDocumentFragment(),o=Yt(e.display),u=o.left,a=r.lineSpace.offsetWidth-o.right,c=t.from(),h=t.to();if(c.line==h.line)l(c.line,c.ch,h.ch);else{var p=Rs(i,c.line),d=Rs(i,h.line),v=ts(p)==ts(d),m=l(c.line,c.ch,v?p.text.length+1:null).end,g=l(h.line,v?0:null,h.ch).start;v&&(m.top<g.top-2?(f(m.right,m.top,null,m.bottom),f(u,g.top,g.left,g.bottom)):f(m.right,m.top,g.left-m.right,m.bottom)),m.bottom<g.top&&f(u,m.bottom,null,g.top)}n.appendChild(s)}function Xt(e){if(!e.state.focused)return;var t=e.display;clearInterval(t.blinker);var n=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}function Vt(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,zo($t,e))}function $t(e){var t=e.doc;t.frontier<t.first&&(t.frontier=t.first);if(t.frontier>=e.display.viewTo)return;var n=+(new Date)+e.options.workTime,r=bi(t.mode,Kt(e,t.frontier)),i=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(s){if(t.frontier>=e.display.viewFrom){var o=s.styles,u=ys(e,s,r,!0);s.styles=u.styles;var a=s.styleClasses,f=u.classes;f?s.styleClasses=f:a&&(s.styleClasses=null);var l=!o||o.length!=s.styles.length||a!=f&&(!a||!f||a.bgClass!=f.bgClass||a.textClass!=f.textClass);for(var c=0;!l&&c<o.length;++c)l=o[c]!=s.styles[c];l&&i.push(t.frontier),s.stateAfter=bi(t.mode,r)}else ws(e,s.text,r),s.stateAfter=t.frontier%5==0?bi(t.mode,r):null;++t.frontier;if(+(new Date)>n)return Vt(e,e.options.workDelay),!0}),i.length&&jn(e,function(){for(var t=0;t<i.length;t++)Wn(e,i[t],"text")})}function Jt(e,t,n){var r,i,s=e.doc,o=n?-1:t-(e.doc.mode.innerMode?1e3:100);for(var u=t;u>o;--u){if(u<=s.first)return s.first;var a=Rs(s,u-1);if(a.stateAfter&&(!n||u<=s.frontier))return u;var f=Do(a.text,null,e.options.tabSize);if(i==null||r>f)i=u-1,r=f}return i}function Kt(e,t,n){var r=e.doc,i=e.display;if(!r.mode.startState)return!0;var s=Jt(e,t,n),o=s>r.first&&Rs(r,s-1).stateAfter;return o?o=bi(r.mode,o):o=wi(r.mode),r.iter(s,t,function(n){ws(e,n.text,o);var u=s==t-1||s%5==0||s>=i.viewFrom&&s<i.viewTo;n.stateAfter=u?bi(r.mode,o):null,++s}),n&&(r.frontier=s),o}function Qt(e){return e.lineSpace.offsetTop}function Gt(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Yt(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=Zo(e.measure,Qo("pre","x")),n=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,r={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return!isNaN(r.left)&&!isNaN(r.right)&&(e.cachedPaddingH=r),r}function Zt(e,t,n){var r=e.options.lineWrapping,i=r&&e.display.scroller.clientWidth;if(!t.measure.heights||r&&t.measure.width!=i){var s=t.measure.heights=[];if(r){t.measure.width=i;var o=t.text.firstChild.getClientRects();for(var u=0;u<o.length-1;u++){var a=o[u],f=o[u+1];Math.abs(a.bottom-f.bottom)>2&&s.push((a.bottom+f.top)/2-n.top)}}s.push(n.bottom-n.top)}}function en(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var r=0;r<e.rest.length;r++)if(e.rest[r]==t)return{map:e.measure.maps[r],cache:e.measure.caches[r]};for(var r=0;r<e.rest.length;r++)if(Xs(e.rest[r])>n)return{map:e.measure.maps[r],cache:e.measure.caches[r],before:!0}}function tn(e,t){t=ts(t);var n=Xs(t),r=e.display.externalMeasured=new Rn(e.doc,t,n);r.lineN=n;var i=r.built=Ts(e,r);return r.text=i.pre,Zo(e.display.lineMeasure,i.pre),r}function nn(e,t,n,r){return on(e,sn(e,t),n,r)}function rn(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[Vn(e,t)];var n=e.display.externalMeasured;if(n&&t>=n.lineN&&t<n.lineN+n.size)return n}function sn(e,t){var n=Xs(t),r=rn(e,n);r&&!r.text?r=null:r&&r.changes&&tt(e,r,n,Z(e)),r||(r=tn(e,t));var i=en(r,t,n);return{line:t,view:r,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:!1}}function on(e,t,n,r,i){t.before&&(n=-1);var s=n+(r||""),o;return t.cache.hasOwnProperty(s)?o=t.cache[s]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(Zt(e,t.view,t.rect),t.hasHeights=!0),o=an(e,t,n,r),o.bogus||(t.cache[s]=o)),{left:o.left,right:o.right,top:i?o.rtop:o.top,bottom:i?o.rbottom:o.bottom}}function an(e,t,n,s){var o=t.map,u,a,f,l;for(var c=0;c<o.length;c+=3){var h=o[c],p=o[c+1];if(n<h)a=0,f=1,l="left";else if(n<p)a=n-h,f=a+1;else if(c==o.length-3||n==p&&o[c+3]>n)f=p-h,a=f-1,n>=p&&(l="right");if(a!=null){u=o[c+2],h==p&&s==(u.insertLeft?"left":"right")&&(l=s);if(s=="left"&&a==0)while(c&&o[c-2]==o[c-3]&&o[c-1].insertLeft)u=o[(c-=3)+2],l="left";if(s=="right"&&a==p-h)while(c<o.length-3&&o[c+3]==o[c+4]&&!o[c+5].insertLeft)u=o[(c+=3)+2],l="right";break}}var d;if(u.nodeType==3){while(a&&Ko(t.line.text.charAt(h+a)))--a;while(h+f<p&&Ko(t.line.text.charAt(h+f)))++f;if(r&&i<9&&a==0&&f==p-h)d=u.parentNode.getBoundingClientRect();else if(r&&e.options.lineWrapping){var v=Go(u,a,f).getClientRects();v.length?d=v[s=="right"?v.length-1:0]:d=un}else d=Go(u,a,f).getBoundingClientRect()||un}else{a>0&&(l=s="right");var v;e.options.lineWrapping&&(v=u.getClientRects()).length>1?d=v[s=="right"?v.length-1:0]:d=u.getBoundingClientRect()}if(r&&i<9&&!a&&(!d||!d.left&&!d.right)){var m=u.parentNode.getClientRects()[0];m?d={left:m.left,right:m.left+Nn(e.display),top:m.top,bottom:m.bottom}:d=un}r&&i<11&&(d=fn(e.display.measure,d));var g=d.top-t.rect.top,y=d.bottom-t.rect.top,b=(g+y)/2,w=t.view.measure.heights;for(var c=0;c<w.length-1;c++)if(b<w[c])break;var E=c?w[c-1]:0,S=w[c],x={left:(l=="right"?d.right:d.left)-t.rect.left,right:(l=="left"?d.left:d.right)-t.rect.left,top:E,bottom:S};return!d.left&&!d.right&&(x.bogus=!0),e.options.singleCursorHeightPerLine||(x.rtop=g,x.rbottom=y),x}function fn(e,t){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!Eu(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,r=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*r,bottom:t.bottom*r}}function ln(e){if(e.measure){e.measure.cache={},e.measure.heights=null;if(e.rest)for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}}function cn(e){e.display.externalMeasure=null,Yo(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)ln(e.display.view[t])}function hn(e){cn(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function pn(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function dn(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function vn(e,t,n,r){if(t.widgets)for(var i=0;i<t.widgets.length;++i)if(t.widgets[i].above){var s=fs(t.widgets[i]);n.top+=s,n.bottom+=s}if(r=="line")return n;r||(r="local");var o=$s(t);r=="local"?o+=Qt(e.display):o-=e.display.viewOffset;if(r=="page"||r=="window"){var u=e.display.lineSpace.getBoundingClientRect();o+=u.top+(r=="window"?0:dn());var a=u.left+(r=="window"?0:pn());n.left+=a,n.right+=a}return n.top+=o,n.bottom+=o,n}function mn(e,t,n){if(n=="div")return t;var r=t.left,i=t.top;if(n=="page")r-=pn(),i-=dn();else if(n=="local"||!n){var s=e.display.sizer.getBoundingClientRect();r+=s.left,i+=s.top}var o=e.display.lineSpace.getBoundingClientRect();return{left:r-o.left,top:i-o.top}}function gn(e,t,n,r,i){return r||(r=Rs(e.doc,t.line)),vn(e,r,nn(e,r,t.ch,i),n)}function yn(e,t,n,r,i,s){function o(t,o){var u=on(e,i,t,o?"right":"left",s);return o?u.left=u.right:u.right=u.left,vn(e,r,u,n)}function u(e,t){var n=a[t],r=n.level%2;return e==Tu(n)&&t&&n.level<a[t-1].level?(n=a[--t],e=Nu(n)-(n.level%2?0:1),r=!0):e==Nu(n)&&t<a.length-1&&n.level<a[t+1].level&&(n=a[++t],e=Tu(n)-n.level%2,r=!1),r&&e==n.to&&e>n.from?o(e-1):o(e,r)}r=r||Rs(e.doc,t.line),i||(i=sn(e,r));var a=Js(r),f=t.ch;if(!a)return o(f);var l=Du(a,f),c=u(f,l);return _u!=null&&(c.other=u(f,_u)),c}function bn(e,t){var n=0,t=xt(e.doc,t);e.options.lineWrapping||(n=Nn(e.display)*t.ch);var r=Rs(e.doc,t.line),i=$s(r)+Qt(e.display);return{left:n,right:n,top:i,bottom:i+r.height}}function wn(e,t,n,r){var i=pt(e,t);return i.xRel=r,n&&(i.outside=!0),i}function En(e,t,n){var r=e.doc;n+=e.display.viewOffset;if(n<0)return wn(r.first,0,!0,-1);var i=Vs(r,n),s=r.first+r.size-1;if(i>s)return wn(r.first+r.size-1,Rs(r,s).text.length,!0,1);t<0&&(t=0);var o=Rs(r,i);for(;;){var u=Sn(e,o,i,t,n),a=Zi(o),f=a&&a.find(0,!0);if(!a||!(u.ch>f.from.ch||u.ch==f.from.ch&&u.xRel>0))return u;i=Xs(o=f.to.line)}}function Sn(e,t,n,r,i){function f(r){var i=yn(e,pt(n,r),"line",t,a);return o=!0,s>i.bottom?i.left-u:s<i.top?i.left+u:(o=!1,i.left)}var s=i-$s(t),o=!1,u=2*e.display.wrapper.clientWidth,a=sn(e,t),l=Js(t),c=t.text.length,h=Cu(t),p=ku(t),d=f(h),v=o,m=f(p),g=o;if(r>m)return wn(n,p,g,1);for(;;){if(l?p==h||p==Hu(t,h,1):p-h<=1){var y=r<d||r-d<=m-r?h:p,b=r-(y==h?d:m);while(Ko(t.text.charAt(y)))++y;var w=wn(n,y,y==h?v:g,b<-1?-1:b>1?1:0);return w}var E=Math.ceil(c/2),S=h+E;if(l){S=h;for(var x=0;x<E;++x)S=Hu(t,S,1)}var T=f(S);if(T>r){p=S,m=T;if(g=o)m+=1e3;c=E}else h=S,d=T,v=o,c-=E}}function Tn(e){if(e.cachedTextHeight!=null)return e.cachedTextHeight;if(xn==null){xn=Qo("pre");for(var t=0;t<49;++t)xn.appendChild(document.createTextNode("x")),xn.appendChild(Qo("br"));xn.appendChild(document.createTextNode("x"))}Zo(e.measure,xn);var n=xn.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),Yo(e.measure),n||1}function Nn(e){if(e.cachedCharWidth!=null)return e.cachedCharWidth;var t=Qo("span","xxxxxxxxxx"),n=Qo("pre",[t]);Zo(e.measure,n);var r=t.getBoundingClientRect(),i=(r.right-r.left)/10;return i>2&&(e.cachedCharWidth=i),i||10}function Ln(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,id:++kn},Cn?Cn.ops.push(e.curOp):e.curOp.ownsGroup=Cn={ops:[e.curOp],delayedCallbacks:[]}}function An(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n]();for(var r=0;r<e.ops.length;r++){var i=e.ops[r];if(i.cursorActivityHandlers)while(i.cursorActivityCalled<i.cursorActivityHandlers.length)i.cursorActivityHandlers[i.cursorActivityCalled++](i.cm)}}while(n<t.length)}function On(e){var t=e.curOp,n=t.ownsGroup;if(!n)return;try{An(n)}finally{Cn=null;for(var r=0;r<n.ops.length;r++)n.ops[r].cm.curOp=null;Mn(n)}}function Mn(e){var t=e.ops;for(var n=0;n<t.length;n++)_n(t[n]);for(var n=0;n<t.length;n++)Dn(t[n]);for(var n=0;n<t.length;n++)Pn(t[n]);for(var n=0;n<t.length;n++)Hn(t[n]);for(var n=0;n<t.length;n++)Bn(t[n])}function _n(e){var t=e.cm,n=t.display;e.updateMaxLine&&H(t),e.mustUpdate=e.viewChanged||e.forceUpdate||e.scrollTop!=null||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new X(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Dn(e){e.updatedDisplay=e.mustUpdate&&V(e.cm,e.update)}function Pn(e){var t=e.cm,n=t.display;e.updatedDisplay&&G(t),e.barMeasure=F(t);if(n.maxLineChanged&&!t.options.lineWrapping){e.adjustWidthTo=nn(t,n.maxLine,n.maxLine.text.length).left+3,e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo+ko-n.scroller.clientWidth);var r=n.sizer.style.minWidth;r&&e.barMeasure.scrollWidth>e.barMeasure.clientWidth&&(e.barMeasure.scrollWidth+=e.adjustWidthTo-parseInt(r))}if(e.updatedDisplay||e.selectionChanged)e.newSelectionNodes=qt(t)}function Hn(e){var t=e.cm;e.adjustWidthTo!=null&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&wr(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1),e.newSelectionNodes&&Rt(t,e.newSelectionNodes),e.updatedDisplay&&K(t,e.barMeasure),(e.updatedDisplay||e.startHeight!=t.doc.height)&&I(t,e.barMeasure),e.selectionChanged&&Xt(t),t.state.focused&&e.updateInput&&er(t,e.typing)}function Bn(e){var t=e.cm,n=t.display,r=t.doc;e.updatedDisplay&&$(t,e.update),n.wheelStartX!=null&&(e.scrollTop!=null||e.scrollLeft!=null||e.scrollToPos)&&(n.wheelStartX=n.wheelStartY=null);if(e.scrollTop!=null&&n.scroller.scrollTop!=e.scrollTop){var i=Math.max(0,Math.min(n.scroller.scrollHeight-n.scroller.clientHeight,e.scrollTop));n.scroller.scrollTop=n.scrollbarV.scrollTop=r.scrollTop=i}if(e.scrollLeft!=null&&n.scroller.scrollLeft!=e.scrollLeft){var o=Math.max(0,Math.min(n.scroller.scrollWidth-n.scroller.clientWidth,e.scrollLeft));n.scroller.scrollLeft=n.scrollbarH.scrollLeft=r.scrollLeft=o,R(t)}if(e.scrollToPos){var u=Yr(t,xt(r,e.scrollToPos.from),xt(r,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&Gr(t,u)}var a=e.maybeHiddenMarkers,f=e.maybeUnhiddenMarkers;if(a)for(var l=0;l<a.length;++l)a[l].lines.length||bo(a[l],"hide");if(f)for(var l=0;l<f.length;++l)f[l].lines.length&&bo(f[l],"unhide");n.wrapper.offsetHeight&&(r.scrollTop=t.display.scroller.scrollTop),e.updatedDisplay&&s&&(t.options.lineWrapping&&Q(t,e.barMeasure),e.barMeasure.scrollWidth>e.barMeasure.clientWidth&&e.barMeasure.scrollWidth<e.barMeasure.clientWidth+1&&!j(t)&&I(t)),e.changeObjs&&bo(t,"changes",t,e.changeObjs)}function jn(e,t){if(e.curOp)return t();Ln(e);try{return t()}finally{On(e)}}function Fn(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Ln(e);try{return t.apply(e,arguments)}finally{On(e)}}}function In(e){return function(){if(this.curOp)return e.apply(this,arguments);Ln(this);try{return e.apply(this,arguments)}finally{On(this)}}}function qn(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);Ln(t);try{return e.apply(this,arguments)}finally{On(t)}}}function Rn(e,t,n){this.line=t,this.rest=ns(t),this.size=this.rest?Xs(jo(this.rest))-n+1:1,this.node=this.text=null,this.hidden=ss(e,t)}function Un(e,t,n){var r=[],i;for(var s=t;s<n;s=i){var o=new Rn(e.doc,Rs(e.doc,s),s);i=s+o.size,r.push(o)}return r}function zn(e,t,n,r){t==null&&(t=e.doc.first),n==null&&(n=e.doc.first+e.doc.size),r||(r=0);var i=e.display;r&&n<i.viewTo&&(i.updateLineNumbers==null||i.updateLineNumbers>t)&&(i.updateLineNumbers=t),e.curOp.viewChanged=!0;if(t>=i.viewTo)E&&rs(e.doc,t)<i.viewTo&&Xn(e);else if(n<=i.viewFrom)E&&is(e.doc,n+r)>i.viewFrom?Xn(e):(i.viewFrom+=r,i.viewTo+=r);else if(t<=i.viewFrom&&n>=i.viewTo)Xn(e);else if(t<=i.viewFrom){var s=$n(e,n,n+r,1);s?(i.view=i.view.slice(s.index),i.viewFrom=s.lineN,i.viewTo+=r):Xn(e)}else if(n>=i.viewTo){var s=$n(e,t,t,-1);s?(i.view=i.view.slice(0,s.index),i.viewTo=s.lineN):Xn(e)}else{var o=$n(e,t,t,-1),u=$n(e,n,n+r,1);o&&u?(i.view=i.view.slice(0,o.index).concat(Un(e,o.lineN,u.lineN)).concat(i.view.slice(u.index)),i.viewTo+=r):Xn(e)}var a=i.externalMeasured;a&&(n<a.lineN?a.lineN+=r:t<a.lineN+a.size&&(i.externalMeasured=null))}function Wn(e,t,n){e.curOp.viewChanged=!0;var r=e.display,i=e.display.externalMeasured;i&&t>=i.lineN&&t<i.lineN+i.size&&(r.externalMeasured=null);if(t<r.viewFrom||t>=r.viewTo)return;var s=r.view[Vn(e,t)];if(s.node==null)return;var o=s.changes||(s.changes=[]);Io(o,n)==-1&&o.push(n)}function Xn(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function Vn(e,t){if(t>=e.display.viewTo)return null;t-=e.display.viewFrom;if(t<0)return null;var n=e.display.view;for(var r=0;r<n.length;r++){t-=n[r].size;if(t<0)return r}}function $n(e,t,n,r){var i=Vn(e,t),s,o=e.display.view;if(!E||n==e.doc.first+e.doc.size)return{index:i,lineN:n};for(var u=0,a=e.display.viewFrom;u<i;u++)a+=o[u].size;if(a!=t){if(r>0){if(i==o.length-1)return null;s=a+o[i].size-t,i++}else s=a-t;t+=s,n+=s}while(rs(e.doc,n)!=n){if(i==(r<0?0:o.length-1))return null;n+=r*o[i-(r<0?1:0)].size,i+=r}return{index:i,lineN:n}}function Jn(e,t,n){var r=e.display,i=r.view;i.length==0||t>=r.viewTo||n<=r.viewFrom?(r.view=Un(e,t,n),r.viewFrom=t):(r.viewFrom>t?r.view=Un(e,t,r.viewFrom).concat(r.view):r.viewFrom<t&&(r.view=r.view.slice(Vn(e,t))),r.viewFrom=t,r.viewTo<n?r.view=r.view.concat(Un(e,r.viewTo,n)):r.viewTo>n&&(r.view=r.view.slice(0,Vn(e,n)))),r.viewTo=n}function Kn(e){var t=e.display.view,n=0;for(var r=0;r<t.length;r++){var i=t[r];!i.hidden&&(!i.node||i.changes)&&++n}return n}function Qn(e){if(e.display.pollingFast)return;e.display.poll.set(e.options.pollInterval,function(){Zn(e),e.state.focused&&Qn(e)})}function Gn(e){function n(){var r=Zn(e);!r&&!t?(t=!0,e.display.poll.set(60,n)):(e.display.pollingFast=!1,Qn(e))}var t=!1;e.display.pollingFast=!0,e.display.poll.set(20,n)}function Zn(e){var t=e.display.input,n=e.display.prevInput,s=e.doc;if(!e.state.focused||yu(t)&&!n||rr(e)||e.options.disableInput)return!1;e.state.pasteIncoming&&e.state.fakedLastChar&&(t.value=t.value.substring(0,t.value.length-1),e.state.fakedLastChar=!1);var o=t.value;if(o==n&&!e.somethingSelected())return!1;if(r&&i>=9&&e.display.inputHasSelection===o||v&&/[\uf700-\uf7ff]/.test(o))return er(e),!1;var u=!e.curOp;u&&Ln(e),e.display.shift=!1,o.charCodeAt(0)==8203&&s.sel==e.display.selForContextMenu&&!n&&(n="​");var a=0,f=Math.min(n.length,o.length);while(a<f&&n.charCodeAt(a)==o.charCodeAt(a))++a;var l=o.slice(a),c=gu(l),h=null;e.state.pasteIncoming&&s.sel.ranges.length>1&&(Yn&&Yn.join("\n")==l?h=s.sel.ranges.length%Yn.length==0&&qo(Yn,gu):c.length==s.sel.ranges.length&&(h=qo(c,function(e){return[e]})));for(var p=s.sel.ranges.length-1;p>=0;p--){var d=s.sel.ranges[p],m=d.from(),g=d.to();a<n.length?m=pt(m.line,m.ch-(n.length-a)):e.state.overwrite&&d.empty()&&!e.state.pasteIncoming&&(g=pt(g.line,Math.min(Rs(s,g.line).text.length,g.ch+jo(c).length)));var y=e.curOp.updateInput,b={from:m,to:g,text:h?h[p%h.length]:c,origin:e.state.pasteIncoming?"paste":e.state.cutIncoming?"cut":"+input"};Wr(e.doc,b),Eo(e,"inputRead",e,b);if(l&&!e.state.pasteIncoming&&e.options.electricChars&&e.options.smartIndent&&d.head.ch<100&&(!p||s.sel.ranges[p-1].head.line!=d.head.line)){var w=e.getModeAt(d.head);if(w.electricChars){for(var E=0;E<w.electricChars.length;E++)if(l.indexOf(w.electricChars.charAt(E))>-1){ii(e,d.head.line,"smart");break}}else if(w.electricInput){var S=Fr(b);w.electricInput.test(Rs(s,S.line).text.slice(0,S.ch))&&ii(e,d.head.line,"smart")}}}return ni(e),e.curOp.updateInput=y,e.curOp.typing=!0,o.length>1e3||o.indexOf("\n")>-1?t.value=e.display.prevInput="":e.display.prevInput=o,u&&On(e),e.state.pasteIncoming=e.state.cutIncoming=!1,!0}function er(e,t){var n,s,o=e.doc;if(e.somethingSelected()){e.display.prevInput="";var u=o.sel.primary();n=bu&&(u.to().line-u.from().line>100||(s=e.getSelection()).length>1e3);var a=n?"-":s||e.getSelection();e.display.input.value=a,e.state.focused&&Fo(e.display.input),r&&i>=9&&(e.display.inputHasSelection=a)}else t||(e.display.prevInput=e.display.input.value="",r&&i>=9&&(e.display.inputHasSelection=null));e.display.inaccurateSelection=n}function tr(e){e.options.readOnly!="nocursor"&&(!d||tu()!=e.display.input)&&e.display.input.focus()}function nr(e){e.state.focused||(tr(e),Pr(e))}function rr(e){return e.options.readOnly||e.doc.cantEdit}function ir(e){function n(){e.state.focused&&setTimeout(zo(tr,e),0)}function o(t){xo(e,t)||po(t)}function u(n){if(e.somethingSelected())Yn=e.getSelections(),t.inaccurateSelection&&(t.prevInput="",t.inaccurateSelection=!1,t.input.value=Yn.join("\n"),Fo(t.input));else{var r=[],i=[];for(var s=0;s<e.doc.sel.ranges.length;s++){var o=e.doc.sel.ranges[s].head.line,u={anchor:pt(o,0),head:pt(o+1,0)};i.push(u),r.push(e.getRange(u.anchor,u.head))}n.type=="cut"?e.setSelections(i,null,Ao):(t.prevInput="",t.input.value=r.join("\n"),Fo(t.input)),Yn=r}n.type=="cut"&&(e.state.cutIncoming=!0)}var t=e.display;go(t.scroller,"mousedown",Fn(e,ar)),r&&i<11?go(t.scroller,"dblclick",Fn(e,function(t){if(xo(e,t))return;var n=ur(e,t);if(!n||vr(e,t)||or(e.display,t))return;lo(t);var r=fi(e,n);Lt(e.doc,r.anchor,r.head)})):go(t.scroller,"dblclick",function(t){xo(e,t)||lo(t)}),go(t.lineSpace,"selectstart",function(e){or(t,e)||lo(e)}),b||go(t.scroller,"contextmenu",function(t){Br(e,t)}),go(t.scroller,"scroll",function(){t.scroller.clientHeight&&(br(e,t.scroller.scrollTop),wr(e,t.scroller.scrollLeft,!0),bo(e,"scroll",e))}),go(t.scrollbarV,"scroll",function(){t.scroller.clientHeight&&br(e,t.scrollbarV.scrollTop)}),go(t.scrollbarH,"scroll",function(){t.scroller.clientHeight&&wr(e,t.scrollbarH.scrollLeft)}),go(t.scroller,"mousewheel",function(t){xr(e,t)}),go(t.scroller,"DOMMouseScroll",function(t){xr(e,t)}),go(t.scrollbarH,"mousedown",n),go(t.scrollbarV,"mousedown",n),go(t.wrapper,"scroll",function(){t.wrapper.scrollTop=t.wrapper.scrollLeft=0}),go(t.input,"keyup",function(t){_r.call(e,t)}),go(t.input,"input",function(){r&&i>=9&&e.display.inputHasSelection&&(e.display.inputHasSelection=null),Gn(e)}),go(t.input,"keydown",Fn(e,Or)),go(t.input,"keypress",Fn(e,Dr)),go(t.input,"focus",zo(Pr,e)),go(t.input,"blur",zo(Hr,e)),e.options.dragDrop&&(go(t.scroller,"dragstart",function(t){yr(e,t)}),go(t.scroller,"dragenter",o),go(t.scroller,"dragover",o),go(t.scroller,"drop",Fn(e,gr))),go(t.scroller,"paste",function(n){if(or(t,n))return;e.state.pasteIncoming=!0,tr(e),Gn(e)}),go(t.input,"paste",function(){if(s&&!e.state.fakedLastChar&&!(new Date-e.state.lastMiddleDown<200)){var n=t.input.selectionStart,r=t.input.selectionEnd;t.input.value+="$",t.input.selectionEnd=r,t.input.selectionStart=n,e.state.fakedLastChar=!0}e.state.pasteIncoming=!0,Gn(e)}),go(t.input,"cut",u),go(t.input,"copy",u),l&&go(t.sizer,"mouseup",function(){tu()==t.input&&t.input.blur(),tr(e)})}function sr(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,e.setSize()}function or(e,t){for(var n=vo(t);n!=e.wrapper;n=n.parentNode)if(!n||n.ignoreEvents||n.parentNode==e.sizer&&n!=e.mover)return!0}function ur(e,t,n,r){var i=e.display;if(!n){var s=vo(t);if(s==i.scrollbarH||s==i.scrollbarV||s==i.scrollbarFiller||s==i.gutterFiller)return null}var o,u,a=i.lineSpace.getBoundingClientRect();try{o=t.clientX-a.left,u=t.clientY-a.top}catch(t){return null}var f=En(e,o,u),l;if(r&&f.xRel==1&&(l=Rs(e.doc,f.line).text).length==f.ch){var c=Do(l,l.length,e.options.tabSize)-l.length;f=pt(f.line,Math.max(0,Math.round((o-Yt(e.display).left)/Nn(e.display))-c))}return f}function ar(e){if(xo(this,e))return;var t=this,n=t.display;n.shift=e.shiftKey;if(or(n,e)){s||(n.scroller.draggable=!1,setTimeout(function(){n.scroller.draggable=!0},100));return}if(vr(t,e))return;var r=ur(t,e);window.focus();switch(mo(e)){case 1:r?cr(t,e,r):vo(e)==n.scroller&&lo(e);break;case 2:s&&(t.state.lastMiddleDown=+(new Date)),r&&Lt(t.doc,r),setTimeout(zo(tr,t),20),lo(e);break;case 3:b&&Br(t,e)}}function cr(e,t,n){setTimeout(zo(nr,e),0);var r=+(new Date),i;lr&&lr.time>r-400&&dt(lr.pos,n)==0?i="triple":fr&&fr.time>r-400&&dt(fr.pos,n)==0?(i="double",lr={time:r,pos:n}):(i="single",fr={time:r,pos:n});var s=e.doc.sel,o=v?t.metaKey:t.ctrlKey;e.options.dragDrop&&lu&&!rr(e)&&i=="single"&&s.contains(n)>-1&&s.somethingSelected()?hr(e,t,n,o):pr(e,t,n,i,o)}function hr(e,t,n,o){var u=e.display,a=Fn(e,function(f){s&&(u.scroller.draggable=!1),e.state.draggingText=!1,yo(document,"mouseup",a),yo(u.scroller,"drop",a),Math.abs(t.clientX-f.clientX)+Math.abs(t.clientY-f.clientY)<10&&(lo(f),o||Lt(e.doc,n),tr(e),r&&i==9&&setTimeout(function(){document.body.focus(),tr(e)},20))});s&&(u.scroller.draggable=!0),e.state.draggingText=a,u.scroller.dragDrop&&u.scroller.dragDrop(),go(document,"mouseup",a),go(u.scroller,"drop",a)}function pr(e,t,n,r,i){function p(t){if(dt(h,t)==0)return;h=t;if(r=="rect"){var i=[],s=e.options.tabSize,l=Do(Rs(o,n.line).text,n.ch,s),c=Do(Rs(o,t.line).text,t.ch,s),p=Math.min(l,c),d=Math.max(l,c);for(var v=Math.min(n.line,t.line),m=Math.min(e.lastLine(),Math.max(n.line,t.line));v<=m;v++){var g=Rs(o,v).text,y=Po(g,p,s);p==d?i.push(new bt(pt(v,y),pt(v,y))):g.length>y&&i.push(new bt(pt(v,y),pt(v,Po(g,d,s))))}i.length||i.push(new bt(n,n)),Pt(o,wt(f.ranges.slice(0,a).concat(i),a),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var b=u,w=b.anchor,E=t;if(r!="single"){if(r=="double")var S=fi(e,t);else var S=new bt(pt(t.line,0),xt(o,pt(t.line+1,0)));dt(S.anchor,w)>0?(E=S.head,w=gt(b.from(),S.anchor)):(E=S.anchor,w=mt(b.to(),S.head))}var i=f.ranges.slice(0);i[a]=new bt(xt(o,w),E),Pt(o,wt(i,a),Oo)}}function m(t){var n=++v,i=ur(e,t,!0,r=="rect");if(!i)return;if(dt(i,h)!=0){nr(e),p(i);var u=q(s,o);(i.line>=u.to||i.line<u.from)&&setTimeout(Fn(e,function(){v==n&&m(t)}),150)}else{var a=t.clientY<d.top?-20:t.clientY>d.bottom?20:0;a&&setTimeout(Fn(e,function(){if(v!=n)return;s.scroller.scrollTop+=a,m(t)}),50)}}function g(t){v=Infinity,lo(t),tr(e),yo(document,"mousemove",y),yo(document,"mouseup",b),o.history.lastSelOrigin=null}var s=e.display,o=e.doc;lo(t);var u,a,f=o.sel;i&&!t.shiftKey?(a=o.sel.contains(n),a>-1?u=o.sel.ranges[a]:u=new bt(n,n)):u=o.sel.primary();if(t.altKey)r="rect",i||(u=new bt(n,n)),n=ur(e,t,!0,!0),a=-1;else if(r=="double"){var l=fi(e,n);e.display.shift||o.extend?u=kt(o,u,l.anchor,l.head):u=l}else if(r=="triple"){var c=new bt(pt(n.line,0),xt(o,pt(n.line+1,0)));e.display.shift||o.extend?u=kt(o,u,c.anchor,c.head):u=c}else u=kt(o,u,n);i?a>-1?Ot(o,a,u,Oo):(a=o.sel.ranges.length,Pt(o,wt(o.sel.ranges.concat([u]),a),{scroll:!1,origin:"*mouse"})):(a=0,Pt(o,new yt([u],0),Oo),f=o.sel);var h=n,d=s.wrapper.getBoundingClientRect(),v=0,y=Fn(e,function(e){mo(e)?m(e):g(e)}),b=Fn(e,g);go(document,"mousemove",y),go(document,"mouseup",b)}function dr(e,t,n,r,i){try{var s=t.clientX,o=t.clientY}catch(t){return!1}if(s>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;r&&lo(t);var u=e.display,a=u.lineDiv.getBoundingClientRect();if(o>a.bottom||!No(e,n))return ho(t);o-=a.top-u.viewOffset;for(var f=0;f<e.options.gutters.length;++f){var l=u.gutters.childNodes[f];if(l&&l.getBoundingClientRect().right>=s){var c=Vs(e.doc,o),h=e.options.gutters[f];return i(e,n,e,c,h,t),ho(t)}}}function vr(e,t){return dr(e,t,"gutterClick",!0,Eo)}function gr(e){var t=this;if(xo(t,e)||or(t.display,e))return;lo(e),r&&(mr=+(new Date));var n=ur(t,e,!0),i=e.dataTransfer.files;if(!n||rr(t))return;if(i&&i.length&&window.FileReader&&window.File){var s=i.length,o=Array(s),u=0,a=function(e,r){var i=new FileReader;i.onload=Fn(t,function(){o[r]=i.result;if(++u==s){n=xt(t.doc,n);var e={from:n,to:n,text:gu(o.join("\n")),origin:"paste"};Wr(t.doc,e),Dt(t.doc,Et(n,Fr(e)))}}),i.readAsText(e)};for(var f=0;f<s;++f)a(i[f],f)}else{if(t.state.draggingText&&t.doc.sel.contains(n)>-1){t.state.draggingText(e),setTimeout(zo(tr,t),20);return}try{var o=e.dataTransfer.getData("Text");if(o){if(t.state.draggingText&&(v?!e.metaKey:!e.ctrlKey))var l=t.listSelections();Ht(t.doc,Et(n,n));if(l)for(var f=0;f<l.length;++f)Qr(t.doc,"",l[f].anchor,l[f].head,"drag");t.replaceSelection(o,"around","paste"),tr(t)}}catch(e){}}}function yr(e,t){if(r&&(!e.state.draggingText||+(new Date)-mr<100)){po(t);return}if(xo(e,t)||or(e.display,t))return;t.dataTransfer.setData("Text",e.getSelection());if(t.dataTransfer.setDragImage&&!f){var n=Qo("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",a&&(n.width=n.height=1,e.display.wrapper.appendChild(n),n._top=n.offsetTop),t.dataTransfer.setDragImage(n,0,0),a&&n.parentNode.removeChild(n)}}function br(t,n){if(Math.abs(t.doc.scrollTop-n)<2)return;t.doc.scrollTop=n,e||J(t,{top:n}),t.display.scroller.scrollTop!=n&&(t.display.scroller.scrollTop=n),t.display.scrollbarV.scrollTop!=n&&(t.display.scrollbarV.scrollTop=n),e&&J(t),Vt(t,100)}function wr(e,t,n){if(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)return;t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,R(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbarH.scrollLeft!=t&&(e.display.scrollbarH.scrollLeft=t)}function xr(t,n){var r=n.wheelDeltaX,i=n.wheelDeltaY;r==null&&n.detail&&n.axis==n.HORIZONTAL_AXIS&&(r=n.detail),i==null&&n.detail&&n.axis==n.VERTICAL_AXIS?i=n.detail:i==null&&(i=n.wheelDelta);var o=t.display,u=o.scroller;if(!(r&&u.scrollWidth>u.clientWidth||i&&u.scrollHeight>u.clientHeight))return;if(i&&v&&s)e:for(var f=n.target,l=o.view;f!=u;f=f.parentNode)for(var c=0;c<l.length;c++)if(l[c].node==f){t.display.currentWheelTarget=f;break e}if(r&&!e&&!a&&Sr!=null){i&&br(t,Math.max(0,Math.min(u.scrollTop+i*Sr,u.scrollHeight-u.clientHeight))),wr(t,Math.max(0,Math.min(u.scrollLeft+r*Sr,u.scrollWidth-u.clientWidth))),lo(n),o.wheelStartX=null;return}if(i&&Sr!=null){var h=i*Sr,p=t.doc.scrollTop,d=p+o.wrapper.clientHeight;h<0?p=Math.max(0,p+h-50):d=Math.min(t.doc.height,d+h+50),J(t,{top:p,bottom:d})}Er<20&&(o.wheelStartX==null?(o.wheelStartX=u.scrollLeft,o.wheelStartY=u.scrollTop,o.wheelDX=r,o.wheelDY=i,setTimeout(function(){if(o.wheelStartX==null)return;var e=u.scrollLeft-o.wheelStartX,t=u.scrollTop-o.wheelStartY,n=t&&o.wheelDY&&t/o.wheelDY||e&&o.wheelDX&&e/o.wheelDX;o.wheelStartX=o.wheelStartY=null;if(!n)return;Sr=(Sr*Er+n)/(Er+1),++Er},200)):(o.wheelDX+=r,o.wheelDY+=i))}function Tr(e,t,n){if(typeof t=="string"){t=Ei[t];if(!t)return!1}e.display.pollingFast&&Zn(e)&&(e.display.pollingFast=!1);var r=e.display.shift,i=!1;try{rr(e)&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),i=t(e)!=Lo}finally{e.display.shift=r,e.state.suppressEdits=!1}return i}function Nr(e){var t=e.state.keyMaps.slice(0);return e.options.extraKeys&&t.push(e.options.extraKeys),t.push(e.options.keyMap),t}function kr(e,t){var n=xi(e.options.keyMap),r=n.auto;clearTimeout(Cr),r&&!Ni(t)&&(Cr=setTimeout(function(){xi(e.options.keyMap)==n&&(e.options.keyMap=r.call?r.call(null,e):r,A(e))},50));var i=Ci(t,!0),s=!1;if(!i)return!1;var o=Nr(e);return t.shiftKey?s=Ti("Shift-"+i,o,function(t){return Tr(e,t,!0)})||Ti(i,o,function(t){if(typeof t=="string"?/^go[A-Z]/.test(t):t.motion)return Tr(e,t)}):s=Ti(i,o,function(t){return Tr(e,t)}),s&&(lo(t),Xt(e),Eo(e,"keyHandled",e,i,t)),s}function Lr(e,t,n){var r=Ti("'"+n+"'",Nr(e),function(t){return Tr(e,t,!0)});return r&&(lo(t),Xt(e),Eo(e,"keyHandled",e,"'"+n+"'",t)),r}function Or(e){var t=this;nr(t);if(xo(t,e))return;r&&i<11&&e.keyCode==27&&(e.returnValue=!1);var n=e.keyCode;t.display.shift=n==16||e.shiftKey;var s=kr(t,e);a&&(Ar=s?n:null,!s&&n==88&&!bu&&(v?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),n==18&&!/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)&&Mr(t)}function Mr(e){function n(e){if(e.keyCode==18||!e.altKey)ru(t,"CodeMirror-crosshair"),yo(document,"keyup",n),yo(document,"mouseover",n)}var t=e.display.lineDiv;iu(t,"CodeMirror-crosshair"),go(document,"keyup",n),go(document,"mouseover",n)}function _r(e){e.keyCode==16&&(this.doc.sel.shift=!1),xo(this,e)}function Dr(e){var t=this;if(xo(t,e)||e.ctrlKey&&!e.altKey||v&&e.metaKey)return;var n=e.keyCode,s=e.charCode;if(a&&n==Ar){Ar=null,lo(e);return}if((a&&(!e.which||e.which<10)||l)&&kr(t,e))return;var o=String.fromCharCode(s==null?n:s);if(Lr(t,e,o))return;r&&i>=9&&(t.display.inputHasSelection=null),Gn(t)}function Pr(e){if(e.options.readOnly=="nocursor")return;e.state.focused||(bo(e,"focus",e),e.state.focused=!0,iu(e.display.wrapper,"CodeMirror-focused"),!e.curOp&&e.display.selForContextMenu!=e.doc.sel&&(er(e),s&&setTimeout(zo(er,e,!0),0))),Qn(e),Xt(e)}function Hr(e){e.state.focused&&(bo(e,"blur",e),e.state.focused=!1,ru(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150)}function Br(e,t){function h(){if(n.input.selectionStart!=null){var t=e.somethingSelected(),r=n.input.value="​"+(t?n.input.value:"");n.prevInput=t?"":"​",n.input.selectionStart=1,n.input.selectionEnd=r.length,n.selForContextMenu=e.doc.sel}}function p(){n.inputDiv.style.position="relative",n.input.style.cssText=l,r&&i<9&&(n.scrollbarV.scrollTop=n.scroller.scrollTop=u),Qn(e);if(n.input.selectionStart!=null){(!r||r&&i<9)&&h();var t=0,s=function(){n.selForContextMenu==e.doc.sel&&n.input.selectionStart==0?Fn(e,Ei.selectAll)(e):t++<10?n.detectingSelectAll=setTimeout(s,500):er(e)};n.detectingSelectAll=setTimeout(s,200)}}if(xo(e,t,"contextmenu"))return;var n=e.display;if(or(n,t)||jr(e,t))return;var o=ur(e,t),u=n.scroller.scrollTop;if(!o||a)return;var f=e.options.resetSelectionOnContextMenu;f&&e.doc.sel.contains(o)==-1&&Fn(e,Pt)(e.doc,Et(o),Ao);var l=n.input.style.cssText;n.inputDiv.style.position="absolute",n.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(t.clientY-5)+"px; left: "+(t.clientX-5)+"px; z-index: 1000; background: "+(r?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";if(s)var c=window.scrollY;tr(e),s&&window.scrollTo(null,c),er(e),e.somethingSelected()||(n.input.value=n.prevInput=" "),n.selForContextMenu=e.doc.sel,clearTimeout(n.detectingSelectAll),r&&i>=9&&h();if(b){po(t);var d=function(){yo(window,"mouseup",d),setTimeout(p,20)};go(window,"mouseup",d)}else setTimeout(p,50)}function jr(e,t){return No(e,"gutterContextMenu")?dr(e,t,"gutterContextMenu",!1,bo):!1}function Ir(e,t){if(dt(e,t.from)<0)return e;if(dt(e,t.to)<=0)return Fr(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,r=e.ch;return e.line==t.to.line&&(r+=Fr(t).ch-t.to.ch),pt(n,r)}function qr(e,t){var n=[];for(var r=0;r<e.sel.ranges.length;r++){var i=e.sel.ranges[r];n.push(new bt(Ir(i.anchor,t),Ir(i.head,t)))}return wt(n,e.sel.primIndex)}function Rr(e,t,n){return e.line==t.line?pt(n.line,e.ch-t.ch+n.ch):pt(n.line+(e.line-t.line),e.ch)}function Ur(e,t,n){var r=[],i=pt(e.first,0),s=i;for(var o=0;o<t.length;o++){var u=t[o],a=Rr(u.from,i,s),f=Rr(Fr(u),i,s);i=u.to,s=f;if(n=="around"){var l=e.sel.ranges[o],c=dt(l.head,l.anchor)<0;r[o]=new bt(c?f:a,c?a:f)}else r[o]=new bt(a,a)}return new yt(r,e.sel.primIndex)}function zr(e,t,n){var r={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return n&&(r.update=function(t,n,r,i){t&&(this.from=xt(e,t)),n&&(this.to=xt(e,n)),r&&(this.text=r),i!==undefined&&(this.origin=i)}),bo(e,"beforeChange",e,r),e.cm&&bo(e.cm,"beforeChange",e.cm,r),r.canceled?null:{from:r.from,to:r.to,text:r.text,origin:r.origin}}function Wr(e,t,n){if(e.cm){if(!e.cm.curOp)return Fn(e.cm,Wr)(e,t,n);if(e.cm.state.suppressEdits)return}if(No(e,"beforeChange")||e.cm&&No(e.cm,"beforeChange")){t=zr(e,t,!0);if(!t)return}var r=w&&!n&&Xi(e,t.from,t.to);if(r)for(var i=r.length-1;i>=0;--i)Xr(e,{from:r[i].from,to:r[i].to,text:i?[""]:t.text});else Xr(e,t)}function Xr(e,t){if(t.text.length==1&&t.text[0]==""&&dt(t.from,t.to)==0)return;var n=qr(e,t);Zs(e,t,n,e.cm?e.cm.curOp.id:NaN),Jr(e,t,n,Ui(e,t));var r=[];Is(e,function(e,n){!n&&Io(r,e.history)==-1&&(fo(e.history,t),r.push(e.history)),Jr(e,t,null,Ui(e,t))})}function Vr(e,t,n){if(e.cm&&e.cm.state.suppressEdits)return;var r=e.history,i,s=e.sel,o=t=="undo"?r.done:r.undone,u=t=="undo"?r.undone:r.done;for(var a=0;a<o.length;a++){i=o[a];if(n?i.ranges&&!i.equals(e.sel):!i.ranges)break}if(a==o.length)return;r.lastOrigin=r.lastSelOrigin=null;for(;;){i=o.pop();if(!i.ranges)break;no(i,u);if(n&&!i.equals(e.sel)){Pt(e,i,{clearRedo:!1});return}s=i}var f=[];no(s,u),u.push({changes:f,generation:r.generation}),r.generation=i.generation||++r.maxGeneration;var l=No(e,"beforeChange")||e.cm&&No(e.cm,"beforeChange");for(var a=i.changes.length-1;a>=0;--a){var c=i.changes[a];c.origin=t;if(l&&!zr(e,c,!1)){o.length=0;return}f.push(Qs(e,c));var h=a?qr(e,c):jo(o);Jr(e,c,h,Wi(e,c)),!a&&e.cm&&e.cm.scrollIntoView({from:c.from,to:Fr(c)});var p=[];Is(e,function(e,t){!t&&Io(p,e.history)==-1&&(fo(e.history,c),p.push(e.history)),Jr(e,c,null,Wi(e,c))})}}function $r(e,t){if(t==0)return;e.first+=t,e.sel=new yt(qo(e.sel.ranges,function(e){return new bt(pt(e.anchor.line+t,e.anchor.ch),pt(e.head.line+t,e.head.ch))}),e.sel.primIndex);if(e.cm){zn(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,r=n.viewFrom;r<n.viewTo;r++)Wn(e.cm,r,"gutter")}}function Jr(e,t,n,r){if(e.cm&&!e.cm.curOp)return Fn(e.cm,Jr)(e,t,n,r);if(t.to.line<e.first){$r(e,t.text.length-1-(t.to.line-t.from.line));return}if(t.from.line>e.lastLine())return;if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);$r(e,i),t={from:pt(e.first,0),to:pt(t.to.line+i,t.to.ch),text:[jo(t.text)],origin:t.origin}}var s=e.lastLine();t.to.line>s&&(t={from:t.from,to:pt(s,Rs(e,s).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Us(e,t.from,t.to),n||(n=qr(e,t)),e.cm?Kr(e.cm,t,r):_s(e,t,r),Ht(e,n,Ao)}function Kr(e,t,n){var r=e.doc,i=e.display,s=t.from,o=t.to,u=!1,a=s.line;e.options.lineWrapping||(a=Xs(ts(Rs(r,s.line))),r.iter(a,o.line+1,function(e){if(e==i.maxLine)return u=!0,!0})),r.sel.contains(t.from,t.to)>-1&&To(e),_s(r,t,n,k(e)),e.options.lineWrapping||(r.iter(a,s.line+t.text.length,function(e){var t=P(e);t>i.maxLineLength&&(i.maxLine=e,i.maxLineLength=t,i.maxLineChanged=!0,u=!1)}),u&&(e.curOp.updateMaxLine=!0)),r.frontier=Math.min(r.frontier,s.line),Vt(e,400);var f=t.text.length-(o.line-s.line)-1;s.line==o.line&&t.text.length==1&&!Ms(e.doc,t)?Wn(e,s.line,"text"):zn(e,s.line,o.line+1,f);var l=No(e,"changes"),c=No(e,"change");if(c||l){var h={from:s,to:o,text:t.text,removed:t.removed,origin:t.origin};c&&Eo(e,"change",e,h),l&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(h)}e.display.selForContextMenu=null}function Qr(e,t,n,r,i){r||(r=n);if(dt(r,n)<0){var s=r;r=n,n=s}typeof t=="string"&&(t=gu(t)),Wr(e,{from:n,to:r,text:t,origin:i})}function Gr(e,t){var n=e.display,r=n.sizer.getBoundingClientRect(),i=null;t.top+r.top<0?i=!0:t.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1);if(i!=null&&!h){var s=Qo("div","​",null,"position: absolute; top: "+(t.top-n.viewOffset-Qt(e.display))+"px; height: "+(t.bottom-t.top+ko)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(s),s.scrollIntoView(i),e.display.lineSpace.removeChild(s)}}function Yr(e,t,n,r){r==null&&(r=0);for(;;){var i=!1,s=yn(e,t),o=!n||n==t?s:yn(e,n),u=ei(e,Math.min(s.left,o.left),Math.min(s.top,o.top)-r,Math.max(s.left,o.left),Math.max(s.bottom,o.bottom)+r),a=e.doc.scrollTop,f=e.doc.scrollLeft;u.scrollTop!=null&&(br(e,u.scrollTop),Math.abs(e.doc.scrollTop-a)>1&&(i=!0)),u.scrollLeft!=null&&(wr(e,u.scrollLeft),Math.abs(e.doc.scrollLeft-f)>1&&(i=!0));if(!i)return s}}function Zr(e,t,n,r,i){var s=ei(e,t,n,r,i);s.scrollTop!=null&&br(e,s.scrollTop),s.scrollLeft!=null&&wr(e,s.scrollLeft)}function ei(e,t,n,r,i){var s=e.display,o=Tn(e.display);n<0&&(n=0);var u=e.curOp&&e.curOp.scrollTop!=null?e.curOp.scrollTop:s.scroller.scrollTop,a=s.scroller.clientHeight-ko,f={};i-n>a&&(i=n+a);var l=e.doc.height+Gt(s),c=n<o,h=i>l-o;if(n<u)f.scrollTop=c?0:n;else if(i>u+a){var p=Math.min(n,(h?l:i)-a);p!=u&&(f.scrollTop=p)}var d=e.curOp&&e.curOp.scrollLeft!=null?e.curOp.scrollLeft:s.scroller.scrollLeft,v=s.scroller.clientWidth-ko,m=r-t>v;return m&&(r=n+a),t<s.gutters.offsetWidth+10?f.scrollLeft=0:t<d?f.scrollLeft=Math.max(0,t-(m?0:10)):r>v+d-3&&(f.scrollLeft=r+(m?0:10)-v),f}function ti(e,t,n){(t!=null||n!=null)&&ri(e),t!=null&&(e.curOp.scrollLeft=(e.curOp.scrollLeft==null?e.doc.scrollLeft:e.curOp.scrollLeft)+t),n!=null&&(e.curOp.scrollTop=(e.curOp.scrollTop==null?e.doc.scrollTop:e.curOp.scrollTop)+n)}function ni(e){ri(e);var t=e.getCursor(),n=t,r=t;e.options.lineWrapping||(n=t.ch?pt(t.line,t.ch-1):t,r=pt(t.line,t.ch+1)),e.curOp.scrollToPos={from:n,to:r,margin:e.options.cursorScrollMargin,isCursor:!0}}function ri(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var n=bn(e,t.from),r=bn(e,t.to),i=ei(e,Math.min(n.left,r.left),Math.min(n.top,r.top)-t.margin,Math.max(n.right,r.right),Math.max(n.bottom,r.bottom)+t.margin);e.scrollTo(i.scrollLeft,i.scrollTop)}}function ii(e,t,n,r){var i=e.doc,s;n==null&&(n="add"),n=="smart"&&(i.mode.indent?s=Kt(e,t):n="prev");var o=e.options.tabSize,u=Rs(i,t),a=Do(u.text,null,o);u.stateAfter&&(u.stateAfter=null);var f=u.text.match(/^\s*/)[0],l;if(!r&&!/\S/.test(u.text))l=0,n="not";else if(n=="smart"){l=i.mode.indent(s,u.text.slice(f.length),u.text);if(l==Lo||l>150){if(!r)return;n="prev"}}n=="prev"?t>i.first?l=Do(Rs(i,t-1).text,null,o):l=0:n=="add"?l=a+e.options.indentUnit:n=="subtract"?l=a-e.options.indentUnit:typeof n=="number"&&(l=a+n),l=Math.max(0,l);var c="",h=0;if(e.options.indentWithTabs)for(var p=Math.floor(l/o);p;--p)h+=o,c+="	";h<l&&(c+=Bo(l-h));if(c!=f)Qr(i,c,pt(t,0),pt(t,f.length),"+input");else for(var p=0;p<i.sel.ranges.length;p++){var d=i.sel.ranges[p];if(d.head.line==t&&d.head.ch<f.length){var h=pt(t,f.length);Ot(i,p,new bt(h,h));break}}u.stateAfter=null}function si(e,t,n,r){var i=t,s=t;return typeof t=="number"?s=Rs(e,St(e,t)):i=Xs(t),i==null?null:(r(s,i)&&e.cm&&Wn(e.cm,i,n),s)}function oi(e,t){var n=e.doc.sel.ranges,r=[];for(var i=0;i<n.length;i++){var s=t(n[i]);while(r.length&&dt(s.from,jo(r).to)<=0){var o=r.pop();if(dt(o.from,s.from)<0){s.from=o.from;break}}r.push(s)}jn(e,function(){for(var t=r.length-1;t>=0;t--)Qr(e.doc,"",r[t].from,r[t].to,"+delete");ni(e)})}function ui(e,t,n,r,i){function l(){var t=s+n;return t<e.first||t>=e.first+e.size?f=!1:(s=t,a=Rs(e,t))}function c(e){var t=(i?Hu:Bu)(a,o,n,!0);if(t==null){if(!!e||!l())return f=!1;i?o=(n<0?ku:Cu)(a):o=n<0?a.text.length:0}else o=t;return!0}var s=t.line,o=t.ch,u=n,a=Rs(e,s),f=!0;if(r=="char")c();else if(r=="column")c(!0);else if(r=="word"||r=="group"){var h=null,p=r=="group",d=e.cm&&e.cm.getHelper(t,"wordChars");for(var v=!0;;v=!1){if(n<0&&!c(!v))break;var m=a.text.charAt(o)||"\n",g=Vo(m,d)?"w":p&&m=="\n"?"n":!p||/\s/.test(m)?null:"p";p&&!v&&!g&&(g="s");if(h&&h!=g){n<0&&(n=1,c());break}g&&(h=g);if(n>0&&!c(!v))break}}var y=It(e,pt(s,o),u,!0);return f||(y.hitSide=!0),y}function ai(e,t,n,r){var i=e.doc,s=t.left,o;if(r=="page"){var u=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);o=t.top+n*(u-(n<0?1.5:.5)*Tn(e.display))}else r=="line"&&(o=n>0?t.bottom+3:t.top-3);for(;;){var a=En(e,s,o);if(!a.outside)break;if(n<0?o<=0:o>=i.height){a.hitSide=!0;break}o+=n*5}return a}function fi(e,t){var n=e.doc,r=Rs(n,t.line).text,i=t.ch,s=t.ch;if(r){var o=e.getHelper(t,"wordChars");(t.xRel<0||s==r.length)&&i?--i:++s;var u=r.charAt(i),a=Vo(u,o)?function(e){return Vo(e,o)}:/\s/.test(u)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!Vo(e)};while(i>0&&a(r.charAt(i-1)))--i;while(s<r.length&&a(r.charAt(s)))++s}return new bt(pt(t.line,i),pt(t.line,s))}function hi(e,t,n,r){S.defaults[e]=t,n&&(ci[e]=r?function(e,t,r){r!=pi&&n(e,t,r)}:n)}function xi(e){return typeof e=="string"?Si[e]:e}function Oi(e,t,n,r,i){if(r&&r.shared)return _i(e,t,n,r,i);if(e.cm&&!e.cm.curOp)return Fn(e.cm,Oi)(e,t,n,r,i);var s=new Li(e,i),o=dt(t,n);r&&Uo(r,s,!1);if(o>0||o==0&&s.clearWhenEmpty!==!1)return s;s.replacedWith&&(s.collapsed=!0,s.widgetNode=Qo("span",[s.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||(s.widgetNode.ignoreEvents=!0),r.insertLeft&&(s.widgetNode.insertLeft=!0));if(s.collapsed){if(es(e,t.line,t,n,s)||t.line!=n.line&&es(e,n.line,t,n,s))throw new Error("Inserting collapsed marker partially overlapping an existing one");E=!0}s.addToHistory&&Zs(e,{from:t,to:n,origin:"markText"},e.sel,NaN);var u=t.line,a=e.cm,f;e.iter(u,n.line+1,function(e){a&&s.collapsed&&!a.options.lineWrapping&&ts(e)==a.display.maxLine&&(f=!0),s.collapsed&&u!=t.line&&Ws(e,0),Ii(e,new Bi(s,u==t.line?t.ch:null,u==n.line?n.ch:null)),++u}),s.collapsed&&e.iter(t.line,n.line+1,function(t){ss(e,t)&&Ws(t,0)}),s.clearOnEnter&&go(s,"beforeCursorEnter",function(){s.clear()}),s.readOnly&&(w=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),s.collapsed&&(s.id=++Ai,s.atomic=!0);if(a){f&&(a.curOp.updateMaxLine=!0);if(s.collapsed)zn(a,t.line,n.line+1);else if(s.className||s.title||s.startStyle||s.endStyle)for(var l=t.line;l<=n.line;l++)Wn(a,l,"text");s.atomic&&jt(a.doc),Eo(a,"markerAdded",a,s)}return s}function _i(e,t,n,r,i){r=Uo(r),r.shared=!1;var s=[Oi(e,t,n,r,i)],o=s[0],u=r.widgetNode;return Is(e,function(e){u&&(r.widgetNode=u.cloneNode(!0)),s.push(Oi(e,xt(e,t),xt(e,n),r,i));for(var a=0;a<e.linked.length;++a)if(e.linked[a].isParent)return;o=jo(s)}),new Mi(s,o)}function Di(e){return e.findMarks(pt(e.first,0),e.clipPos(pt(e.lastLine())),function(e){return e.parent})}function Pi(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=r.find(),s=e.clipPos(i.from),o=e.clipPos(i.to);if(dt(s,o)){var u=Oi(e,s,o,r.primary,r.primary.type);r.markers.push(u),u.parent=r}}}function Hi(e){for(var t=0;t<e.length;t++){var n=e[t],r=[n.primary.doc];Is(n.primary.doc,function(e){r.push(e)});for(var i=0;i<n.markers.length;i++){var s=n.markers[i];Io(r,s.doc)==-1&&(s.parent=null,n.markers.splice(i--,1))}}}function Bi(e,t,n){this.marker=e,this.from=t,this.to=n}function ji(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n];if(r.marker==t)return r}}function Fi(e,t){for(var n,r=0;r<e.length;++r)e[r]!=t&&(n||(n=[])).push(e[r]);return n}function Ii(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function qi(e,t,n){if(e)for(var r=0,i;r<e.length;++r){var s=e[r],o=s.marker,u=s.from==null||(o.inclusiveLeft?s.from<=t:s.from<t);if(u||s.from==t&&o.type=="bookmark"&&(!n||!s.marker.insertLeft)){var a=s.to==null||(o.inclusiveRight?s.to>=t:s.to>t);(i||(i=[])).push(new Bi(o,s.from,a?null:s.to))}}return i}function Ri(e,t,n){if(e)for(var r=0,i;r<e.length;++r){var s=e[r],o=s.marker,u=s.to==null||(o.inclusiveRight?s.to>=t:s.to>t);if(u||s.from==t&&o.type=="bookmark"&&(!n||s.marker.insertLeft)){var a=s.from==null||(o.inclusiveLeft?s.from<=t:s.from<t);(i||(i=[])).push(new Bi(o,a?null:s.from-t,s.to==null?null:s.to-t))}}return i}function Ui(e,t){var n=Nt(e,t.from.line)&&Rs(e,t.from.line).markedSpans,r=Nt(e,t.to.line)&&Rs(e,t.to.line).markedSpans;if(!n&&!r)return null;var i=t.from.ch,s=t.to.ch,o=dt(t.from,t.to)==0,u=qi(n,i,o),a=Ri(r,s,o),f=t.text.length==1,l=jo(t.text).length+(f?i:0);if(u)for(var c=0;c<u.length;++c){var h=u[c];if(h.to==null){var p=ji(a,h.marker);p?f&&(h.to=p.to==null?null:p.to+l):h.to=i}}if(a)for(var c=0;c<a.length;++c){var h=a[c];h.to!=null&&(h.to+=l);if(h.from==null){var p=ji(u,h.marker);p||(h.from=l,f&&(u||(u=[])).push(h))}else h.from+=l,f&&(u||(u=[])).push(h)}u&&(u=zi(u)),a&&a!=u&&(a=zi(a));var d=[u];if(!f){var v=t.text.length-2,m;if(v>0&&u)for(var c=0;c<u.length;++c)u[c].to==null&&(m||(m=[])).push(new Bi(u[c].marker,null,null));for(var c=0;c<v;++c)d.push(m);d.push(a)}return d}function zi(e){for(var t=0;t<e.length;++t){var n=e[t];n.from!=null&&n.from==n.to&&n.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function Wi(e,t){var n=so(e,t),r=Ui(e,t);if(!n)return r;if(!r)return n;for(var i=0;i<n.length;++i){var s=n[i],o=r[i];if(s&&o)e:for(var u=0;u<o.length;++u){var a=o[u];for(var f=0;f<s.length;++f)if(s[f].marker==a.marker)continue e;s.push(a)}else o&&(n[i]=o)}return n}function Xi(e,t,n){var r=null;e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;n.readOnly&&(!r||Io(r,n)==-1)&&(r||(r=[])).push(n)}});if(!r)return null;var i=[{from:t,to:n}];for(var s=0;s<r.length;++s){var o=r[s],u=o.find(0);for(var a=0;a<i.length;++a){var f=i[a];if(dt(f.to,u.from)<0||dt(f.from,u.to)>0)continue;var l=[a,1],c=dt(f.from,u.from),h=dt(f.to,u.to);(c<0||!o.inclusiveLeft&&!c)&&l.push({from:f.from,to:u.from}),(h>0||!o.inclusiveRight&&!h)&&l.push({from:u.to,to:f.to}),i.splice.apply(i,l),a+=l.length-1}}return i}function Vi(e){var t=e.markedSpans;if(!t)return;for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}function $i(e,t){if(!t)return;for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}function Ji(e){return e.inclusiveLeft?-1:0}function Ki(e){return e.inclusiveRight?1:0}function Qi(e,t){var n=e.lines.length-t.lines.length;if(n!=0)return n;var r=e.find(),i=t.find(),s=dt(r.from,i.from)||Ji(e)-Ji(t);if(s)return-s;var o=dt(r.to,i.to)||Ki(e)-Ki(t);return o?o:t.id-e.id}function Gi(e,t){var n=E&&e.markedSpans,r;if(n)for(var i,s=0;s<n.length;++s)i=n[s],i.marker.collapsed&&(t?i.from:i.to)==null&&(!r||Qi(r,i.marker)<0)&&(r=i.marker);return r}function Yi(e){return Gi(e,!0)}function Zi(e){return Gi(e,!1)}function es(e,t,n,r,i){var s=Rs(e,t),o=E&&s.markedSpans;if(o)for(var u=0;u<o.length;++u){var a=o[u];if(!a.marker.collapsed)continue;var f=a.marker.find(0),l=dt(f.from,n)||Ji(a.marker)-Ji(i),c=dt(f.to,r)||Ki(a.marker)-Ki(i);if(l>=0&&c<=0||l<=0&&c>=0)continue;if(l<=0&&(dt(f.to,n)>0||a.marker.inclusiveRight&&i.inclusiveLeft)||l>=0&&(dt(f.from,r)<0||a.marker.inclusiveLeft&&i.inclusiveRight))return!0}}function ts(e){var t;while(t=Yi(e))e=t.find(-1,!0).line;return e}function ns(e){var t,n;while(t=Zi(e))e=t.find(1,!0).line,(n||(n=[])).push(e);return n}function rs(e,t){var n=Rs(e,t),r=ts(n);return n==r?t:Xs(r)}function is(e,t){if(t>e.lastLine())return t;var n=Rs(e,t),r;if(!ss(e,n))return t;while(r=Zi(n))n=r.find(1,!0).line;return Xs(n)+1}function ss(e,t){var n=E&&t.markedSpans;if(n)for(var r,i=0;i<n.length;++i){r=n[i];if(!r.marker.collapsed)continue;if(r.from==null)return!0;if(r.marker.widgetNode)continue;if(r.from==0&&r.marker.inclusiveLeft&&os(e,t,r))return!0}}function os(e,t,n){if(n.to==null){var r=n.marker.find(1,!0);return os(e,r.line,ji(r.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var i,s=0;s<t.markedSpans.length;++s){i=t.markedSpans[s];if(i.marker.collapsed&&!i.marker.widgetNode&&i.from==n.to&&(i.to==null||i.to!=n.from)&&(i.marker.inclusiveLeft||n.marker.inclusiveRight)&&os(e,t,i))return!0}}function as(e,t,n){$s(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&ti(e,null,n)}function fs(e){if(e.height!=null)return e.height;if(!eu(document.body,e.node)){var t="position: relative;";e.coverGutter&&(t+="margin-left: -"+e.cm.getGutterElement().offsetWidth+"px;"),Zo(e.cm.display.measure,Qo("div",[e.node],null,t))}return e.height=e.node.offsetHeight}function ls(e,t,n,r){var i=new us(e,n,r);return i.noHScroll&&(e.display.alignWidgets=!0),si(e.doc,t,"widget",function(t){var n=t.widgets||(t.widgets=[]);i.insertAt==null?n.push(i):n.splice(Math.min(n.length-1,Math.max(0,i.insertAt)),0,i),i.line=t;if(!ss(e.doc,t)){var r=$s(t)<e.doc.scrollTop;Ws(t,t.height+fs(i)),r&&ti(e,null,i.height),e.curOp.forceUpdate=!0}return!0}),i}function hs(e,t,n,r){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),e.order!=null&&(e.order=null),Vi(e),$i(e,n);var i=r?r(e):1;i!=e.height&&Ws(e,i)}function ps(e){e.parent=null,Vi(e)}function ds(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var r=n[1]?"bgClass":"textClass";t[r]==null?t[r]=n[2]:(new RegExp("(?:^|s)"+n[2]+"(?:$|s)")).test(t[r])||(t[r]+=" "+n[2])}return e}function vs(e,t){if(e.blankLine)return e.blankLine(t);if(!e.innerMode)return;var n=S.innerMode(e,t);if(n.mode.blankLine)return n.mode.blankLine(n.state)}function ms(e,t,n){for(var r=0;r<10;r++){var i=e.token(t,n);if(t.pos>t.start)return i}throw new Error("Mode "+e.name+" failed to advance stream.")}function gs(e,t,n,r,i,s,o){var u=n.flattenSpans;u==null&&(u=e.options.flattenSpans);var a=0,f=null,l=new ki(t,e.options.tabSize),c;t==""&&ds(vs(n,r),s);while(!l.eol()){l.pos>e.options.maxHighlightLength?(u=!1,o&&ws(e,t,r,l.pos),l.pos=t.length,c=null):c=ds(ms(n,l,r),s);if(e.options.addModeClass){var h=S.innerMode(n,r).mode.name;h&&(c="m-"+(c?h+" "+c:h))}if(!u||f!=c)a<l.start&&i(l.start,f),a=l.start,f=c;l.start=l.pos}while(a<l.pos){var p=Math.min(l.pos,a+5e4);i(p,f),a=p}}function ys(e,t,n,r){var i=[e.state.modeGen],s={};gs(e,t.text,e.doc.mode,n,function(e,t){i.push(e,t)},s,r);for(var o=0;o<e.state.overlays.length;++o){var u=e.state.overlays[o],a=1,f=0;gs(e,t.text,u.mode,!0,function(e,t){var n=a;while(f<e){var r=i[a];r>e&&i.splice(a,1,e,i[a+1],r),a+=2,f=Math.min(e,r)}if(!t)return;if(u.opaque)i.splice(n,a-n,e,"cm-overlay "+t),a=n+2;else for(;n<a;n+=2){var s=i[n+1];i[n+1]=(s?s+" ":"")+"cm-overlay "+t}},s)}return{styles:i,classes:s.bgClass||s.textClass?s:null}}function bs(e,t){if(!t.styles||t.styles[0]!=e.state.modeGen){var n=ys(e,t,t.stateAfter=Kt(e,Xs(t)));t.styles=n.styles,n.classes?t.styleClasses=n.classes:t.styleClasses&&(t.styleClasses=null)}return t.styles}function ws(e,t,n,r){var i=e.doc.mode,s=new ki(t,e.options.tabSize);s.start=s.pos=r||0,t==""&&vs(i,n);while(!s.eol()&&s.pos<=e.options.maxHighlightLength)ms(i,s,n),s.start=s.pos}function xs(e,t){if(!e||/^\s*$/.test(e))return null;var n=t.addModeClass?Ss:Es;return n[e]||(n[e]=e.replace(/\S+/g,"cm-$&"))}function Ts(e,t){var n=Qo("span",null,null,s?"padding-right: .1px":null),i={pre:Qo("pre",[n]),content:n,col:0,pos:0,cm:e};t.measure={};for(var o=0;o<=(t.rest?t.rest.length:0);o++){var u=o?t.rest[o-1]:t.line,a;i.pos=0,i.addToken=Cs,(r||s)&&e.getOption("lineWrapping")&&(i.addToken=ks(i.addToken)),mu(e.display.measure)&&(a=Js(u))&&(i.addToken=Ls(i.addToken,a)),i.map=[],Os(u,i,bs(e,u)),u.styleClasses&&(u.styleClasses.bgClass&&(i.bgClass=su(u.styleClasses.bgClass,i.bgClass||"")),u.styleClasses.textClass&&(i.textClass=su(u.styleClasses.textClass,i.textClass||""))),i.map.length==0&&i.map.push(0,0,i.content.appendChild(du(e.display.measure))),o==0?(t.measure.map=i.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(i.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return bo(e,"renderLine",e,t.line,i.pre),i.pre.className&&(i.textClass=su(i.pre.className,i.textClass||"")),i}function Ns(e){var t=Qo("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t}function Cs(e,t,n,s,o,u){if(!t)return;var a=e.cm.options.specialChars,f=!1;if(!a.test(t)){e.col+=t.length;var l=document.createTextNode(t);e.map.push(e.pos,e.pos+t.length,l),r&&i<9&&(f=!0),e.pos+=t.length}else{var l=document.createDocumentFragment(),c=0;for(;;){a.lastIndex=c;var h=a.exec(t),p=h?h.index-c:t.length-c;if(p){var d=document.createTextNode(t.slice(c,c+p));r&&i<9?l.appendChild(Qo("span",[d])):l.appendChild(d),e.map.push(e.pos,e.pos+p,d),e.col+=p,e.pos+=p}if(!h)break;c+=p+1;if(h[0]=="	"){var v=e.cm.options.tabSize,m=v-e.col%v,d=l.appendChild(Qo("span",Bo(m),"cm-tab"));e.col+=m}else{var d=e.cm.options.specialCharPlaceholder(h[0]);r&&i<9?l.appendChild(Qo("span",[d])):l.appendChild(d),e.col+=1}e.map.push(e.pos,e.pos+1,d),e.pos++}}if(n||s||o||f){var g=n||"";s&&(g+=s),o&&(g+=o);var y=Qo("span",[l],g);return u&&(y.title=u),e.content.appendChild(y)}e.content.appendChild(l)}function ks(e){function t(e){var t=" ";for(var n=0;n<e.length-2;++n)t+=n%2?" ":" ";return t+=" ",t}return function(n,r,i,s,o,u){e(n,r.replace(/ {3,}/g,t),i,s,o,u)}}function Ls(e,t){return function(n,r,i,s,o,u){i=i?i+" cm-force-border":"cm-force-border";var a=n.pos,f=a+r.length;for(;;){for(var l=0;l<t.length;l++){var c=t[l];if(c.to>a&&c.from<=a)break}if(c.to>=f)return e(n,r,i,s,o,u);e(n,r.slice(0,c.to-a),i,s,null,u),s=null,r=r.slice(c.to-a),a=c.to}}}function As(e,t,n,r){var i=!r&&n.widgetNode;i&&(e.map.push(e.pos,e.pos+t,i),e.content.appendChild(i)),e.pos+=t}function Os(e,t,n){var r=e.markedSpans,i=e.text,s=0;if(!r){for(var o=1;o<n.length;o+=2)t.addToken(t,i.slice(s,s=n[o]),xs(n[o+1],t.cm.options));return}var u=i.length,a=0,o=1,f="",l,c=0,h,p,d,v,m;for(;;){if(c==a){h=p=d=v="",m=null,c=Infinity;var g=[];for(var y=0;y<r.length;++y){var b=r[y],w=b.marker;b.from<=a&&(b.to==null||b.to>a)?(b.to!=null&&c>b.to&&(c=b.to,p=""),w.className&&(h+=" "+w.className),w.startStyle&&b.from==a&&(d+=" "+w.startStyle),w.endStyle&&b.to==c&&(p+=" "+w.endStyle),w.title&&!v&&(v=w.title),w.collapsed&&(!m||Qi(m.marker,w)<0)&&(m=b)):b.from>a&&c>b.from&&(c=b.from),w.type=="bookmark"&&b.from==a&&w.widgetNode&&g.push(w)}if(m&&(m.from||0)==a){As(t,(m.to==null?u+1:m.to)-a,m.marker,m.from==null);if(m.to==null)return}if(!m&&g.length)for(var y=0;y<g.length;++y)As(t,0,g[y])}if(a>=u)break;var E=Math.min(u,c);for(;;){if(f){var S=a+f.length;if(!m){var x=S>E?f.slice(0,E-a):f;t.addToken(t,x,l?l+h:h,d,a+x.length==c?p:"",v)}if(S>=E){f=f.slice(E-a),a=E;break}a=S,d=""}f=i.slice(s,s=n[o++]),l=xs(n[o++],t.cm.options)}}}function Ms(e,t){return t.from.ch==0&&t.to.ch==0&&jo(t.text)==""&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function _s(e,t,n,r){function i(e){return n?n[e]:null}function s(e,n,i){hs(e,n,i,r),Eo(e,"change",e,t)}var o=t.from,u=t.to,a=t.text,f=Rs(e,o.line),l=Rs(e,u.line),c=jo(a),h=i(a.length-1),p=u.line-o.line;if(Ms(e,t)){for(var d=0,v=[];d<a.length-1;++d)v.push(new cs(a[d],i(d),r));s(l,l.text,h),p&&e.remove(o.line,p),v.length&&e.insert(o.line,v)}else if(f==l)if(a.length==1)s(f,f.text.slice(0,o.ch)+c+f.text.slice(u.ch),h);else{for(var v=[],d=1;d<a.length-1;++d)v.push(new cs(a[d],i(d),r));v.push(new cs(c+f.text.slice(u.ch),h,r)),s(f,f.text.slice(0,o.ch)+a[0],i(0)),e.insert(o.line+1,v)}else if(a.length==1)s(f,f.text.slice(0,o.ch)+a[0]+l.text.slice(u.ch),i(0)),e.remove(o.line+1,p);else{s(f,f.text.slice(0,o.ch)+a[0],i(0)),s(l,c+l.text.slice(u.ch),h);for(var d=1,v=[];d<a.length-1;++d)v.push(new cs(a[d],i(d),r));p>1&&e.remove(o.line+1,p-1),e.insert(o.line+1,v)}Eo(e,"change",e,t)}function Ds(e){this.lines=e,this.parent=null;for(var t=0,n=0;t<e.length;++t)e[t].parent=this,n+=e[t].height;this.height=n}function Ps(e){this.children=e;var t=0,n=0;for(var r=0;r<e.length;++r){var i=e[r];t+=i.chunkSize(),n+=i.height,i.parent=this}this.size=t,this.height=n,this.parent=null}function Is(e,t,n){function r(e,i,s){if(e.linked)for(var o=0;o<e.linked.length;++o){var u=e.linked[o];if(u.doc==i)continue;var a=s&&u.sharedHist;if(n&&!a)continue;t(u.doc,a),r(u.doc,e,a)}}r(e,null,!0)}function qs(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,L(e),T(e),e.options.lineWrapping||H(e),e.options.mode=t.modeOption,zn(e)}function Rs(e,t){t-=e.first;if(t<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var r=0;;++r){var i=n.children[r],s=i.chunkSize();if(t<s){n=i;break}t-=s}return n.lines[t]}function Us(e,t,n){var r=[],i=t.line;return e.iter(t.line,n.line+1,function(e){var s=e.text;i==n.line&&(s=s.slice(0,n.ch)),i==t.line&&(s=s.slice(t.ch)),r.push(s),++i}),r}function zs(e,t,n){var r=[];return e.iter(t,n,function(e){r.push(e.text)}),r}function Ws(e,t){var n=t-e.height;if(n)for(var r=e;r;r=r.parent)r.height+=n}function Xs(e){if(e.parent==null)return null;var t=e.parent,n=Io(t.lines,e);for(var r=t.parent;r;t=r,r=r.parent)for(var i=0;;++i){if(r.children[i]==t)break;n+=r.children[i].chunkSize()}return n+t.first}function Vs(e,t){var n=e.first;e:do{for(var r=0;r<e.children.length;++r){var i=e.children[r],s=i.height;if(t<s){e=i;continue e}t-=s,n+=i.chunkSize()}return n}while(!e.lines);for(var r=0;r<e.lines.length;++r){var o=e.lines[r],u=o.height;if(t<u)break;t-=u}return n+r}function $s(e){e=ts(e);var t=0,n=e.parent;for(var r=0;r<n.lines.length;++r){var i=n.lines[r];if(i==e)break;t+=i.height}for(var s=n.parent;s;n=s,s=n.parent)for(var r=0;r<s.children.length;++r){var o=s.children[r];if(o==n)break;t+=o.height}return t}function Js(e){var t=e.order;return t==null&&(t=e.order=ju(e.text)),t}function Ks(e){this.done=[],this.undone=[],this.undoDepth=Infinity,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function Qs(e,t){var n={from:vt(t.from),to:Fr(t),text:Us(e,t.from,t.to)};return ro(e,n,t.from.line,t.to.line+1),Is(e,function(e){ro(e,n,t.from.line,t.to.line+1)},!0),n}function Gs(e){while(e.length){var t=jo(e);if(!t.ranges)break;e.pop()}}function Ys(e,t){if(t)return Gs(e.done),jo(e.done);if(e.done.length&&!jo(e.done).ranges)return jo(e.done);if(e.done.length>1&&!e.done[e.done.length-2].ranges)return e.done.pop(),jo(e.done)}function Zs(e,t,n,r){var i=e.history;i.undone.length=0;var s=+(new Date),o;if((i.lastOp==r||i.lastOrigin==t.origin&&t.origin&&(t.origin.charAt(0)=="+"&&e.cm&&i.lastModTime>s-e.cm.options.historyEventDelay||t.origin.charAt(0)=="*"))&&(o=Ys(i,i.lastOp==r))){var u=jo(o.changes);dt(t.from,t.to)==0&&dt(t.from,u.to)==0?u.to=Fr(t):o.changes.push(Qs(e,t))}else{var a=jo(i.done);(!a||!a.ranges)&&no(e.sel,i.done),o={changes:[Qs(e,t)],generation:i.generation},i.done.push(o);while(i.done.length>i.undoDepth)i.done.shift(),i.done[0].ranges||i.done.shift()}i.done.push(n),i.generation=++i.maxGeneration,i.lastModTime=i.lastSelTime=s,i.lastOp=i.lastSelOp=r,i.lastOrigin=i.lastSelOrigin=t.origin,u||bo(e,"historyAdded")}function eo(e,t,n,r){var i=t.charAt(0);return i=="*"||i=="+"&&n.ranges.length==r.ranges.length&&n.somethingSelected()==r.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function to(e,t,n,r){var i=e.history,s=r&&r.origin;n==i.lastSelOp||s&&i.lastSelOrigin==s&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==s||eo(e,s,jo(i.done),t))?i.done[i.done.length-1]=t:no(t,i.done),i.lastSelTime=+(new Date),i.lastSelOrigin=s,i.lastSelOp=n,r&&r.clearRedo!==!1&&Gs(i.undone)}function no(e,t){var n=jo(t);n&&n.ranges&&n.equals(e)||t.push(e)}function ro(e,t,n,r){var i=t["spans_"+e.id],s=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,r),function(n){n.markedSpans&&((i||(i=t["spans_"+e.id]={}))[s]=n.markedSpans),++s})}function io(e){if(!e)return null;for(var t=0,n;t<e.length;++t)e[t].marker.explicitlyCleared?n||(n=e.slice(0,t)):n&&n.push(e[t]);return n?n.length?n:null:e}function so(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var r=0,i=[];r<t.text.length;++r)i.push(io(n[r]));return i}function oo(e,t,n){for(var r=0,i=[];r<e.length;++r){var s=e[r];if(s.ranges){i.push(n?yt.prototype.deepCopy.call(s):s);continue}var o=s.changes,u=[];i.push({changes:u});for(var a=0;a<o.length;++a){var f=o[a],l;u.push({from:f.from,to:f.to,text:f.text});if(t)for(var c in f)(l=c.match(/^spans_(\d+)$/))&&Io(t,Number(l[1]))>-1&&(jo(u)[c]=f[c],delete f[c])}}return i}function uo(e,t,n,r){n<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function ao(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i],o=!0;if(s.ranges){s.copied||(s=e[i]=s.deepCopy(),s.copied=!0);for(var u=0;u<s.ranges.length;u++)uo(s.ranges[u].anchor,t,n,r),uo(s.ranges[u].head,t,n,r);continue}for(var u=0;u<s.changes.length;++u){var a=s.changes[u];if(n<a.from.line)a.from=pt(a.from.line+r,a.from.ch),a.to=pt(a.to.line+r,a.to.ch);else if(t<=a.to.line){o=!1;break}}o||(e.splice(0,i+1),i=0)}}function fo(e,t){var n=t.from.line,r=t.to.line,i=t.text.length-(r-n)-1;ao(e.done,n,r,i),ao(e.undone,n,r,i)}function ho(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==0}function vo(e){return e.target||e.srcElement}function mo(e){var t=e.which;return t==null&&(e.button&1?t=1:e.button&2?t=3:e.button&4&&(t=2)),v&&e.ctrlKey&&t==1&&(t=3),t}function Eo(e,t){function s(e){return function(){e.apply(null,r)}}var n=e._handlers&&e._handlers[t];if(!n)return;var r=Array.prototype.slice.call(arguments,2),i;Cn?i=Cn.delayedCallbacks:wo?i=wo:(i=wo=[],setTimeout(So,0));for(var o=0;o<n.length;++o)i.push(s(n[o]))}function So(){var e=wo;wo=null;for(var t=0;t<e.length;++t)e[t]()}function xo(e,t,n){return bo(e,n||t.type,e,t),ho(t)||t.codemirrorIgnore}function To(e){var t=e._handlers&&e._handlers.cursorActivity;if(!t)return;var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]);for(var r=0;r<t.length;++r)Io(n,t[r])==-1&&n.push(t[r])}function No(e,t){var n=e._handlers&&e._handlers[t];return n&&n.length>0}function Co(e){e.prototype.on=function(e,t){go(this,e,t)},e.prototype.off=function(e,t){yo(this,e,t)}}function _o(){this.id=null}function Po(e,t,n){for(var r=0,i=0;;){var s=e.indexOf("	",r);s==-1&&(s=e.length);var o=s-r;if(s==e.length||i+o>=t)return r+Math.min(o,t-i);i+=s-r,i+=n-i%n,r=s+1;if(i>=t)return r}}function Bo(e){while(Ho.length<=e)Ho.push(jo(Ho)+" ");return Ho[e]}function jo(e){return e[e.length-1]}function Io(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}function qo(e,t){var n=[];for(var r=0;r<e.length;r++)n[r]=t(e[r],r);return n}function Ro(e,t){var n;if(Object.create)n=Object.create(e);else{var r=function(){};r.prototype=e,n=new r}return t&&Uo(t,n),n}function Uo(e,t,n){t||(t={});for(var r in e)e.hasOwnProperty(r)&&(n!==!1||!t.hasOwnProperty(r))&&(t[r]=e[r]);return t}function zo(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function Vo(e,t){return t?t.source.indexOf("\\w")>-1&&Xo(e)?!0:t.test(e):Xo(e)}function $o(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function Ko(e){return e.charCodeAt(0)>=768&&Jo.test(e)}function Qo(e,t,n,r){var i=document.createElement(e);n&&(i.className=n),r&&(i.style.cssText=r);if(typeof t=="string")i.appendChild(document.createTextNode(t));else if(t)for(var s=0;s<t.length;++s)i.appendChild(t[s]);return i}function Yo(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function Zo(e,t){return Yo(e).appendChild(t)}function eu(e,t){if(e.contains)return e.contains(t);while(t=t.parentNode)if(t==e)return!0}function tu(){return document.activeElement}function nu(e){return new RegExp("\\b"+e+"\\b\\s*")}function ru(e,t){var n=nu(t);n.test(e.className)&&(e.className=e.className.replace(n,""))}function iu(e,t){nu(t).test(e.className)||(e.className+=" "+t)}function su(e,t){var n=e.split(" ");for(var r=0;r<n.length;r++)n[r]&&!nu(n[r]).test(t)&&(t+=" "+n[r]);return t}function ou(e){if(!document.body.getElementsByClassName)return;var t=document.body.getElementsByClassName("CodeMirror");for(var n=0;n<t.length;n++){var r=t[n].CodeMirror;r&&e(r)}}function au(){if(uu)return;fu(),uu=!0}function fu(){var e;go(window,"resize",function(){e==null&&(e=setTimeout(function(){e=null,cu=null,ou(sr)},100))}),go(window,"blur",function(){ou(Hr)})}function hu(e){if(cu!=null)return cu;var t=Qo("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return Zo(e,t),t.offsetWidth&&(cu=t.offsetHeight-t.clientHeight),cu||0}function du(e){if(pu==null){var t=Qo("span","​");Zo(e,Qo("span",[t,document.createTextNode("x")])),e.firstChild.offsetHeight!=0&&(pu=t.offsetWidth<=1&&t.offsetHeight>2&&!(r&&i<8))}return pu?Qo("span","​"):Qo("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")}function mu(e){if(vu!=null)return vu;var t=Zo(e,document.createTextNode("AخA")),n=Go(t,0,1).getBoundingClientRect();if(n.left==n.right)return!1;var r=Go(t,1,2).getBoundingClientRect();return vu=r.right-n.right<3}function Eu(e){if(wu!=null)return wu;var t=Zo(e,Qo("span","x")),n=t.getBoundingClientRect(),r=Go(t,0,1).getBoundingClientRect();return wu=Math.abs(n.left-r.left)>1}function xu(e,t,n,r){if(!e)return r(t,n,"ltr");var i=!1;for(var s=0;s<e.length;++s){var o=e[s];if(o.from<n&&o.to>t||t==n&&o.to==t)r(Math.max(o.from,t),Math.min(o.to,n),o.level==1?"rtl":"ltr"),i=!0}i||r(t,n,"ltr")}function Tu(e){return e.level%2?e.to:e.from}function Nu(e){return e.level%2?e.from:e.to}function Cu(e){var t=Js(e);return t?Tu(t[0]):0}function ku(e){var t=Js(e);return t?Nu(jo(t)):e.text.length}function Lu(e,t){var n=Rs(e.doc,t),r=ts(n);r!=n&&(t=Xs(r));var i=Js(r),s=i?i[0].level%2?ku(r):Cu(r):0;return pt(t,s)}function Au(e,t){var n,r=Rs(e.doc,t);while(n=Zi(r))r=n.find(1,!0).line,t=null;var i=Js(r),s=i?i[0].level%2?Cu(r):ku(r):r.text.length;return pt(t==null?Xs(r):t,s)}function Ou(e,t){var n=Lu(e,t.line),r=Rs(e.doc,n.line),i=Js(r);if(!i||i[0].level==0){var s=Math.max(0,r.text.search(/\S/)),o=t.line==n.line&&t.ch<=s&&t.ch;return pt(n.line,o?0:s)}return n}function Mu(e,t,n){var r=e[0].level;return t==r?!0:n==r?!1:t<n}function Du(e,t){_u=null;for(var n=0,r;n<e.length;++n){var i=e[n];if(i.from<t&&i.to>t)return n;if(i.from==t||i.to==t){if(r!=null)return Mu(e,i.level,e[r].level)?(i.from!=i.to&&(_u=r),n):(i.from!=i.to&&(_u=n),r);r=n}}return r}function Pu(e,t,n,r){if(!r)return t+n;do t+=n;while(t>0&&Ko(e.text.charAt(t)));return t}function Hu(e,t,n,r){var i=Js(e);if(!i)return Bu(e,t,n,r);var s=Du(i,t),o=i[s],u=Pu(e,t,o.level%2?-n:n,r);for(;;){if(u>o.from&&u<o.to)return u;if(u==o.from||u==o.to)return Du(i,u)==s?u:(o=i[s+=n],n>0==o.level%2?o.to:o.from);o=i[s+=n];if(!o)return null;n>0==o.level%2?u=Pu(e,o.to,-1,r):u=Pu(e,o.from,1,r)}}function Bu(e,t,n,r){var i=t+n;if(r)while(i>0&&Ko(e.text.charAt(i)))i+=n;return i<0||i>e.text.length?null:i}var e=/gecko\/\d/i.test(navigator.userAgent),t=/MSIE \d/.test(navigator.userAgent),n=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),r=t||n,i=r&&(t?document.documentMode||6:n[1]),s=/WebKit\//.test(navigator.userAgent),o=s&&/Qt\/\d+\.\d+/.test(navigator.userAgent),u=/Chrome\//.test(navigator.userAgent),a=/Opera\//.test(navigator.userAgent),f=/Apple Computer/.test(navigator.vendor),l=/KHTML\//.test(navigator.userAgent),c=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),h=/PhantomJS/.test(navigator.userAgent),p=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),d=p||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),v=p||/Mac/.test(navigator.platform),m=/win/i.test(navigator.platform),g=a&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);g&&(g=Number(g[1])),g&&g>=15&&(a=!1,s=!0);var y=v&&(o||a&&(g==null||g<12.11)),b=e||r&&i>=9,w=!1,E=!1,pt=S.Pos=function(e,t){if(!(this instanceof pt))return new pt(e,t);this.line=e,this.ch=t},dt=S.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch};yt.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],r=e.ranges[t];if(dt(n.anchor,r.anchor)!=0||dt(n.head,r.head)!=0)return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new bt(vt(this.ranges[t].anchor),vt(this.ranges[t].head));return new yt(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var n=0;n<this.ranges.length;n++){var r=this.ranges[n];if(dt(t,r.from())>=0&&dt(e,r.to())<=0)return n}return-1}},bt.prototype={from:function(){return gt(this.anchor,this.head)},to:function(){return mt(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var un={left:0,right:0,top:0,bottom:0},xn,Cn=null,kn=0,Yn=null,fr,lr,mr=0,Er=0,Sr=null;r?Sr=-0.53:e?Sr=15:u?Sr=-0.7:f&&(Sr=-1/3);var Cr,Ar=null,Fr=S.changeEnd=function(e){return e.text?pt(e.from.line+e.text.length-1,jo(e.text).length+(e.text.length==1?e.from.ch:0)):e.to};S.prototype={constructor:S,focus:function(){window.focus(),tr(this),Gn(this)},setOption:function(e,t){var n=this.options,r=n[e];if(n[e]==t&&e!="mode")return;n[e]=t,ci.hasOwnProperty(e)&&Fn(this,ci[e])(this,t,r)},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](e)},removeKeyMap:function(e){var t=this.state.keyMaps;for(var n=0;n<t.length;++n)if(t[n]==e||typeof t[n]!="string"&&t[n].name==e)return t.splice(n,1),!0},addOverlay:In(function(e,t){var n=e.token?e:S.getMode(this.options,e);if(n.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:n,modeSpec:e,opaque:t&&t.opaque}),this.state.modeGen++,zn(this)}),removeOverlay:In(function(e){var t=this.state.overlays;for(var n=0;n<t.length;++n){var r=t[n].modeSpec;if(r==e||typeof e=="string"&&r.name==e){t.splice(n,1),this.state.modeGen++,zn(this);return}}}),indentLine:In(function(e,t,n){typeof t!="string"&&typeof t!="number"&&(t==null?t=this.options.smartIndent?"smart":"prev":t=t?"add":"subtract"),Nt(this.doc,e)&&ii(this,e,t,n)}),indentSelection:In(function(e){var t=this.doc.sel.ranges,n=-1;for(var r=0;r<t.length;r++){var i=t[r];if(!i.empty()){var s=i.from(),o=i.to(),u=Math.max(n,s.line);n=Math.min(this.lastLine(),o.line-(o.ch?0:1))+1;for(var a=u;a<n;++a)ii(this,a,e);var f=this.doc.sel.ranges;s.ch==0&&t.length==f.length&&f[r].from().ch>0&&Ot(this.doc,r,new bt(s,f[r].to()))}else i.head.line>n&&(ii(this,i.head.line,e,!0),n=i.head.line,r==this.doc.sel.primIndex&&ni(this))}}),getTokenAt:function(e,t){var n=this.doc;e=xt(n,e);var r=Kt(this,e.line,t),i=this.doc.mode,s=Rs(n,e.line),o=new ki(s.text,this.options.tabSize);while(o.pos<e.ch&&!o.eol()){o.start=o.pos;var u=ms(i,o,r)}return{start:o.start,end:o.pos,string:o.current(),type:u||null,state:r}},getTokenTypeAt:function(e){e=xt(this.doc,e);var t=bs(this,Rs(this.doc,e.line)),n=0,r=(t.length-1)/2,i=e.ch,s;if(i==0)s=t[2];else for(;;){var o=n+r>>1;if((o?t[o*2-1]:0)>=i)r=o;else{if(!(t[o*2+1]<i)){s=t[o*2+2];break}n=o+1}}var u=s?s.indexOf("cm-overlay "):-1;return u<0?s:u==0?null:s.slice(0,u-1)},getModeAt:function(e){var t=this.doc.mode;return t.innerMode?S.innerMode(t,this.getTokenAt(e).state).mode:t},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(!yi.hasOwnProperty(t))return yi;var r=yi[t],i=this.getModeAt(e);if(typeof i[t]=="string")r[i[t]]&&n.push(r[i[t]]);else if(i[t])for(var s=0;s<i[t].length;s++){var o=r[i[t][s]];o&&n.push(o)}else i.helperType&&r[i.helperType]?n.push(r[i.helperType]):r[i.name]&&n.push(r[i.name]);for(var s=0;s<r._global.length;s++){var u=r._global[s];u.pred(i,this)&&Io(n,u.val)==-1&&n.push(u.val)}return n},getStateAfter:function(e,t){var n=this.doc;return e=St(n,e==null?n.first+n.size-1:e),Kt(this,e+1,t)},cursorCoords:function(e,t){var n,r=this.doc.sel.primary();return e==null?n=r.head:typeof e=="object"?n=xt(this.doc,e):n=e?r.from():r.to(),yn(this,n,t||"page")},charCoords:function(e,t){return gn(this,xt(this.doc,e),t||"page")},coordsChar:function(e,t){return e=mn(this,e,t||"page"),En(this,e.left,e.top)},lineAtHeight:function(e,t){return e=mn(this,{top:e,left:0},t||"page").top,Vs(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var n=!1,r=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>r&&(e=r,n=!0);var i=Rs(this.doc,e);return vn(this,i,{top:0,left:0},t||"page").top+(n?this.doc.height-$s(i):0)},defaultTextHeight:function(){return Tn(this.display)},defaultCharWidth:function(){return Nn(this.display)},setGutterMarker:In(function(e,t,n){return si(this.doc,e,"gutter",function(e){var r=e.gutterMarkers||(e.gutterMarkers={});return r[t]=n,!n&&$o(r)&&(e.gutterMarkers=null),!0})}),clearGutter:In(function(e){var t=this,n=t.doc,r=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,Wn(t,r,"gutter"),$o(n.gutterMarkers)&&(n.gutterMarkers=null)),++r})}),addLineWidget:In(function(e,t,n){return ls(this,e,t,n)}),removeLineWidget:function(e){e.clear()},lineInfo:function(e){if(typeof e=="number"){if(!Nt(this.doc,e))return null;var t=e;e=Rs(this.doc,e);if(!e)return null}else{var t=Xs(e);if(t==null)return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,r,i){var s=this.display;e=yn(this,xt(this.doc,e));var o=e.bottom,u=e.left;t.style.position="absolute",s.sizer.appendChild(t);if(r=="over")o=e.top;else if(r=="above"||r=="near"){var a=Math.max(s.wrapper.clientHeight,this.doc.height),f=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth);(r=="above"||e.bottom+t.offsetHeight>a)&&e.top>t.offsetHeight?o=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=a&&(o=e.bottom),u+t.offsetWidth>f&&(u=f-t.offsetWidth)}t.style.top=o+"px",t.style.left=t.style.right="",i=="right"?(u=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):(i=="left"?u=0:i=="middle"&&(u=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=u+"px"),n&&Zr(this,u,o,u+t.offsetWidth,o+t.offsetHeight)},triggerOnKeyDown:In(Or),triggerOnKeyPress:In(Dr),triggerOnKeyUp:_r,execCommand:function(e){if(Ei.hasOwnProperty(e))return Ei[e](this)},findPosH:function(e,t,n,r){var i=1;t<0&&(i=-1,t=-t);for(var s=0,o=xt(this.doc,e);s<t;++s){o=ui(this.doc,o,i,n,r);if(o.hitSide)break}return o},moveH:In(function(e,t){var n=this;n.extendSelectionsBy(function(r){return n.display.shift||n.doc.extend||r.empty()?ui(n.doc,r.head,e,t,n.options.rtlMoveVisually):e<0?r.from():r.to()},Mo)}),deleteH:In(function(e,t){var n=this.doc.sel,r=this.doc;n.somethingSelected()?r.replaceSelection("",null,"+delete"):oi(this,function(n){var i=ui(r,n.head,e,t,!1);return e<0?{from:i,to:n.head}:{from:n.head,to:i}})}),findPosV:function(e,t,n,r){var i=1,s=r;t<0&&(i=-1,t=-t);for(var o=0,u=xt(this.doc,e);o<t;++o){var a=yn(this,u,"div");s==null?s=a.left:a.left=s,u=ai(this,a,i,n);if(u.hitSide)break}return u},moveV:In(function(e,t){var n=this,r=this.doc,i=[],s=!n.display.shift&&!r.extend&&r.sel.somethingSelected();r.extendSelectionsBy(function(o){if(s)return e<0?o.from():o.to();var u=yn(n,o.head,"div");o.goalColumn!=null&&(u.left=o.goalColumn),i.push(u.left);var a=ai(n,u,e,t);return t=="page"&&o==r.sel.primary()&&ti(n,null,gn(n,a,"div").top-u.top),a},Mo);if(i.length)for(var o=0;o<r.sel.ranges.length;o++)r.sel.ranges[o].goalColumn=i[o]}),toggleOverwrite:function(e){if(e!=null&&e==this.state.overwrite)return;(this.state.overwrite=!this.state.overwrite)?iu(this.display.cursorDiv,"CodeMirror-overwrite"):ru(this.display.cursorDiv,"CodeMirror-overwrite"),bo(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return tu()==this.display.input},scrollTo:In(function(e,t){(e!=null||t!=null)&&ri(this),e!=null&&(this.curOp.scrollLeft=e),t!=null&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller,t=ko;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-t,width:e.scrollWidth-t,clientHeight:e.clientHeight-t,clientWidth:e.clientWidth-t}},scrollIntoView:In(function(e,t){e==null?(e={from:this.doc.sel.primary().head,to:null},t==null&&(t=this.options.cursorScrollMargin)):typeof e=="number"?e={from:pt(e,0),to:null}:e.from==null&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0;if(e.from.line!=null)ri(this),this.curOp.scrollToPos=e;else{var n=ei(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(n.scrollLeft,n.scrollTop)}}),setSize:In(function(e,t){function r(e){return typeof e=="number"||/^\d+$/.test(String(e))?e+"px":e}var n=this;e!=null&&(n.display.wrapper.style.width=r(e)),t!=null&&(n.display.wrapper.style.height=r(t)),n.options.lineWrapping&&cn(this);var i=n.display.viewFrom;n.doc.iter(i,n.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){Wn(n,i,"widget");break}++i}),n.curOp.forceUpdate=!0,bo(n,"refresh",this)}),operation:function(e){return jn(this,e)},refresh:In(function(){var e=this.display.cachedTextHeight;zn(this),this.curOp.forceUpdate=!0,hn(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),D(this),(e==null||Math.abs(e-Tn(this.display))>.5)&&L(this),bo(this,"refresh",this)}),swapDoc:In(function(e){var t=this.doc;return t.cm=null,qs(this,e),hn(this),er(this),this.scrollTo(e.scrollLeft,e.scrollTop),Eo(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Co(S);var li=S.defaults={},ci=S.optionHandlers={},pi=S.Init={toString:function(){return"CodeMirror.Init"}};hi("value","",function(e,t){e.setValue(t)},!0),hi("mode",null,function(e,t){e.doc.modeOption=t,T(e)},!0),hi("indentUnit",2,T,!0),hi("indentWithTabs",!1),hi("smartIndent",!0),hi("tabSize",4,function(e){N(e),hn(e),zn(e)},!0),hi("specialChars",/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\ufeff]/g,function(e,t){e.options.specialChars=new RegExp(t.source+(t.test("	")?"":"|	"),"g"),e.refresh()},!0),hi("specialCharPlaceholder",Ns,function(e){e.refresh()},!0),hi("electricChars",!0),hi("rtlMoveVisually",!m),hi("wholeLineUpdateBefore",!0),hi("theme","default",function(e){O(e),M(e)},!0),hi("keyMap","default",A),hi("extraKeys",null),hi("lineWrapping",!1,C,!0),hi("gutters",[],function(e){B(e.options),M(e)},!0),hi("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?W(e.display)+"px":"0",e.refresh()},!0),hi("coverGutterNextToScrollbar",!1,I,!0),hi("lineNumbers",!1,function(e){B(e.options),M(e)},!0),hi("firstLineNumber",1,M,!0),hi("lineNumberFormatter",function(e){return e},M,!0),hi("showCursorWhenSelecting",!1,Ut,!0),hi("resetSelectionOnContextMenu",!0),hi("readOnly",!1,function(e,t){t=="nocursor"?(Hr(e),e.display.input.blur(),e.display.disabled=!0):(e.display.disabled=!1,t||er(e))}),hi("disableInput",!1,function(e,t){t||er(e)},!0),hi("dragDrop",!0),hi("cursorBlinkRate",530),hi("cursorScrollMargin",0),hi("cursorHeight",1,Ut,!0),hi("singleCursorHeightPerLine",!0,Ut,!0),hi("workTime",100),hi("workDelay",100),hi("flattenSpans",!0,N,!0),hi("addModeClass",!1,N,!0),hi("pollInterval",100),hi("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),hi("historyEventDelay",1250),hi("viewportMargin",10,function(e){e.refresh()},!0),hi("maxHighlightLength",1e4,N,!0),hi("moveInputWithCursor",!0,function(e,t){t||(e.display.inputDiv.style.top=e.display.inputDiv.style.left=0)}),hi("tabindex",null,function(e,t){e.display.input.tabIndex=t||""}),hi("autofocus",null);var di=S.modes={},vi=S.mimeModes={};S.defineMode=function(e,t){!S.defaults.mode&&e!="null"&&(S.defaults.mode=e);if(arguments.length>2){t.dependencies=[];for(var n=2;n<arguments.length;++n)t.dependencies.push(arguments[n])}di[e]=t},S.defineMIME=function(e,t){vi[e]=t},S.resolveMode=function(e){if(typeof e=="string"&&vi.hasOwnProperty(e))e=vi[e];else if(e&&typeof e.name=="string"&&vi.hasOwnProperty(e.name)){var t=vi[e.name];typeof t=="string"&&(t={name:t}),e=Ro(t,e),e.name=t.name}else if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return S.resolveMode("application/xml");return typeof e=="string"?{name:e}:e||{name:"null"}},S.getMode=function(e,t){var t=S.resolveMode(t),n=di[t.name];if(!n)return S.getMode(e,"text/plain");var r=n(e,t);if(mi.hasOwnProperty(t.name)){var i=mi[t.name];for(var s in i){if(!i.hasOwnProperty(s))continue;r.hasOwnProperty(s)&&(r["_"+s]=r[s]),r[s]=i[s]}}r.name=t.name,t.helperType&&(r.helperType=t.helperType);if(t.modeProps)for(var s in t.modeProps)r[s]=t.modeProps[s];return r},S.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),S.defineMIME("text/plain","null");var mi=S.modeExtensions={};S.extendMode=function(e,t){var n=mi.hasOwnProperty(e)?mi[e]:mi[e]={};Uo(t,n)},S.defineExtension=function(e,t){S.prototype[e]=t},S.defineDocExtension=function(e,t){Bs.prototype[e]=t},S.defineOption=hi;var gi=[];S.defineInitHook=function(e){gi.push(e)};var yi=S.helpers={};S.registerHelper=function(e,t,n){yi.hasOwnProperty(e)||(yi[e]=S[e]={_global:[]}),yi[e][t]=n},S.registerGlobalHelper=function(e,t,n,r){S.registerHelper(e,t,r),yi[e]._global.push({pred:n,val:r})};var bi=S.copyState=function(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var n={};for(var r in t){var i=t[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n},wi=S.startState=function(e,t,n){return e.startState?e.startState(t,n):!0};S.innerMode=function(e,t){while(e.innerMode){var n=e.innerMode(t);if(!n||n.mode==e)break;t=n.state,e=n.mode}return n||{mode:e,state:t}};var Ei=S.commands={selectAll:function(e){e.setSelection(pt(e.firstLine(),0),pt(e.lastLine()),Ao)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),Ao)},killLine:function(e){oi(e,function(t){if(t.empty()){var n=Rs(e.doc,t.head.line).text.length;return t.head.ch==n&&t.head.line<e.lastLine()?{from:t.head,to:pt(t.head.line+1,0)}:{from:t.head,to:pt(t.head.line,n)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){oi(e,function(t){return{from:pt(t.from().line,0),to:xt(e.doc,pt(t.to().line+1,0))}})},delLineLeft:function(e){oi(e,function(e){return{from:pt(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){oi(e,function(t){var n=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:0,top:n},"div");return{from:r,to:t.from()}})},delWrappedLineRight:function(e){oi(e,function(t){var n=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div");return{from:t.from(),to:r}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(pt(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(pt(e.lastLine()))},goLineStart:function(e){e.extendSelectionsBy(function(t){return Lu(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){e.extendSelectionsBy(function(t){return Ou(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){e.extendSelectionsBy(function(t){return Au(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div")},Mo)},goLineLeft:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:n},"div")},Mo)},goLineLeftSmart:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:0,top:n},"div");return r.ch<e.getLine(r.line).search(/\S/)?Ou(e,t.head):r},Mo)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	")},insertSoftTab:function(e){var t=[],n=e.listSelections(),r=e.options.tabSize;for(var i=0;i<n.length;i++){var s=n[i].from(),o=Do(e.getLine(s.line),s.ch,r);t.push((new Array(r-o%r+1)).join(" "))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){jn(e,function(){var t=e.listSelections(),n=[];for(var r=0;r<t.length;r++){var i=t[r].head,s=Rs(e.doc,i.line).text;if(s){i.ch==s.length&&(i=new pt(i.line,i.ch-1));if(i.ch>0)i=new pt(i.line,i.ch+1),e.replaceRange(s.charAt(i.ch-1)+s.charAt(i.ch-2),pt(i.line,i.ch-2),i,"+transpose");else if(i.line>e.doc.first){var o=Rs(e.doc,i.line-1).text;o&&e.replaceRange(s.charAt(0)+"\n"+o.charAt(o.length-1),pt(i.line-1,o.length-1),pt(i.line,1),"+transpose")}}n.push(new bt(i,i))}e.setSelections(n)})},newlineAndIndent:function(e){jn(e,function(){var t=e.listSelections().length;for(var n=0;n<t;n++){var r=e.listSelections()[n];e.replaceRange("\n",r.anchor,r.head,"+input"),e.indentLine(r.from().line+1,null,!0),ni(e)}})},toggleOverwrite:function(e){e.toggleOverwrite()}},Si=S.keyMap={};Si.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Si.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Si.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection",fallthrough:["basic","emacsy"]},Si.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},Si["default"]=v?Si.macDefault:Si.pcDefault;var Ti=S.lookupKey=function(e,t,n){function r(t){t=xi(t);var i=t[e];if(i===!1)return"stop";if(i!=null&&n(i))return!0;if(t.nofallthrough)return"stop";var s=t.fallthrough;if(s==null)return!1;if(Object.prototype.toString.call(s)!="[object Array]")return r(s);for(var o=0;o<s.length;++o){var u=r(s[o]);if(u)return u}return!1}for(var i=0;i<t.length;++i){var s=r(t[i]);if(s)return s!="stop"}},Ni=S.isModifierKey=function(e){var t=Su[e.keyCode];return t=="Ctrl"||t=="Alt"||t=="Shift"||t=="Mod"},Ci=S.keyName=function(e,t){if(a&&e.keyCode==34&&e["char"])return!1;var n=Su[e.keyCode];if(n==null||e.altGraphKey)return!1;e.altKey&&(n="Alt-"+n);if(y?e.metaKey:e.ctrlKey)n="Ctrl-"+n;if(y?e.ctrlKey:e.metaKey)n="Cmd-"+n;return!t&&e.shiftKey&&(n="Shift-"+n),n};S.fromTextArea=function(e,t){function r(){e.value=a.getValue()}t||(t={}),t.value=e.value,!t.tabindex&&e.tabindex&&(t.tabindex=e.tabindex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder);if(t.autofocus==null){var n=tu();t.autofocus=n==e||e.getAttribute("autofocus")!=null&&n==document.body}if(e.form){go(e.form,"submit",r);if(!t.leaveSubmitMethodAlone){var i=e.form,s=i.submit;try{var o=i.submit=function(){r(),i.submit=s,i.submit(),i.submit=o}}catch(u){}}}e.style.display="none";var a=S(function(t){e.parentNode.insertBefore(t,e.nextSibling)},t);return a.save=r,a.getTextArea=function(){return e},a.toTextArea=function(){r(),e.parentNode.removeChild(a.getWrapperElement()),e.style.display="",e.form&&(yo(e.form,"submit",r),typeof e.form.submit=="function"&&(e.form.submit=s))},a};var ki=S.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};ki.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(e){var t=this.string.charAt(this.pos);if(typeof e=="string")var n=t==e;else var n=t&&(e.test?e.test(t):e(t));if(n)return++this.pos,t},eatWhile:function(e){var t=this.pos;while(this.eat(e));return this.pos>t},eatSpace:function(){var e=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Do(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Do(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return Do(this.string,null,this.tabSize)-(this.lineStart?Do(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,n){if(typeof e!="string"){var s=this.string.slice(this.pos).match(e);return s&&s.index>0?null:(s&&t!==!1&&(this.pos+=s[0].length),s)}var r=function(e){return n?e.toLowerCase():e},i=this.string.substr(this.pos,e.length);if(r(i)==r(e))return t!==!1&&(this.pos+=e.length),!0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var Li=S.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e};Co(Li),Li.prototype.clear=function(){if(this.explicitlyCleared)return;var e=this.doc.cm,t=e&&!e.curOp;t&&Ln(e);if(No(this,"clear")){var n=this.find();n&&Eo(this,"clear",n.from,n.to)}var r=null,i=null;for(var s=0;s<this.lines.length;++s){var o=this.lines[s],u=ji(o.markedSpans,this);e&&!this.collapsed?Wn(e,Xs(o),"text"):e&&(u.to!=null&&(i=Xs(o)),u.from!=null&&(r=Xs(o))),o.markedSpans=Fi(o.markedSpans,u),u.from==null&&this.collapsed&&!ss(this.doc,o)&&e&&Ws(o,Tn(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var s=0;s<this.lines.length;++s){var a=ts(this.lines[s]),f=P(a);f>e.display.maxLineLength&&(e.display.maxLine=a,e.display.maxLineLength=f,e.display.maxLineChanged=!0)}r!=null&&e&&this.collapsed&&zn(e,r,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&jt(e.doc)),e&&Eo(e,"markerCleared",e,this),t&&On(e),this.parent&&this.parent.clear()},Li.prototype.find=function(e,t){e==null&&this.type=="bookmark"&&(e=1);var n,r;for(var i=0;i<this.lines.length;++i){var s=this.lines[i],o=ji(s.markedSpans,this);if(o.from!=null){n=pt(t?s:Xs(s),o.from);if(e==-1)return n}if(o.to!=null){r=pt(t?s:Xs(s),o.to);if(e==1)return r}}return n&&{from:n,to:r}},Li.prototype.changed=function(){var e=this.find(-1,!0),t=this,n=this.doc.cm;if(!e||!n)return;jn(n,function(){var r=e.line,i=Xs(e.line),s=rn(n,i);s&&(ln(s),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0;if(!ss(t.doc,r)&&t.height!=null){var o=t.height;t.height=null;var u=fs(t)-o;u&&Ws(r,r.height+u)}})},Li.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(!t.maybeHiddenMarkers||Io(t.maybeHiddenMarkers,this)==-1)&&(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},Li.prototype.detachLine=function(e){this.lines.splice(Io(this.lines,e),1);if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};var Ai=0,Mi=S.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};Co(Mi),Mi.prototype.clear=function(){if(this.explicitlyCleared)return;this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();Eo(this,"clear")},Mi.prototype.find=function(e,t){return this.primary.find(e,t)};var us=S.LineWidget=function(e,t,n){if(n)for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.cm=e,this.node=t};Co(us),us.prototype.clear=function(){var e=this.cm,t=this.line.widgets,n=this.line,r=Xs(n);if(r==null||!t)return;for(var i=0;i<t.length;++i)t[i]==this&&t.splice(i--,1);t.length||(n.widgets=null);var s=fs(this);jn(e,function(){as(e,n,-s),Wn(e,r,"widget"),Ws(n,Math.max(0,n.height-s))})},us.prototype.changed=function(){var e=this.height,t=this.cm,n=this.line;this.height=null;var r=fs(this)-e;if(!r)return;jn(t,function(){t.curOp.forceUpdate=!0,as(t,n,r),Ws(n,n.height+r)})};var cs=S.Line=function(e,t,n){this.text=e,$i(this,t),this.height=n?n(this):1};Co(cs),cs.prototype.lineNo=function(){return Xs(this)};var Es={},Ss={};Ds.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,r=e+t;n<r;++n){var i=this.lines[n];this.height-=i.height,ps(i),Eo(i,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0;r<t.length;++r)t[r].parent=this},iterN:function(e,t,n){for(var r=e+t;e<r;++e)if(n(this.lines[e]))return!0}},Ps.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var r=this.children[n],i=r.chunkSize();if(e<i){var s=Math.min(t,i-e),o=r.height;r.removeInner(e,s),this.height-=o-r.height,i==s&&(this.children.splice(n--,1),r.parent=null);if((t-=s)==0)break;e=0}else e-=i}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof Ds))){var u=[];this.collapse(u),this.children=[new Ds(u)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var r=0;r<this.children.length;++r){var i=this.children[r],s=i.chunkSize();if(e<=s){i.insertInner(e,t,n);if(i.lines&&i.lines.length>50){while(i.lines.length>50){var o=i.lines.splice(i.lines.length-25,25),u=new Ds(o);i.height-=u.height,this.children.splice(r+1,0,u),u.parent=this}this.maybeSpill()}break}e-=s}},maybeSpill:function(){if(this.children.length<=10)return;var e=this;do{var t=e.children.splice(e.children.length-5,5),n=new Ps(t);if(!e.parent){var r=new Ps(e.children);r.parent=e,e.children=[r,n],e=r}else{e.size-=n.size,e.height-=n.height;var i=Io(e.parent.children,e);e.parent.children.splice(i+1,0,n)}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()},iterN:function(e,t,n){for(var r=0;r<this.children.length;++r){var i=this.children[r],s=i.chunkSize();if(e<s){var o=Math.min(t,s-e);if(i.iterN(e,o,n))return!0;if((t-=o)==0)break;e=0}else e-=s}}};var Hs=0,Bs=S.Doc=function(e,t,n){if(!(this instanceof Bs))return new Bs(e,t,n);n==null&&(n=0),Ps.call(this,[new Ds([new cs("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=n;var r=pt(n,0);this.sel=Et(r),this.history=new Ks(null),this.id=++Hs,this.modeOption=t,typeof e=="string"&&(e=gu(e)),_s(this,{from:r,to:r,text:e}),Pt(this,Et(r),Ao)};Bs.prototype=Ro(Ps.prototype,{constructor:Bs,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){var n=0;for(var r=0;r<t.length;++r)n+=t[r].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=zs(this,this.first,this.first+this.size);return e===!1?t:t.join(e||"\n")},setValue:qn(function(e){var t=pt(this.first,0),n=this.first+this.size-1;Wr(this,{from:t,to:pt(n,Rs(this,n).text.length),text:gu(e),origin:"setValue"},!0),Pt(this,Et(t))}),replaceRange:function(e,t,n,r){t=xt(this,t),n=n?xt(this,n):t,Qr(this,e,t,n,r)},getRange:function(e,t,n){var r=Us(this,xt(this,e),xt(this,t));return n===!1?r:r.join(n||"\n")},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(Nt(this,e))return Rs(this,e)},getLineNumber:function(e){return Xs(e)},getLineHandleVisualStart:function(e){return typeof e=="number"&&(e=Rs(this,e)),ts(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return xt(this,e)},getCursor:function(e){var t=this.sel.primary(),n;return e==null||e=="head"?n=t.head:e=="anchor"?n=t.anchor:e=="end"||e=="to"||e===!1?n=t.to():n=t.from(),n},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:qn(function(e,t,n){Mt(this,xt(this,typeof e=="number"?pt(e,t||0):e),null,n)}),setSelection:qn(function(e,t,n){Mt(this,xt(this,e),xt(this,t||e),n)}),extendSelection:qn(function(e,t,n){Lt(this,xt(this,e),t&&xt(this,t),n)}),extendSelections:qn(function(e,t){At(this,Ct(this,e,t))}),extendSelectionsBy:qn(function(e,t){At(this,qo(this.sel.ranges,e),t)}),setSelections:qn(function(e,t,n){if(!e.length)return;for(var r=0,i=[];r<e.length;r++)i[r]=new bt(xt(this,e[r].anchor),xt(this,e[r].head));t==null&&(t=Math.min(e.length-1,this.sel.primIndex)),Pt(this,wt(i,t),n)}),addSelection:qn(function(e,t,n){var r=this.sel.ranges.slice(0);r.push(new bt(xt(this,e),xt(this,t||e))),Pt(this,wt(r,r.length-1),n)}),getSelection:function(e){var t=this.sel.ranges,n;for(var r=0;r<t.length;r++){var i=Us(this,t[r].from(),t[r].to());n=n?n.concat(i):i}return e===!1?n:n.join(e||"\n")},getSelections:function(e){var t=[],n=this.sel.ranges;for(var r=0;r<n.length;r++){var i=Us(this,n[r].from(),n[r].to());e!==!1&&(i=i.join(e||"\n")),t[r]=i}return t},replaceSelection:function(e,t,n){var r=[];for(var i=0;i<this.sel.ranges.length;i++)r[i]=e;this.replaceSelections(r,t,n||"+input")},replaceSelections:qn(function(e,t,n){var r=[],i=this.sel;for(var s=0;s<i.ranges.length;s++){var o=i.ranges[s];r[s]={from:o.from(),to:o.to(),text:gu(e[s]),origin:n}}var u=t&&t!="end"&&Ur(this,r,t);for(var s=r.length-1;s>=0;s--)Wr(this,r[s]);u?Dt(this,u):this.cm&&ni(this.cm)}),undo:qn(function(){Vr(this,"undo")}),redo:qn(function(){Vr(this,"redo")}),undoSelection:qn(function(){Vr(this,"undo",!0)}),redoSelection:qn(function(){Vr(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){var e=this.history,t=0,n=0;for(var r=0;r<e.done.length;r++)e.done[r].ranges||++t;for(var r=0;r<e.undone.length;r++)e.undone[r].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){this.history=new Ks(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:oo(this.history.done),undone:oo(this.history.undone)}},setHistory:function(e){var t=this.history=new Ks(this.history.maxGeneration);t.done=oo(e.done.slice(0),null,!0),t.undone=oo(e.undone.slice(0),null,!0)},addLineClass:qn(function(e,t,n){return si(this,e,"class",function(e){var r=t=="text"?"textClass":t=="background"?"bgClass":"wrapClass";if(!e[r])e[r]=n;else{if((new RegExp("(?:^|\\s)"+n+"(?:$|\\s)")).test(e[r]))return!1;e[r]+=" "+n}return!0})}),removeLineClass:qn(function(e,t,n){return si(this,e,"class",function(e){var r=t=="text"?"textClass":t=="background"?"bgClass":"wrapClass",i=e[r];if(!i)return!1;if(n==null)e[r]=null;else{var s=i.match(new RegExp("(?:^|\\s+)"+n+"(?:$|\\s+)"));if(!s)return!1;var o=s.index+s[0].length;e[r]=i.slice(0,s.index)+(!s.index||o==i.length?"":" ")+i.slice(o)||null}return!0})}),markText:function(e,t,n){return Oi(this,xt(this,e),xt(this,t),n,"range")},setBookmark:function(e,t){var n={replacedWith:t&&(t.nodeType==null?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared};return e=xt(this,e),Oi(this,e,e,n,"bookmark")},findMarksAt:function(e){e=xt(this,e);var t=[],n=Rs(this,e.line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(i.from==null||i.from<=e.ch)&&(i.to==null||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},findMarks:function(e,t,n){e=xt(this,e),t=xt(this,t);var r=[],i=e.line;return this.iter(e.line,t.line+1,function(s){var o=s.markedSpans;if(o)for(var u=0;u<o.length;u++){var a=o[u];!(i==e.line&&e.ch>a.to||a.from==null&&i!=e.line||i==t.line&&a.from>t.ch)&&(!n||n(a.marker))&&r.push(a.marker.parent||a.marker)}++i}),r},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var r=0;r<n.length;++r)n[r].from!=null&&e.push(n[r].marker)}),e},posFromIndex:function(e){var t,n=this.first;return this.iter(function(r){var i=r.text.length+1;if(i>e)return t=e,!0;e-=i,++n}),xt(this,pt(n,t))},indexFromPos:function(e){e=xt(this,e);var t=e.ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new Bs(zs(this,this.first,this.first+this.size),this.modeOption,this.first);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;e.from!=null&&e.from>t&&(t=e.from),e.to!=null&&e.to<n&&(n=e.to);var r=new Bs(zs(this,t,n),e.mode||this.modeOption,t);return e.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:e.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Pi(r,Di(this)),r},unlinkDoc:function(e){e instanceof S&&(e=e.doc);if(this.linked)for(var t=0;t<this.linked.length;++t){var n=this.linked[t];if(n.doc!=e)continue;this.linked.splice(t,1),e.unlinkDoc(this),Hi(Di(this));break}if(e.history==this.history){var r=[e.id];Is(e,function(e){r.push(e.id)},!0),e.history=new Ks(null),e.history.done=oo(this.history.done,r),e.history.undone=oo(this.history.undone,r)}},iterLinkedDocs:function(e){Is(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),Bs.prototype.eachLine=Bs.prototype.iter;var js="iter insert remove copy getEditor".split(" ");for(var Fs in Bs.prototype)Bs.prototype.hasOwnProperty(Fs)&&Io(js,Fs)<0&&(S.prototype[Fs]=function(e){return function(){return e.apply(this.doc,arguments)}}(Bs.prototype[Fs]));Co(Bs);var lo=S.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},co=S.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},po=S.e_stop=function(e){lo(e),co(e)},go=S.on=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var r=e._handlers||(e._handlers={}),i=r[t]||(r[t]=[]);i.push(n)}},yo=S.off=function(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var r=e._handlers&&e._handlers[t];if(!r)return;for(var i=0;i<r.length;++i)if(r[i]==n){r.splice(i,1);break}}},bo=S.signal=function(e,t){var n=e._handlers&&e._handlers[t];if(!n)return;var r=Array.prototype.slice.call(arguments,2);for(var i=0;i<n.length;++i)n[i].apply(null,r)},wo=null,ko=30,Lo=S.Pass={toString:function(){return"CodeMirror.Pass"}},Ao={scroll:!1},Oo={origin:"*mouse"},Mo={origin:"+move"};_o.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var Do=S.countColumn=function(e,t,n,r,i){t==null&&(t=e.search(/[^\s\u00a0]/),t==-1&&(t=e.length));for(var s=r||0,o=i||0;;){var u=e.indexOf("	",s);if(u<0||u>=t)return o+(t-s);o+=u-s,o+=n-o%n,s=u+1}},Ho=[""],Fo=function(e){e.select()};p?Fo=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:r&&(Fo=function(e){try{e.select()}catch(t){}}),[].indexOf&&(Io=function(e,t){return e.indexOf(t)}),[].map&&(qo=function(e,t){return e.map(t)});var Wo=/[\u00df\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Xo=S.isWordChar=function(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||Wo.test(e))},Jo=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/,Go;document.createRange?Go=function(e,t,n){var r=document.createRange();return r.setEnd(e,n),r.setStart(e,t),r}:Go=function(e,t,n){var r=document.body.createTextRange();return r.moveToElementText(e.parentNode),r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",t),r},r&&i<11&&(tu=function(){try{return document.activeElement}catch(e){return document.body}});var uu=!1,lu=function(){if(r&&i<9)return!1;var e=Qo("div");return"draggable"in e||"dragDrop"in e}(),cu,pu,vu,gu=S.splitLines="\n\nb".split(/\n/).length!=3?function(e){var t=0,n=[],r=e.length;while(t<=r){var i=e.indexOf("\n",t);i==-1&&(i=e.length);var s=e.slice(t,e.charAt(i-1)=="\r"?i-1:i),o=s.indexOf("\r");o!=-1?(n.push(s.slice(0,o)),t+=o+1):(n.push(s),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)},yu=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return!t||t.parentElement()!=e?!1:t.compareEndPoints("StartToEnd",t)!=0},bu=function(){var e=Qo("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),typeof e.oncopy=="function")}(),wu=null,Su={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};S.keyNames=Su,function(){for(var e=0;e<10;e++)Su[e+48]=Su[e+96]=String(e);for(var e=65;e<=90;e++)Su[e]=String.fromCharCode(e);for(var e=1;e<=12;e++)Su[e+111]=Su[e+63235]="F"+e}();var _u,ju=function(){function n(n){return n<=247?e.charAt(n):1424<=n&&n<=1524?"R":1536<=n&&n<=1773?t.charAt(n-1536):1774<=n&&n<=2220?"r":8192<=n&&n<=8203?"w":n==8204?"b":"L"}function f(e,t,n){this.level=e,this.from=t,this.to=n}var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",t="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,s=/[LRr]/,o=/[Lb1n]/,u=/[1n]/,a="L";return function(e){if(!r.test(e))return!1;var t=e.length,l=[];for(var c=0,h;c<t;++c)l.push(h=n(e.charCodeAt(c)));for(var c=0,p=a;c<t;++c){var h=l[c];h=="m"?l[c]=p:p=h}for(var c=0,d=a;c<t;++c){var h=l[c];h=="1"&&d=="r"?l[c]="n":s.test(h)&&(d=h,h=="r"&&(l[c]="R"))}for(var c=1,p=l[0];c<t-1;++c){var h=l[c];h=="+"&&p=="1"&&l[c+1]=="1"?l[c]="1":h==","&&p==l[c+1]&&(p=="1"||p=="n")&&(l[c]=p),p=h}for(var c=0;c<t;++c){var h=l[c];if(h==",")l[c]="N";else if(h=="%"){for(var v=c+1;v<t&&l[v]=="%";++v);var m=c&&l[c-1]=="!"||v<t&&l[v]=="1"?"1":"N";for(var g=c;g<v;++g)l[g]=m;c=v-1}}for(var c=0,d=a;c<t;++c){var h=l[c];d=="L"&&h=="1"?l[c]="L":s.test(h)&&(d=h)}for(var c=0;c<t;++c)if(i.test(l[c])){for(var v=c+1;v<t&&i.test(l[v]);++v);var y=(c?l[c-1]:a)=="L",b=(v<t?l[v]:a)=="L",m=y||b?"L":"R";for(var g=c;g<v;++g)l[g]=m;c=v-1}var w=[],E;for(var c=0;c<t;)if(o.test(l[c])){var S=c;for(++c;c<t&&o.test(l[c]);++c);w.push(new f(0,S,c))}else{var x=c,T=w.length;for(++c;c<t&&l[c]!="L";++c);for(var g=x;g<c;)if(u.test(l[g])){x<g&&w.splice(T,0,new f(1,x,g));var N=g;for(++g;g<c&&u.test(l[g]);++g);w.splice(T,0,new f(2,N,g)),x=g}else++g;x<c&&w.splice(T,0,new f(1,x,c))}return w[0].level==1&&(E=e.match(/^\s+/))&&(w[0].from=E[0].length,w.unshift(new f(0,0,E[0].length))),jo(w).level==1&&(E=e.match(/\s+$/))&&(jo(w).to-=E[0].length,w.push(new f(0,t-E[0].length,t))),w[0].level!=jo(w).level&&w.push(new f(w[0].level,t,t)),w}}();return S.version="4.4.1",S}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define("thirdparty/CodeMirror2/addon/fold/xml-fold",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function n(e,t){return e.line-t.line||e.ch-t.ch}function o(e,t,n,r){this.line=t,this.ch=n,this.cm=e,this.text=e.getLine(t),this.min=r?r.from:e.firstLine(),this.max=r?r.to-1:e.lastLine()}function u(e,n){var r=e.cm.getTokenTypeAt(t(e.line,n));return r&&/\btag\b/.test(r)}function a(e){if(e.line>=e.max)return;return e.ch=0,e.text=e.cm.getLine(++e.line),!0}function f(e){if(e.line<=e.min)return;return e.text=e.cm.getLine(--e.line),e.ch=e.text.length,!0}function l(e){for(;;){var t=e.text.indexOf(">",e.ch);if(t==-1){if(a(e))continue;return}if(!u(e,t+1)){e.ch=t+1;continue}var n=e.text.lastIndexOf("/",t),r=n>-1&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,r?"selfClose":"regular"}}function c(e){for(;;){var t=e.ch?e.text.lastIndexOf("<",e.ch-1):-1;if(t==-1){if(f(e))continue;return}if(!u(e,t+1)){e.ch=t;continue}s.lastIndex=t,e.ch=t;var n=s.exec(e.text);if(n&&n.index==t)return n}}function h(e){for(;;){s.lastIndex=e.ch;var t=s.exec(e.text);if(!t){if(a(e))continue;return}if(!u(e,t.index+1)){e.ch=t.index+1;continue}return e.ch=t.index+t[0].length,t}}function p(e){for(;;){var t=e.ch?e.text.lastIndexOf(">",e.ch-1):-1;if(t==-1){if(f(e))continue;return}if(!u(e,t+1)){e.ch=t;continue}var n=e.text.lastIndexOf("/",t),r=n>-1&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,r?"selfClose":"regular"}}function d(e,n){var r=[];for(;;){var i=h(e),s,o=e.line,u=e.ch-(i?i[0].length:0);if(!i||!(s=l(e)))return;if(s=="selfClose")continue;if(i[1]){for(var a=r.length-1;a>=0;--a)if(r[a]==i[2]){r.length=a;break}if(a<0&&(!n||n==i[2]))return{tag:i[2],from:t(o,u),to:t(e.line,e.ch)}}else r.push(i[2])}}function v(e,n){var r=[];for(;;){var i=p(e);if(!i)return;if(i=="selfClose"){c(e);continue}var s=e.line,o=e.ch,u=c(e);if(!u)return;if(u[1])r.push(u[2]);else{for(var a=r.length-1;a>=0;--a)if(r[a]==u[2]){r.length=a;break}if(a<0&&(!n||n==u[2]))return{tag:u[2],from:t(e.line,e.ch),to:t(s,o)}}}}var t=e.Pos,r="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",i=r+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",s=new RegExp("<(/?)(["+r+"]["+i+"]*)","g");e.registerHelper("fold","xml",function(e,n){var r=new o(e,n.line,0);for(;;){var i=h(r),s;if(!i||r.line!=n.line||!(s=l(r)))return;if(!i[1]&&s!="selfClose"){var n=t(r.line,r.ch),u=d(r,i[2]);return u&&{from:n,to:u.from}}}}),e.findMatchingTag=function(e,r,i){var s=new o(e,r.line,r.ch,i);if(s.text.indexOf(">")==-1&&s.text.indexOf("<")==-1)return;var u=l(s),a=u&&t(s.line,s.ch),f=u&&c(s);if(!u||!f||n(s,r)>0)return;var h={from:t(s.line,s.ch),to:a,tag:f[2]};return u=="selfClose"?{open:h,close:null,at:"open"}:f[1]?{open:v(s,f[2]),close:h,at:"close"}:(s=new o(e,a.line,a.ch,i),{open:h,close:d(s,f[2]),at:"open"})},e.findEnclosingTag=function(e,t,n){var r=new o(e,t.line,t.ch,n);for(;;){var i=v(r);if(!i)break;var s=new o(e,t.line,t.ch,n),u=d(s,i.tag);if(u)return{open:i,close:u}}},e.scanForClosingTag=function(e,t,n,r){var i=new o(e,t.line,t.ch,r?{from:0,to:r}:null);return d(i,n)}}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror"),require("../fold/xml-fold")):typeof define=="function"&&define.amd?define("thirdparty/CodeMirror2/addon/edit/matchtags",["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(e){function t(e){e.state.tagHit&&e.state.tagHit.clear(),e.state.tagOther&&e.state.tagOther.clear(),e.state.tagHit=e.state.tagOther=null}function n(n){n.state.failedTagMatch=!1,n.operation(function(){t(n);if(n.somethingSelected())return;var r=n.getCursor(),i=n.getViewport();i.from=Math.min(i.from,r.line),i.to=Math.max(r.line+1,i.to);var s=e.findMatchingTag(n,r,i);if(!s)return;if(n.state.matchBothTags){var o=s.at=="open"?s.open:s.close;o&&(n.state.tagHit=n.markText(o.from,o.to,{className:"CodeMirror-matchingtag"}))}var u=s.at=="close"?s.open:s.close;u?n.state.tagOther=n.markText(u.from,u.to,{className:"CodeMirror-matchingtag"}):n.state.failedTagMatch=!0})}function r(e){e.state.failedTagMatch&&n(e)}e.defineOption("matchTags",!1,function(i,s,o){o&&o!=e.Init&&(i.off("cursorActivity",n),i.off("viewportChange",r),t(i)),s&&(i.state.matchBothTags=typeof s=="object"&&s.bothTags,i.on("cursorActivity",n),i.on("viewportChange",r),n(i))}),e.commands.toMatchingTag=function(t){var n=e.findMatchingTag(t,t.getCursor());if(n){var r=n.at=="close"?n.open:n.close;r&&t.extendSelection(r.to,r.from)}}}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define("thirdparty/CodeMirror2/addon/edit/matchbrackets",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function i(e,t,i,o){var u=e.getLineHandle(t.line),a=t.ch-1,f=a>=0&&r[u.text.charAt(a)]||r[u.text.charAt(++a)];if(!f)return null;var l=f.charAt(1)==">"?1:-1;if(i&&l>0!=(a==t.ch))return null;var c=e.getTokenTypeAt(n(t.line,a+1)),h=s(e,n(t.line,a+(l>0?1:0)),l,c||null,o);return h==null?null:{from:n(t.line,a),to:h&&h.pos,match:h&&h.ch==f.charAt(0),forward:l>0}}function s(e,t,i,s,o){var u=o&&o.maxScanLineLength||1e4,a=o&&o.maxScanLines||1e3,f=[],l=o&&o.bracketRegex?o.bracketRegex:/[(){}[\]]/,c=i>0?Math.min(t.line+a,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-a);for(var h=t.line;h!=c;h+=i){var p=e.getLine(h);if(!p)continue;var d=i>0?0:p.length-1,v=i>0?p.length:-1;if(p.length>u)continue;h==t.line&&(d=t.ch-(i<0?1:0));for(;d!=v;d+=i){var m=p.charAt(d);if(l.test(m)&&(s===undefined||e.getTokenTypeAt(n(h,d+1))==s)){var g=r[m];if(g.charAt(1)==">"==i>0)f.push(m);else{if(!f.length)return{pos:n(h,d),ch:m};f.pop()}}}}return h-i==(i>0?e.lastLine():e.firstLine())?!1:null}function o(e,r,s){var o=e.state.matchBrackets.maxHighlightLineLength||1e3,u=[],a=e.listSelections();for(var f=0;f<a.length;f++){var l=a[f].empty()&&i(e,a[f].head,!1,s);if(l&&e.getLine(l.from.line).length<=o){var c=l.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";u.push(e.markText(l.from,n(l.from.line,l.from.ch+1),{className:c})),l.to&&e.getLine(l.to.line).length<=o&&u.push(e.markText(l.to,n(l.to.line,l.to.ch+1),{className:c}))}}if(u.length){t&&e.state.focused&&e.display.input.focus();var h=function(){e.operation(function(){for(var e=0;e<u.length;e++)u[e].clear()})};if(!r)return h;setTimeout(h,800)}}function a(e){e.operation(function(){u&&(u(),u=null),u=o(e,!1,e.state.matchBrackets)})}var t=/MSIE \d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8),n=e.Pos,r={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},u=null;e.defineOption("matchBrackets",!1,function(t,n,r){r&&r!=e.Init&&t.off("cursorActivity",a),n&&(t.state.matchBrackets=typeof n=="object"?n:{},t.on("cursorActivity",a))}),e.defineExtension("matchBrackets",function(){o(this,!0)}),e.defineExtension("findMatchingBracket",function(e,t,n){return i(this,e,t,n)}),e.defineExtension("scanForBracket",function(e,t,n,r){return s(this,e,t,n,r)})}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define("thirdparty/CodeMirror2/addon/edit/closebrackets",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function s(e,t){var n=e.getRange(i(t.line,t.ch-1),i(t.line,t.ch+1));return n.length==2?n:null}function o(t,n,r){var i=t.getLine(n.line),s=t.getTokenAt(n);if(/\bstring2?\b/.test(s.type))return!1;var o=new e.StringStream(i.slice(0,n.ch)+r+i.slice(n.ch),4);o.pos=o.start=s.start;for(;;){var u=t.getMode().token(o,s.state);if(o.pos>=n.ch+1)return/\bstring2?\b/.test(u);o.start=o.pos}}function u(t){var n={name:"autoCloseBrackets",Backspace:function(n){if(n.getOption("disableInput"))return e.Pass;var r=n.listSelections();for(var o=0;o<r.length;o++){if(!r[o].empty())return e.Pass;var u=s(n,r[o].head);if(!u||t.indexOf(u)%2!=0)return e.Pass}for(var o=r.length-1;o>=0;o--){var a=r[o].head;n.replaceRange("",i(a.line,a.ch-1),i(a.line,a.ch+1))}}},u="";for(var a=0;a<t.length;a+=2)(function(t,s){t!=s&&(u+=s),n["'"+t+"'"]=function(n){if(n.getOption("disableInput"))return e.Pass;var a=n.listSelections(),f,l;for(var c=0;c<a.length;c++){var h=a[c],p=h.head,d,l=n.getRange(p,i(p.line,p.ch+1));if(!h.empty())d="surround";else if(t==s&&l==s)n.getRange(p,i(p.line,p.ch+3))==t+t+t?d="skipThree":d="skip";else if(t==s&&p.ch>1&&n.getRange(i(p.line,p.ch-2),p)==t+t&&(p.ch<=2||n.getRange(i(p.line,p.ch-3),i(p.line,p.ch-2))!=t))d="addFour";else if(t=='"'||t=="'"){if(!!e.isWordChar(l)||!o(n,p,t))return e.Pass;d="both"}else{if(!(n.getLine(p.line).length==p.ch||u.indexOf(l)>=0||r.test(l)))return e.Pass;d="both"}if(!f)f=d;else if(f!=d)return e.Pass}n.operation(function(){if(f=="skip")n.execCommand("goCharRight");else if(f=="skipThree")for(var e=0;e<3;e++)n.execCommand("goCharRight");else if(f=="surround"){var r=n.getSelections();for(var e=0;e<r.length;e++)r[e]=t+r[e]+s;n.replaceSelections(r,"around")}else f=="both"?(n.replaceSelection(t+s,null),n.execCommand("goCharLeft")):f=="addFour"&&(n.replaceSelection(t+t+t+t,"before"),n.execCommand("goCharRight"))})},t!=s&&(n["'"+s+"'"]=function(t){var n=t.listSelections();for(var r=0;r<n.length;r++){var o=n[r];if(!o.empty()||t.getRange(o.head,i(o.head.line,o.head.ch+1))!=s)return e.Pass}t.execCommand("goCharRight")})})(t.charAt(a),t.charAt(a+1));return n}function a(t){return function(n){if(n.getOption("disableInput"))return e.Pass;var r=n.listSelections();for(var i=0;i<r.length;i++){if(!r[i].empty())return e.Pass;var o=s(n,r[i].head);if(!o||t.indexOf(o)%2!=0)return e.Pass}n.operation(function(){n.replaceSelection("\n\n",null),n.execCommand("goCharLeft"),r=n.listSelections();for(var e=0;e<r.length;e++){var t=r[e].head.line;n.indentLine(t,null,!0),n.indentLine(t+1,null,!0)}})}}var t="()[]{}''\"\"",n="[]{}",r=/\s/,i=e.Pos;e.defineOption("autoCloseBrackets",!1,function(r,i,s){s!=e.Init&&s&&r.removeKeyMap("autoCloseBrackets");if(!i)return;var o=t,f=n;typeof i=="string"?o=i:typeof i=="object"&&(i.pairs!=null&&(o=i.pairs),i.explode!=null&&(f=i.explode));var l=u(o);f&&(l.Enter=a(f)),r.addKeyMap(l)})}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror"),require("../fold/xml-fold")):typeof define=="function"&&define.amd?define("thirdparty/CodeMirror2/addon/edit/closetag",["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(e){function r(r){if(r.getOption("disableInput"))return e.Pass;var i=r.listSelections(),u=[];for(var a=0;a<i.length;a++){if(!i[a].empty())return e.Pass;var f=i[a].head,l=r.getTokenAt(f),c=e.innerMode(r.getMode(),l.state),h=c.state;if(c.mode.name!="xml"||!h.tagName)return e.Pass;var p=r.getOption("autoCloseTags"),d=c.mode.configuration=="html",v=typeof p=="object"&&p.dontCloseTags||d&&t,m=typeof p=="object"&&p.indentTags||d&&n,g=h.tagName;l.end>f.ch&&(g=g.slice(0,g.length-l.end+f.ch));var y=g.toLowerCase();if(!g||l.type=="string"&&(l.end!=f.ch||!/[\"\']/.test(l.string.charAt(l.string.length-1))||l.string.length==1)||l.type=="tag"&&h.type=="closeTag"||l.string.indexOf("/")==l.string.length-1||v&&s(v,y)>-1||o(r,g,f,h,!0))return e.Pass;var b=m&&s(m,y)>-1;u[a]={indent:b,text:">"+(b?"\n\n":"")+"</"+g+">",newPos:b?e.Pos(f.line+1,0):e.Pos(f.line,f.ch+1)}}for(var a=i.length-1;a>=0;a--){var w=u[a];r.replaceRange(w.text,i[a].head,i[a].anchor,"+insert");var E=r.listSelections().slice(0);E[a]={head:w.newPos,anchor:w.newPos},r.setSelections(E),w.indent&&(r.indentLine(w.newPos.line,null,!0),r.indentLine(w.newPos.line+1,null,!0))}}function i(t){if(t.getOption("disableInput"))return e.Pass;var n=t.listSelections(),r=[];for(var i=0;i<n.length;i++){if(!n[i].empty())return e.Pass;var s=n[i].head,u=t.getTokenAt(s),a=e.innerMode(t.getMode(),u.state),f=a.state;if(u.type=="string"||u.string.charAt(0)!="<"||u.start!=s.ch-1||a.mode.name!="xml"||!f.context||!f.context.tagName||o(t,f.context.tagName,s,f))return e.Pass;r[i]="/"+f.context.tagName+">"}t.replaceSelections(r),n=t.listSelections();for(var i=0;i<n.length;i++)(i==n.length-1||n[i].head.line<n[i+1].head.line)&&t.indentLine(n[i].head.line)}function s(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;++n)if(e[n]==t)return n;return-1}function o(t,n,r,i,s){if(!e.scanForClosingTag)return!1;var o=Math.min(t.lastLine()+1,r.line+500),u=e.scanForClosingTag(t,r,null,o);if(!u||u.tag!=n)return!1;var a=i.context;for(var f=s?1:0;a&&a.tagName==n;a=a.prev)++f;r=u.to;for(var l=1;l<f;l++){var c=e.scanForClosingTag(t,r,null,o);if(!c||c.tag!=n)return!1;r=c.to}return!0}e.defineOption("autoCloseTags",!1,function(t,n,s){s!=e.Init&&s&&t.removeKeyMap("autoCloseTags");if(!n)return;var o={name:"autoCloseTags"};if(typeof n!="object"||n.whenClosing)o["'/'"]=function(e){return i(e)};if(typeof n!="object"||n.whenOpening)o["'>'"]=function(e){return r(e)};t.addKeyMap(o)});var t=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],n=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"]}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define("thirdparty/CodeMirror2/addon/scroll/scrollpastend",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(t,r){e.changeEnd(r).line==t.lastLine()&&n(t)}function n(e){var t="";if(e.lineCount()>1){var n=e.display.scroller.clientHeight-30,r=e.getLineHandle(e.lastLine()).height;t=n-r+"px"}e.state.scrollPastEndPadding!=t&&(e.state.scrollPastEndPadding=t,e.display.lineSpace.parentNode.style.paddingBottom=t,e.setSize())}e.defineOption("scrollPastEnd",!1,function(r,i,s){s&&s!=e.Init&&(r.off("change",t),r.off("refresh",n),r.display.lineSpace.parentNode.style.paddingBottom="",r.state.scrollPastEndPadding=null),i&&(r.on("change",t),r.on("refresh",n),n(r))})}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define("thirdparty/CodeMirror2/addon/selection/active-line",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function r(e){for(var r=0;r<e.state.activeLines.length;r++)e.removeLineClass(e.state.activeLines[r],"wrap",t),e.removeLineClass(e.state.activeLines[r],"background",n)}function i(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function s(e,s){var o=[];for(var u=0;u<s.length;u++){var a=s[u];if(!a.empty())continue;var f=e.getLineHandleVisualStart(a.head.line);o[o.length-1]!=f&&o.push(f)}if(i(e.state.activeLines,o))return;e.operation(function(){r(e);for(var i=0;i<o.length;i++)e.addLineClass(o[i],"wrap",t),e.addLineClass(o[i],"background",n);e.state.activeLines=o})}function o(e,t){s(e,t.ranges)}var t="CodeMirror-activeline",n="CodeMirror-activeline-background";e.defineOption("styleActiveLine",!1,function(t,n,i){var u=i&&i!=e.Init;n&&!u?(t.state.activeLines=[],s(t,t.listSelections()),t.on("beforeSelectionChange",o)):!n&&u&&(t.off("beforeSelectionChange",o),r(t),delete t.state.activeLines)})}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define("thirdparty/CodeMirror2/addon/selection/mark-selection",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e){e.operation(function(){f(e)})}function n(e){e.state.markedSelection.length&&e.operation(function(){u(e)})}function o(e,t,n,o){if(s(t,n)==0)return;var u=e.state.markedSelection,a=e.state.markedSelectionStyle;for(var f=t.line;;){var l=f==t.line?t:i(f,0),c=f+r,h=c>=n.line,p=h?n:i(c,0),d=e.markText(l,p,{className:a});o==null?u.push(d):u.splice(o++,0,d);if(h)break;f=c}}function u(e){var t=e.state.markedSelection;for(var n=0;n<t.length;++n)t[n].clear();t.length=0}function a(e){u(e);var t=e.listSelections();for(var n=0;n<t.length;n++)o(e,t[n].from(),t[n].to())}function f(e){if(!e.somethingSelected())return u(e);if(e.listSelections().length>1)return a(e);var t=e.getCursor("start"),n=e.getCursor("end"),i=e.state.markedSelection;if(!i.length)return o(e,t,n);var f=i[0].find(),l=i[i.length-1].find();if(!f||!l||n.line-t.line<r||s(t,l.to)>=0||s(n,f.from)<=0)return a(e);while(s(t,f.from)>0)i.shift().clear(),f=i[0].find();s(t,f.from)<0&&(f.to.line-t.line<r?(i.shift().clear(),o(e,t,f.to,0)):o(e,t,f.from,0));while(s(n,l.to)<0)i.pop().clear(),l=i[i.length-1].find();s(n,l.to)>0&&(n.line-l.from.line<r?(i.pop().clear(),o(e,l.from,n)):o(e,l.to,n))}e.defineOption("styleSelectedText",!1,function(r,i,s){var o=s&&s!=e.Init;i&&!o?(r.state.markedSelection=[],r.state.markedSelectionStyle=typeof i=="string"?i:"CodeMirror-selectedtext",a(r),r.on("cursorActivity",t),r.on("change",n)):!i&&o&&(r.off("cursorActivity",t),r.off("change",n),u(r),r.state.markedSelection=r.state.markedSelectionStyle=null)});var r=8,i=e.Pos,s=e.cmpPos}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define("thirdparty/CodeMirror2/addon/mode/multiplex",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){e.multiplexingMode=function(t){function i(e,t,n){if(typeof t=="string")return e.indexOf(t,n);var r=t.exec(n?e.slice(n):e);return r?r.index+n:-1}var n=Array.prototype.slice.call(arguments,1),r=n.length;return{startState:function(){return{outer:e.startState(t),innerActive:null,inner:null}},copyState:function(n){return{outer:e.copyState(t,n.outer),innerActive:n.innerActive,inner:n.innerActive&&e.copyState(n.innerActive.mode,n.inner)}},token:function(s,o){if(!o.innerActive){var u=Infinity,a=s.string;for(var f=0;f<r;++f){var l=n[f],c=i(a,l.open,s.pos);if(c==s.pos)return s.match(l.open),o.innerActive=l,o.inner=e.startState(l.mode,t.indent?t.indent(o.outer,""):0),l.delimStyle;c!=-1&&c<u&&(u=c)}u!=Infinity&&(s.string=a.slice(0,u));var h=t.token(s,o.outer);return u!=Infinity&&(s.string=a),h}var p=o.innerActive,a=s.string;if(!p.close&&s.sol())return o.innerActive=o.inner=null,this.token(s,o);var c=p.close?i(a,p.close,s.pos):-1;if(c==s.pos)return s.match(p.close),o.innerActive=o.inner=null,p.delimStyle;c>-1&&(s.string=a.slice(0,c));var d=p.mode.token(s,o.inner);return c>-1&&(s.string=a),p.innerStyle&&(d?d=d+" "+p.innerStyle:d=p.innerStyle),d},indent:function(n,r){var i=n.innerActive?n.innerActive.mode:t;return i.indent?i.indent(n.innerActive?n.inner:n.outer,r):e.Pass},blankLine:function(i){var s=i.innerActive?i.innerActive.mode:t;s.blankLine&&s.blankLine(i.innerActive?i.inner:i.outer);if(!i.innerActive)for(var o=0;o<r;++o){var u=n[o];u.open==="\n"&&(i.innerActive=u,i.inner=e.startState(u.mode,s.indent?s.indent(i.outer,""):0))}else i.innerActive.close==="\n"&&(i.innerActive=i.inner=null)},electricChars:t.electricChars,innerMode:function(e){return e.inner?{state:e.inner,mode:e.innerActive.mode}:{state:e.outer,mode:t}}}}}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define("thirdparty/CodeMirror2/addon/mode/overlay",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){e.overlayMode=function(t,n,r){return{startState:function(){return{base:e.startState(t),overlay:e.startState(n),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,lineSeen:null}},copyState:function(r){return{base:e.copyState(t,r.base),overlay:e.copyState(n,r.overlay),basePos:r.basePos,baseCur:null,overlayPos:r.overlayPos,overlayCur:null}},token:function(e,i){if(e.sol()||e.string!=i.lineSeen||Math.min(i.basePos,i.overlayPos)<e.start)i.lineSeen=e.string,i.basePos=i.overlayPos=e.start;return e.start==i.basePos&&(i.baseCur=t.token(e,i.base),i.basePos=e.pos),e.start==i.overlayPos&&(e.pos=e.start,i.overlayCur=n.token(e,i.overlay),i.overlayPos=e.pos),e.pos=Math.min(i.basePos,i.overlayPos),i.overlayCur==null?i.baseCur:i.baseCur!=null&&i.overlay.combineTokens||r&&i.overlay.combineTokens==null?i.baseCur+" "+i.overlayCur:i.overlayCur},indent:t.indent&&function(e,n){return t.indent(e.base,n)},electricChars:t.electricChars,innerMode:function(e){return{state:e.base,mode:t}},blankLine:function(e){t.blankLine&&t.blankLine(e.base),n.blankLine&&n.blankLine(e.overlay)}}}}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define("thirdparty/CodeMirror2/addon/search/match-highlighter",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function i(e){typeof e=="object"&&(this.minChars=e.minChars,this.style=e.style,this.showToken=e.showToken,this.delay=e.delay),this.style==null&&(this.style=n),this.minChars==null&&(this.minChars=t),this.delay==null&&(this.delay=r),this.overlay=this.timeout=null}function s(e){var t=e.state.matchHighlighter;clearTimeout(t.timeout),t.timeout=setTimeout(function(){o(e)},t.delay)}function o(e){e.operation(function(){var t=e.state.matchHighlighter;t.overlay&&(e.removeOverlay(t.overlay),t.overlay=null);if(!e.somethingSelected()&&t.showToken){var n=t.showToken===!0?/[\w$]/:t.showToken,r=e.getCursor(),i=e.getLine(r.line),s=r.ch,o=s;while(s&&n.test(i.charAt(s-1)))--s;while(o<i.length&&n.test(i.charAt(o)))++o;s<o&&e.addOverlay(t.overlay=a(i.slice(s,o),n,t.style));return}var u=e.getCursor("from"),f=e.getCursor("to");if(u.line!=f.line)return;var l=e.getRange(u,f).replace(/^\s+|\s+$/g,"");l.length>=t.minChars&&e.addOverlay(t.overlay=a(l,!1,t.style))})}function u(e,t){return(!e.start||!t.test(e.string.charAt(e.start-1)))&&(e.pos==e.string.length||!t.test(e.string.charAt(e.pos)))}function a(e,t,n){return{token:function(r){if(r.match(e)&&(!t||u(r,t)))return n;r.next(),r.skipTo(e.charAt(0))||r.skipToEnd()}}}var t=2,n="matchhighlight",r=100;e.defineOption("highlightSelectionMatches",!1,function(t,n,r){if(r&&r!=e.Init){var u=t.state.matchHighlighter.overlay;u&&t.removeOverlay(u),clearTimeout(t.state.matchHighlighter.timeout),t.state.matchHighlighter=null,t.off("cursorActivity",s)}n&&(t.state.matchHighlighter=new i(n),o(t),t.on("cursorActivity",s))})}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define("thirdparty/CodeMirror2/addon/search/searchcursor",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function n(e,n,i,s){this.atOccurrence=!1,this.doc=e,s==null&&typeof n=="string"&&(s=!1),i=i?e.clipPos(i):t(0,0),this.pos={from:i,to:i};if(typeof n!="string")n.global||(n=new RegExp(n.source,n.ignoreCase?"ig":"g")),this.matches=function(r,i){if(r){n.lastIndex=0;var s=e.getLine(i.line).slice(0,i.ch),o=0,u,a;for(;;){n.lastIndex=o;var f=n.exec(s);if(!f)break;u=f,a=u.index,o=u.index+(u[0].length||1);if(o==s.length)break}var l=u&&u[0].length||0;l||(a==0&&s.length==0?u=undefined:a!=e.getLine(i.line).length&&l++)}else{n.lastIndex=i.ch;var s=e.getLine(i.line),u=n.exec(s),l=u&&u[0].length||0,a=u&&u.index;a+l!=s.length&&!l&&(l=1)}if(u&&l)return{from:t(i.line,a),to:t(i.line,a+l),match:u}};else{var o=n;s&&(n=n.toLowerCase());var u=s?function(e){return e.toLowerCase()}:function(e){return e},a=n.split("\n");if(a.length==1)n.length?this.matches=function(i,s){if(i){var a=e.getLine(s.line).slice(0,s.ch),f=u(a),l=f.lastIndexOf(n);if(l>-1)return l=r(a,f,l),{from:t(s.line,l),to:t(s.line,l+o.length)}}else{var a=e.getLine(s.line).slice(s.ch),f=u(a),l=f.indexOf(n);if(l>-1)return l=r(a,f,l)+s.ch,{from:t(s.line,l),to:t(s.line,l+o.length)}}}:this.matches=function(){};else{var f=o.split("\n");this.matches=function(n,r){var i=a.length-1;if(n){if(r.line-(a.length-1)<e.firstLine())return;if(u(e.getLine(r.line).slice(0,f[i].length))!=a[a.length-1])return;var s=t(r.line,f[i].length);for(var o=r.line-1,l=i-1;l>=1;--l,--o)if(a[l]!=u(e.getLine(o)))return;var c=e.getLine(o),h=c.length-f[0].length;if(u(c.slice(h))!=a[0])return;return{from:t(o,h),to:s}}if(r.line+(a.length-1)>e.lastLine())return;var c=e.getLine(r.line),h=c.length-f[0].length;if(u(c.slice(h))!=a[0])return;var p=t(r.line,h);for(var o=r.line+1,l=1;l<i;++l,++o)if(a[l]!=u(e.getLine(o)))return;if(u(e.getLine(o).slice(0,f[i].length))!=a[i])return;return{from:p,to:t(o,f[i].length)}}}}}function r(e,t,n){if(e.length==t.length)return n;for(var r=Math.min(n,e.length);;){var i=e.slice(0,r).toLowerCase().length;if(i<n)++r;else{if(!(i>n))return r;--r}}}var t=e.Pos;n.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){function i(e){var r=t(e,0);return n.pos={from:r,to:r},n.atOccurrence=!1,!1}var n=this,r=this.doc.clipPos(e?this.pos.from:this.pos.to);for(;;){if(this.pos=this.matches(e,r))return this.atOccurrence=!0,this.pos.match||!0;if(e){if(!r.line)return i(0);r=t(r.line-1,this.doc.getLine(r.line-1).length)}else{var s=this.doc.lineCount();if(r.line==s-1)return i(s);r=t(r.line+1,0)}}},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(n){if(!this.atOccurrence)return;var r=e.splitLines(n);this.doc.replaceRange(r,this.pos.from,this.pos.to),this.pos.to=t(this.pos.from.line+r.length-1,r[r.length-1].length+(r.length==1?this.pos.from.ch:0))}},e.defineExtension("getSearchCursor",function(e,t,r){return new n(this.doc,e,t,r)}),e.defineDocExtension("getSearchCursor",function(e,t,r){return new n(this,e,t,r)}),e.defineExtension("selectMatches",function(t,n){var r=[],i,s=this.getSearchCursor(t,this.getCursor("from"),n);while(i=s.findNext()){if(e.cmpPos(s.to(),this.getCursor("to"))>0)break;r.push({anchor:s.from(),head:s.to()})}r.length&&this.setSelections(r,0)})}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/edit/matchbrackets")):typeof define=="function"&&define.amd?define("thirdparty/CodeMirror2/keymap/sublime",["../lib/codemirror","../addon/search/searchcursor","../addon/edit/matchbrackets"],e):e(CodeMirror)}(function(e){function o(t,n,i){if(i<0&&n.ch==0)return t.clipPos(r(n.line-1));var s=t.getLine(n.line);if(i>0&&n.ch>=s.length)return t.clipPos(r(n.line+1,0));var o="start",u;for(var a=n.ch,f=i<0?0:s.length,l=0;a!=f;a+=i,l++){var c=s.charAt(i<0?a-1:a),h=c!="_"&&e.isWordChar(c)?"w":"o";h=="w"&&c.toUpperCase()==c&&(h="W");if(o=="start")h!="o"&&(o="in",u=h);else if(o=="in"&&u!=h){u=="w"&&h=="W"&&i<0&&a--;if(u=="W"&&h=="w"&&i>0){u="w";continue}break}}return r(n.line,a)}function u(e,t){e.extendSelectionsBy(function(n){return e.display.shift||e.doc.extend||n.empty()?o(e.doc,n.head,t):t<0?n.from():n.to()})}function a(e,t){e.operation(function(){var n=e.listSelections().length,i=[],s=-1;for(var o=0;o<n;o++){var u=e.listSelections()[o].head;if(u.line<=s)continue;var a=r(u.line+(t?0:1),0);e.replaceRange("\n",a,null,"+insertLine"),e.indentLine(a.line,null,!0),i.push({head:a,anchor:a}),s=u.line+1}e.setSelections(i)})}function f(t,n){var i=n.ch,s=i,o=t.getLine(n.line);while(i&&e.isWordChar(o.charAt(i-1)))--i;while(s<o.length&&e.isWordChar(o.charAt(s)))++s;return{from:r(n.line,i),to:r(n.line,s),word:o.slice(i,s)}}function c(e){var t=e.getCursor(),n=e.scanForBracket(t,-1);if(!n)return;for(;;){var i=e.scanForBracket(t,1);if(!i)return;if(i.ch==l.charAt(l.indexOf(n.ch)+1))return e.setSelection(r(n.pos.line,n.pos.ch+1),i.pos,!1),!0;t=r(i.pos.line,i.pos.ch+1)}}function p(e,t){var n=e.listSelections(),i=[],s;for(var o=0;o<n.length;o++){var u=n[o];if(u.empty())continue;var a=u.from().line,f=u.to().line;while(o<n.length-1&&n[o+1].from().line==f)f=u[++o].to().line;i.push(a,f)}i.length?s=!0:i.push(e.firstLine(),e.lastLine()),e.operation(function(){var n=[];for(var o=0;o<i.length;o+=2){var u=i[o],a=i[o+1],f=r(u,0),l=r(a),c=e.getRange(f,l,!1);t?c.sort():c.sort(function(e,t){var n=e.toUpperCase(),r=t.toUpperCase();return n!=r&&(e=n,t=r),e<t?-1:e==t?0:1}),e.replaceRange(c,f,l),s&&n.push({anchor:f,head:l})}s&&e.setSelections(n,0)})}function v(t,n){t.operation(function(){var r=t.listSelections(),i=[],s=[];for(var o=0;o<r.length;o++){var u=r[o];u.empty()?(i.push(o),s.push("")):s.push(n(t.getRange(u.from(),u.to())))}t.replaceSelections(s,"around","case");for(var o=i.length-1,a;o>=0;o--){var u=r[i[o]];if(a&&e.cmpPos(u.head,a)>0)continue;var l=f(t,u.head);a=l.from,t.replaceRange(n(l.word),l.from,l.to)}})}function m(t){var n=t.getCursor("from"),r=t.getCursor("to");if(e.cmpPos(n,r)==0){var i=f(t,n);if(!i.word)return;n=i.from,r=i.to}return{from:n,to:r,query:t.getRange(n,r),word:i}}function g(e,t){var n=m(e);if(!n)return;var i=n.query,s=e.getSearchCursor(i,t?n.to:n.from);(t?s.findNext():s.findPrevious())?e.setSelection(s.from(),s.to()):(s=e.getSearchCursor(i,t?r(e.firstLine(),0):e.clipPos(r(e.lastLine()))),(t?s.findNext():s.findPrevious())?e.setSelection(s.from(),s.to()):n.word&&e.setSelection(n.from,n.to))}var t=e.keyMap.sublime={fallthrough:"default"},n=e.commands,r=e.Pos,i=e.keyMap["default"]==e.keyMap.macDefault,s=i?"Cmd-":"Ctrl-";n[t["Alt-Left"]="goSubwordLeft"]=function(e){u(e,-1)},n[t["Alt-Right"]="goSubwordRight"]=function(e){u(e,1)},n[t[s+"Up"]="scrollLineUp"]=function(e){var t=e.getScrollInfo();if(!e.somethingSelected()){var n=e.lineAtHeight(t.top+t.clientHeight,"local");e.getCursor().line>=n&&e.execCommand("goLineUp")}e.scrollTo(null,t.top-e.defaultTextHeight())},n[t[s+"Down"]="scrollLineDown"]=function(e){var t=e.getScrollInfo();if(!e.somethingSelected()){var n=e.lineAtHeight(t.top,"local")+1;e.getCursor().line<=n&&e.execCommand("goLineDown")}e.scrollTo(null,t.top+e.defaultTextHeight())},n[t["Shift-"+s+"L"]="splitSelectionByLine"]=function(e){var t=e.listSelections(),n=[];for(var i=0;i<t.length;i++){var s=t[i].from(),o=t[i].to();for(var u=s.line;u<=o.line;++u)o.line>s.line&&u==o.line&&o.ch==0||n.push({anchor:u==s.line?s:r(u,0),head:u==o.line?o:r(u)})}e.setSelections(n,0)},t["Shift-Tab"]="indentLess",n[t.Esc="singleSelectionTop"]=function(e){var t=e.listSelections()[0];e.setSelection(t.anchor,t.head,{scroll:!1})},n[t[s+"L"]="selectLine"]=function(e){var t=e.listSelections(),n=[];for(var i=0;i<t.length;i++){var s=t[i];n.push({anchor:r(s.from().line,0),head:r(s.to().line+1,0)})}e.setSelections(n)},t["Shift-"+s+"K"]="deleteLine",n[t[s+"Enter"]="insertLineAfter"]=function(e){a(e,!1)},n[t["Shift-"+s+"Enter"]="insertLineBefore"]=function(e){a(e,!0)},n[t[s+"D"]="selectNextOccurrence"]=function(t){var n=t.getCursor("from"),i=t.getCursor("to"),s=t.state.sublimeFindFullWord==t.doc.sel;if(e.cmpPos(n,i)==0){var o=f(t,n);if(!o.word)return;t.setSelection(o.from,o.to),s=!0}else{var u=t.getRange(n,i),a=s?new RegExp("\\b"+u+"\\b"):u,l=t.getSearchCursor(a,i);l.findNext()?t.addSelection(l.from(),l.to()):(l=t.getSearchCursor(a,r(t.firstLine(),0)),l.findNext()&&t.addSelection(l.from(),l.to()))}s&&(t.state.sublimeFindFullWord=t.doc.sel)};var l="(){}[]";n[t["Shift-"+s+"Space"]="selectScope"]=function(e){c(e)||e.execCommand("selectAll")},n[t["Shift-"+s+"M"]="selectBetweenBrackets"]=function(t){if(!c(t))return e.Pass},n[t[s+"M"]="goToBracket"]=function(t){t.extendSelectionsBy(function(n){var i=t.scanForBracket(n.head,1);if(i&&e.cmpPos(i.pos,n.head)!=0)return i.pos;var s=t.scanForBracket(n.head,-1);return s&&r(s.pos.line,s.pos.ch+1)||n.head})};var h=i?"Cmd-Ctrl-":"Shift-Ctrl-";n[t[h+"Up"]="swapLineUp"]=function(e){var t=e.listSelections(),n=[],i=e.firstLine()-1,s=[];for(var o=0;o<t.length;o++){var u=t[o],a=u.from().line-1,f=u.to().line;s.push({anchor:r(u.anchor.line-1,u.anchor.ch),head:r(u.head.line-1,u.head.ch)}),u.to().ch==0&&!u.empty()&&--f,a>i?n.push(a,f):n.length&&(n[n.length-1]=f),i=f}e.operation(function(){for(var t=0;t<n.length;t+=2){var i=n[t],o=n[t+1],u=e.getLine(i);e.replaceRange("",r(i,0),r(i+1,0),"+swapLine"),o>e.lastLine()?e.replaceRange("\n"+u,r(e.lastLine()),null,"+swapLine"):e.replaceRange(u+"\n",r(o,0),null,"+swapLine")}e.setSelections(s),e.scrollIntoView()})},n[t[h+"Down"]="swapLineDown"]=function(e){var t=e.listSelections(),n=[],i=e.lastLine()+1;for(var s=t.length-1;s>=0;s--){var o=t[s],u=o.to().line+1,a=o.from().line;o.to().ch==0&&!o.empty()&&u--,u<i?n.push(u,a):n.length&&(n[n.length-1]=a),i=a}e.operation(function(){for(var t=n.length-2;t>=0;t-=2){var i=n[t],s=n[t+1],o=e.getLine(i);i==e.lastLine()?e.replaceRange("",r(i-1),r(i),"+swapLine"):e.replaceRange("",r(i,0),r(i+1,0),"+swapLine"),e.replaceRange(o+"\n",r(s,0),null,"+swapLine")}e.scrollIntoView()})},t[s+"/"]="toggleComment",n[t[s+"J"]="joinLines"]=function(e){var t=e.listSelections(),n=[];for(var i=0;i<t.length;i++){var s=t[i],o=s.from(),u=o.line,a=s.to().line;while(i<t.length-1&&t[i+1].from().line==a)a=t[++i].to().line;n.push({start:u,end:a,anchor:!s.empty()&&o})}e.operation(function(){var t=0,i=[];for(var s=0;s<n.length;s++){var o=n[s],u=o.anchor&&r(o.anchor.line-t,o.anchor.ch),a;for(var f=o.start;f<=o.end;f++){var l=f-t;f==o.end&&(a=r(l,e.getLine(l).length+1)),l<e.lastLine()&&(e.replaceRange(" ",r(l),r(l+1,/^\s*/.exec(e.getLine(l+1))[0].length)),++t)}i.push({anchor:u||a,head:a})}e.setSelections(i,0)})},n[t["Shift-"+s+"D"]="duplicateLine"]=function(e){e.operation(function(){var t=e.listSelections().length;for(var n=0;n<t;n++){var i=e.listSelections()[n];i.empty()?e.replaceRange(e.getLine(i.head.line)+"\n",r(i.head.line,0)):e.replaceRange(e.getRange(i.from(),i.to()),i.from())}e.scrollIntoView()})},t[s+"T"]="transposeChars",n[t.F9="sortLines"]=function(e){p(e,!0)},n[t[s+"F9"]="sortLinesInsensitive"]=function(e){p(e,!1)},n[t.F2="nextBookmark"]=function(e){var t=e.state.sublimeBookmarks;if(t)while(t.length){var n=t.shift(),r=n.find();if(r)return t.push(n),e.setSelection(r.from,r.to)}},n[t["Shift-F2"]="prevBookmark"]=function(e){var t=e.state.sublimeBookmarks;if(t)while(t.length){t.unshift(t.pop());var n=t[t.length-1].find();if(!!n)return e.setSelection(n.from,n.to);t.pop()}},n[t[s+"F2"]="toggleBookmark"]=function(e){var t=e.listSelections(),n=e.state.sublimeBookmarks||(e.state.sublimeBookmarks=[]);for(var r=0;r<t.length;r++){var i=t[r].from(),s=t[r].to(),o=e.findMarks(i,s);for(var u=0;u<o.length;u++)if(o[u].sublimeBookmark){o[u].clear();for(var a=0;a<n.length;a++)n[a]==o[u]&&n.splice(a--,1);break}u==o.length&&n.push(e.markText(i,s,{sublimeBookmark:!0,clearWhenEmpty:!1}))}},n[t["Shift-"+s+"F2"]="clearBookmarks"]=function(e){var t=e.state.sublimeBookmarks;if(t)for(var n=0;n<t.length;n++)t[n].clear();t.length=0},n[t["Alt-F2"]="selectBookmarks"]=function(e){var t=e.state.sublimeBookmarks,n=[];if(t)for(var r=0;r<t.length;r++){var i=t[r].find();i?n.push({anchor:i.from,head:i.to}):t.splice(r--,0)}n.length&&e.setSelections(n,0)},t["Alt-Q"]="wrapLines";var d=e.keyMap["sublime-Ctrl-K"]={auto:"sublime",nofallthrough:!0};t[s+"K"]=function(e){e.setOption("keyMap","sublime-Ctrl-K")},d[s+"Backspace"]="delLineLeft",n[d[s+"K"]="delLineRight"]=function(e){e.operation(function(){var t=e.listSelections();for(var n=t.length-1;n>=0;n--)e.replaceRange("",t[n].anchor,r(t[n].to().line),"+delete");e.scrollIntoView()})},n[d[s+"U"]="upcaseAtCursor"]=function(e){v(e,function(e){return e.toUpperCase()})},n[d[s+"L"]="downcaseAtCursor"]=function(e){v(e,function(e){return e.toLowerCase()})},n[d[s+"Space"]="setSublimeMark"]=function(e){e.state.sublimeMark&&e.state.sublimeMark.clear(),e.state.sublimeMark=e.setBookmark(e.getCursor())},n[d[s+"A"]="selectToSublimeMark"]=function(e){var t=e.state.sublimeMark&&e.state.sublimeMark.find();t&&e.setSelection(e.getCursor(),t)},n[d[s+"W"]="deleteToSublimeMark"]=function(t){var n=t.state.sublimeMark&&t.state.sublimeMark.find();if(n){var r=t.getCursor(),i=n;if(e.cmpPos(r,i)>0){var s=i;i=r,r=s}t.state.sublimeKilled=t.getRange(r,i),t.replaceRange("",r,i)}},n[d[s+"X"]="swapWithSublimeMark"]=function(e){var t=e.state.sublimeMark&&e.state.sublimeMark.find();t&&(e.state.sublimeMark.clear(),e.state.sublimeMark=e.setBookmark(e.getCursor()),e.setCursor(t))},n[d[s+"Y"]="sublimeYank"]=function(e){e.state.sublimeKilled!=null&&e.replaceSelection(e.state.sublimeKilled,null,"paste")},d[s+"G"]="clearBookmarks",n[d[s+"C"]="showInCenter"]=function(e){var t=e.cursorCoords(null,"local");e.scrollTo(null,(t.top+t.bottom)/2-e.getScrollInfo().clientHeight/2)},n[t["Shift-Alt-Up"]="selectLinesUpward"]=function(e){e.operation(function(){var t=e.listSelections();for(var n=0;n<t.length;n++){var i=t[n];i.head.line>e.firstLine()&&e.addSelection(r(i.head.line-1,i.head.ch))}})},n[t["Shift-Alt-Down"]="selectLinesDownward"]=function(e){e.operation(function(){var t=e.listSelections();for(var n=0;n<t.length;n++){var i=t[n];i.head.line<e.lastLine()&&e.addSelection(r(i.head.line+1,i.head.ch))}})},n[t[s+"F3"]="findUnder"]=function(e){g(e,!0)},n[t["Shift-"+s+"F3"]="findUnderPrevious"]=function(e){g(e,!1)},n[t["Alt-F3"]="findAllUnder"]=function(e){var t=m(e);if(!t)return;var n=e.getSearchCursor(t.query),r=[],i=-1;while(n.findNext())r.push({anchor:n.from(),head:n.to()}),n.from().line<=t.from.line&&n.from().ch<=t.from.ch&&i++;e.setSelections(r,i)},t["Shift-"+s+"["]="fold",t["Shift-"+s+"]"]="unfold",d[s+"0"]=d[s+"j"]="unfoldAll",t[s+"I"]="findIncremental",t["Shift-"+s+"I"]="findIncrementalReverse",t[s+"H"]="replace",t.F3="findNext",t["Shift-F3"]="findPrev"}),define("text",["module"],function(e){var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.10",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}d.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!config.json",[],function(){return'{\n    "config": {\n        "app_title": "Brackets",\n        "app_name_about": "Brackets",\n        "about_icon": "styles/images/brackets_icon.svg",\n        "update_info_url": "http://s3.amazonaws.com/files.brackets.io/updates/stable/",\n        "how_to_use_url": "https://github.com/adobe/brackets/wiki/How-to-Use-Brackets",\n        "support_url": "https://github.com/adobe/brackets/wiki/Troubleshooting",\n        "suggest_feature_url": "https://github.com/adobe/brackets/wiki/Suggest-a-Feature",\n        "get_involved_url": "https://github.com/adobe/brackets/blob/master/CONTRIBUTING.md",\n        "glob_help_url": "https://github.com/adobe/brackets/wiki/Using-File-Filters",\n        "release_notes_url": "https://github.com/adobe/brackets/wiki/Release-Notes",\n        "homepage_url": "http://brackets.io",\n        "twitter_url": "https://twitter.com/brackets",\n        "troubleshoot_url": "https://github.com/adobe/brackets/wiki/Troubleshooting#wiki-livedev",\n        "twitter_name": "@brackets",\n        "contributors_url": "https://api.github.com/repos/adobe/brackets/contributors?per_page={0}&page={1}",\n        "extension_listing_url": "",\n        "extension_registry": "https://s3.amazonaws.com/extend.brackets/registry.json",\n        "extension_url": "https://s3.amazonaws.com/extend.brackets/{0}/{0}-{1}.zip",\n        "linting.enabled_by_default": true,\n        "build_timestamp": ""\n    },\n    "name": "Brackets",\n    "version": "0.43.0-0",\n    "apiVersion": "0.43.0",\n    "homepage": "http://brackets.io",\n    "issues": {\n        "url": "http://github.com/adobe/brackets/issues"\n    },\n    "repository": {\n        "type": "git",\n        "url": "https://github.com/adobe/brackets.git",\n        "branch": "",\n        "SHA": ""\n    },\n    "devDependencies": {\n        "grunt": "0.4.1",\n        "jasmine-node": "1.11.0",\n        "grunt-jasmine-node": "0.1.0",\n        "grunt-cli": "0.1.9",\n        "phantomjs": "1.9.0-1",\n        "grunt-lib-phantomjs": "0.3.0",\n        "grunt-contrib-jshint": "0.6.0",\n        "grunt-contrib-watch": "0.4.3",\n        "grunt-contrib-jasmine": "0.4.2",\n        "grunt-template-jasmine-requirejs": "0.1.0",\n        "grunt-contrib-cssmin": "0.6.0",\n        "grunt-contrib-clean": "0.4.1",\n        "grunt-contrib-copy": "0.4.1",\n        "grunt-contrib-htmlmin": "0.1.3",\n        "grunt-contrib-less": "0.8.2",\n        "grunt-contrib-requirejs": "0.4.1",\n        "grunt-contrib-uglify": "0.2.0",\n        "grunt-contrib-concat": "0.3.0",\n        "grunt-targethtml": "0.2.6",\n        "grunt-usemin": "0.1.11",\n        "load-grunt-tasks": "0.2.0",\n        "q": "0.9.2",\n        "jshint": "2.1.4",\n        "xmldoc": "^0.1.2"\n    },\n    "scripts": {\n        "postinstall": "grunt install",\n        "test": "grunt cla-check-pull test"\n    },\n    "licenses": [\n        {\n            "type": "MIT",\n            "url": "https://github.com/adobe/brackets/blob/master/LICENSE"\n        }\n    ]\n}'}),function(){function e(e,t,n){n=(n||0)-1;for(var r=e?e.length:0;++n<r;)if(e[n]===t)return n;return-1}function t(t,n){var r=typeof n;if(t=t.l,"boolean"==r||null==n)return t[n]?0:-1;"number"!=r&&"string"!=r&&(r="object");var i="number"==r?n:y+n;return t=(t=t[r])&&t[i],"object"==r?t&&-1<e(t,n)?0:-1:t?0:-1}function n(e){var t=this.l,n=typeof e;if("boolean"==n||null==e)t[e]=!0;else{"number"!=n&&"string"!=n&&(n="object");var r="number"==n?e:y+e,t=t[n]||(t[n]={});"object"==n?(t[r]||(t[r]=[])).push(e):t[r]=!0}}function r(e){return e.charCodeAt(0)}function i(e,t){var n=e.m,r=t.m;if(n!==r){if(n>r||typeof n=="undefined")return 1;if(n<r||typeof r=="undefined")return-1}return e.n-t.n}function s(e){var t=-1,r=e.length,i=e[0],s=e[0|r/2],o=e[r-1];if(i&&typeof i=="object"&&s&&typeof s=="object"&&o&&typeof o=="object")return!1;for(i=a(),i["false"]=i["null"]=i["true"]=i.undefined=!1,s=a(),s.k=e,s.l=i,s.push=n;++t<r;)s.push(e[t]);return s}function o(e){return"\\"+$[e]}function u(){return v.pop()||[]}function a(){return m.pop()||{k:null,l:null,m:null,"false":!1,n:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,"undefined":!1,o:null}}function f(){}function l(e){e.length=0,v.length<w&&v.push(e)}function c(e){var t=e.l;t&&c(t),e.k=e.l=e.m=e.object=e.number=e.string=e.o=null,m.length<w&&m.push(e)}function h(e,t,n){t||(t=0),typeof n=="undefined"&&(n=e?e.length:0);var r=-1;n=n-t||0;for(var i=Array(0>n?0:n);++r<n;)i[r]=e[t+r];return i}function p(n){function v(e){if(!e||Sn.call(e)!=q)return!1;var t=e.valueOf,n=typeof t=="function"&&(n=vn(t))&&vn(n);return n?e==n||vn(e)==n:ct(e)}function m(e,t,n){if(!e||!V[typeof e])return e;t=t&&typeof n=="undefined"?t:nt(t,n,3);for(var r=-1,i=V[typeof e]&&Un(e),s=i?i.length:0;++r<s&&(n=i[r],!1!==t(e[n],n,e)););return e}function w(e,t,n){var r;if(!e||!V[typeof e])return e;t=t&&typeof n=="undefined"?t:nt(t,n,3);for(r in e)if(!1===t(e[r],r,e))break;return e}function $(e,t,n){var r,i=e,s=i;if(!i)return s;for(var o=arguments,u=0,a=typeof n=="number"?2:o.length;++u<a;)if((i=o[u])&&V[typeof i])for(var f=-1,l=V[typeof i]&&Un(i),c=l?l.length:0;++f<c;)r=l[f],"undefined"==typeof s[r]&&(s[r]=i[r]);return s}function K(e,t,n){var r,i=e,s=i;if(!i)return s;var o=arguments,u=0,a=typeof n=="number"?2:o.length;if(3<a&&"function"==typeof o[a-2])var f=nt(o[--a-1],o[a--],2);else 2<a&&"function"==typeof o[a-1]&&(f=o[--a]);for(;++u<a;)if((i=o[u])&&V[typeof i])for(var l=-1,c=V[typeof i]&&Un(i),h=c?c.length:0;++l<h;)r=c[l],s[r]=f?f(s[r],i[r]):i[r];return s}function Q(e){var t,n=[];if(!e||!V[typeof e])return n;for(t in e)mn.call(e,t)&&n.push(t);return n}function Z(e){return e&&typeof e=="object"&&!Rn(e)&&mn.call(e,"__wrapped__")?e:new et(e)}function et(e,t){this.__chain__=!!t,this.__wrapped__=e}function tt(e,t,n,r,i){if(n){var s=n(e);if(typeof s!="undefined")return s}if(!yt(e))return e;var o=Sn.call(e);if(!z[o])return e;var a=Fn[o];switch(o){case B:case j:return new a(+e);case I:case U:return new a(e);case R:return s=a(e.source,C.exec(e)),s.lastIndex=e.lastIndex,s}if(o=Rn(e),t){var f=!r;r||(r=u()),i||(i=u());for(var c=r.length;c--;)if(r[c]==e)return i[c];s=o?a(e.length):{}}else s=o?h(e):K({},e);return o&&(mn.call(e,"index")&&(s.index=e.index),mn.call(e,"input")&&(s.input=e.input)),t?(r.push(e),i.push(s),(o?Ct:m)(e,function(e,o){s[o]=tt(e,t,n,r,i)}),f&&(l(r),l(i)),s):s}function nt(e,t,n){if(typeof e!="function")return Vt;if(typeof t=="undefined")return e;var r=e.__bindData__||In.funcNames&&!e.name;if(typeof r=="undefined"){var i=M&&dn.call(e);In.funcNames||!i||k.test(i)||(r=!0),(In.funcNames||!r)&&(r=!In.funcDecomp||M.test(i),qn(e,r))}if(!0!==r&&r&&1&r[1])return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,s){return e.call(t,n,r,i,s)}}return zt(e,t)}function rt(e,t,n,r){r=(r||0)-1;for(var i=e?e.length:0,s=[];++r<i;){var o=e[r];if(o&&typeof o=="object"&&typeof o.length=="number"&&(Rn(o)||pt(o))){t||(o=rt(o,t,n));var u=-1,a=o.length,f=s.length;for(s.length+=a;++u<a;)s[f++]=o[u]}else n||s.push(o)}return s}function it(e,t,n,r,i,s){if(n){var o=n(e,t);if(typeof o!="undefined")return!!o}if(e===t)return 0!==e||1/e==1/t;if(e===e&&!(e&&V[typeof e]||t&&V[typeof t]))return!1;if(null==e||null==t)return e===t;var a=Sn.call(e),f=Sn.call(t);if(a==P&&(a=q),f==P&&(f=q),a!=f)return!1;switch(a){case B:case j:return+e==+t;case I:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case R:case U:return e==sn(t)}if(f=a==H,!f){if(mn.call(e,"__wrapped__")||mn.call(t,"__wrapped__"))return it(e.__wrapped__||e,t.__wrapped__||t,n,r,i,s);if(a!=q)return!1;var a=e.constructor,c=t.constructor;if(a!=c&&!(gt(a)&&a instanceof a&&gt(c)&&c instanceof c))return!1}for(c=!i,i||(i=u()),s||(s=u()),a=i.length;a--;)if(i[a]==e)return s[a]==t;var h=0,o=!0;if(i.push(e),s.push(t),f){if(a=e.length,h=t.length,o=h==e.length,!o&&!r)return o;for(;h--;)if(f=a,c=t[h],r)for(;f--&&!(o=it(e[f],c,n,r,i,s)););else if(!(o=it(e[h],c,n,r,i,s)))break;return o}return w(t,function(t,u,a){return mn.call(a,u)?(h++,o=mn.call(e,u)&&it(e[u],t,n,r,i,s)):void 0}),o&&!r&&w(e,function(e,t,n){return mn.call(n,t)?o=-1<--h:void 0}),c&&(l(i),l(s)),o}function st(e,t,n,r,i){(Rn(t)?Ct:m)(t,function(t,s){var o,u,a=t,f=e[s];if(t&&((u=Rn(t))||v(t))){for(a=r.length;a--;)if(o=r[a]==t){f=i[a];break}if(!o){var l;n&&(a=n(f,t),l=typeof a!="undefined")&&(f=a),l||(f=u?Rn(f)?f:[]:v(f)?f:{}),r.push(t),i.push(f),l||st(f,t,n,r,i)}}else n&&(a=n(f,t),typeof a=="undefined"&&(a=t)),typeof a!="undefined"&&(f=a);e[s]=f})}function ot(n,r,i){var o=-1,a=lt(),f=n?n.length:0,h=[],p=!r&&f>=b&&a===e,d=i||p?u():h;if(p){var v=s(d);v?(a=t,d=v):(p=!1,d=i?d:(l(d),h))}for(;++o<f;){var v=n[o],m=i?i(v,o,n):v;(r?!o||d[d.length-1]!==m:0>a(d,m))&&((i||p)&&d.push(m),h.push(v))}return p?(l(d.k),c(d)):i&&l(d),h}function ut(e){return function(t,n,r){var i={};n=Z.createCallback(n,r,3),r=-1;var s=t?t.length:0;if(typeof s=="number")for(;++r<s;){var o=t[r];e(i,o,n(o,r,t),t)}else m(t,function(t,r,s){e(i,t,n(t,r,s),s)});return i}}function at(e,t,n,r,i,s){var o=1&t,u=2&t,a=4&t,f=8&t,l=16&t,c=32&t,h=e;if(!u&&!gt(e))throw new on;l&&!n.length&&(t&=-17,l=n=!1),c&&!r.length&&(t&=-33,c=r=!1);var p=e&&e.__bindData__;if(p)return!o||1&p[1]||(p[4]=i),!o&&1&p[1]&&(t|=8),!a||4&p[1]||(p[5]=s),l&&yn.apply(p[2]||(p[2]=[]),n),c&&yn.apply(p[3]||(p[3]=[]),r),p[1]|=t,at.apply(null,p);if(!o||u||a||c||!(In.fastBind||Nn&&l))v=function(){var p=arguments,d=o?i:this;return(a||l||c)&&(p=Hn.call(p),l&&xn.apply(p,n),c&&yn.apply(p,r),a&&p.length<s)?(t|=16,at(e,f?t:-4&t,p,null,i,s)):(u&&(e=d[h]),this instanceof v?(d=yt(e.prototype)?Cn(e.prototype):{},p=e.apply(d,p),yt(p)?p:d):e.apply(d,p))};else{if(l){var d=[i];yn.apply(d,n)}var v=l?Nn.apply(e,d):Nn.call(e,i)}return qn(v,Hn.call(arguments)),v}function ft(e){return zn[e]}function lt(){var t=(t=Z.indexOf)===jt?e:t;return t}function ct(e){var t,n;return e&&Sn.call(e)==q&&(t=e.constructor,!gt(t)||t instanceof t)?(w(e,function(e,t){n=t}),typeof n=="undefined"||mn.call(e,n)):!1}function ht(e){return Wn[e]}function pt(e){return e&&typeof e=="object"&&typeof e.length=="number"&&Sn.call(e)==P||!1}function dt(e,t,n){var r=Un(e),i=r.length;for(t=nt(t,n,3);i--&&(n=r[i],!1!==t(e[n],n,e)););return e}function vt(e){var t=[];return w(e,function(e,n){gt(e)&&t.push(n)}),t.sort()}function mt(e){for(var t=-1,n=Un(e),r=n.length,i={};++t<r;){var s=n[t];i[e[s]]=s}return i}function gt(e){return typeof e=="function"}function yt(e){return!!e&&!!V[typeof e]}function bt(e){return typeof e=="number"||Sn.call(e)==I}function wt(e){return typeof e=="string"||Sn.call(e)==U}function Et(e){for(var t=-1,n=Un(e),r=n.length,i=Qt(r);++t<r;)i[t]=e[n[t]];return i}function St(e,t,n){var r=-1,i=lt(),s=e?e.length:0,o=!1;return n=(0>n?Mn(0,s+n):n)||0,Rn(e)?o=-1<i(e,t,n):typeof s=="number"?o=-1<(wt(e)?e.indexOf(t,n):i(e,t,n)):m(e,function(e){return++r<n?void 0:!(o=e===t)}),o}function xt(e,t,n){var r=!0;t=Z.createCallback(t,n,3),n=-1;var i=e?e.length:0;if(typeof i=="number")for(;++n<i&&(r=!!t(e[n],n,e)););else m(e,function(e,n,i){return r=!!t(e,n,i)});return r}function Tt(e,t,n){var r=[];t=Z.createCallback(t,n,3),n=-1;var i=e?e.length:0;if(typeof i=="number")for(;++n<i;){var s=e[n];t(s,n,e)&&r.push(s)}else m(e,function(e,n,i){t(e,n,i)&&r.push(e)});return r}function Nt(e,t,n){t=Z.createCallback(t,n,3),n=-1;var r=e?e.length:0;if(typeof r!="number"){var i;return m(e,function(e,n,r){return t(e,n,r)?(i=e,!1):void 0}),i}for(;++n<r;){var s=e[n];if(t(s,n,e))return s}}function Ct(e,t,n){var r=-1,i=e?e.length:0;if(t=t&&typeof n=="undefined"?t:nt(t,n,3),typeof i=="number")for(;++r<i&&!1!==t(e[r],r,e););else m(e,t);return e}function kt(e,t,n){var r=e?e.length:0;if(t=t&&typeof n=="undefined"?t:nt(t,n,3),typeof r=="number")for(;r--&&!1!==t(e[r],r,e););else{var i=Un(e),r=i.length;m(e,function(e,n,s){return n=i?i[--r]:--r,t(s[n],n,s)})}return e}function Lt(e,t,n){var r=-1,i=e?e.length:0;if(t=Z.createCallback(t,n,3),typeof i=="number")for(var s=Qt(i);++r<i;)s[r]=t(e[r],r,e);else s=[],m(e,function(e,n,i){s[++r]=t(e,n,i)});return s}function At(e,t,n){var i=-1/0,s=i;if(!t&&Rn(e)){n=-1;for(var o=e.length;++n<o;){var u=e[n];u>s&&(s=u)}}else t=!t&&wt(e)?r:Z.createCallback(t,n,3),Ct(e,function(e,n,r){n=t(e,n,r),n>i&&(i=n,s=e)});return s}function Ot(e,t){var n=-1,r=e?e.length:0;if(typeof r=="number")for(var i=Qt(r);++n<r;)i[n]=e[n][t];return i||Lt(e,t)}function Mt(e,t,n,r){if(!e)return n;var i=3>arguments.length;t=nt(t,r,4);var s=-1,o=e.length;if(typeof o=="number")for(i&&(n=e[++s]);++s<o;)n=t(n,e[s],s,e);else m(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)});return n}function _t(e,t,n,r){var i=3>arguments.length;return t=nt(t,r,4),kt(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)}),n}function Dt(e){var t=-1,n=e?e.length:0,r=Qt(typeof n=="number"?n:0);return Ct(e,function(e){var n=Jt(++t);r[t]=r[n],r[n]=e}),r}function Pt(e,t,n){var r;t=Z.createCallback(t,n,3),n=-1;var i=e?e.length:0;if(typeof i=="number")for(;++n<i&&!(r=t(e[n],n,e)););else m(e,function(e,n,i){return!(r=t(e,n,i))});return!!r}function Ht(n){var r=-1,i=lt(),o=n?n.length:0,u=rt(arguments,!0,!0,1),a=[],f=o>=b&&i===e;if(f){var l=s(u);l?(i=t,u=l):f=!1}for(;++r<o;)l=n[r],0>i(u,l)&&a.push(l);return f&&c(u),a}function Bt(e,t,n){var r=0,i=e?e.length:0;if(typeof t!="number"&&null!=t){var s=-1;for(t=Z.createCallback(t,n,3);++s<i&&t(e[s],s,e);)r++}else if(r=t,null==r||n)return e?e[0]:d;return h(e,0,_n(Mn(0,r),i))}function jt(t,n,r){if(typeof r=="number"){var i=t?t.length:0;r=0>r?Mn(0,i+r):r||0}else if(r)return r=It(t,n),t[r]===n?r:-1;return e(t,n,r)}function Ft(e,t,n){if(typeof t!="number"&&null!=t){var r=0,i=-1,s=e?e.length:0;for(t=Z.createCallback(t,n,3);++i<s&&t(e[i],i,e);)r++}else r=null==t||n?1:Mn(0,t);return h(e,r)}function It(e,t,n,r){var i=0,s=e?e.length:i;for(n=n?Z.createCallback(n,r,1):Vt,t=n(t);i<s;)r=i+s>>>1,n(e[r])<t?i=r+1:s=r;return i}function qt(e,t,n,r){return typeof t!="boolean"&&null!=t&&(n=(r=n)&&r[t]===e?null:t,t=!1),null!=n&&(n=Z.createCallback(n,r,3)),ot(e,t,n)}function Rt(){for(var e=1<arguments.length?arguments:arguments[0],t=-1,n=e?At(Ot(e,"length")):0,r=Qt(0>n?0:n);++t<n;)r[t]=Ot(e,t);return r}function Ut(e,t){for(var n=-1,r=e?e.length:0,i={};++n<r;){var s=e[n];t?i[s]=t[n]:s&&(i[s[0]]=s[1])}return i}function zt(e,t){return 2<arguments.length?at(e,17,Hn.call(arguments,2),null,t):at(e,1,null,null,t)}function Wt(e,t,n){function r(){l&&hn(l),o=l=c=d,(v||p!==t)&&(h=gn(),u=e.apply(f,s))}function i(){var n=t-(gn()-a);0<n?l=wn(i,n):(o&&hn(o),n=c,o=l=c=d,n&&(h=gn(),u=e.apply(f,s)))}var s,o,u,a,f,l,c,h=0,p=!1,v=!0;if(!gt(e))throw new on;if(t=Mn(0,t)||0,!0===n)var m=!0,v=!1;else yt(n)&&(m=n.leading,p="maxWait"in n&&(Mn(t,n.maxWait)||0),v="trailing"in n?n.trailing:v);return function(){if(s=arguments,a=gn(),f=this,c=v&&(l||!m),!1===p)var n=m&&!l;else{o||m||(h=a);var d=p-(a-h);0<d?o||(o=wn(r,d)):(o&&(o=hn(o)),h=a,u=e.apply(f,s))}return l||t===p||(l=wn(i,t)),n&&(u=e.apply(f,s)),u}}function Xt(e){if(!gt(e))throw new on;var t=Hn.call(arguments,1);return wn(function(){e.apply(d,t)},1)}function Vt(e){return e}function $t(e,t){var n=e,r=!t||gt(n);t||(n=et,t=e,e=Z),Ct(vt(t),function(i){var s=e[i]=t[i];r&&(n.prototype[i]=function(){var t=this.__wrapped__,r=[t];return yn.apply(r,arguments),r=s.apply(e,r),t&&typeof t=="object"&&t===r?this:new n(r)})})}function Jt(e,t,n){var r=null==e,i=null==t;return null==n&&(typeof e=="boolean"&&i?(n=e,e=1):i||typeof t!="boolean"||(n=t,i=!0)),r&&i&&(t=1),e=+e||0,i?(t=e,e=0):t=+t||0,r=Pn(),n||e%1||t%1?_n(e+r*(t-e+parseFloat("1e-"+((r+"").length-1))),t):e+pn(r*(t-e+1))}function Kt(){return this.__wrapped__}n=n?Y.defaults(J.Object(),n,Y.pick(J,D)):J;var Qt=n.Array,Gt=n.Boolean,Yt=n.Date,Zt=n.Function,en=n.Math,tn=n.Number,nn=n.Object,rn=n.RegExp,sn=n.String,on=n.TypeError,un=[],an=nn.prototype,fn=n._,ln=rn("^"+sn(an.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),cn=en.ceil,hn=n.clearTimeout,pn=en.floor,dn=Zt.prototype.toString,vn=ln.test(vn=nn.getPrototypeOf)&&vn,mn=an.hasOwnProperty,gn=ln.test(gn=Yt.now)&&gn||function(){return+(new Yt)},yn=un.push,bn=n.setImmediate,wn=n.setTimeout,En=un.splice,Sn=an.toString,xn=un.unshift,Tn=function(){try{var e={},t=ln.test(t=nn.defineProperty)&&t,n=t(e,e,e)&&t}catch(r){}return n}(),Nn=ln.test(Nn=Sn.bind)&&Nn,Cn=ln.test(Cn=nn.create)&&Cn,kn=ln.test(kn=Qt.isArray)&&kn,Ln=n.isFinite,An=n.isNaN,On=ln.test(On=nn.keys)&&On,Mn=en.max,_n=en.min,Dn=n.parseInt,Pn=en.random,Hn=un.slice,Bn=ln.test(n.attachEvent),jn=Nn&&!/\n|true/.test(Nn+Bn),Fn={};Fn[H]=Qt,Fn[B]=Gt,Fn[j]=Yt,Fn[F]=Zt,Fn[q]=nn,Fn[I]=tn,Fn[R]=rn,Fn[U]=sn,et.prototype=Z.prototype;var In=Z.support={};In.fastBind=Nn&&!jn,In.funcDecomp=!ln.test(n.a)&&M.test(p),In.funcNames=typeof Zt.name=="string",Z.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:L,variable:"",imports:{_:Z}};var qn=Tn?function(e,t){X.value=t,Tn(e,"__bindData__",X)}:f,Rn=kn||function(e){return e&&typeof e=="object"&&typeof e.length=="number"&&Sn.call(e)==H||!1},Un=On?function(e){return yt(e)?On(e):[]}:Q,zn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Wn=mt(zn),Xn=rn("("+Un(Wn).join("|")+")","g"),Vn=rn("["+Un(zn).join("")+"]","g"),$n=ut(function(e,t,n){mn.call(e,n)?e[n]++:e[n]=1}),Jn=ut(function(e,t,n){(mn.call(e,n)?e[n]:e[n]=[]).push(t)}),Kn=ut(function(e,t,n){e[n]=t});jn&&G&&typeof bn=="function"&&(Xt=function(e){if(!gt(e))throw new on;return bn.apply(n,arguments)});var Qn=8==Dn(E+"08")?Dn:function(e,t){return Dn(wt(e)?e.replace(A,""):e,t||0)};return Z.after=function(e,t){if(!gt(t))throw new on;return function(){return 1>--e?t.apply(this,arguments):void 0}},Z.assign=K,Z.at=function(e){for(var t=arguments,n=-1,r=rt(t,!0,!1,1),t=t[2]&&t[2][t[1]]===e?1:r.length,i=Qt(t);++n<t;)i[n]=e[r[n]];return i},Z.bind=zt,Z.bindAll=function(e){for(var t=1<arguments.length?rt(arguments,!0,!1,1):vt(e),n=-1,r=t.length;++n<r;){var i=t[n];e[i]=at(e[i],1,null,null,e)}return e},Z.bindKey=function(e,t){return 2<arguments.length?at(t,19,Hn.call(arguments,2),null,e):at(t,3,null,null,e)},Z.chain=function(e){return e=new et(e),e.__chain__=!0,e},Z.compact=function(e){for(var t=-1,n=e?e.length:0,r=[];++t<n;){var i=e[t];i&&r.push(i)}return r},Z.compose=function(){for(var e=arguments,t=e.length;t--;)if(!gt(e[t]))throw new on;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}},Z.countBy=$n,Z.createCallback=function(e,t,n){var r=typeof e;if(null==e||"function"==r)return nt(e,t,n);if("object"!=r)return function(t){return t[e]};var i=Un(e),s=i[0],o=e[s];return 1!=i.length||o!==o||yt(o)?function(t){for(var n=i.length,r=!1;n--&&(r=it(t[i[n]],e[i[n]],null,!0)););return r}:function(e){return e=e[s],o===e&&(0!==o||1/o==1/e)}},Z.curry=function(e,t){return t=typeof t=="number"?t:+t||e.length,at(e,4,null,null,null,t)},Z.debounce=Wt,Z.defaults=$,Z.defer=Xt,Z.delay=function(e,t){if(!gt(e))throw new on;var n=Hn.call(arguments,2);return wn(function(){e.apply(d,n)},t)},Z.difference=Ht,Z.filter=Tt,Z.flatten=function(e,t,n,r){return typeof t!="boolean"&&null!=t&&(n=(r=n)&&r[t]===e?null:t,t=!1),null!=n&&(e=Lt(e,n,r)),rt(e,t)},Z.forEach=Ct,Z.forEachRight=kt,Z.forIn=w,Z.forInRight=function(e,t,n){var r=[];w(e,function(e,t){r.push(t,e)});var i=r.length;for(t=nt(t,n,3);i--&&!1!==t(r[i--],r[i],e););return e},Z.forOwn=m,Z.forOwnRight=dt,Z.functions=vt,Z.groupBy=Jn,Z.indexBy=Kn,Z.initial=function(e,t,n){var r=0,i=e?e.length:0;if(typeof t!="number"&&null!=t){var s=i;for(t=Z.createCallback(t,n,3);s--&&t(e[s],s,e);)r++}else r=null==t||n?1:t||r;return h(e,0,_n(Mn(0,i-r),i))},Z.intersection=function(n){for(var r=arguments,i=r.length,o=-1,a=u(),f=-1,h=lt(),p=n?n.length:0,d=[],v=u();++o<i;){var m=r[o];a[o]=h===e&&(m?m.length:0)>=b&&s(o?r[o]:v)}e:for(;++f<p;){var g=a[0],m=n[f];if(0>(g?t(g,m):h(v,m))){for(o=i,(g||v).push(m);--o;)if(g=a[o],0>(g?t(g,m):h(r[o],m)))continue e;d.push(m)}}for(;i--;)(g=a[i])&&c(g);return l(a),l(v),d},Z.invert=mt,Z.invoke=function(e,t){var n=Hn.call(arguments,2),r=-1,i=typeof t=="function",s=e?e.length:0,o=Qt(typeof s=="number"?s:0);return Ct(e,function(e){o[++r]=(i?t:e[t]).apply(e,n)}),o},Z.keys=Un,Z.map=Lt,Z.max=At,Z.memoize=function(e,t){function n(){var r=n.cache,i=t?t.apply(this,arguments):y+arguments[0];return mn.call(r,i)?r[i]:r[i]=e.apply(this,arguments)}if(!gt(e))throw new on;return n.cache={},n},Z.merge=function(e){var t=arguments,n=2;if(!yt(e))return e;if("number"!=typeof t[2]&&(n=t.length),3<n&&"function"==typeof t[n-2])var r=nt(t[--n-1],t[n--],2);else 2<n&&"function"==typeof t[n-1]&&(r=t[--n]);for(var t=Hn.call(arguments,1,n),i=-1,s=u(),o=u();++i<n;)st(e,t[i],r,s,o);return l(s),l(o),e},Z.min=function(e,t,n){var i=1/0,s=i;if(!t&&Rn(e)){n=-1;for(var o=e.length;++n<o;){var u=e[n];u<s&&(s=u)}}else t=!t&&wt(e)?r:Z.createCallback(t,n,3),Ct(e,function(e,n,r){n=t(e,n,r),n<i&&(i=n,s=e)});return s},Z.omit=function(e,t,n){var r=lt(),i=typeof t=="function",s={};if(i)t=Z.createCallback(t,n,3);else var o=rt(arguments,!0,!1,1);return w(e,function(e,n,u){(i?!t(e,n,u):0>r(o,n))&&(s[n]=e)}),s},Z.once=function(e){var t,n;if(!gt(e))throw new on;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},Z.pairs=function(e){for(var t=-1,n=Un(e),r=n.length,i=Qt(r);++t<r;){var s=n[t];i[t]=[s,e[s]]}return i},Z.partial=function(e){return at(e,16,Hn.call(arguments,1))},Z.partialRight=function(e){return at(e,32,null,Hn.call(arguments,1))},Z.pick=function(e,t,n){var r={};if(typeof t!="function")for(var i=-1,s=rt(arguments,!0,!1,1),o=yt(e)?s.length:0;++i<o;){var u=s[i];u in e&&(r[u]=e[u])}else t=Z.createCallback(t,n,3),w(e,function(e,n,i){t(e,n,i)&&(r[n]=e)});return r},Z.pluck=Ot,Z.pull=function(e){for(var t=arguments,n=0,r=t.length,i=e?e.length:0;++n<r;)for(var s=-1,o=t[n];++s<i;)e[s]===o&&(En.call(e,s--,1),i--);return e},Z.range=function(e,t,n){e=+e||0,n=typeof n=="number"?n:+n||1,null==t&&(t=e,e=0);var r=-1;t=Mn(0,cn((t-e)/(n||1)));for(var i=Qt(t);++r<t;)i[r]=e,e+=n;return i},Z.reject=function(e,t,n){return t=Z.createCallback(t,n,3),Tt(e,function(e,n,r){return!t(e,n,r)})},Z.remove=function(e,t,n){var r=-1,i=e?e.length:0,s=[];for(t=Z.createCallback(t,n,3);++r<i;)n=e[r],t(n,r,e)&&(s.push(n),En.call(e,r--,1),i--);return s},Z.rest=Ft,Z.shuffle=Dt,Z.sortBy=function(e,t,n){var r=-1,s=e?e.length:0,o=Qt(typeof s=="number"?s:0);for(t=Z.createCallback(t,n,3),Ct(e,function(e,n,i){var s=o[++r]=a();s.m=t(e,n,i),s.n=r,s.o=e}),s=o.length,o.sort(i);s--;)e=o[s],o[s]=e.o,c(e);return o},Z.tap=function(e,t){return t(e),e},Z.throttle=function(e,t,n){var r=!0,i=!0;if(!gt(e))throw new on;return!1===n?r=!1:yt(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),W.leading=r,W.maxWait=t,W.trailing=i,Wt(e,t,W)},Z.times=function(e,t,n){e=-1<(e=+e)?e:0;var r=-1,i=Qt(e);for(t=nt(t,n,1);++r<e;)i[r]=t(r);return i},Z.toArray=function(e){return e&&typeof e.length=="number"?h(e):Et(e)},Z.transform=function(e,t,n,r){var i=Rn(e);return t=nt(t,r,4),null==n&&(i?n=[]:(r=e&&e.constructor,n=yt(r&&r.prototype)?Cn(r&&r.prototype):{})),(i?Ct:m)(e,function(e,r,i){return t(n,e,r,i)}),n},Z.union=function(){return ot(rt(arguments,!0,!0))},Z.uniq=qt,Z.values=Et,Z.where=Tt,Z.without=function(e){return Ht(e,Hn.call(arguments,1))},Z.wrap=function(e,t){if(!gt(t))throw new on;return function(){var n=[e];return yn.apply(n,arguments),t.apply(this,n)}},Z.zip=Rt,Z.zipObject=Ut,Z.collect=Lt,Z.drop=Ft,Z.each=Ct,Z.b=kt,Z.extend=K,Z.methods=vt,Z.object=Ut,Z.select=Tt,Z.tail=Ft,Z.unique=qt,Z.unzip=Rt,$t(Z),Z.clone=function(e,t,n,r){return typeof t!="boolean"&&null!=t&&(r=n,n=t,t=!1),tt(e,t,typeof n=="function"&&nt(n,r,1))},Z.cloneDeep=function(e,t,n){return tt(e,!0,typeof t=="function"&&nt(t,n,1))},Z.contains=St,Z.escape=function(e){return null==e?"":sn(e).replace(Vn,ft)},Z.every=xt,Z.find=Nt,Z.findIndex=function(e,t,n){var r=-1,i=e?e.length:0;for(t=Z.createCallback(t,n,3);++r<i;)if(t(e[r],r,e))return r;return-1},Z.findKey=function(e,t,n){var r;return t=Z.createCallback(t,n,3),m(e,function(e,n,i){return t(e,n,i)?(r=n,!1):void 0}),r},Z.findLast=function(e,t,n){var r;return t=Z.createCallback(t,n,3),kt(e,function(e,n,i){return t(e,n,i)?(r=e,!1):void 0}),r},Z.findLastIndex=function(e,t,n){var r=e?e.length:0;for(t=Z.createCallback(t,n,3);r--;)if(t(e[r],r,e))return r;return-1},Z.findLastKey=function(e,t,n){var r;return t=Z.createCallback(t,n,3),dt(e,function(e,n,i){return t(e,n,i)?(r=n,!1):void 0}),r},Z.has=function(e,t){return e?mn.call(e,t):!1},Z.identity=Vt,Z.indexOf=jt,Z.isArguments=pt,Z.isArray=Rn,Z.isBoolean=function(e){return!0===e||!1===e||Sn.call(e)==B},Z.isDate=function(e){return e?typeof e=="object"&&Sn.call(e)==j:!1},Z.isElement=function(e){return e?1===e.nodeType:!1},Z.isEmpty=function(e){var t=!0;if(!e)return t;var n=Sn.call(e),r=e.length;return n==H||n==U||n==P||n==q&&typeof r=="number"&&gt(e.splice)?!r:(m(e,function(){return t=!1}),t)},Z.isEqual=function(e,t,n,r){return it(e,t,typeof n=="function"&&nt(n,r,2))},Z.isFinite=function(e){return Ln(e)&&!An(parseFloat(e))},Z.isFunction=gt,Z.isNaN=function(e){return bt(e)&&e!=+e},Z.isNull=function(e){return null===e},Z.isNumber=bt,Z.isObject=yt,Z.isPlainObject=v,Z.isRegExp=function(e){return e?typeof e=="object"&&Sn.call(e)==R:!1},Z.isString=wt,Z.isUndefined=function(e){return typeof e=="undefined"},Z.lastIndexOf=function(e,t,n){var r=e?e.length:0;for(typeof n=="number"&&(r=(0>n?Mn(0,r+n):_n(n,r-1))+1);r--;)if(e[r]===t)return r;return-1},Z.mixin=$t,Z.noConflict=function(){return n._=fn,this},Z.parseInt=Qn,Z.random=Jt,Z.reduce=Mt,Z.reduceRight=_t,Z.result=function(e,t){if(e){var n=e[t];return gt(n)?e[t]():n}},Z.runInContext=p,Z.size=function(e){var t=e?e.length:0;return typeof t=="number"?t:Un(e).length},Z.some=Pt,Z.sortedIndex=It,Z.template=function(e,t,n){var r=Z.templateSettings;e||(e=""),n=$({},n,r);var i,s=$({},n.imports,r.imports),r=Un(s),s=Et(s),u=0,a=n.interpolate||O,f="__p+='",a=rn((n.escape||O).source+"|"+a.source+"|"+(a===L?N:O).source+"|"+(n.evaluate||O).source+"|$","g");e.replace(a,function(t,n,r,s,a,l){return r||(r=s),f+=e.slice(u,l).replace(_,o),n&&(f+="'+__e("+n+")+'"),a&&(i=!0,f+="';"+a+";__p+='"),r&&(f+="'+((__t=("+r+"))==null?'':__t)+'"),u=l+t.length,t}),f+="';\n",a=n=n.variable,a||(n="obj",f="with("+n+"){"+f+"}"),f=(i?f.replace(S,""):f).replace(x,"$1").replace(T,"$1;"),f="function("+n+"){"+(a?"":n+"||("+n+"={});")+"var __t,__p='',__e=_.escape"+(i?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+f+"return __p}";try{var l=Zt(r,"return "+f).apply(d,s)}catch(c){throw c.source=f,c}return t?l(t):(l.source=f,l)},Z.unescape=function(e){return null==e?"":sn(e).replace(Xn,ht)},Z.uniqueId=function(e){var t=++g;return sn(null==e?"":e)+t},Z.all=xt,Z.any=Pt,Z.detect=Nt,Z.findWhere=Nt,Z.foldl=Mt,Z.foldr=_t,Z.include=St,Z.inject=Mt,m(Z,function(e,t){Z.prototype[t]||(Z.prototype[t]=function(){var t=[this.__wrapped__],n=this.__chain__;return yn.apply(t,arguments),t=e.apply(Z,t),n?new et(t,n):t})}),Z.first=Bt,Z.last=function(e,t,n){var r=0,i=e?e.length:0;if(typeof t!="number"&&null!=t){var s=i;for(t=Z.createCallback(t,n,3);s--&&t(e[s],s,e);)r++}else if(r=t,null==r||n)return e?e[i-1]:d;return h(e,Mn(0,i-r))},Z.sample=function(e,t,n){var r=e?e.length:0;return typeof r!="number"&&(e=Et(e)),null==t||n?e?e[Jt(r-1)]:d:(e=Dt(e),e.length=_n(Mn(0,t),e.length),e)},Z.take=Bt,Z.head=Bt,m(Z,function(e,t){var n="sample"!==t;Z.prototype[t]||(Z.prototype[t]=function(t,r){var i=this.__chain__,s=e(this.__wrapped__,t,r);return i||null!=t&&(!r||n&&typeof t=="function")?new et(s,i):s})}),Z.VERSION="2.2.0",Z.prototype.chain=function(){return this.__chain__=!0,this},Z.prototype.toString=function(){return sn(this.__wrapped__)},Z.prototype.value=Kt,Z.prototype.valueOf=Kt,Ct(["join","pop","shift"],function(e){var t=un[e];Z.prototype[e]=function(){var e=this.__chain__,n=t.apply(this.__wrapped__,arguments);return e?new et(n,e):n}}),Ct(["push","reverse","sort","unshift"],function(e){var t=un[e];Z.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),Ct(["concat","slice","splice"],function(e){var t=un[e];Z.prototype[e]=function(){return new et(t.apply(this.__wrapped__,arguments),this.__chain__)}}),Z}var d,v=[],m=[],g=0,y=+(new Date)+"",b=75,w=40,E=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",S=/\b__p\+='';/g,x=/\b(__p\+=)''\+/g,T=/(__e\(.*?\)|\b__t\))\+'';/g,N=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,C=/\w*$/,k=/^function[ \n\r\t]+\w/,L=/<%=([\s\S]+?)%>/g,A=RegExp("^["+E+"]*0+(?=.$)"),O=/($^)/,M=/\bthis\b/,_=/['\n\r\t\u2028\u2029\\]/g,D="Array Boolean Date Function Math Number Object RegExp String _ attachEvent clearTimeout isFinite isNaN parseInt setImmediate setTimeout".split(" "),P="[object Arguments]",H="[object Array]",B="[object Boolean]",j="[object Date]",F="[object Function]",I="[object Number]",q="[object Object]",R="[object RegExp]",U="[object String]",z={};z[F]=!1,z[P]=z[H]=z[B]=z[j]=z[I]=z[q]=z[R]=z[U]=!0;var W={leading:!1,maxWait:0,trailing:!1},X={configurable:!1,enumerable:!1,value:null,writable:!1},V={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1},$={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},J=V[typeof window]&&window||this,K=V[typeof exports]&&exports&&!exports.nodeType&&exports,Q=V[typeof module]&&module&&!module.nodeType&&module,G=Q&&Q.exports===K&&K,Y=p();typeof define=="function"&&typeof define.amd=="object"&&define.amd&&define("thirdparty/lodash",[],function(){return Y})}.call(this),define("utils/UrlParams",["require","exports","module","thirdparty/lodash"],function(e,t,n){function i(){this._store={}}var r=e("thirdparty/lodash");i.prototype.parse=function(e){var t="",n,r,i=this;i._store={},e?e.indexOf("?")!==-1&&(t=e.substring(e.indexOf("?")+1)):t=window.document.location.search.substring(1),t=t.trimRight(),t&&(n=t.split("&"),n.forEach(function(e){r=e.split("="),r[1]=r[1]||"",i._store[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}))},i.prototype.put=function(e,t){this._store[e]=t},i.prototype.get=function(e){return this._store[e]},i.prototype.remove=function(e){delete this._store[e]},i.prototype.isEmpty=function(e){return r.isEmpty(this._store)},i.prototype.toString=function(){var e=[],t=this;return r.forEach(t._store,function(t,n){e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))}),e.join("&")},t.UrlParams=i}),define("utils/AppInit",["require","exports","module"],function(e,t,n){function u(e){try{e()}catch(t){console.error("Exception when calling a 'brackets done loading' handler:"),console.log(t.stack)}}function a(e){var t,n=o[e];s[e]=!0;for(t=0;t<n.length;t++)u(n[t]);o[e]=[]}function f(e,t){s[e]?u(t):o[e].push(t)}function l(e){f(i,e)}function c(e){f(r,e)}var r="htmlReady",i="appReady",s={HTML_READY:!1,APP_READY:!1},o={};o[r]=[],o[i]=[],t.appReady=l,t.htmlReady=c,t.HTML_READY=r,t.APP_READY=i,t._dispatchReady=a}),define("command/CommandManager",["require","exports","module"],function(e,t,n){function s(e,t,n){this._name=e,this._id=t,this._commandFn=n,this._checked=undefined,this._enabled=!0}function o(e,n,i){if(r[n])return console.log("Attempting to register an already-registered command: "+n),null;if(!e||!n||!i)return console.error("Attempting to register a command with a missing name, id, or command function:"+e+" "+n),null;var o=new s(e,n,i);return r[n]=o,$(t).triggerHandler("commandRegistered",[o]),o}function u(e,n){if(r[e])return console.log("Attempting to register an already-registered command: "+e),null;if(!e||!n)return console.error("Attempting to register an internal command with a missing id, or command function: "+e),null;var i=new s(null,e,n);return r[e]=i,$(t).triggerHandler("commandRegistered",[i]),i}function a(){i=r,r={}}function f(){r=i,i={}}function l(e){return r[e]}function c(){return Object.keys(r)}function h(e){var n=r[e];if(n){try{$(t).triggerHandler("beforeExecuteCommand",e)}catch(i){console.error(i)}return n.execute.apply(n,Array.prototype.slice.call(arguments,1))}return(new $.Deferred).reject().promise()}var r={},i={};s.prototype.getID=function(){return this._id},s.prototype.execute=function(){if(!this._enabled)return(new $.Deferred).reject().promise();var e=this._commandFn.apply(this,arguments);return e?e:(new $.Deferred).resolve().promise()},s.prototype.getEnabled=function(){return this._enabled},s.prototype.setEnabled=function(e){var t=this._enabled!==e;this._enabled=e,t&&$(this).triggerHandler("enabledStateChange")},s.prototype.setChecked=function(e){var t=this._checked!==e;this._checked=e,t&&$(this).triggerHandler("checkedStateChange")},s.prototype.getChecked=function(){return this._checked},s.prototype.setName=function(e){var t=this._name!==e;this._name=e,t&&$(this).triggerHandler("nameChange")},s.prototype.getName=function(){return this._name},t.register=o,t.registerInternal=u,t.execute=h,t.get=l,t.getAll=c,t._testReset=a,t._testRestore=f}),define("utils/DeprecationWarning",["require","exports","module"],function(e,t,n){function i(e){var t;return e=e.substr(e.indexOf(")\n")+2),t=e.indexOf("requirejs/require.js"),t!==-1&&(t=e.lastIndexOf(")",t)+1,e=e.substr(0,t)),e}function s(e,t){if(!e||!t&&r[e])return;var n=(new Error).stack,s=n.split("\n")[3];if(t&&r[e]&&r[e][s])return;console.warn(e+"\n"+i(n)),r[e]||(r[e]={}),r[e][s]=!0}var r={};t.deprecationWarning=s}),define("command/Commands",["require","exports","module","utils/DeprecationWarning"],function(e,t,n){function i(e,n){var i="Use Commands."+n+" instead of Commands."+e,s=t[n];Object.defineProperty(t,e,{get:function(){return r.deprecationWarning(i,!0),s}})}var r=e("utils/DeprecationWarning");t.FILE_NEW_UNTITLED="file.newDoc",t.FILE_NEW="file.newFile",t.FILE_NEW_FOLDER="file.newFolder",t.FILE_OPEN="file.open",t.FILE_OPEN_FOLDER="file.openFolder",t.FILE_SAVE="file.save",t.FILE_SAVE_ALL="file.saveAll",t.FILE_SAVE_AS="file.saveAs",t.FILE_CLOSE="file.close",t.FILE_CLOSE_ALL="file.close_all",t.FILE_CLOSE_LIST="file.close_list",t.FILE_ADD_TO_WORKING_SET="file.addToWorkingSet",t.FILE_OPEN_DROPPED_FILES="file.openDroppedFiles",t.FILE_LIVE_FILE_PREVIEW="file.liveFilePreview",t.CMD_RELOAD_LIVE_PREVIEW="file.reloadLivePreview",t.FILE_LIVE_HIGHLIGHT="file.previewHighlight",t.FILE_PROJECT_SETTINGS="file.projectSettings",t.FILE_RENAME="file.rename",t.FILE_DELETE="file.delete",t.FILE_EXTENSION_MANAGER="file.extensionManager",t.FILE_REFRESH="file.refresh",t.FILE_OPEN_PREFERENCES="file.openPreferences",t.FILE_CLOSE_WINDOW="file.close_window",t.FILE_QUIT="file.quit",t.EDIT_UNDO="edit.undo",t.EDIT_REDO="edit.redo",t.EDIT_CUT="edit.cut",t.EDIT_COPY="edit.copy",t.EDIT_PASTE="edit.paste",t.EDIT_SELECT_ALL="edit.selectAll",t.EDIT_SELECT_LINE="edit.selectLine",t.EDIT_SPLIT_SEL_INTO_LINES="edit.splitSelIntoLines",t.EDIT_ADD_CUR_TO_NEXT_LINE="edit.addCursorToNextLine",t.EDIT_ADD_CUR_TO_PREV_LINE="edit.addCursorToPrevLine",t.EDIT_INDENT="edit.indent",t.EDIT_UNINDENT="edit.unindent",t.EDIT_DUPLICATE="edit.duplicate",t.EDIT_DELETE_LINES="edit.deletelines",t.EDIT_LINE_COMMENT="edit.lineComment",t.EDIT_BLOCK_COMMENT="edit.blockComment",t.EDIT_LINE_UP="edit.lineUp",t.EDIT_LINE_DOWN="edit.lineDown",t.EDIT_OPEN_LINE_ABOVE="edit.openLineAbove",t.EDIT_OPEN_LINE_BELOW="edit.openLineBelow",t.TOGGLE_CLOSE_BRACKETS="edit.autoCloseBrackets",t.SHOW_CODE_HINTS="edit.showCodeHints",t.CMD_FIND="cmd.find",t.CMD_FIND_IN_FILES="cmd.findInFiles",t.CMD_FIND_IN_SELECTED="cmd.findInSelected",t.CMD_FIND_IN_SUBTREE="cmd.findInSubtree",t.CMD_FIND_NEXT="cmd.findNext",t.CMD_FIND_PREVIOUS="cmd.findPrevious",t.CMD_FIND_ALL_AND_SELECT="cmd.findAllAndSelect",t.CMD_ADD_NEXT_MATCH="cmd.addNextMatch",t.CMD_SKIP_CURRENT_MATCH="cmd.skipCurrentMatch",t.CMD_REPLACE="cmd.replace",t.CMD_REPLACE_IN_FILES="cmd.replaceInFiles",t.CMD_REPLACE_IN_SELECTED="cmd.replaceInSelected",t.CMD_REPLACE_IN_SUBTREE="cmd.replaceInSubtree",t.CMD_THEMES_OPEN_SETTINGS="view.themesOpenSetting",t.VIEW_HIDE_SIDEBAR="view.hideSidebar",t.VIEW_INCREASE_FONT_SIZE="view.increaseFontSize",t.VIEW_DECREASE_FONT_SIZE="view.decreaseFontSize",t.VIEW_RESTORE_FONT_SIZE="view.restoreFontSize",t.VIEW_SCROLL_LINE_UP="view.scrollLineUp",t.VIEW_SCROLL_LINE_DOWN="view.scrollLineDown",t.VIEW_TOGGLE_INSPECTION="view.toggleCodeInspection",t.TOGGLE_LINE_NUMBERS="view.toggleLineNumbers",t.TOGGLE_ACTIVE_LINE="view.toggleActiveLine",t.TOGGLE_WORD_WRAP="view.toggleWordWrap",t.SORT_WORKINGSET_BY_ADDED="view.sortWorkingSetByAdded",t.SORT_WORKINGSET_BY_NAME="view.sortWorkingSetByName",t.SORT_WORKINGSET_BY_TYPE="view.sortWorkingSetByType",t.SORT_WORKINGSET_AUTO="view.sortWorkingSetAuto",t.NAVIGATE_NEXT_DOC="navigate.nextDoc",t.NAVIGATE_PREV_DOC="navigate.prevDoc",t.NAVIGATE_SHOW_IN_FILE_TREE="navigate.showInFileTree",t.NAVIGATE_SHOW_IN_OS="navigate.showInOS",t.NAVIGATE_QUICK_OPEN="navigate.quickOpen",t.NAVIGATE_JUMPTO_DEFINITION="navigate.jumptoDefinition",t.NAVIGATE_GOTO_DEFINITION="navigate.gotoDefinition",t.NAVIGATE_GOTO_LINE="navigate.gotoLine",t.NAVIGATE_GOTO_FIRST_PROBLEM="navigate.gotoFirstProblem",t.TOGGLE_QUICK_EDIT="navigate.toggleQuickEdit",t.TOGGLE_QUICK_DOCS="navigate.toggleQuickDocs",t.QUICK_EDIT_NEXT_MATCH="navigate.nextMatch",t.QUICK_EDIT_PREV_MATCH="navigate.previousMatch",t.CSS_QUICK_EDIT_NEW_RULE="navigate.newRule",t.HELP_CHECK_FOR_UPDATE="help.checkForUpdate",t.HELP_HOW_TO_USE_BRACKETS="help.howToUseBrackets",t.HELP_SUPPORT="help.support",t.HELP_SUGGEST="help.suggest",t.HELP_RELEASE_NOTES="help.releaseNotes",t.HELP_GET_INVOLVED="help.getInvolved",t.HELP_SHOW_EXT_FOLDER="help.showExtensionsFolder",t.HELP_HOMEPAGE="help.homepage",t.HELP_TWITTER="help.twitter",t.HELP_ABOUT="help.about",t.APP_RELOAD="app.reload",t.APP_RELOAD_WITHOUT_EXTS="app.reload_without_exts",t.APP_ABORT_QUIT="app.abort_quit",t.APP_BEFORE_MENUPOPUP="app.before_menupopup",i("EDIT_FIND","CMD_FIND"),i("EDIT_FIND_IN_SELECTED","CMD_FIND_IN_SELECTED"),i("EDIT_FIND_IN_SUBTREE","CMD_FIND_IN_SUBTREE"),i("EDIT_FIND_NEXT","CMD_FIND_NEXT"),i("EDIT_FIND_PREVIOUS","CMD_FIND_PREVIOUS"),i("EDIT_FIND_ALL_AND_SELECT","CMD_FIND_ALL_AND_SELECT"),i("EDIT_ADD_NEXT_MATCH","CMD_ADD_NEXT_MATCH"),i("EDIT_SKIP_CURRENT_MATCH","CMD_SKIP_CURRENT_MATCH"),i("EDIT_REPLACE","CMD_REPLACE")}),define("utils/ShellAPI",["require","exports","module","utils/AppInit","command/CommandManager","command/Commands"],function(e,t,n){function u(e){if($(".modal.instance").length||!o)return window.isBracketsTestWindow?!1:e===s.FILE_CLOSE_WINDOW;var t,n=Error,r=new n,u=r.stack.split("\n").length;return u<3?t=i.execute(e):console.error("Skipping command "+e+" because it looks like you are "+"at a breakpoint. If you are NOT at a breakpoint, please "+"file a bug and mention this comment. Stack depth = "+u+"."),t&&t.state()==="rejected"?!1:!0}var r=e("utils/AppInit"),i=e("command/CommandManager"),s=e("command/Commands"),o=!1;r.appReady(function(){o=!0}),t.executeCommand=u}),define("hacks.app",["require","exports","module"],function(e,t){t.getApplicationSupportDirectory=function(){return"/"},t.getNodeState=function(e){e(-2)};var n=Function,r=(new n("return this"))();r.Mustache.compile||(r.Mustache.compile=function(e){return r.Mustache.parse(e),function(t,n){return r.Mustache.render(e,t,n)}})}),define("utils/Global",["require","exports","module","text!config.json","utils/UrlParams","utils/ShellAPI","hacks.app"],function(e,t,n){var r=e("text!config.json"),i=e("utils/UrlParams").UrlParams,s=Function,o=(new s("return this"))();o.brackets||(o.brackets={});var u=new i;u.parse();try{o.brackets.metadata=JSON.parse(r),o.brackets.config=o.brackets.metadata.config}catch(a){console.log(a)}o.brackets.shellAPI=e("utils/ShellAPI"),o.navigator.platform==="MacIntel"||o.navigator.platform==="MacPPC"?o.brackets.platform="mac":o.navigator.platform.indexOf("Linux")>=0?o.brackets.platform="linux":o.brackets.platform="win",o.brackets.inBrowser=!o.brackets.hasOwnProperty("fs");var f=u.get("hasNativeMenus");f?o.brackets.nativeMenus=f==="true":o.brackets.nativeMenus=!o.brackets.inBrowser&&o.brackets.platform!=="linux",o.brackets.isLocaleDefault=function(){return!o.localStorage.getItem("locale")},o.brackets.getLocale=function(){return o.localStorage.getItem("locale")||o.require.s.contexts._.config.locale},o.brackets.setLocale=function(e){e?o.localStorage.setItem("locale",e):o.localStorage.removeItem("locale")},o.brackets.app||(o.brackets.app=e("hacks.app"),o.brackets.inBrowser=!1,o.brackets.nativeMenus=!1,o.brackets.config.extension_registry="/brackets/s3.amazonaws.com/extend.brackets/registry.json",o.brackets.config.extension_url="/brackets/s3.amazonaws.com/extend.brackets/{0}/{0}-{1}.zip"),o.brackets.libRequire=o.require,o.brackets.getModule=e,t.global=o}),define("utils/Async",["require","exports","module"],function(e,t,n){function r(e,t,n){var r=[],i=new $.Deferred;if(e.length===0)i.resolve();else{var s=0,o=!1;e.forEach(function(u,a){var f=t(u,a);r.push(f),f.fail(function(){n?i.reject():o=!0}),f.always(function(){s++,s===e.length&&(o?i.reject():i.resolve())})})}return i.promise()}function i(e,t,n){function s(o){if(o>=e.length){i?r.reject():r.resolve();return}var u=t(e[o],o);u.done(function(){s(o+1)}),u.fail(function(){n?r.reject():(i=!0,s(o+1))})}var r=new $.Deferred,i=!1;return s(0),r.promise()}function s(e,t,n,r){n=n||15,r=r||30;var s=(new Date).getTime();return i(e,function(e,i){var o=new $.Deferred;return t(e,i),(new Date).getTime()-s>=n?window.setTimeout(function(){s=(new Date).getTime(),o.resolve()},r):o.resolve(),o},!1)}function o(e,t){var n=[],i=new $.Deferred,s=r(e,function(e,r){var i=t(e,r);return i.fail(function(t){n.push({item:e,error:t})}),i},!1);return s.done(function(){i.resolve()}).fail(function(){i.reject(n)}),i.promise()}function a(e,t,n){var r=new $.Deferred,i=window.setTimeout(function(){n?r.resolve():r.reject(u)},t);return e.always(function(){window.clearTimeout(i)}),e.then(r.resolve,r.reject),r.promise()}function f(e,t,n){var r=new $.Deferred,i=0,s=!1;return!e||e.length===0?(r.resolve(),r.promise()):(t=t===undefined?!1:!0,n!==undefined&&a(r,n),e.forEach(function(n){n.fail(function(e){s=!0}).always(function(){i++,i===e.length&&(t&&s?r.reject():r.resolve())})}),r.promise())}function l(e,t){function r(t,i){if(e.length===t)n.resolveWith(null,i);else{var s=e[t++];try{var o=s.apply(null,i);o.hasOwnProperty("done")&&o.hasOwnProperty("fail")?(o.done(function(){r(t,arguments)}),o.fail(function(){n.rejectWith(null,arguments)})):r(t,[o])}catch(u){n.reject(u)}}}var n=$.Deferred();return r(0,t||[]),n.promise()}function c(e,t){var n=new $.Deferred,r=Array.prototype.slice.call(arguments,2);return r.push(function(e){e?n.reject(e):n.resolve.apply(n,Array.prototype.slice.call(arguments,1))}),e[t].apply(e,r),n.promise()}function h(){this._queue=[]}var u={};h.prototype._queue=null,h.prototype._curPromise=null,Object.defineProperties(h.prototype,{length:{get:function(){return this._queue.length},set:function(){throw new Error("Cannot set length")}}}),h.prototype.add=function(e){this._queue.push(e),this._curPromise||this._doNext()},h.prototype.removeAll=function(){this._queue=[]},h.prototype._doNext=function(){var e=this;if(this._queue.length){var t=this._queue.shift();this._curPromise=t(),this._curPromise.always(function(){e._curPromise=null,e._doNext()})}},t.doInParallel=r,t.doSequentially=i,t.doSequentiallyInBackground=s,t.doInParallel_aggregateErrors=o,t.withTimeout=a,t.waitForAll=f,t.ERROR_TIMEOUT=u,t.chain=l,t.promisify=c,t.PromiseQueue=h}),define("filesystem/FileSystemError",["require","exports","module"],function(e,t,n){n.exports={UNKNOWN:"Unknown",INVALID_PARAMS:"InvalidParams",NOT_FOUND:"NotFound",NOT_READABLE:"NotReadable",UNSUPPORTED_ENCODING:"UnsupportedEncoding",NOT_SUPPORTED:"NotSupported",NOT_WRITABLE:"NotWritable",OUT_OF_SPACE:"OutOfSpace",TOO_MANY_ENTRIES:"TooManyEntries",ALREADY_EXISTS:"AlreadyExists",CONTENTS_MODIFIED:"ContentsModified",ROOT_NOT_WATCHED:"RootNotBeingWatched"}}),define("utils/PerfUtils",["require","exports","module","thirdparty/lodash","utils/Global"],function(e,t,n){function l(e,t){this.id=e,this.name=t}function c(e,n){f[e]&&console.error("Performance measurement "+e+" is already defined");var r=new l(e,n);return t[e]=r,r}function h(e){return e instanceof l?e.id:e}function p(e,t){u[e]&&console.error("Recursive tests with the same name are not supported. Timer name: "+e),u[e]={startTime:t}}function d(e){if(!s)return;var t=brackets.app.getElapsedMilliseconds();e=h(e);if(Array.isArray(e)){var n;for(n=0;n<e.length;n++)p(e[n],t)}else p(e,t);return e}function v(e){if(!s)return;var t=brackets.app.getElapsedMilliseconds();e=h(e),u[e]&&(t-=u[e].startTime,delete u[e]),o[e]?Array.isArray(o[e])?o[e].push(t):o[e]=[o[e],t]:o[e]=t}function m(e){var t=brackets.app.getElapsedMilliseconds();e=h(e),a[e]?(t-=a[e].startTime,o[e]&&Array.isArray(o[e])?o[e][o[e].length-1]=t:o[e]=t):(u[e]&&(a[e]={startTime:u[e].startTime}),v(e))}function g(e){e=h(e),u[e]&&delete u[e],a[e]&&delete a[e]}function y(e){return u[e]?!0:!1}function b(){var e=function(e){if(Array.isArray(e)){var t,n="";for(t=0;t<e.length;t++)n+=e[t],t<e.length-1&&(n+=", ");return n}return e},t,n,i="";return r.forEach(o,function(t,n){i+=e(t)+"	"+n+"\n"}),i}function w(e){return e?o[h(e)]:o}function E(e){var t=Object.keys(o).filter(function(t){return e.test(t)}),n=[];return t.forEach(function(e){n.push(o[e])}),n}function S(){o={},u={},a={}}var r=e("thirdparty/lodash"),i=e("utils/Global"),s=brackets&&!!brackets.app.getElapsedMilliseconds,o={},u={},a={},f={};c("INLINE_WIDGET_OPEN","Open inline editor or docs"),c("INLINE_WIDGET_CLOSE","Close inline editor or docs"),t.addMeasurement=v,t.finalizeMeasurement=g,t.isActive=y,t.markStart=d,t.getData=w,t.searchData=E,t.updateMeasurement=m,t.getDelimitedPerfData=b,t.createPerfMeasurement=c,t.clear=S}),define("utils/KeyEvent",{DOM_VK_CANCEL:3,DOM_VK_HELP:6,DOM_VK_BACK_SPACE:8,DOM_VK_TAB:9,DOM_VK_CLEAR:12,DOM_VK_RETURN:13,DOM_VK_ENTER:14,DOM_VK_SHIFT:16,DOM_VK_CONTROL:17,DOM_VK_ALT:18,DOM_VK_PAUSE:19,DOM_VK_CAPS_LOCK:20,DOM_VK_ESCAPE:27,DOM_VK_SPACE:32,DOM_VK_PAGE_UP:33,DOM_VK_PAGE_DOWN:34,DOM_VK_END:35,DOM_VK_HOME:36,DOM_VK_LEFT:37,DOM_VK_UP:38,DOM_VK_RIGHT:39,DOM_VK_DOWN:40,DOM_VK_PRINTSCREEN:44,DOM_VK_INSERT:45,DOM_VK_DELETE:46,DOM_VK_0:48,DOM_VK_1:49,DOM_VK_2:50,DOM_VK_3:51,DOM_VK_4:52,DOM_VK_5:53,DOM_VK_6:54,DOM_VK_7:55,DOM_VK_8:56,DOM_VK_9:57,DOM_VK_A:65,DOM_VK_B:66,DOM_VK_C:67,DOM_VK_D:68,DOM_VK_E:69,DOM_VK_F:70,DOM_VK_G:71,DOM_VK_H:72,DOM_VK_I:73,DOM_VK_J:74,DOM_VK_K:75,DOM_VK_L:76,DOM_VK_M:77,DOM_VK_N:78,DOM_VK_O:79,DOM_VK_P:80,DOM_VK_Q:81,DOM_VK_R:82,DOM_VK_S:83,DOM_VK_T:84,DOM_VK_U:85,DOM_VK_V:86,DOM_VK_W:87,DOM_VK_X:88,DOM_VK_Y:89,DOM_VK_Z:90,DOM_VK_CONTEXT_MENU:93,DOM_VK_NUMPAD0:96,DOM_VK_NUMPAD1:97,DOM_VK_NUMPAD2:98,DOM_VK_NUMPAD3:99,DOM_VK_NUMPAD4:100,DOM_VK_NUMPAD5:101,DOM_VK_NUMPAD6:102,DOM_VK_NUMPAD7:103,DOM_VK_NUMPAD8:104,DOM_VK_NUMPAD9:105,DOM_VK_MULTIPLY:106,DOM_VK_ADD:107,DOM_VK_SEPARATOR:108,DOM_VK_SUBTRACT:109,DOM_VK_DECIMAL:110,DOM_VK_DIVIDE:111,DOM_VK_F1:112,DOM_VK_F2:113,DOM_VK_F3:114,DOM_VK_F4:115,DOM_VK_F5:116,DOM_VK_F6:117,DOM_VK_F7:118,DOM_VK_F8:119,DOM_VK_F9:120,DOM_VK_F10:121,DOM_VK_F11:122,DOM_VK_F12:123,DOM_VK_F13:124,DOM_VK_F14:125,DOM_VK_F15:126,DOM_VK_F16:127,DOM_VK_F17:128,DOM_VK_F18:129,DOM_VK_F19:130,DOM_VK_F20:131,DOM_VK_F21:132,DOM_VK_F22:133,DOM_VK_F23:134,DOM_VK_F24:135,DOM_VK_NUM_LOCK:144,DOM_VK_SCROLL_LOCK:145,DOM_VK_SEMICOLON:186,DOM_VK_EQUALS:187,DOM_VK_COMMA:188,DOM_VK_DASH:189,DOM_VK_PERIOD:190,DOM_VK_SLASH:191,DOM_VK_BACK_QUOTE:192,DOM_VK_OPEN_BRACKET:219,DOM_VK_BACK_SLASH:220,DOM_VK_CLOSE_BRACKET:221,DOM_VK_QUOTE:222,DOM_VK_META:224}),function(){function t(e,t,n,r,i,s){t[e]&&(n.push(e),(t[e]===!0||t[e]===1)&&r.push(i+e+"/"+s))}function n(e,t,n,r,i){var s=r+t+"/"+i;require._fileExists(e.toUrl(s+".js"))&&n.push(s)}function r(e,t,n){var i;for(i in t)t.hasOwnProperty(i)&&(!e.hasOwnProperty(i)||n)?e[i]=t[i]:typeof t[i]=="object"&&r(e[i],t[i],n)}var e=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(i){var s=i.config?i.config():{};return{version:"2.0.1+",load:function(i,o,u,a){a=a||{},a.locale&&(s.locale=a.locale);var f,l=e.exec(i),c=l[1],h=l[4],p=l[5],d=h.split("-"),v=[],m={},g,y,b="";l[5]?(c=l[1],f=c+p):(f=i,p=l[4],h=s.locale,h||(h=s.locale=typeof navigator=="undefined"?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),d=h.split("-"));if(a.isBuild){v.push(f),n(o,"root",v,c,p);for(g=0;g<d.length;g++)y=d[g],b+=(b?"-":"")+y,n(o,b,v,c,p);o(v,function(){u()})}else o([f],function(e){var n=[],i;t("root",e,n,v,c,p);for(g=0;g<d.length;g++)i=d[g],b+=(b?"-":"")+i,t(b,e,n,v,c,p);o(v,function(){var t,i,s;for(t=n.length-1;t>-1&&n[t];t--){s=n[t],i=e[s];if(i===!0||i===1)i=o(c+s+"/"+p);r(m,i)}u(m)})})}}})}(),define("nls/strings",["require","exports","module"],function(e,t,n){n.exports={root:!0,cs:!0,da:!0,de:!0,el:!0,"en-gb":!0,es:!0,"fa-ir":!0,fi:!0,fr:!0,gl:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,nb:!0,nl:!0,pl:!0,"pt-br":!0,"pt-pt":!0,ro:!0,ru:!0,sk:!0,sr:!0,sv:!0,tr:!0,"zh-cn":!0,"zh-tw":!0}}),define("nls/root/strings",{GENERIC_ERROR:"(error {0})",NOT_FOUND_ERR:"The file could not be found.",NOT_READABLE_ERR:"The file could not be read.",NO_MODIFICATION_ALLOWED_ERR:"The target directory cannot be modified.",NO_MODIFICATION_ALLOWED_ERR_FILE:"The permissions do not allow you to make modifications.",CONTENTS_MODIFIED_ERR:"The file has been modified outside of {APP_NAME}.",UNSUPPORTED_ENCODING_ERR:"{APP_NAME} currently only supports UTF-8 encoded text files.",FILE_EXISTS_ERR:"The file or directory already exists.",FILE:"file",FILE_TITLE:"File",DIRECTORY:"directory",DIRECTORY_TITLE:"Directory",DIRECTORY_NAMES_LEDE:"Directory names",FILENAMES_LEDE:"Filenames",FILENAME:"Filename",DIRECTORY_NAME:"Directory Name",ERROR_LOADING_PROJECT:"Error Loading Project",OPEN_DIALOG_ERROR:"An error occurred when showing the open file dialog. (error {0})",REQUEST_NATIVE_FILE_SYSTEM_ERROR:"An error occurred when trying to load the directory <span class='dialog-filename'>{0}</span>. (error {1})",READ_DIRECTORY_ENTRIES_ERROR:"An error occurred when reading the contents of the directory <span class='dialog-filename'>{0}</span>. (error {1})",ERROR_OPENING_FILE_TITLE:"Error Opening File",ERROR_OPENING_FILE:"An error occurred when trying to open the file <span class='dialog-filename'>{0}</span>. {1}",ERROR_OPENING_FILES:"An error occurred when trying to open the following files:",ERROR_RELOADING_FILE_TITLE:"Error Reloading Changes From Disk",ERROR_RELOADING_FILE:"An error occurred when trying to reload the file <span class='dialog-filename'>{0}</span>. {1}",ERROR_SAVING_FILE_TITLE:"Error Saving File",ERROR_SAVING_FILE:"An error occurred when trying to save the file <span class='dialog-filename'>{0}</span>. {1}",ERROR_RENAMING_FILE_TITLE:"Error Renaming {0}",ERROR_RENAMING_FILE:"An error occurred when trying to rename the {2} <span class='dialog-filename'>{0}</span>. {1}",ERROR_DELETING_FILE_TITLE:"Error Deleting {0}",ERROR_DELETING_FILE:"An error occurred when trying to delete the {2} <span class='dialog-filename'>{0}</span>. {1}",INVALID_FILENAME_TITLE:"Invalid {0}",INVALID_FILENAME_MESSAGE:"{0} cannot use any system reserved words, end with dots (.) or use any of the following characters: <code class='emphasized'>{1}</code>",ENTRY_WITH_SAME_NAME_EXISTS:"A file or directory with the name <span class='dialog-filename'>{0}</span> already exists.",ERROR_CREATING_FILE_TITLE:"Error Creating {0}",ERROR_CREATING_FILE:"An error occurred when trying to create the {0} <span class='dialog-filename'>{1}</span>. {2}",ERROR_PREFS_CORRUPT_TITLE:"Error Reading Preferences",ERROR_PREFS_CORRUPT:"Your preferences file is not valid JSON. The file will be opened so that you can correct the format. You will need to restart {APP_NAME} for the changes to take effect.",ERROR_IN_BROWSER_TITLE:"Oops! {APP_NAME} Doesn't Run in Browsers Yet.",ERROR_IN_BROWSER:"{APP_NAME} is built in HTML, but right now it runs as a desktop app so you can use it to edit local files. Please use the application shell in the <b>github.com/adobe/brackets-shell</b> repo to run {APP_NAME}.",ERROR_MAX_FILES_TITLE:"Error Indexing Files",ERROR_MAX_FILES:"The maximum number of files have been indexed. Actions that look up files in the index may function incorrectly.",ERROR_LAUNCHING_BROWSER_TITLE:"Error Launching Browser",ERROR_CANT_FIND_CHROME:"The Google Chrome browser could not be found. Please make sure it is installed.",ERROR_LAUNCHING_BROWSER:"An error occurred when launching the browser. (error {0})",LIVE_DEVELOPMENT_ERROR_TITLE:"Live Preview Error",LIVE_DEVELOPMENT_RELAUNCH_TITLE:"Connecting to Browser",LIVE_DEVELOPMENT_ERROR_MESSAGE:"In order for Live Preview to connect, Chrome needs to be relaunched with remote debugging enabled.<br /><br />Would you like to relaunch Chrome and enable remote debugging?",LIVE_DEV_LOADING_ERROR_MESSAGE:"Unable to load Live Preview page",LIVE_DEV_NEED_HTML_MESSAGE:"Open an HTML file or make sure there is an index.html file in your project in order to launch live preview.",LIVE_DEV_NEED_BASEURL_MESSAGE:"To launch live preview with a server-side file, you need to specify a Base URL for this project.",LIVE_DEV_SERVER_NOT_READY_MESSAGE:"Error starting up the HTTP server for live preview files. Please try again.",LIVE_DEVELOPMENT_INFO_TITLE:"Welcome to Live Preview!",LIVE_DEVELOPMENT_INFO_MESSAGE:"Live Preview connects {APP_NAME} to your browser. It launches a preview of your HTML file in the browser, then updates the preview instantly as you edit your code.<br /><br />In this early version of {APP_NAME}, Live Preview only works with <strong>Google Chrome</strong> and updates live as you edit <strong>CSS or HTML files</strong>. Changes to JavaScript files are automatically reloaded when you save.<br /><br />(You'll only see this message once.)",LIVE_DEVELOPMENT_TROUBLESHOOTING:"For more information, see <a href='{0}' title='{0}'>Troubleshooting Live Preview connection errors</a>.",LIVE_DEV_STATUS_TIP_NOT_CONNECTED:"Live Preview",LIVE_DEV_STATUS_TIP_PROGRESS1:"Live Preview: Connecting…",LIVE_DEV_STATUS_TIP_PROGRESS2:"Live Preview: Initializing…",LIVE_DEV_STATUS_TIP_CONNECTED:"Disconnect Live Preview",LIVE_DEV_STATUS_TIP_OUT_OF_SYNC:"Live Preview (save file to refresh)",LIVE_DEV_STATUS_TIP_SYNC_ERROR:"Live Preview (not updating due to syntax error)",LIVE_DEV_DETACHED_REPLACED_WITH_DEVTOOLS:"Live Preview was cancelled because the browser's developer tools were opened",LIVE_DEV_DETACHED_TARGET_CLOSED:"Live Preview was cancelled because the page was closed in the browser",LIVE_DEV_NAVIGATED_AWAY:"Live Preview was cancelled because the browser navigated to a page that is not part of the current project",LIVE_DEV_CLOSED_UNKNOWN_REASON:"Live Preview was cancelled for an unknown reason ({0})",SAVE_CLOSE_TITLE:"Save Changes",SAVE_CLOSE_MESSAGE:"Do you want to save the changes you made in the document <span class='dialog-filename'>{0}</span>?",SAVE_CLOSE_MULTI_MESSAGE:"Do you want to save your changes to the following files?",EXT_MODIFIED_TITLE:"External Changes",CONFIRM_FOLDER_DELETE_TITLE:"Confirm Delete",CONFIRM_FOLDER_DELETE:"Are you sure you want to delete the folder <span class='dialog-filename'>{0}</span>?",FILE_DELETED_TITLE:"File Deleted",EXT_MODIFIED_WARNING:"<span class='dialog-filename'>{0}</span> has been modified on disk.<br /><br />Do you want to save the file and overwrite those changes?",EXT_MODIFIED_MESSAGE:"<span class='dialog-filename'>{0}</span> has been modified on disk, but also has unsaved changes in {APP_NAME}.<br /><br />Which version do you want to keep?",EXT_DELETED_MESSAGE:"<span class='dialog-filename'>{0}</span> has been deleted on disk, but has unsaved changes in {APP_NAME}.<br /><br />Do you want to keep your changes?",DONE:"Done",OK:"OK",CANCEL:"Cancel",DONT_SAVE:"Don't Save",SAVE:"Save",SAVE_AS:"Save As…",SAVE_AND_OVERWRITE:"Overwrite",DELETE:"Delete",BUTTON_YES:"Yes",BUTTON_NO:"No",FIND_RESULT_COUNT:"{0} results",FIND_RESULT_COUNT_SINGLE:"1 result",FIND_NO_RESULTS:"No results",FIND_QUERY_PLACEHOLDER:"Find…",REPLACE_PLACEHOLDER:"Replace with…",BUTTON_REPLACE_ALL:"Batch…",BUTTON_REPLACE_ALL_IN_FILES:"Replace…",BUTTON_REPLACE:"Replace",BUTTON_NEXT:"▶",BUTTON_PREV:"◀",BUTTON_NEXT_HINT:"Next Match",BUTTON_PREV_HINT:"Previous Match",BUTTON_CASESENSITIVE_HINT:"Match Case",BUTTON_REGEXP_HINT:"Regular Expression",REPLACE_WITHOUT_UNDO_WARNING_TITLE:"Replace Without Undo",REPLACE_WITHOUT_UNDO_WARNING:"Because more than {0} files need to be changed, {APP_NAME} will modify unopened files on disk.<br />You won't be able to undo replacements in those files.",BUTTON_REPLACE_WITHOUT_UNDO:"Replace Without Undo",OPEN_FILE:"Open File",SAVE_FILE_AS:"Save File",CHOOSE_FOLDER:"Choose a folder",RELEASE_NOTES:"Release Notes",NO_UPDATE_TITLE:"You're Up to Date!",NO_UPDATE_MESSAGE:"You are running the latest version of {APP_NAME}.",FIND_REPLACE_TITLE_LABEL:"Replace",FIND_REPLACE_TITLE_WITH:"with",FIND_TITLE_LABEL:"Found",FIND_TITLE_SUMMARY:"&mdash; {0} {1} {2} in {3}",FIND_NUM_FILES:"{0} {1}",FIND_IN_FILES_SCOPED:"in <span class='dialog-filename'>{0}</span>",FIND_IN_FILES_NO_SCOPE:"in project",FIND_IN_FILES_ZERO_FILES:"Filter excludes all files {0}",FIND_IN_FILES_FILE:"file",FIND_IN_FILES_FILES:"files",FIND_IN_FILES_MATCH:"match",FIND_IN_FILES_MATCHES:"matches",FIND_IN_FILES_MORE_THAN:"Over ",FIND_IN_FILES_PAGING:"{0}&mdash;{1}",FIND_IN_FILES_FILE_PATH:"<span class='dialog-filename'>{0}</span> {2} <span class='dialog-path'>{1}</span>",FIND_IN_FILES_EXPAND_COLLAPSE:"Ctrl/Cmd click to expand/collapse all",REPLACE_IN_FILES_ERRORS_TITLE:"Replace Errors",REPLACE_IN_FILES_ERRORS:"The following files weren't modified because they changed after the search or couldn't be written.",ERROR_FETCHING_UPDATE_INFO_TITLE:"Error Getting Update Info",ERROR_FETCHING_UPDATE_INFO_MSG:"There was a problem getting the latest update information from the server. Please make sure you are connected to the internet and try again.",NEW_FILE_FILTER:"New Exclusion Set…",CLEAR_FILE_FILTER:"Don't Exclude Files",NO_FILE_FILTER:"No Files Excluded",EXCLUDE_FILE_FILTER:"Exclude {0}",EDIT_FILE_FILTER:"Edit…",FILE_FILTER_DIALOG:"Edit Exclusion Set",FILE_FILTER_INSTRUCTIONS:"Exclude files and folders matching any of the following strings / substrings or <a href='{0}' title='{0}'>wildcards</a>. Enter each string on a new line.",FILTER_NAME_PLACEHOLDER:"Name this exclusion set (optional)",FILE_FILTER_CLIPPED_SUFFIX:"and {0} more",FILTER_COUNTING_FILES:"Counting files…",FILTER_FILE_COUNT:"Allows {0} of {1} files {2}",FILTER_FILE_COUNT_ALL:"Allows all {0} files {1}",ERROR_QUICK_EDIT_PROVIDER_NOT_FOUND:"No Quick Edit available for current cursor position",ERROR_CSSQUICKEDIT_BETWEENCLASSES:"CSS Quick Edit: place cursor on a single class name",ERROR_CSSQUICKEDIT_CLASSNOTFOUND:"CSS Quick Edit: incomplete class attribute",ERROR_CSSQUICKEDIT_IDNOTFOUND:"CSS Quick Edit: incomplete id attribute",ERROR_CSSQUICKEDIT_UNSUPPORTEDATTR:"CSS Quick Edit: place cursor in tag, class, or id",ERROR_TIMINGQUICKEDIT_INVALIDSYNTAX:"CSS Timing Function Quick Edit: invalid syntax",ERROR_JSQUICKEDIT_FUNCTIONNOTFOUND:"JS Quick Edit: place cursor in function name",ERROR_QUICK_DOCS_PROVIDER_NOT_FOUND:"No Quick Docs available for current cursor position",PROJECT_LOADING:"Loading…",UNTITLED:"Untitled",WORKING_FILES:"Working Files",KEYBOARD_CTRL:"Ctrl",KEYBOARD_SHIFT:"Shift",KEYBOARD_SPACE:"Space",STATUSBAR_CURSOR_POSITION:"Line {0}, Column {1}",STATUSBAR_SELECTION_CH_SINGULAR:" — Selected {0} column",STATUSBAR_SELECTION_CH_PLURAL:" — Selected {0} columns",STATUSBAR_SELECTION_LINE_SINGULAR:" — Selected {0} line",STATUSBAR_SELECTION_LINE_PLURAL:" — Selected {0} lines",STATUSBAR_SELECTION_MULTIPLE:" — {0} selections",STATUSBAR_INDENT_TOOLTIP_SPACES:"Click to switch indentation to spaces",STATUSBAR_INDENT_TOOLTIP_TABS:"Click to switch indentation to tabs",STATUSBAR_INDENT_SIZE_TOOLTIP_SPACES:"Click to change number of spaces used when indenting",STATUSBAR_INDENT_SIZE_TOOLTIP_TABS:"Click to change tab character width",STATUSBAR_SPACES:"Spaces:",STATUSBAR_TAB_SIZE:"Tab Size:",STATUSBAR_LINE_COUNT_SINGULAR:"— {0} Line",STATUSBAR_LINE_COUNT_PLURAL:"— {0} Lines",STATUSBAR_USER_EXTENSIONS_DISABLED:"Extensions Disabled",STATUSBAR_INSERT:"INS",STATUSBAR_OVERWRITE:"OVR",STATUSBAR_DEFAULT_LANG:"(default)",ERRORS_PANEL_TITLE_MULTIPLE:"{0} Problems",SINGLE_ERROR:"1 {0} Problem",MULTIPLE_ERRORS:"{1} {0} Problems",NO_ERRORS:"No {0} problems found - good job!",NO_ERRORS_MULTIPLE_PROVIDER:"No problems found - good job!",LINT_DISABLED:"Linting is disabled",NO_LINT_AVAILABLE:"No linter available for {0}",NOTHING_TO_LINT:"Nothing to lint",LINTER_TIMED_OUT:"{0} has timed out after waiting for {1} ms",LINTER_FAILED:"{0} terminated with error: {1}",FILE_MENU:"File",CMD_FILE_NEW_UNTITLED:"New",CMD_FILE_NEW:"New File",CMD_FILE_NEW_FOLDER:"New Folder",CMD_FILE_OPEN:"Open…",CMD_ADD_TO_WORKING_SET:"Add To Working Set",CMD_OPEN_DROPPED_FILES:"Open Dropped Files",CMD_OPEN_FOLDER:"Open Folder…",CMD_FILE_CLOSE:"Close",CMD_FILE_CLOSE_ALL:"Close All",CMD_FILE_CLOSE_LIST:"Close List",CMD_FILE_CLOSE_OTHERS:"Close Others",CMD_FILE_CLOSE_ABOVE:"Close Others Above",CMD_FILE_CLOSE_BELOW:"Close Others Below",CMD_FILE_SAVE:"Save",CMD_FILE_SAVE_ALL:"Save All",CMD_FILE_SAVE_AS:"Save As…",CMD_LIVE_FILE_PREVIEW:"Live Preview",CMD_RELOAD_LIVE_PREVIEW:"Force Reload Live Preview",CMD_PROJECT_SETTINGS:"Project Settings…",CMD_FILE_RENAME:"Rename",CMD_FILE_DELETE:"Delete",CMD_INSTALL_EXTENSION:"Install Extension…",CMD_EXTENSION_MANAGER:"Extension Manager…",CMD_FILE_REFRESH:"Refresh File Tree",CMD_QUIT:"Quit",CMD_EXIT:"Exit",EDIT_MENU:"Edit",CMD_UNDO:"Undo",CMD_REDO:"Redo",CMD_CUT:"Cut",CMD_COPY:"Copy",CMD_PASTE:"Paste",CMD_SELECT_ALL:"Select All",CMD_SELECT_LINE:"Select Line",CMD_SPLIT_SEL_INTO_LINES:"Split Selection into Lines",CMD_ADD_CUR_TO_NEXT_LINE:"Add Cursor to Next Line",CMD_ADD_CUR_TO_PREV_LINE:"Add Cursor to Previous Line",CMD_INDENT:"Indent",CMD_UNINDENT:"Unindent",CMD_DUPLICATE:"Duplicate",CMD_DELETE_LINES:"Delete Line",CMD_COMMENT:"Toggle Line Comment",CMD_BLOCK_COMMENT:"Toggle Block Comment",CMD_LINE_UP:"Move Line Up",CMD_LINE_DOWN:"Move Line Down",CMD_OPEN_LINE_ABOVE:"Open Line Above",CMD_OPEN_LINE_BELOW:"Open Line Below",CMD_TOGGLE_CLOSE_BRACKETS:"Auto Close Braces",CMD_SHOW_CODE_HINTS:"Show Code Hints",FIND_MENU:"Find",CMD_FIND:"Find",CMD_FIND_NEXT:"Find Next",CMD_FIND_PREVIOUS:"Find Previous",CMD_FIND_ALL_AND_SELECT:"Find All and Select",CMD_ADD_NEXT_MATCH:"Add Next Match to Selection",CMD_SKIP_CURRENT_MATCH:"Skip and Add Next Match",CMD_FIND_IN_FILES:"Find in Files",CMD_FIND_IN_SELECTED:"Find in Selected File/Folder",CMD_FIND_IN_SUBTREE:"Find in…",CMD_REPLACE:"Replace",CMD_REPLACE_IN_FILES:"Replace in Files",CMD_REPLACE_IN_SELECTED:"Replace in Selected File/Folder",CMD_REPLACE_IN_SUBTREE:"Replace in…",VIEW_MENU:"View",CMD_HIDE_SIDEBAR:"Hide Sidebar",CMD_SHOW_SIDEBAR:"Show Sidebar",CMD_INCREASE_FONT_SIZE:"Increase Font Size",CMD_DECREASE_FONT_SIZE:"Decrease Font Size",CMD_RESTORE_FONT_SIZE:"Restore Font Size",CMD_SCROLL_LINE_UP:"Scroll Line Up",CMD_SCROLL_LINE_DOWN:"Scroll Line Down",CMD_TOGGLE_LINE_NUMBERS:"Line Numbers",CMD_TOGGLE_ACTIVE_LINE:"Highlight Active Line",CMD_TOGGLE_WORD_WRAP:"Word Wrap",CMD_LIVE_HIGHLIGHT:"Live Preview Highlight",CMD_VIEW_TOGGLE_INSPECTION:"Lint Files on Save",CMD_SORT_WORKINGSET_BY_ADDED:"Sort by Added",CMD_SORT_WORKINGSET_BY_NAME:"Sort by Name",CMD_SORT_WORKINGSET_BY_TYPE:"Sort by Type",CMD_SORT_WORKINGSET_AUTO:"Automatic Sort",CMD_THEMES:"Themes…",NAVIGATE_MENU:"Navigate",CMD_QUICK_OPEN:"Quick Open",CMD_GOTO_LINE:"Go to Line",CMD_GOTO_DEFINITION:"Quick Find Definition",CMD_GOTO_FIRST_PROBLEM:"Go to First Error/Warning",CMD_TOGGLE_QUICK_EDIT:"Quick Edit",CMD_TOGGLE_QUICK_DOCS:"Quick Docs",CMD_QUICK_EDIT_PREV_MATCH:"Previous Match",CMD_QUICK_EDIT_NEXT_MATCH:"Next Match",CMD_CSS_QUICK_EDIT_NEW_RULE:"New Rule",CMD_NEXT_DOC:"Next Document",CMD_PREV_DOC:"Previous Document",CMD_SHOW_IN_TREE:"Show in File Tree",CMD_SHOW_IN_EXPLORER:"Show in Explorer",CMD_SHOW_IN_FINDER:"Show in Finder",CMD_SHOW_IN_OS:"Show in OS",HELP_MENU:"Help",CMD_CHECK_FOR_UPDATE:"Check for Updates",CMD_HOW_TO_USE_BRACKETS:"How to Use {APP_NAME}",CMD_SUPPORT:"{APP_NAME} Support",CMD_SUGGEST:"Suggest a Feature",CMD_RELEASE_NOTES:"Release Notes",CMD_GET_INVOLVED:"Get Involved",CMD_SHOW_EXTENSIONS_FOLDER:"Show Extensions Folder",CMD_HOMEPAGE:"{APP_TITLE} Homepage",CMD_TWITTER:"{TWITTER_NAME} on Twitter",CMD_ABOUT:"About {APP_TITLE}",CMD_OPEN_PREFERENCES:"Open Preferences File",EXPERIMENTAL_BUILD:"experimental build",DEVELOPMENT_BUILD:"development build",RELOAD_FROM_DISK:"Reload from Disk",KEEP_CHANGES_IN_EDITOR:"Keep Changes in Editor",CLOSE_DONT_SAVE:"Close (Don't Save)",RELAUNCH_CHROME:"Relaunch Chrome",ABOUT:"About",CLOSE:"Close",ABOUT_TEXT_LINE1:"sprint {VERSION_MINOR} {BUILD_TYPE} {VERSION}",ABOUT_TEXT_BUILD_TIMESTAMP:"build timestamp: ",ABOUT_TEXT_LINE3:"Notices, terms and conditions pertaining to third party software are located at <a href='{ADOBE_THIRD_PARTY}'>{ADOBE_THIRD_PARTY}</a> and incorporated by reference herein.",ABOUT_TEXT_LINE4:"Documentation and source at <a href='https://github.com/adobe/brackets/'>https://github.com/adobe/brackets/</a>",ABOUT_TEXT_LINE5:"Made with ❤ and JavaScript by:",ABOUT_TEXT_LINE6:"Lots of people (but we're having trouble loading that data right now).",ABOUT_TEXT_WEB_PLATFORM_DOCS:"Web Platform Docs and the Web Platform graphical logo are licensed under a Creative Commons Attribution license, <a href='{WEB_PLATFORM_DOCS_LICENSE}'>CC-BY 3.0 Unported</a>.",UPDATE_NOTIFICATION_TOOLTIP:"There's a new build of {APP_NAME} available! Click here for details.",UPDATE_AVAILABLE_TITLE:"Update Available",UPDATE_MESSAGE:"Hey, there's a new build of {APP_NAME} available. Here are some of the new features:",GET_IT_NOW:"Get it now!",PROJECT_SETTINGS_TITLE:"Project Settings for: {0}",PROJECT_SETTING_BASE_URL:"Live Preview Base URL",PROJECT_SETTING_BASE_URL_HINT:"To use a local server, enter a url like http://localhost:8000/",BASEURL_ERROR_INVALID_PROTOCOL:"The {0} protocol isn't supported by Live Preview&mdash;please use http: or https: .",BASEURL_ERROR_SEARCH_DISALLOWED:'The base URL can\'t contain search parameters like "{0}".',BASEURL_ERROR_HASH_DISALLOWED:'The base URL can\'t contain hashes like "{0}".',BASEURL_ERROR_INVALID_CHAR:"Special characters like '{0}' must be %-encoded.",BASEURL_ERROR_UNKNOWN_ERROR:"Unknown error parsing Base URL",CURRENT_THEME:"Current Theme",USE_THEME_SCROLLBARS:"Use Theme Scrollbars",FONT_SIZE:"Font Size",FONT_FAMILY:"Font Family",BUTTON_NEW_RULE:"New Rule",INSTALL:"Install",UPDATE:"Update",REMOVE:"Remove",OVERWRITE:"Overwrite",CANT_REMOVE_DEV:'Extensions in the "dev" folder must be manually deleted.',CANT_UPDATE:"The update isn't compatible with this version of {APP_NAME}.",CANT_UPDATE_DEV:'Extensions in the "dev" folder can\'t be updated automatically.',INSTALL_EXTENSION_TITLE:"Install Extension",UPDATE_EXTENSION_TITLE:"Update Extension",INSTALL_EXTENSION_LABEL:"Extension URL",INSTALL_EXTENSION_HINT:"URL of the extension's zip file or GitHub repo",INSTALLING_FROM:"Installing extension from {0}…",INSTALL_SUCCEEDED:"Installation successful!",INSTALL_FAILED:"Installation failed.",CANCELING_INSTALL:"Canceling…",CANCELING_HUNG:"Canceling the install is taking a long time. An internal error may have occurred.",INSTALL_CANCELED:"Installation canceled.",VIEW_COMPLETE_DESCRIPTION:"View complete description",VIEW_TRUNCATED_DESCRIPTION:"View truncated description",INVALID_ZIP_FILE:"The downloaded content is not a valid zip file.",INVALID_PACKAGE_JSON:"The package.json file is not valid (error was: {0}).",MISSING_PACKAGE_NAME:"The package.json file doesn't specify a package name.",BAD_PACKAGE_NAME:"{0} is an invalid package name.",MISSING_PACKAGE_VERSION:"The package.json file doesn't specify a package version.",INVALID_VERSION_NUMBER:"The package version number ({0}) is invalid.",INVALID_BRACKETS_VERSION:"The {APP_NAME} compatibility string ({0}) is invalid.",DISALLOWED_WORDS:"The words ({1}) are not allowed in the {0} field.",API_NOT_COMPATIBLE:"The extension isn't compatible with this version of {APP_NAME}. It's installed in your disabled extensions folder.",MISSING_MAIN:"The package has no main.js file.",EXTENSION_ALREADY_INSTALLED:"Installing this package will overwrite a previously installed extension. Overwrite the old extension?",EXTENSION_SAME_VERSION:"This package is the same version as the one that is currently installed. Overwrite the existing installation?",EXTENSION_OLDER_VERSION:"This package is version {0} which is older than the currently installed ({1}). Overwrite the existing installation?",DOWNLOAD_ID_IN_USE:"Internal error: download ID already in use.",NO_SERVER_RESPONSE:"Cannot connect to server.",BAD_HTTP_STATUS:"File not found on server (HTTP {0}).",CANNOT_WRITE_TEMP:"Unable to save download to temp file.",ERROR_LOADING:"The extension encountered an error while starting up.",MALFORMED_URL:"The URL is invalid. Please check that you entered it correctly.",UNSUPPORTED_PROTOCOL:"The URL must be an http or https URL.",UNKNOWN_ERROR:"Unknown internal error.",EXTENSION_MANAGER_TITLE:"Extension Manager",EXTENSION_MANAGER_ERROR_LOAD:"Unable to access the extension registry. Please try again later.",INSTALL_EXTENSION_DRAG:"Drag .zip here or",INSTALL_EXTENSION_DROP:"Drop .zip to install",INSTALL_EXTENSION_DROP_ERROR:"Install/Update aborted due to the following errors:",INSTALL_FROM_URL:"Install from URL…",INSTALL_EXTENSION_VALIDATING:"Validating…",EXTENSION_AUTHOR:"Author",EXTENSION_DATE:"Date",EXTENSION_INCOMPATIBLE_NEWER:"This extension requires a newer version of {APP_NAME}.",EXTENSION_INCOMPATIBLE_OLDER:"This extension currently only works with older versions of {APP_NAME}.",EXTENSION_LATEST_INCOMPATIBLE_NEWER:"Version {0} of this extension requires a newer version of {APP_NAME}. But you can install the earlier version {1}.",EXTENSION_LATEST_INCOMPATIBLE_OLDER:"Version {0} of this extension only works with older versions of {APP_NAME}. But you can install the earlier version {1}.",EXTENSION_NO_DESCRIPTION:"No description",EXTENSION_MORE_INFO:"More info...",EXTENSION_ERROR:"Extension error",EXTENSION_KEYWORDS:"Keywords",EXTENSION_TRANSLATED_USER_LANG:"Translated into {0} languages, including yours",EXTENSION_TRANSLATED_GENERAL:"Translated into {0} languages",EXTENSION_TRANSLATED_LANGS:"This extension has been translated into these languages: {0}",EXTENSION_INSTALLED:"Installed",EXTENSION_UPDATE_INSTALLED:"This extension update has been downloaded and will be installed after {APP_NAME} reloads.",EXTENSION_SEARCH_PLACEHOLDER:"Search",EXTENSION_MORE_INFO_LINK:"More",BROWSE_EXTENSIONS:"Browse Extensions",EXTENSION_MANAGER_REMOVE:"Remove Extension",EXTENSION_MANAGER_REMOVE_ERROR:"Unable to remove one or more extensions: {0}. {APP_NAME} will still reload.",EXTENSION_MANAGER_UPDATE:"Update Extension",EXTENSION_MANAGER_UPDATE_ERROR:"Unable to update one or more extensions: {0}. {APP_NAME} will still reload.",MARKED_FOR_REMOVAL:"Marked for removal",UNDO_REMOVE:"Undo",MARKED_FOR_UPDATE:"Marked for update",UNDO_UPDATE:"Undo",CHANGE_AND_RELOAD_TITLE:"Change Extensions",CHANGE_AND_RELOAD_MESSAGE:"To update or remove the marked extensions, {APP_NAME} will need to reload. You'll be prompted to save unsaved changes.",REMOVE_AND_RELOAD:"Remove Extensions and Reload",CHANGE_AND_RELOAD:"Change Extensions and Reload",UPDATE_AND_RELOAD:"Update Extensions and Reload",PROCESSING_EXTENSIONS:"Processing extension changes…",EXTENSION_NOT_INSTALLED:"Couldn't remove extension {0} because it wasn't installed.",NO_EXTENSIONS:"No extensions installed yet.<br>Click on the Available tab above to get started.",NO_EXTENSION_MATCHES:"No extensions match your search.",REGISTRY_SANITY_CHECK_WARNING:"Be cautious when installing extensions from an unknown source.",EXTENSIONS_INSTALLED_TITLE:"Installed",EXTENSIONS_AVAILABLE_TITLE:"Available",EXTENSIONS_UPDATES_TITLE:"Updates",INLINE_EDITOR_NO_MATCHES:"No matches available.",CSS_QUICK_EDIT_NO_MATCHES:'There are no existing CSS rules that match your selection.<br> Click "New Rule" to create one.',CSS_QUICK_EDIT_NO_STYLESHEETS:"There are no stylesheets in your project.<br>Create one to add CSS rules.",IMAGE_VIEWER_LARGEST_ICON:"largest",UNIT_PIXELS:"pixels",DEBUG_MENU:"Debug",ERRORS:"Errors",CMD_SHOW_DEV_TOOLS:"Show Developer Tools",CMD_REFRESH_WINDOW:"Reload With Extensions",CMD_RELOAD_WITHOUT_USER_EXTS:"Reload Without Extensions",CMD_NEW_BRACKETS_WINDOW:"New {APP_NAME} Window",CMD_SWITCH_LANGUAGE:"Switch Language",CMD_RUN_UNIT_TESTS:"Run Tests",CMD_SHOW_PERF_DATA:"Show Performance Data",CMD_ENABLE_NODE_DEBUGGER:"Enable Node Debugger",CMD_LOG_NODE_STATE:"Log Node State to Console",CMD_RESTART_NODE:"Restart Node",CMD_SHOW_ERRORS_IN_STATUS_BAR:"Show Errors in Status Bar",LANGUAGE_TITLE:"Switch Language",LANGUAGE_MESSAGE:"Language:",LANGUAGE_SUBMIT:"Reload {APP_NAME}",LANGUAGE_CANCEL:"Cancel",LANGUAGE_SYSTEM_DEFAULT:"System Default",INLINE_TIMING_EDITOR_TIME:"Time",INLINE_TIMING_EDITOR_PROGRESSION:"Progression",BEZIER_EDITOR_INFO:"<kbd>↑</kbd><kbd>↓</kbd><kbd>←</kbd><kbd>→</kbd> Move selected point<br><kbd class='text'>Shift</kbd> Move by ten units<br><kbd class='text'>Tab</kbd> Switch points",STEPS_EDITOR_INFO:"<kbd>↑</kbd><kbd>↓</kbd> Increase or decrease steps<br><kbd>←</kbd><kbd>→</kbd> 'Start' or 'End'",INLINE_TIMING_EDITOR_INVALID:"The old value <code>{0}</code> is not valid, so the displayed function was changed to <code>{1}</code>. The document will be updated with the first edit.",COLOR_EDITOR_CURRENT_COLOR_SWATCH_TIP:"Current Color",COLOR_EDITOR_ORIGINAL_COLOR_SWATCH_TIP:"Original Color",COLOR_EDITOR_RGBA_BUTTON_TIP:"RGBa Format",COLOR_EDITOR_HEX_BUTTON_TIP:"Hex Format",COLOR_EDITOR_HSLA_BUTTON_TIP:"HSLa Format",COLOR_EDITOR_USED_COLOR_TIP_SINGULAR:"{0} (Used {1} time)",COLOR_EDITOR_USED_COLOR_TIP_PLURAL:"{0} (Used {1} times)",CMD_JUMPTO_DEFINITION:"Jump to Definition",CMD_SHOW_PARAMETER_HINT:"Show Parameter Hint",NO_ARGUMENTS:"<no parameters>",DETECTED_EXCLUSION_TITLE:"JavaScript File Inference Problem",DETECTED_EXCLUSION_INFO:"Brackets ran into trouble processing:<br><br>{0}<br><br>This file will no longer be processed for code hints and jump to definition. To turn this back on, open <code>.brackets.json</code> in your project and remove the file from jscodehints.detectedExclusions.",JSLINT_NAME:"JSLint",CMD_ENABLE_QUICK_VIEW:"Quick View on Hover",CMD_TOGGLE_RECENT_PROJECTS:"Recent Projects",DOCS_MORE_LINK:"Read more"}),define("nls/urls",["require","exports","module"],function(e,t,n){n.exports={root:!0,cs:!0,da:!0,de:!0,es:!0,"fa-ir":!0,fi:!0,fr:!0,hr:!0,id:!0,it:!0,ja:!0,ko:!0,nb:!0,pl:!0,"pt-br":!0,"pt-pt":!0,ru:!0,sv:!0,"zh-cn":!0,tr:!0}}),define("nls/root/urls",{GETTING_STARTED:"root/Getting Started",ADOBE_THIRD_PARTY:"http://www.adobe.com/go/thirdparty/",WEB_PLATFORM_DOCS_LICENSE:"http://creativecommons.org/licenses/by/3.0/"}),define("nls/strings-app",["require","exports","module"],function(e,t,n){n.exports={root:!0}}),define("nls/root/strings-app",{APP_NAME:"Brackets",LOCALE_CS:"čeština",LOCALE_DA:"Dansk",LOCALE_DE:"Deutsch",LOCALE_EL:"Ελληνικά",LOCALE_EN:"English (US)",LOCALE_EN_GB:"English (UK)",LOCALE_ES:"español",LOCALE_FA_IR:"فارسی",LOCALE_FI:"suomi",LOCALE_FR:"français",LOCALE_GL:"galego",LOCALE_HR:"hrvatski",LOCALE_HU:"magyar",LOCALE_ID:"Bahasa Indonesia",LOCALE_IT:"italiano",LOCALE_JA:"日本語",LOCALE_KO:"한국어",LOCALE_NB:"norsk",LOCALE_NL:"Nederlands",LOCALE_PL:"polski",LOCALE_PT_BR:"português (BR)",LOCALE_PT_PT:"português (PT)",LOCALE_RO:"română",LOCALE_RU:"русский",LOCALE_SK:"slovenčina",LOCALE_SR:"Српски",LOCALE_SV:"svenska",LOCALE_TR:"Türkçe",LOCALE_ZH_CN:"简体中文",LOCALE_ZH_TW:"繁體中文"}),define("utils/StringUtils",["require","exports","module","thirdparty/lodash"],function(e,t,n){function i(e){var t=[].slice.call(arguments,1);return e.replace(/\{(\d+)\}/g,function(e,n){return typeof t[n]!="undefined"?t[n]:e})}function s(e){return console.warn("StringUtils.htmlEscape is deprecated. Use _.escape instead."),r.escape(e)}function o(e){return e.replace(/([.?*+\^$\[\]\\(){}|\-])/g,"\\$1")}function u(e){return e.replace(/\./g,"\\.")}function a(e){return e.split("\n")}function f(e,t){if(Array.isArray(e)){var n=e,r=0,i;for(i=0;i<n.length;i++){if(!(r<t))return r===t?i:i-1;r+=n[i].length+1}return t<=r?i-1:undefined}return e.substr(0,t).split("\n").length-1}function l(e,t){return e.indexOf(t,e.length-t.length)!==-1}function c(e,t){function i(e){return e.lastIndexOf("/")+1<e.length}var n,r;return brackets.platform==="win"?(n=(i(e)?"1":"0")+e.toLowerCase(),r=(i(t)?"1":"0")+t.toLowerCase()):(n=e.toLowerCase(),r=t.toLowerCase()),n===r?0:n>r?1:-1}function h(e){var t=r.escape(e);return t.replace(new RegExp(o("/"),"g"),"/&#8203;")}function p(e,t){var n=1024,r=n*1024,i=r*1024,s=i*1024,o=e;if(e>=0&&e<n)o=e+" B";else if(e<r)o=(e/n).toFixed(t)+" KB";else if(e<i)o=(e/r).toFixed(t)+" MB";else if(e<s)o=(e/i).toFixed(t)+" GB";else if(e>=s)return(e/s).toFixed(t)+" TB";return o}function d(e,t){if(e.length>t){e=e.substr(0,t);var n=e.lastIndexOf(" ");return n<t&&n>-1&&(e=e.substr(0,n)),e}}var r=e("thirdparty/lodash");t.format=i,t.htmlEscape=s,t.regexEscape=o,t.jQueryIdEscape=u,t.getLines=a,t.offsetToLineNum=f,t.urlSort=c,t.breakableUrl=h,t.endsWith=l,t.prettyPrintBytes=p,t.truncate=d}),define("strings",["require","exports","module","thirdparty/lodash","i18n!nls/strings","i18n!nls/urls","i18n!nls/strings-app","utils/Global","utils/StringUtils"],function(e,t,n){var r=e("thirdparty/lodash"),i=e("i18n!nls/strings"),s=e("i18n!nls/urls"),o=e("i18n!nls/strings-app"),u=e("utils/Global"),a=e("utils/StringUtils"),f=$.extend({},s),l=/([0-9]+)\.([0-9]+)\.([0-9]+)/.exec(brackets.metadata.version);f.APP_NAME=brackets.metadata.name||i.APP_NAME,f.APP_TITLE=brackets.config.app_title||i.APP_NAME,f.TWITTER_NAME=brackets.config.twitter_name,f.VERSION=brackets.metadata.version,f.VERSION_MAJOR=l[1],f.VERSION_MINOR=l[2],f.VERSION_PATCH=l[3];var c=!a.endsWith(decodeURI(window.location.pathname),"/www/index.html");f.BUILD_TYPE=c?i.DEVELOPMENT_BUILD:i.EXPERIMENTAL_BUILD,r.forEach(i,function(e,t){r.forEach(f,function(e,n){i[t]=i[t].replace(new RegExp("{"+n+"}","g"),f[n])})}),r.forEach(o,function(e,t){r.forEach(f,function(e,n){o[t]=o[t].replace(new RegExp("{"+n+"}","g"),f[n])}),i[t]=o[t]}),n.exports=i}),define("text!base-config/keyboard.json",[],function(){return'{\n    "file.newDoc":  [\n        "Ctrl-N"\n    ],\n    "file.open":  [\n        "Ctrl-O"\n    ],\n    "file.close":  [\n        "Ctrl-W"\n    ],\n    "file.openFolder": [\n        "Ctrl-Alt-O"\n    ],\n    "file.close_all":  [\n        "Ctrl-Shift-W"\n    ],\n    "file.save":  [\n        "Ctrl-S"\n    ],\n    "file.saveAll":  [\n        "Ctrl-Alt-S"\n    ],\n    "file.saveAs":  [\n        "Ctrl-Shift-S"\n    ],    \n    "file.liveFilePreview":  [\n        "Ctrl-Alt-P"\n    ],\n    "file.reloadLivePreview": [\n        {\n            "key": "Ctrl-Shift-R"\n        }\n    ],\n    "file.previewHighlight":  [\n        "Ctrl-Shift-C"\n    ],\n    "file.quit":  [\n        "Ctrl-Q"\n    ],\n    "edit.undo": [\n        "Ctrl-Z"\n    ],\n    "edit.redo": [\n        {\n            "key": "Ctrl-Y"\n        },\n        {\n            "key": "Cmd-Shift-Z",\n            "platform": "mac"\n        }\n    ],\n    "edit.cut": [\n        "Ctrl-X"\n    ],\n    "edit.copy": [\n        "Ctrl-C"\n    ],\n    "edit.paste": [\n        "Ctrl-V"\n    ],\n    "edit.selectAll":  [\n        "Ctrl-A"\n    ],\n    "edit.selectLine":  [\n        {\n            "key": "Ctrl-L"\n        },\n        {\n            "key": "Ctrl-L",\n            "platform": "mac"\n        }\n    ],\n    "edit.splitSelIntoLines": [\n        "Ctrl-Alt-L"\n    ],\n    "edit.addCursorToPrevLine": [\n        {\n            "key": "Shift-Alt-Up",\n            "displayKey": "Shift-Alt-↑"\n        }\n    ],\n    "edit.addCursorToNextLine": [\n        {\n            "key": "Shift-Alt-Down",\n            "displayKey": "Shift-Alt-↓"\n        }\n    ],\n    "edit.indent":  [\n        {\n            "key": "Ctrl-]"\n        }\n    ],\n    "edit.unindent":  [\n        {\n            "key": "Ctrl-["\n        }\n    ],\n    "edit.duplicate":  [\n        "Ctrl-D"\n    ],\n    "edit.deletelines":  [\n        "Ctrl-Shift-D"\n    ],\n    "edit.lineUp":  [\n        {\n            "key": "Ctrl-Shift-Up",\n            "displayKey": "Ctrl-Shift-↑"\n        },\n        {\n            "key": "Cmd-Ctrl-Up",\n            "displayKey": "Cmd-Ctrl-↑",\n            "platform": "mac"\n        }\n    ],\n    "edit.lineDown":  [\n        {\n            "key": "Ctrl-Shift-Down",\n            "displayKey": "Ctrl-Shift-↓"\n        },\n        {\n            "key": "Cmd-Ctrl-Down",\n            "displayKey": "Cmd-Ctrl-↓",\n            "platform": "mac"\n        }\n    ],\n    "edit.openLineAbove":  [\n        "Ctrl-Shift-Enter"\n    ],\n    "edit.openLineBelow":  [\n        "Ctrl-Enter"\n    ],\n    "edit.lineComment":  [\n        "Ctrl-/"\n    ],\n    "edit.blockComment":  [\n        {\n            "key": "Ctrl-Shift-/"\n        },\n        {\n            "key": "Cmd-Opt-/",\n            "platform": "mac"\n        }\n    ],\n    "edit.showCodeHints":  [\n        {\n            "key": "Ctrl-Space"\n        },\n        {\n            "key": "Ctrl-Space",\n            "platform": "mac"\n        }\n    ],\n    "cmd.find":  [\n        "Ctrl-F"\n    ],\n    "cmd.findInFiles":  [\n        "Ctrl-Shift-F"\n    ],\n    "cmd.replaceInFiles":  [\n        "Ctrl-Alt-Shift-F"\n    ],\n    "cmd.findNext":  [\n        {\n            "key": "F3"\n        },\n        {\n            "key": "Cmd-G",\n            "platform": "mac"\n        }\n    ],\n    "cmd.findPrevious":  [\n        {\n            "key": "Shift-F3"\n        },\n        {\n            "key": "Cmd-Shift-G",\n            "platform": "mac"\n        }\n    ],\n    "cmd.findAllAndSelect": [\n        {\n            "key": "Alt-F3"\n        },\n        {\n            "key": "Cmd-Ctrl-G",\n            "platform": "mac"\n        }\n    ],\n    "cmd.addNextMatch": [\n        {\n            "key": "Ctrl-B"\n        }\n    ],\n    "cmd.skipCurrentMatch": [\n        {\n            "key": "Ctrl-Shift-B"\n        }\n    ],\n    "cmd.replace":  [\n        {\n            "key": "Ctrl-H"\n        },\n        {\n            "key": "Cmd-Alt-F",\n            "platform": "mac"\n        }\n    ],\n    "view.hideSidebar":  [\n        "Ctrl-Shift-H"\n    ],\n    "view.increaseFontSize":  [\n        {\n            "key": "Ctrl-=",\n            "displayKey": "Cmd-+"\n        },\n        {\n            "key": "Ctrl-+",\n            "displayKey": "Cmd-+"\n        }\n    ],\n    "view.decreaseFontSize":  [\n        {\n            "key": "Ctrl--",\n            "displayKey": "Cmd-−"\n        }\n    ],\n    "view.restoreFontSize":  [\n        "Ctrl-0"\n    ],\n    "view.scrollLineUp":  [\n        {\n            "key": "Ctrl-Up",\n            "displayKey": "Ctrl-\\u2191"\n        },\n        {\n            "key": "Ctrl-Alt-Up",\n            "displayKey": "Ctrl-Alt-\\u2191",\n            "platform": "mac"\n        }\n    ],\n    "view.scrollLineDown":  [\n        {\n            "key": "Ctrl-Down",\n            "displayKey": "Ctrl-\\u2193"\n        },\n        {\n            "key": "Ctrl-Alt-Down",\n            "displayKey": "Ctrl-Alt-\\u2193",\n            "platform": "mac"\n        }\n    ],\n    "navigate.quickOpen":  [\n        "Ctrl-Shift-O"\n    ],\n    "navigate.gotoLine":  [\n        {\n            "key": "Ctrl-G"\n        },\n        {\n            "key": "Cmd-L",\n            "platform": "mac"\n        }\n    ],\n    "navigate.gotoDefinition":  [\n        "Ctrl-T"\n    ],\n    "navigate.jumptoDefinition":  [\n        "Ctrl-J"\n    ],\n    "navigate.gotoFirstProblem":  [\n        {\n            "key": "F8"\n        },\n        {\n            "key": "Cmd-\'",\n            "platform": "mac"\n        }\n    ],\n    "navigate.nextDoc":  [\n        {\n            "key": "Ctrl-Tab"\n        },\n        {\n            "key": "Ctrl-Tab",\n            "platform": "mac"\n        },\n        {\n            "key": "Cmd-Shift-]",\n            "platform": "mac"\n        }\n    ],\n    "navigate.prevDoc":  [\n        {\n            "key": "Ctrl-Shift-Tab"\n        },\n        {\n            "key": "Ctrl-Shift-Tab",\n            "platform": "mac"\n        },\n        {\n            "key": "Cmd-Shift-[",\n            "platform": "mac"\n        }\n    ],\n    "navigate.toggleQuickEdit":  [\n        "Ctrl-E"\n    ],\n    "navigate.toggleQuickDocs":  [\n        "Ctrl-K"\n    ],\n    "navigate.previousMatch":  [\n        {\n            "key": "Alt-Up",\n            "displayKey": "Alt-↑"\n        }\n    ],\n    "navigate.nextMatch":  [\n        {\n            "key": "Alt-Down",\n            "displayKey": "Alt-↓"\n        }\n    ],\n    "navigate.newRule":  [\n        "Cmd-Alt-N"\n    ],\n    "file.rename":  [\n        "F2"\n    ],\n    "help.support": [\n        "F1"\n    ]\n}\n'}),define("command/KeyBindingManager",["require","exports","module","utils/Global","utils/AppInit","command/CommandManager","utils/KeyEvent","strings","text!base-config/keyboard.json"],function(e,t,n){function h(){a={},f={},c=[]}function p(e,t,n,r,i){if(!i)return console.log("KeyBindingManager _buildKeyDescriptor() - No key provided!"),"";var s=[];return e&&s.push("Ctrl"),n&&s.push("Alt"),r&&s.push("Shift"),t&&(brackets.platform==="mac"?s.push("Cmd"):s.unshift("Ctrl")),s.push(i),s.join("-")}function d(e){function u(e,t){return!e||!t?!1:(e=e.trim().toLowerCase(),t=t.trim().toLowerCase(),e.length>0&&e===t)}var t=!1,n=!1,r=!1,i=!1,s="",o=!1;return e.split("-").forEach(function(f,l,c){u("ctrl",f)?brackets.platform==="mac"?t=!0:n=!0:u("cmd",f)?n=!0:u("alt",f)?r=!0:u("opt",f)?r=!0:u("shift",f)?i=!0:s.length>0?(console.log("KeyBindingManager normalizeKeyDescriptorString() - Multiple keys defined. Using key: "+s+" from: "+e),o=!0):s=f}),o?null:(s===""&&e.search(/^.+--$/)!==-1&&(s="-"),s.indexOf("+")>=0&&s.length>1?null:p(t,n,r,i,s))}function v(e,t){if(e>=s.DOM_VK_0&&e<=s.DOM_VK_9)return String(e-s.DOM_VK_0);if(e>=s.DOM_VK_NUMPAD0&&e<=s.DOM_VK_NUMPAD9)return String(e-s.DOM_VK_NUMPAD0);switch(e){case s.DOM_VK_SEMICOLON:return";";case s.DOM_VK_EQUALS:return"=";case s.DOM_VK_COMMA:return",";case s.DOM_VK_SUBTRACT:case s.DOM_VK_DASH:return"-";case s.DOM_VK_ADD:return"+";case s.DOM_VK_DECIMAL:case s.DOM_VK_PERIOD:return".";case s.DOM_VK_DIVIDE:case s.DOM_VK_SLASH:return"/";case s.DOM_VK_BACK_QUOTE:return"`";case s.DOM_VK_OPEN_BRACKET:return"[";case s.DOM_VK_BACK_SLASH:return"\\";case s.DOM_VK_CLOSE_BRACKET:return"]";case s.DOM_VK_QUOTE:return"'";default:return t}}function m(e){var t=brackets.platform==="mac"?e.ctrlKey:!1,n=brackets.platform!=="mac"?e.ctrlKey:e.metaKey,r=e.altKey,i=e.shiftKey,s=String.fromCharCode(e.keyCode),o=e.keyIdentifier;return o&&(o.charAt(0)==="U"&&o.charAt(1)==="+"?s=String.fromCharCode(parseInt(o.substring(2),16)):s=o),s==="	"?s="Tab":s===" "?s="Space":s=v(e.keyCode,s),p(t,n,r,i,s)}function g(e){var t;return brackets.platform==="mac"?(t=e.replace(/-(?!$)/g,""),t=t.replace("Ctrl","⌃"),t=t.replace("Cmd","⌘"),t=t.replace("Shift","⇧"),t=t.replace("Alt","⌥")):(t=e.replace("Ctrl",o.KEYBOARD_CTRL),t=t.replace("Shift",o.KEYBOARD_SHIFT),t=t.replace("Space",o.KEYBOARD_SPACE),t=t.replace(/-(?!$)/g,"+")),t}function y(e){return a[e]!==undefined}function b(e,t){if(!e||t!==null&&t!==undefined&&t!==brackets.platform)return;var n=d(e);if(!n)console.log("Fail to nomalize "+e);else if(y(n)){var r=a[n],s=i.get(r.commandID),o=f[r.commandID];delete a[n],o&&(f[r.commandID]=o.filter(function(e){return e.key!==n}),s&&$(s).triggerHandler("keyBindingRemoved",[{key:n,displayKey:r.displayKey}]))}}function w(e,n,r){var s,o=null,u,l,c=n.platform||r,h,p,v=[],m;c&&c!=="all"?h=c:h=brackets.platform,s=n.key||n,brackets.platform==="mac"&&(c===undefined||c==="all")&&(s=s.replace("Ctrl","Cmd"),n.displayKey!==undefined&&(n.displayKey=n.displayKey.replace("Ctrl","Cmd"))),u=d(s);if(!u)return console.error("Unable to parse key binding "+s+". Permitted modifiers: Ctrl, Cmd, Alt, Opt, Shift; separated by '-' (not '+')."),null;m=a[u];if(t.useWindowsCompatibleBindings&&c==="win"){if(m&&(!m.explicitPlatform||m.explicitPlatform===brackets.platform||m.explicitPlatform==="all"))return null;h=brackets.platform}if(h!==brackets.platform)return null;m&&!m.explicitPlatform&&c&&(b(u),m=!1);var g=f[e]||[],y,w,E;return g.forEach(function(e){y=t.useWindowsCompatibleBindings&&e.explicitPlatform==="win",w=!e.explicitPlatform&&c,y||w?v.push(e):E=e.explicitPlatform&&!c}),E?null:m?(console.error("Cannot assign "+u+" to "+e+". It is already assigned to "+a[u].commandID),null):(v.forEach(function(e){b(e.key)}),l=n.displayKey?d(n.displayKey):u,f[e]||(f[e]=[]),o={key:u,displayKey:l,explicitPlatform:c},f[e].push(o),a[u]={commandID:e,key:u,displayKey:l,explicitPlatform:c},p=i.get(e),p&&$(p).triggerHandler("keyBindingAdded",[o]),o)}function E(){return $.extend({},a)}function S(e){if(l&&a[e]){var t=i.execute(a[e].commandID);return t.state()!=="rejected"}return!1}function x(e){l=e}function T(e,t){var n=e.platform?1:0,r=t.platform?1:0;return r-n}function N(e,t,n){var r="",i;if(!e){console.error("addBinding(): missing required parameter: command");return}if(!t)return;typeof e=="string"?r=e:r=e.getID();if(Array.isArray(t)){var s;i=[],t.sort(T),t.forEach(function(t){s=w(r,t,t.platform),s&&i.push(s)})}else i=w(r,t,n);return i}function C(e){var t=[],n="";return e?(typeof e=="string"?n=e:n=e.getID(),t=f[n],t||[]):(console.error("getKeyBindings(): missing required parameter: command"),[])}function k(e,t){var n=t.getID(),r=u[n];r&&N(n,r)}function L(e){c.push(e)}function A(e){var t=c.indexOf(e);t!==-1&&c.splice(t,1)}function O(e){var t,n=!1;for(t=c.length-1;t>=0;t--)if(c[t](e)){n=!0;break}!n&&S(m(e))&&(e.stopPropagation(),e.preventDefault())}e("utils/Global");var r=e("utils/AppInit"),i=e("command/CommandManager"),s=e("utils/KeyEvent"),o=e("strings"),u=JSON.parse(e("text!base-config/keyboard.json")),a={},f={},l=!0,c=[];r.htmlReady(function(){window.document.body.addEventListener("keydown",O,!0),t.useWindowsCompatibleBindings=brackets.platform!=="mac"&&brackets.platform!=="win"}),$(i).on("commandRegistered",k),t._reset=h,t.getKeymap=E,t.setEnabled=x,t.addBinding=N,t.removeBinding=b,t.formatKeyDescriptor=g,t.getKeyBindings=C,t.addGlobalKeydownHook=L,t.removeGlobalKeydownHook=A,t.useWindowsCompatibleBindings=!1,t._handleKey=S,t._handleKeyEvent=O}),define("utils/NativeApp",["require","exports","module","utils/Async","filesystem/FileSystemError"],function(e,t,n){function s(e){return e===brackets.fs.ERR_NOT_FOUND?i.NOT_FOUND:i.UNKNOWN}function u(e,t){var n=new $.Deferred;return brackets.app.openLiveBrowser(e,!!t,function(t,r){t?n.reject(s(t)):(r!==undefined&&o.push(r),n.resolve(r))}),n.promise()}function a(e){var t=new $.Deferred;return isNaN(e)&&(e=0),brackets.app.closeLiveBrowser(function(n){if(!n){var r=o.indexOf(e);r!==-1&&o.splice(r,1),t.resolve()}else t.reject(s(n))},e),t.promise()}function f(){var e=o.concat();return r.doSequentially(e,a,!1)}function l(e){brackets.app.openURLInDefaultBrowser(e)}var r=e("utils/Async"),i=e("filesystem/FileSystemError"),o=[];t.openLiveBrowser=u,t.closeLiveBrowser=a,t.closeAllLiveBrowsers=f,t.openURLInDefaultBrowser=l}),define("text!htmlContent/dialog-template.html",[],function(){return'<div class="{{dlgClass}} template modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{{title}}}</h1>\n    </div>\n    <div class="modal-body">\n        <div class="dialog-message">{{{message}}}</div>\n    </div>\n    <div class="modal-footer">\n        {{#buttons}}\n        <button class="dialog-button btn {{className}}" data-button-id="{{id}}">{{{text}}}</button>\n        {{/buttons}}\n    </div>\n</div>\n'}),define("widgets/Dialogs",["require","exports","module","utils/Global","command/KeyBindingManager","utils/KeyEvent","utils/NativeApp","strings","text!htmlContent/dialog-template.html"],function(e,t,n){function y(e,t){e.data("buttonId",t),e.modal("hide")}function b(e,t,n){n?y(e,t):e.triggerHandler("buttonClick",t)}function w(e,t){return e.find("[data-button-id='"+t+"']").length>0}function E(e,t){function r(){e.stopPropagation(),e.preventDefault()}var n=$(":input:enabled, a",t).filter(":visible");$(e.target).closest(t).length?!e.shiftKey&&e.target===n[n.length-1]||e.shiftKey&&e.target===n[0]?(n.filter(e.shiftKey?":last":":first").focus(),r()):n.length||r():(n.first().focus(),r())}function x(e,t){this._$dlg=e,this._promise=t}function T(){var e,t,n=$(".modal-inner-wrapper > .instance");n.length>0&&(e=$("body").width(),t=$("body").height(),n.css({"max-width":e,"max-height":t,overflow:"auto"}))}function N(e,t){t===undefined&&(t=!0),$("body").append("<div class='modal-wrapper'><div class='modal-inner-wrapper'></div></div>");var n=new $.Deferred,i=n.promise(),s=$(e).addClass("instance").appendTo(".modal-inner-wrapper:last");T(),s.data("promise",i);var o=function(e){return S.call(s,e,t)};return s.one("hidden",function(){var e=s.data("buttonId");e||(e=a),window.setTimeout(function(){n.resolve(e)},0),s.remove(),r.removeGlobalKeydownHook(o),$(".modal-wrapper:last").remove()}).one("shown",function(){var e=s.find(".primary:enabled"),t=s.find(".modal-footer .dialog-button:enabled:eq(0)");e.length?e.focus():t.length?t.focus():document.activeElement.blur(),r.addGlobalKeydownHook(o)}),s.one("click",".dialog-button",function(e){b(s,$(this).attr("data-button-id"),t)}),s.modal({backdrop:"static",show:!0,selector:".modal-inner-wrapper:last",keyboard:!1}).css("z-index",g+1).next().css("z-index",g),g+=2,new x(s,i)}function C(e,t,n,r,i){var s={dlgClass:e,title:t||"",message:n||"",buttons:r||[{className:d,id:f,text:o.OK}]},a=Mustache.render(u,s);return N(a,i)}function k(e,t){$("."+e+".instance").each(function(){$(this).is(":visible")&&y($(this),t||h)})}e("utils/Global");var r=e("command/KeyBindingManager"),i=e("utils/KeyEvent"),s=e("utils/NativeApp"),o=e("strings"),u=e("text!htmlContent/dialog-template.html"),a="cancel",f="ok",l="dontsave",c="save_as",h="_canceled",p="download",d="primary",v="",m="left",g=1050,S=function(e,t){function u(){e.preventDefault(),e.stopPropagation()}var n=this.find(".primary"),r=null,s=String.fromCharCode(e.which),o=this.find(".dialog-button:focus, a:focus"),f=e.target.tagName==="TEXTAREA",c=f||$(e.target).filter(":text, :password").length>0;return e.which===i.DOM_VK_TAB?E(e,this):e.which===i.DOM_VK_ESCAPE?r=a:e.which===i.DOM_VK_RETURN&&(!f||e.ctrlKey)?(u(),e.target.tagName==="BUTTON"?this.find(e.target).click():n.click()):e.which===i.DOM_VK_SPACE?o.length&&(u(),o.click()):brackets.platform==="mac"?e.metaKey&&s==="D"?w(this,l)&&(r=l):e.metaKey&&e.which===i.DOM_VK_PERIOD&&(r=a):s==="N"&&!c&&w(this,l)&&(r=l),r&&(u(),b(this,r,t)),!0};x.prototype.getElement=function(){return this._$dlg},x.prototype.getPromise=function(){return this._promise},x.prototype.close=function(){this._$dlg.is(":visible")&&y(this._$dlg,h)},x.prototype.done=function(e){this._promise.done(e)},window.addEventListener("resize",T),t.DIALOG_BTN_CANCEL=a,t.DIALOG_BTN_OK=f,t.DIALOG_BTN_DONTSAVE=l,t.DIALOG_BTN_SAVE_AS=c,t.DIALOG_CANCELED=h,t.DIALOG_BTN_DOWNLOAD=p,t.DIALOG_BTN_CLASS_PRIMARY=d,t.DIALOG_BTN_CLASS_NORMAL=v,t.DIALOG_BTN_CLASS_LEFT=m,t.showModalDialog=C,t.showModalDialogUsingTemplate=N,t.cancelModalDialogIfOpen=k}),define("widgets/DefaultDialogs",["require","exports","module"],function(e,t,n){t.DIALOG_ID_ERROR="error-dialog",t.DIALOG_ID_INFO="error-dialog",t.DIALOG_ID_SAVE_CLOSE="save-close-dialog",t.DIALOG_ID_EXT_CHANGED="ext-changed-dialog",t.DIALOG_ID_EXT_DELETED="ext-deleted-dialog",t.DIALOG_ID_LIVE_DEVELOPMENT="live-development-error-dialog",t.DIALOG_ID_CHANGE_EXTENSIONS="change-marked-extensions"}),define("file/FileUtils",["require","exports","module","utils/Global","filesystem/FileSystemError","language/LanguageManager","utils/PerfUtils","widgets/Dialogs","widgets/DefaultDialogs","strings","utils/StringUtils"],function(e,t,n){function l(e){var t=new $.Deferred,n=s.markStart("readAsText:	"+e.fullPath);return t.always(function(){s.addMeasurement(n)}),e.read(function(e,n,r){e?t.reject(e):t.resolve(n,r.mtime)}),t.promise()}function c(e,t,n){var r=new $.Deferred,i={};return n&&(i.blind=!0),e.write(t,i,function(e){e?r.reject(e):r.resolve()}),r.promise()}function d(){return brackets.platform==="win"?h:p}function v(e){var t=e.substr(0,1e3),n=/\r\n/.test(t),r=/[^\r]\n/.test(t);return n&&r||!n&&!r?null:n?h:p}function m(e,t){t!==h&&t!==p&&(t=d());var n=t===h?"\r\n":"\n",r=/\r\n|\r|\n/g;return e.replace(r,n)}function g(e){var t;return e===r.NOT_FOUND?t=a.NOT_FOUND_ERR:e===r.NOT_READABLE?t=a.NOT_READABLE_ERR:e===r.NOT_WRITABLE?t=a.NO_MODIFICATION_ALLOWED_ERR_FILE:e===r.CONTENTS_MODIFIED?t=a.CONTENTS_MODIFIED_ERR:e===r.UNSUPPORTED_ENCODING?t=a.UNSUPPORTED_ENCODING_ERR:t=f.format(a.GENERIC_ERROR,e),t}function y(e,t){return o.showModalDialog(u.DIALOG_ID_ERROR,a.ERROR_OPENING_FILE_TITLE,f.format(a.ERROR_OPENING_FILE,f.breakableUrl(t),g(e)))}function b(e){var t="<ul class='dialog-list'>";return e.forEach(function(e){t+="<li><span class='dialog-filename'>",t+=f.breakableUrl(e),t+="</span></li>"}),t+="</ul>",t}function w(e){return e=unescape(e),e.indexOf(":")!==-1&&e[0]==="/"?e.substr(1):e}function E(e){return brackets.platform==="win"&&(e=e.replace(/\\/g,"/")),e}function S(e){return e&&e[e.length-1]==="/"?e.slice(0,-1):e}function x(e){return console.error("Warning: FileUtils.canonicalizeFolderPath() is deprecated. Use paths ending in '/' if possible, like Directory.fullPath"),S(e)}function T(e){var t=e.lastIndexOf("/");return t===e.length-1?e.slice(e.lastIndexOf("/",e.length-2)+1,-1):e.slice(t+1)}function N(){var e=decodeURI(window.location.pathname),t=e.substr(0,e.lastIndexOf("/"));return w(t)}function C(e){var t;return e&&e.uri&&(t=decodeURI(e.uri),t=t.substr(0,t.lastIndexOf("/"))),t}function k(e){var t=T(e),n=t.lastIndexOf(".");return n===-1?"":t.substr(n+1)}function L(e){var t=T(e),n=t.split(".");n.shift(),t[0]==="."&&n.shift();var r=[n.pop()],s=n.length;while(s--){if(!i.getLanguageForExtension(n[s]))break;r.unshift(n[s])}return r.join(".")}function A(e,t){if(!t||t.substr(0,e.length)!==e)return;return t.substr(e.length)}function _(e){return e?O.indexOf(k(e).toLowerCase())!==-1:!1}function D(e){return e?M.indexOf(k(e).toLowerCase())!==-1:!1}function P(e){return e.substr(0,e.lastIndexOf("/")+1)}function H(e){var t=e.lastIndexOf(".");return t===-1?e:e.slice(0,t)}function B(e,t,n){var r=k(e),i=k(t),s=r.toLocaleLowerCase().localeCompare(i.toLocaleLowerCase(),undefined,{numeric:!0}),o;return brackets.platform==="win"&&(e=H(e),t=H(t)),o=e.toLocaleLowerCase().localeCompare(t.toLocaleLowerCase(),undefined,{numeric:!0}),n?s||o:o||s}function j(e,t){var n,r,i=e.split("/"),s=t.split("/"),o=Math.min(i.length,s.length),u=i.length-1,a=s.length-1,f=0;while(f<o){n=i[f],r=s[f];if(n!==r)return f<u&&f<a?n.toLocaleLowerCase().localeCompare(r.toLocaleLowerCase()):f>=u&&f>=a?B(n,r):f>=u&&f<a?1:-1;f++}return 0}e("utils/Global");var r=e("filesystem/FileSystemError"),i=e("language/LanguageManager"),s=e("utils/PerfUtils"),o=e("widgets/Dialogs"),u=e("widgets/DefaultDialogs"),a=e("strings"),f=e("utils/StringUtils"),h="CRLF",p="LF",O=["htm","html"],M=["php","php3","php4","php5","phtm","phtml","cfm","cfml","asp","aspx","jsp","jspx","shtm","shtml"];t.LINE_ENDINGS_CRLF=h,t.LINE_ENDINGS_LF=p,t.getPlatformLineEndings=d,t.sniffLineEndings=v,t.translateLineEndings=m,t.showFileOpenError=y,t.getFileErrorString=g,t.makeDialogFileList=b,t.readAsText=l,t.writeText=c,t.convertToNativePath=w,t.convertWindowsPathToUnixPath=E,t.getNativeBracketsDirectoryPath=N,t.getNativeModuleDirectoryPath=C,t.canonicalizeFolderPath=x,t.stripTrailingSlash=S,t.isStaticHtmlFileExt=_,t.isServerHtmlFileExt=D,t.getDirectoryPath=P,t.getBaseName=T,t.getRelativeFilename=A,t.getFileExtension=k,t.getSmartFileExtension=L,t.compareFilenames=B,t.comparePaths=j}),define("text!language/languages.json",[],function(){return'{\n    "unknown": {\n        "name": "Text",\n        "mode": ["null", "text/plain"]\n    },\n    \n    "groovy": {\n        "name": "Groovy",\n        "mode": "groovy",\n        "fileExtensions": ["groovy"],\n        "blockComment": ["/*", "*/"],\n        "lineComment": ["//"]\n    },\n   \n    "properties": {\n        "name": "Properties",\n        "mode": ["properties", "text/x-properties"],\n        "fileExtensions": ["ini", "properties"]\n    },\n\n    "css": {\n        "name": "CSS",\n        "mode": "css",\n        "fileExtensions": ["css", "css.erb"],\n        "blockComment": ["/*", "*/"]\n    },\n\n    "scss": {\n        "name": "SCSS",\n        "mode": ["css", "text/x-scss"],\n        "fileExtensions": ["scss", "scss.erb"],\n        "blockComment": ["/*", "*/"],\n        "lineComment": ["//"]\n    },\n\n    "html": {\n        "name": "HTML",\n        "mode": ["htmlmixed", "text/x-brackets-html"],\n        "fileExtensions": ["html", "htm", "shtm", "shtml", "xhtml", "cfm", "cfml", "cfc", "dhtml", "xht", "tpl", "twig", "hbs", "handlebars", "kit", "jsp", "aspx", "ascx", "asp", "master", "cshtml", "vbhtml"],\n        "blockComment": ["<!--", "-->"]\n    },\n    \n    "ejs": {\n        "name": "EJS",\n        "mode": ["htmlembedded", "application/x-ejs"],\n        "fileExtensions": ["ejs", "dust"],\n        "blockComment": ["<!--", "-->"]\n    },\n    \n    "erb_html": {\n        "name": "Embedded Ruby",\n        "mode": ["htmlembedded", "application/x-erb"],\n        "fileExtensions": ["erb", "html.erb", "htm.erb"],\n        "blockComment": ["<!--", "-->"]\n    },\n\n    "javascript": {\n        "name": "JavaScript",\n        "mode": "javascript",\n        "fileExtensions": ["js", "jsx", "js.erb", "jsm", "_js"],\n        "blockComment": ["/*", "*/"],\n        "lineComment": ["//"]\n    },\n\n    "vbscript": {\n        "name": "VBScript",\n        "mode": "vbscript",\n        "fileExtensions": ["vbs"],\n        "lineComment": ["\'", "REM"]\n    },\n\n    "vb": {\n        "name": "VB",\n        "mode": ["vb", "text/x-vb"],\n        "fileExtensions": ["vb"],\n        "lineComment": ["\'"]\n    },\n\n    "json": {\n        "name": "JSON",\n        "mode": ["javascript", "application/json"],\n        "fileExtensions": ["json"],\n        "fileNames": [".jshintrc", ".bowerrc"]\n    },\n\n    "xml": {\n        "name": "XML",\n        "mode": "xml",\n        "fileExtensions": ["xml", "svg", "wxs", "wxl", "wsdl", "rss", "atom", "rdf", "xslt", "xsl", "xul", "xbl", "mathml", "config", "plist", "xaml"],\n        "blockComment": ["<!--", "-->"]\n    },\n\n    "php": {\n        "name": "PHP",\n        "mode": "php",\n        "fileExtensions": ["php", "php3", "php4", "php5", "phtm", "phtml", "ctp"],\n        "blockComment": ["/*", "*/"],\n        "lineComment": ["//", "#"]\n    },\n\n    "c": {\n        "name": "C",\n        "mode": ["clike", "text/x-csrc"],\n        "fileExtensions": ["c", "h", "i"],\n        "blockComment": ["/*", "*/"],\n        "lineComment": ["//"]\n    },\n\n    "cpp": {\n        "name": "C++",\n        "mode": ["clike", "text/x-c++src"],\n        "fileExtensions": ["cc", "cp", "cpp", "c++", "cxx", "hh", "hpp", "hxx", "h++", "ii", "ino"],\n        "blockComment": ["/*", "*/"],\n        "lineComment": ["//"]\n    },\n\n    "csharp": {\n        "name": "C#",\n        "mode": ["clike", "text/x-csharp"],\n        "fileExtensions": ["cs", "asax", "ashx"],\n        "blockComment": ["/*", "*/"],\n        "lineComment": ["//"]\n    },\n\n    "java": {\n        "name": "Java",\n        "mode": ["clike", "text/x-java"],\n        "fileExtensions": ["java"],\n        "blockComment": ["/*", "*/"],\n        "lineComment": ["//"]\n    },\n\n    "scala": {\n        "name": "Scala",\n        "mode": ["clike", "text/x-scala"],\n        "fileExtensions": ["scala", "sbt"],\n        "blockComment": ["/*", "*/"],\n        "lineComment": ["//"]\n    },\n\n    "coffeescript": {\n        "name": "CoffeeScript",\n        "mode": "coffeescript",\n        "fileExtensions": ["coffee", "cf", "cson", "_coffee"],\n        "fileNames": ["Cakefile"],\n        "blockComment": ["###", "###"],\n        "lineComment": ["#"]\n    },\n\n    "clojure": {\n        "name": "Clojure",\n        "mode": "clojure",\n        "fileExtensions": ["clj", "cljs", "cljx"],\n        "lineComment": [";", ";;"]\n    },\n\n    "perl": {\n        "name": "Perl",\n        "mode": "perl",\n        "fileExtensions": ["pl", "pm"],\n        "lineComment": ["#"]\n    },\n\n    "ruby": {\n        "name": "Ruby",\n        "mode": "ruby",\n        "fileExtensions": ["rb", "ru", "gemspec", "rake"],\n        "fileNames": ["Gemfile", "Rakefile", "Guardfile"],\n        "lineComment": ["#"]\n    },\n\n    "python": {\n        "name": "Python",\n        "mode": "python",\n        "fileExtensions": ["py", "pyw", "wsgi"],\n        "lineComment": ["#"]\n    },\n\n    "sass": {\n        "name": "SASS",\n        "mode": "sass",\n        "fileExtensions": ["sass"],\n        "blockComment": ["/*", "*/"],\n        "lineComment": ["//"]\n    },\n\n    "lua": {\n        "name": "Lua",\n        "mode": "lua",\n        "fileExtensions": ["lua"],\n        "blockComment": ["--[[", "]]"],\n        "lineComment": ["--"]\n    },\n\n    "sql": {\n        "name": "SQL",\n        "mode": ["sql", "text/x-mysql"],\n        "fileExtensions": ["sql"]\n    },\n\n    "diff": {\n        "name": "Diff",\n        "mode": "diff",\n        "fileExtensions": ["diff", "patch"]\n    },\n\n    "markdown": {\n        "name": "Markdown",\n        "mode": "markdown",\n        "fileExtensions": ["md", "markdown"],\n        "blockComment": ["<!--", "-->"]\n    },\n\n    "yaml": {\n        "name": "YAML",\n        "mode": "yaml",\n        "fileExtensions": ["yaml", "yml"],\n        "lineComment": ["#"]\n    },\n\n    "hx": {\n        "name": "Haxe",\n        "mode": "haxe",\n        "fileExtensions": ["hx"],\n        "blockComment": ["/*", "*/"],\n        "lineComment": ["//"]\n    },\n\n    "bash": {\n        "name": "Bash",\n        "mode": ["shell", "text/x-sh"],\n        "fileExtensions": ["sh", "command", "bash"],\n        "lineComment": ["#"]\n    },\n  \n    "image": {\n        "name": "Image",\n        "fileExtensions": ["gif", "png", "jpe", "jpeg", "jpg", "ico", "bmp"],\n        "isBinary": true\n    },\n    \n    "audio": {\n        "name": "Audio",\n        "fileExtensions": ["mp3", "wav", "aif", "aiff", "ogg"],\n        "isBinary": true\n    },\n    \n    "binary": {\n        "name": "Other Binary",\n        "fileExtensions": [\n            "a", "ai", "avi", "bin", "cab", "com", "db", "dll", "dmg",\n            "doc", "docx", "dot", "dotx", "dsym", "dylib", "egg", "epub", "eot",\n            "exe", "flv", "gz", "gzip", "htmz", "htmlz", "ipch", "iso", "jar",\n            "jsz", "lib", "mpeg", "mpg", "mp4", "msi", "node", "o", "obj", "odc",\n            "odb", "odf", "odg", "odp", "ods", "odt", "otf", "pak", "pdb", "pdf",\n            "pdi", "ppt", "pptx", "psd", "rar", "sdf", "so", "sqlite", "suo", "svgz",\n            "swf", "tar", "tif", "tiff", "ttf", "woff", "xls", "xlsx", "zip"\n        ],\n        "isBinary": true\n    }\n}\n'}),define("language/LanguageManager",["require","exports","module","thirdparty/CodeMirror2/lib/codemirror","utils/Async","file/FileUtils","text!language/languages.json","thirdparty/lodash"],function(e,t,n){function E(e,t,n){var r=n?n.reject:console.error;return Object.prototype.toString.call(e)!=="[object String]"?(r(t+" must be a string"),!1):e===""?(r(t+" must not be empty"),!1):!0}function S(){function t(t){if(r.modes[t]){console.error('There already is a CodeMirror mode with the name "'+t+'"');return}e.apply(r,arguments)}var e=r.defineMode;r.defineMode=t}function x(e,t){if(m[e]){console.warn('CodeMirror mode "'+e+'" is already used by language '+m[e]._name+" - cannot fully register language "+t._name+" using the same mode. Some features will treat all content with this mode as language "+m[e]._name);return}m[e]=t}function T(e,t){t?v[e]=t:delete v[e]}function N(){v={}}function C(e){return c[e]}function k(e){return p[e.toLowerCase()]}function L(e,t){var n,r=v[e],i,o;if(!t&&r)return r;n=s.getBaseName(e).toLowerCase(),r=d[n];if(!r){o=n.split("."),o[0]===""&&o.shift(),o.shift();while(!r&&o.length)i=o.join("."),r=p[i],o.shift()}return r||f}function A(){return $.extend({},c)}function O(e){var t=m[e];return t?t:(console.log("Called LanguageManager._getLanguageForMode with a mode for which no language has been registered:",e),f)}function M(e){c[e.getId()]=e,$(t).triggerHandler("languageAdded",[e])}function _(e){$(t).triggerHandler("languageModified",[e])}function D(){this._fileExtensions=[],this._fileNames=[],this._modeToLanguageMap={},this._lineCommentSyntax=[]}function P(e,t){function p(){if(s)for(f=0,h=s.length;f<h;f++)r.addFileExtension(s[f]);if(o)for(f=0,h=o.length;f<h;f++)r.addFileName(o[f]);r._setBinary(!!t.isBinary),c[r.getId()]=r}var n=new $.Deferred;if(l[e])return n.reject('Language "'+e+'" is waiting to be resolved.'),n.promise();if(c[e])return n.reject('Language "'+e+'" is already defined'),n.promise();var r=new D,i=t.name,s=t.fileExtensions,o=t.fileNames,u=t.blockComment,a=t.lineComment,f,h;return!r._setId(e)||!r._setName(i)||u&&!r.setBlockCommentSyntax(u[0],u[1])||a&&!r.setLineCommentSyntax(a)?(n.reject(),n.promise()):(t.isBinary?(p(),n.resolve(r)):(l[e]=r,r._loadAndSetMode(t.mode).done(function(){x(r.getMode(),r),p(),M(r),n.resolve(r)}).fail(function(e){console.error(e),n.reject(e)}).always(function(){delete l[e]})),n.promise())}function H(e,t){if(t.overridden[e]){var n=C(t.overridden[e]);n[t.add](e),delete t.overridden[e]}}function B(e){var n=a.get(e)||{},r=Object.keys(n),i=w[e],s=i.last,o=i.overridden;r.forEach(function(e){var r;n[e]!==s[e]&&(s[e]&&(r=C(s[e]),r&&(r[i.remove](e),H(e,i))),r=t[i.get](e),r&&(r[i.remove](e),o[e]||(o[e]=r.getId())),r=C(n[e]),r&&r[i.add](e))}),u.difference(Object.keys(s),r).forEach(function(e){var t=C(s[e]);t&&(t[i.remove](e),H(e,i))}),i.last=n}var r=e("thirdparty/CodeMirror2/lib/codemirror"),i=e("utils/Async"),s=e("file/FileUtils"),o=e("text!language/languages.json"),u=e("thirdparty/lodash"),a,f=null,l={},c={},h={},p=Object.create(h),d={},v={},m={},g,y="language.fileExtensions",b="language.fileNames",w={};w[y]={last:{},overridden:{},add:"addFileExtension",remove:"removeFileExtension",get:"getLanguageForExtension"},w[b]={last:{},overridden:{},add:"addFileName",remove:"removeFileName",get:"getLanguageForPath"},D.prototype._id=null,D.prototype._name=null,D.prototype._mode=null,D.prototype._fileExtensions=null,D.prototype._fileNames=null,D.prototype._lineCommentSyntax=null,D.prototype._modeToLanguageMap=null,D.prototype._blockCommentSyntax=null,D.prototype._isBinary=!1,D.prototype.getId=function(){return this._id},D.prototype._setId=function(e){return E(e,"Language ID")?e.match(/^[a-z0-9]+(_[a-z0-9]+)*$/)?(this._id=e,!0):(console.error('Invalid language ID "'+e+'": Only groups of lower case letters and numbers are allowed, separated by underscores.'),!1):!1},D.prototype.getName=function(){return this._name},D.prototype._setName=function(e){return E(e,"name")?(this._name=e,!0):!1},D.prototype.getMode=function(){return this._mode},D.prototype._loadAndSetMode=function(t){var n=new $.Deferred,i=this,s;if(Array.isArray(t)){if(t.length!==2)return n.reject("Mode must either be a string or an array containing two strings"),n.promise();s=t[1],t=t[0]}if(!E(t,"mode",n))return n.reject(),n.promise();var o=function(){if(!r.modes[t]){n.reject('CodeMirror mode "'+t+'" is not loaded');return}if(s){var e=r.mimeModes[s];if(!e){n.reject('CodeMirror MIME mode "'+s+'" not found');return}}i._mode=s||t,i._wasModified(),n.resolve(i)};return r.modes[t]?o():e(["thirdparty/CodeMirror2/mode/"+t+"/"+t],o),n.promise()},D.prototype.getFileExtensions=function(){return this._fileExtensions.concat()},D.prototype.getFileNames=function(){return this._fileNames.concat()},D.prototype.addFileExtension=function(e){Array.isArray(e)?e.forEach(this._addFileExtension.bind(this)):this._addFileExtension(e)},D.prototype._addFileExtension=function(e){e.charAt(0)==="."&&(e=e.substr(1)),e=e.toLowerCase();if(this._fileExtensions.indexOf(e)===-1){this._fileExtensions.push(e);var t=p[e];t?console.warn('Cannot register file extension "'+e+'" for '+this._name+", it already belongs to "+t._name):p[e]=this,this._wasModified()}},D.prototype.removeFileExtension=function(e){Array.isArray(e)?e.forEach(this._removeFileExtension.bind(this)):this._removeFileExtension(e)},D.prototype._removeFileExtension=function(e){e.charAt(0)==="."&&(e=e.substr(1)),e=e.toLowerCase();var t=this._fileExtensions.indexOf(e);t!==-1&&(this._fileExtensions.splice(t,1),delete p[e],this._wasModified())},D.prototype.addFileName=function(e){Array.isArray(e)?e.forEach(this._addFileName.bind(this)):this._addFileName(e)},D.prototype._addFileName=function(e){e=e.toLowerCase();if(this._fileNames.indexOf(e)===-1){this._fileNames.push(e);var t=d[e];t?console.warn('Cannot register file name "'+e+'" for '+this._name+", it already belongs to "+t._name):d[e]=this,this._wasModified()}},D.prototype.removeFileName=function(e){Array.isArray(e)?e.forEach(this._removeFileName.bind(this)):this._removeFileName(e)},D.prototype._removeFileName=function(e){e=e.toLowerCase();var t=this._fileNames.indexOf(e);t!==-1&&(this._fileNames.splice(t,1),delete d[e],this._wasModified())},D.prototype.hasLineCommentSyntax=function(){return this._lineCommentSyntax.length>0},D.prototype.getLineCommentPrefixes=function(){return this._lineCommentSyntax},D.prototype.setLineCommentSyntax=function(e){var t=Array.isArray(e)?e:[e],n;if(t.length){this._lineCommentSyntax=[];for(n=0;n<t.length;n++)E(String(t[n]),Array.isArray(e)?"prefix["+n+"]":"prefix"),this._lineCommentSyntax.push(t[n]);this._wasModified()}else console.error("The prefix array should not be empty");return!0},D.prototype.hasBlockCommentSyntax=function(){return Boolean(this._blockCommentSyntax)},D.prototype.getBlockCommentPrefix=function(){return this._blockCommentSyntax&&this._blockCommentSyntax.prefix},D.prototype.getBlockCommentSuffix=function(){return this._blockCommentSyntax&&this._blockCommentSyntax.suffix},D.prototype.setBlockCommentSyntax=function(e,t){return!E(e,"prefix")||!E(t,"suffix")?!1:(this._blockCommentSyntax={prefix:e,suffix:t},this._wasModified(),!0)},D.prototype.getLanguageForMode=function(e){return e===this._mode?this:this._modeToLanguageMap[e]||O(e)},D.prototype._setLanguageForMode=function(e,t){return e===this._mode&&t!==this?(console.error("A language must always map its mode to itself"),!1):(this._modeToLanguageMap[e]=t,this._wasModified(),!0)},D.prototype.isFallbackLanguage=function(){return this===f},D.prototype._wasModified=function(){c[this._id]&&_(this)},D.prototype.isBinary=function(){return this._isBinary},D.prototype._setBinary=function(e){this._isBinary=e},S(),r.defineMIME("text/x-brackets-html",{name:"htmlmixed",scriptTypes:[{matches:/\/x-handlebars|\/x-mustache|^text\/html$/i,mode:null}]}),o=JSON.parse(o),g=i.doInParallel(Object.keys(o),function(e){return P(e,o[e])},!1),g.always(function(){var t=C("html");t._setLanguageForMode("xml",t),x("html",t);var n=C("php");n._setLanguageForMode("clike",n);var r=C("scss");r._setLanguageForMode("css",r),f=C("unknown"),e(["preferences/PreferencesManager"],function(e){a=e,B(y),B(b),e.definePreference(y,"object").on("change",function(){B(y)}),e.definePreference(b,"object").on("change",function(){B(b)})})}),t._EXTENSION_MAP_PREF=y,t._NAME_MAP_PREF=b,t._resetLanguageOverrides=N,t._setLanguageOverrideForPath=T,t.ready=g,t.defineLanguage=P,t.getLanguage=C,t.getLanguageForExtension=k,t.getLanguageForPath=L,t.getLanguages=A}),function(){if(jQuery&&jQuery.jstree)return;var e=!1,t=!1,n=!1;(function(r){r.vakata={},r.vakata.css={get_css:function(e,t,n){e=e.toLowerCase();var r=n.cssRules||n.rules,i=0;do{if(r.length&&i>r.length+5)return!1;if(r[i].selectorText&&r[i].selectorText.toLowerCase()==e)return t===!0?(n.removeRule&&n.removeRule(i),n.deleteRule&&n.deleteRule(i),!0):r[i]}while(r[++i]);return!1},add_css:function(e,t){return r.jstree.css.get_css(e,!1,t)?!1:(t.insertRule?t.insertRule(e+" { }",0):t.addRule(e,null,0),r.vakata.css.get_css(e))},remove_css:function(e,t){return r.vakata.css.get_css(e,!0,t)},add_sheet:function(e){var t=!1,n=!0;if(e.str)return e.title&&(t=r("style[id='"+e.title+"-stylesheet']")[0]),t?n=!1:(t=document.createElement("style"),t.setAttribute("type","text/css"),e.title&&t.setAttribute("id",e.title+"-stylesheet")),t.styleSheet?n?(document.getElementsByTagName("head")[0].appendChild(t),t.styleSheet.cssText=e.str):t.styleSheet.cssText=t.styleSheet.cssText+" "+e.str:(t.appendChild(document.createTextNode(e.str)),document.getElementsByTagName("head")[0].appendChild(t)),t.sheet||t.styleSheet;if(e.url){if(!document.createStyleSheet)return t=document.createElement("link"),t.rel="stylesheet",t.type="text/css",t.media="all",t.href=e.url,document.getElementsByTagName("head")[0].appendChild(t),t.styleSheet;try{t=document.createStyleSheet(e.url)}catch(i){}}}};var i=[],s=-1,o={},u={};r.fn.jstree=function(e){var t=typeof e=="string",n=Array.prototype.slice.call(arguments,1),s=this;if(t){if(e.substring(0,1)=="_")return s;this.each(function(){var t=i[r.data(this,"jstree_instance_id")],o=t&&r.isFunction(t[e])?t[e].apply(t,n):t;if(typeof o!="undefined"&&(e.indexOf("is_")===0||o!==!0&&o!==!1))return s=o,!1})}else this.each(function(){var t=r.data(this,"jstree_instance_id"),s=[],u=e?r.extend({},!0,e):{},a=r(this),f=!1,l=[];s=s.concat(n),a.data("jstree")&&s.push(a.data("jstree")),u=s.length?r.extend.apply(null,[!0,u].concat(s)):u,typeof t!="undefined"&&i[t]&&i[t].destroy(),t=parseInt(i.push({}),10)-1,r.data(this,"jstree_instance_id",t),u.plugins=r.isArray(u.plugins)?u.plugins:r.jstree.defaults.plugins.slice(),u.plugins.unshift("core"),u.plugins=u.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(","),f=r.extend(!0,{},r.jstree.defaults,u),f.plugins=u.plugins,r.each(o,function(e,t){r.inArray(e,f.plugins)===-1?(f[e]=null,delete f[e]):l.push(e)}),f.plugins=l,i[t]=new r.jstree._instance(t,r(this).addClass("jstree jstree-"+t),f),r.each(i[t]._get_settings().plugins,function(e,n){i[t].data[n]={}}),r.each(i[t]._get_settings().plugins,function(e,n){o[n]&&o[n].__init.apply(i[t])}),setTimeout(function(){i[t]&&i[t].init()},0)});return s},r.jstree={defaults:{plugins:[]},_focused:function(){return i[s]||null},_reference:function(e){if(i[e])return i[e];var t=r(e);return!t.length&&typeof e=="string"&&(t=r("#"+e)),t.length?i[t.closest(".jstree").data("jstree_instance_id")]||null:null},_instance:function(e,t,n){this.data={core:{}},this.get_settings=function(){return r.extend(!0,{},n)},this._get_settings=function(){return n},this.get_index=function(){return e},this.get_container=function(){return t},this.get_container_ul=function(){return t.children("ul:eq(0)")},this._set_settings=function(e){n=r.extend(!0,{},n,e)}},_fn:{},plugin:function(e,t){t=r.extend({},{__init:r.noop,__destroy:r.noop,_fn:{},defaults:!1},t),o[e]=t,r.jstree.defaults[e]=t.defaults,r.each(t._fn,function(t,n){n.plugin=e,n.old=r.jstree._fn[t],r.jstree._fn[t]=function(){var e,i=n,s=Array.prototype.slice.call(arguments),o=new r.Event("before.jstree"),u=!1;if(this.data.core.locked===!0&&t!=="unlock"&&t!=="is_locked")return;do{if(i&&i.plugin&&r.inArray(i.plugin,this._get_settings().plugins)!==-1)break;i=i.old}while(i);if(!i)return;if(t.indexOf("_")===0)e=i.apply(this,s);else{e=this.get_container().triggerHandler(o,{func:t,inst:this,args:s,plugin:i.plugin});if(e===!1)return;typeof e!="undefined"&&(s=e),e=i.apply(r.extend({},this,{__callback:function(e){this.get_container().triggerHandler(t+".jstree",{inst:this,args:s,rslt:e,rlbk:u})},__rollback:function(){return u=this.get_rollback(),u},__call_old:function(e){return i.old.apply(this,e?Array.prototype.slice.call(arguments,1):s)}}),s)}return e},r.jstree._fn[t].old=n.old,r.jstree._fn[t].plugin=e})},rollback:function(e){e&&(r.isArray(e)||(e=[e]),r.each(e,function(e,t){i[t.i].set_rollback(t.h,t.d)}))}},r.jstree._fn=r.jstree._instance.prototype={},r(function(){var i=navigator.userAgent.toLowerCase(),s=(i.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],o=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";if(/msie/.test(i)&&parseInt(s,10)==6){e=!0;try{document.execCommand("BackgroundImageCache",!1,!0)}catch(u){}o+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}/msie/.test(i)&&parseInt(s,10)==7&&(t=!0,o+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } "),!/compatible/.test(i)&&/mozilla/.test(i)&&parseFloat(s,10)<1.9&&(n=!0,o+=".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } "),r.vakata.css.add_sheet({str:o,title:"jstree"})}),r.jstree.plugin("core",{__init:function(){this.data.core.locked=!1,this.data.core.to_open=this.get_settings().core.initially_open,this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:!1,animation:500,initially_open:[],initially_load:[],open_parents:!0,notify_plugins:!0,rtl:!1,load_open:!1,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus(),this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl"),this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_string("loading")+"</a></li></ul>"),this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18,this.get_container().delegate("li > ins","click.jstree",r.proxy(function(e){var t=r(e.target);this.toggle_node(t)},this)).bind("mousedown.jstree",r.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(e){var t;if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(n){}}}),this._get_settings().core.notify_plugins&&this.get_container().bind("load_node.jstree",r.proxy(function(e,t){var n=this._get_node(t.rslt.obj),i=this;n===-1&&(n=this.get_container_ul());if(!n.length)return;n.find("li").each(function(){var e=r(this);e.data("jstree")&&r.each(e.data("jstree"),function(t,n){i.data[t]&&r.isFunction(i["_"+t+"_notify"])&&i["_"+t+"_notify"].call(i,e,n)})})},this)),this._get_settings().core.load_open&&this.get_container().bind("load_node.jstree",r.proxy(function(e,t){var n=this._get_node(t.rslt.obj),i=this;n===-1&&(n=this.get_container_ul());if(!n.length)return;n.find("li.jstree-open:not(:has(ul))").each(function(){i.load_node(this,r.noop,r.noop)})},this)),this.__callback(),this.load_node(-1,function(){this.loaded(),this.reload_nodes()})},destroy:function(){var e,t=this.get_index(),n=this._get_settings(),u=this;r.each(n.plugins,function(e,t){try{o[t].__destroy.apply(u)}catch(n){}}),this.__callback();if(this.is_focused())for(e in i)if(i.hasOwnProperty(e)&&e!=t){i[e].set_focus();break}t===s&&(s=-1),this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")}),r(document).unbind(".jstree-"+t).undelegate(".jstree-"+t),i[t]=null,delete i[t]},_core_notify:function(e,t){t.opened&&this.open_node(e,!1,!0)},lock:function(){this.data.core.locked=!0,this.get_container().children("ul").addClass("jstree-locked").css("opacity","0.7"),this.__callback({})},unlock:function(){this.data.core.locked=!1,this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1"),this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var e=this;this.data.core.to_open=[],this.get_container_ul().find("li.jstree-open").each(function(){this.id&&e.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}),this.__callback(e.data.core.to_open)},save_loaded:function(){},reload_nodes:function(e){var t=this,n=!0,i=[],s=[];e||(this.data.core.reopen=!1,this.data.core.refreshing=!0,this.data.core.to_open=r.map(r.makeArray(this.data.core.to_open),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_load=r.map(r.makeArray(this.data.core.to_load),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_open.length&&(this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open))),this.data.core.to_load.length&&(r.each(this.data.core.to_load,function(e,t){if(t=="#")return!0;r(t).length?i.push(t):s.push(t)}),i.length&&(this.data.core.to_load=s,r.each(i,function(e,r){t._is_loaded(r)||(t.load_node(r,function(){t.reload_nodes(!0)},function(){t.reload_nodes(!0)}),n=!1)}))),this.data.core.to_open.length&&r.each(this.data.core.to_open,function(e,n){t.open_node(n,!1,!0)}),n&&(this.data.core.reopen&&clearTimeout(this.data.core.reopen),this.data.core.reopen=setTimeout(function(){t.__callback({},t)},50),this.data.core.refreshing=!1,this.reopen())},reopen:function(){var e=this;this.data.core.to_open.length&&r.each(this.data.core.to_open,function(t,n){e.open_node(n,!1,!0)}),this.__callback({})},refresh:function(e){var t=this;this.save_opened(),e||(e=-1),e=this._get_node(e),e||(e=-1),e!==-1?e.children("UL").remove():this.get_container_ul().empty(),this.load_node(e,function(){t.__callback({obj:e}),t.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(this.is_focused())return;var e=r.jstree._focused();e&&e.unset_focus(),this.get_container().addClass("jstree-focused"),s=this.get_index(),this.__callback()},is_focused:function(){return s==this.get_index()},unset_focus:function(){this.is_focused()&&(this.get_container().removeClass("jstree-focused"),s=-1),this.__callback()},_get_node:function(e){var t=r(e,this.get_container());return t.is(".jstree")||e==-1?-1:(t=t.closest("li",this.get_container()),t.length?t:!1)},_get_next:function(e,t){return e=this._get_node(e),e===-1?this.get_container().find("> ul > li:first-child"):e.length?t?e.nextAll("li").length>0?e.nextAll("li:eq(0)"):!1:e.hasClass("jstree-open")?e.find("li:eq(0)"):e.nextAll("li").length>0?e.nextAll("li:eq(0)"):e.parentsUntil(".jstree","li").next("li").eq(0):!1},_get_prev:function(e,t){e=this._get_node(e);if(e===-1)return this.get_container().find("> ul > li:last-child");if(!e.length)return!1;if(t)return e.prevAll("li").length>0?e.prevAll("li:eq(0)"):!1;if(e.prev("li").length){e=e.prev("li").eq(0);while(e.hasClass("jstree-open"))e=e.children("ul:eq(0)").children("li:last");return e}var n=e.parentsUntil(".jstree","li:eq(0)");return n.length?n:!1},_get_parent:function(e){e=this._get_node(e);if(e==-1||!e.length)return!1;var t=e.parentsUntil(".jstree","li:eq(0)");return t.length?t:-1},_get_children:function(e){return e=this._get_node(e),e===-1?this.get_container().children("ul:eq(0)").children("li"):e.length?e.children("ul:eq(0)").children("li"):!1},get_path:function(e,t){var n=[],r=this;return e=this._get_node(e),e===-1||!e||!e.length?!1:(e.parentsUntil(".jstree","li").each(function(){n.push(t?this.id:r.get_text(this))}),n.reverse(),n.push(t?e.attr("id"):this.get_text(e)),n)},_get_string:function(e){return this._get_settings().core.strings[e]||e},is_open:function(e){return e=this._get_node(e),e&&e!==-1&&e.hasClass("jstree-open")},is_closed:function(e){return e=this._get_node(e),e&&e!==-1&&e.hasClass("jstree-closed")},is_leaf:function(e){return e=this._get_node(e),e&&e!==-1&&e.hasClass("jstree-leaf")},correct_state:function(e){e=this._get_node(e);if(!e||e===-1)return!1;e.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove(),this.__callback({obj:e})},open_node:function(t,n,r){t=this._get_node(t);if(!t.length)return!1;if(!t.hasClass("jstree-closed"))return n&&n.call(),!1;var i=r||e?0:this._get_settings().core.animation,s=this;this._is_loaded(t)?(this._get_settings().core.open_parents&&t.parentsUntil(".jstree",".jstree-closed").each(function(){s.open_node(this,!1,!0)}),i&&t.children("ul").css("display","none"),t.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"),i?t.children("ul").stop(!0,!0).slideDown(i,function(){this.style.display="",s.after_open(t)}):s.after_open(t),this.__callback({obj:t}),n&&n.call()):(t.children("a").addClass("jstree-loading"),this.load_node(t,function(){s.open_node(t,n,r)},n))},after_open:function(e){this.__callback({obj:e})},close_node:function(t,n){t=this._get_node(t);var r=n||e?0:this._get_settings().core.animation,i=this;if(!t.length||!t.hasClass("jstree-open"))return!1;r&&t.children("ul").attr("style","display:block !important"),t.removeClass("jstree-open").addClass("jstree-closed"),r?t.children("ul").stop(!0,!0).slideUp(r,function(){this.style.display="",i.after_close(t)}):i.after_close(t),this.__callback({obj:t})},after_close:function(e){this.__callback({obj:e})},toggle_node:function(e){e=this._get_node(e);if(e.hasClass("jstree-closed"))return this.open_node(e);if(e.hasClass("jstree-open"))return this.close_node(e)},open_all:function(e,t,n){e=e?this._get_node(e):-1;if(!e||e===-1)e=this.get_container_ul();n?e=e.find("li.jstree-closed"):(n=e,e.is(".jstree-closed")?e=e.find("li.jstree-closed").addBack():e=e.find("li.jstree-closed"));var r=this;e.each(function(){var e=this;r._is_loaded(this)?r.open_node(this,!1,!t):r.open_node(this,function(){r.open_all(e,t,n)},!t)}),n.find("li.jstree-closed").length===0&&this.__callback({obj:n})},close_all:function(e,t){var n=this;e=e?this._get_node(e):this.get_container();if(!e||e===-1)e=this.get_container_ul();e.find("li.jstree-open").addBack().each(function(){n.close_node(this,!t)}),this.__callback({obj:e})},clean_node:function(e){e=e&&e!=-1?r(e):this.get_container_ul(),e=e.is("li")?e.find("li").addBack():e.find("li"),e.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed"),e.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove(),this.__callback({obj:e})},get_rollback:function(){return this.__callback(),{i:this.get_index(),h:this.get_container().children("ul").clone(!0),d:this.data}},set_rollback:function(e,t){this.get_container().empty().append(e),this.data=t,this.__callback()},load_node:function(e,t,n){this.__callback({obj:e})},_is_loaded:function(e){return!0},create_node:function(e,t,n,i,s){e=this._get_node(e),t=typeof t=="undefined"?"last":t;var o=r("<li />"),u=this._get_settings().core,a;if(e!==-1&&!e.length)return!1;if(!s&&!this._is_loaded(e))return this.load_node(e,function(){this.create_node(e,t,n,i,!0)}),!1;this.__rollback(),typeof n=="string"&&(n={data:n}),n||(n={}),n.attr&&o.attr(n.attr),n.metadata&&o.data(n.metadata),n.state&&o.addClass("jstree-"+n.state),n.data||(n.data=this._get_string("new_node")),r.isArray(n.data)||(a=n.data,n.data=[],n.data.push(a)),r.each(n.data,function(e,t){a=r("<a />"),r.isFunction(t)&&(t=t.call(this,n)),typeof t=="string"?a.attr("href","#")[u.html_titles?"html":"text"](t):(t.attr||(t.attr={}),t.attr.href||(t.attr.href="#"),a.attr(t.attr)[u.html_titles?"html":"text"](t.title),t.language&&a.addClass(t.language)),a.prepend("<ins class='jstree-icon'>&#160;</ins>"),!t.icon&&n.icon&&(t.icon=n.icon),t.icon&&(t.icon.indexOf("/")===-1?a.children("ins").addClass(t.icon):a.children("ins").css("background","url('"+t.icon+"') center center no-repeat")),o.append(a)}),o.prepend("<ins class='jstree-icon'>&#160;</ins>"),e===-1&&(e=this.get_container(),t==="before"&&(t="first"),t==="after"&&(t="last"));switch(t){case"before":e.before(o),a=this._get_parent(e);break;case"after":e.after(o),a=this._get_parent(e);break;case"inside":case"first":e.children("ul").length||e.append("<ul />"),e.children("ul").prepend(o),a=e;break;case"last":e.children("ul").length||e.append("<ul />"),e.children("ul").append(o),a=e;break;default:e.children("ul").length||e.append("<ul />"),t||(t=0),a=e.children("ul").children("li").eq(t),a.length?a.before(o):e.children("ul").append(o),a=e}if(a===-1||a.get(0)===this.get_container().get(0))a=-1;return this.clean_node(a),this.__callback({obj:o,parent:a}),i&&i.call(this,o),o},get_text:function(e){e=this._get_node(e);if(!e.length)return!1;var t=this._get_settings().core.html_titles;return e=e.children("a:eq(0)"),t?(e=e.clone(),e.children("INS").remove(),e.html()):(e=e.contents().filter(function(){return this.nodeType==3})[0],e.nodeValue)},set_text:function(e,t){e=this._get_node(e);if(!e.length)return!1;e=e.children("a:eq(0)");if(this._get_settings().core.html_titles){var n=e.children("INS").clone();return e.html(t).prepend(n),this.__callback({obj:e,name:t}),!0}return e=e.contents().filter(function(){return this.nodeType==3})[0],this.__callback({obj:e,name:t}),e.nodeValue=t},rename_node:function(e,t){e=this._get_node(e),this.__rollback(),e&&e.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))&&this.__callback({obj:e,name:t})},delete_node:function(e){e=this._get_node(e);if(!e.length)return!1;this.__rollback();var t=this._get_parent(e),n=r([]),i=this;return e.each(function(){n=n.add(i._get_prev(this))}),e=e.detach(),t!==-1&&t.find("> ul > li").length===0&&t.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),this.clean_node(t),this.__callback({obj:e,prev:n,parent:t}),e},prepare_move:function(e,t,n,i,s){var o={};o.ot=r.jstree._reference(e)||this,o.o=o.ot._get_node(e),o.r=t===-1?-1:this._get_node(t),o.p=typeof n=="undefined"||n===!1?"last":n;if(!s&&u.o&&u.o[0]===o.o[0]&&u.r[0]===o.r[0]&&u.p===o.p){this.__callback(u),i&&i.call(this,u);return}o.ot=r.jstree._reference(o.o)||this,o.rt=r.jstree._reference(o.r)||this;if(o.r===-1||!o.r){o.cr=-1;switch(o.p){case"first":case"before":case"inside":o.cp=0;break;case"after":case"last":o.cp=o.rt.get_container().find(" > ul > li").length;break;default:o.cp=o.p}}else{if(!/^(before|after)$/.test(o.p)&&!this._is_loaded(o.r))return this.load_node(o.r,function(){this.prepare_move(e,t,n,i,!0)});switch(o.p){case"before":o.cp=o.r.index(),o.cr=o.rt._get_parent(o.r);break;case"after":o.cp=o.r.index()+1,o.cr=o.rt._get_parent(o.r);break;case"inside":case"first":o.cp=0,o.cr=o.r;break;case"last":o.cp=o.r.find(" > ul > li").length,o.cr=o.r;break;default:o.cp=o.p,o.cr=o.r}}o.np=o.cr==-1?o.rt.get_container():o.cr,o.op=o.ot._get_parent(o.o),o.cop=o.o.index(),o.op===-1&&(o.op=o.ot?o.ot.get_container():this.get_container()),!/^(before|after)$/.test(o.p)&&o.op&&o.np&&o.op[0]===o.np[0]&&o.o.index()<o.cp&&o.cp++,o.or=o.np.find(" > ul > li:nth-child("+(o.cp+1)+")"),u=o,this.__callback(u),i&&i.call(this,u)},check_move:function(){var e=u,t=!0,n=e.r===-1?this.get_container():e.r;return!e||!e.o||e.or[0]===e.o[0]?!1:e.op&&e.np&&e.op[0]===e.np[0]&&e.cp-1===e.o.index()?!1:(e.o.each(function(){if(n.parentsUntil(".jstree","li").addBack().index(this)!==-1)return t=!1,!1}),t)},move_node:function(e,t,n,i,s,o){if(!s)return this.prepare_move(e,t,n,function(e){this.move_node(e,!1,!1,i,!0,o)});i&&(u.cy=!0);if(!o&&!this.check_move())return!1;this.__rollback();var a=!1;i?(a=e.o.clone(!0),a.find("*[id]").addBack().each(function(){this.id&&(this.id="copy_"+this.id)})):a=e.o,e.or.length?e.or.before(a):(e.np.children("ul").length||r("<ul />").appendTo(e.np),e.np.children("ul:eq(0)").append(a));try{e.ot.clean_node(e.op),e.rt.clean_node(e.np),e.op.find("> ul > li").length||e.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(f){}return i&&(u.cy=!0,u.oc=a),this.__callback(u),u},_get_move:function(){return u}}})})(jQuery),function(e){var t,n,r;e(function(){/msie/.test(navigator.userAgent.toLowerCase())?(n=e('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),r=e('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),t=n.width()-r.width(),n.add(r).remove()):(n=e("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200}),t=100-n.width(),n.parent().remove())}),e.jstree.plugin("ui",{__init:function(){this.data.ui.selected=e(),this.data.ui.last_selected=!1,this.data.ui.hovered=null,this.data.ui.to_select=this.get_settings().ui.initially_select,this.get_container().delegate("a","click.jstree",e.proxy(function(t){t.preventDefault(),t.currentTarget.blur(),e(t.currentTarget).hasClass("jstree-loading")||this.select_node(t.currentTarget,!0,t)},this)).delegate("a","mouseenter.jstree",e.proxy(function(t){e(t.currentTarget).hasClass("jstree-loading")||this.hover_node(t.target)},this)).delegate("a","mouseleave.jstree",e.proxy(function(t){e(t.currentTarget).hasClass("jstree-loading")||this.dehover_node(t.target)},this)).bind("reopen.jstree",e.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",e.proxy(function(){this.dehover_node(),this.save_selected()},this)).bind("set_rollback.jstree",e.proxy(function(){this.reselect()},this)).bind("close_node.jstree",e.proxy(function(t,n){var r=this._get_settings().ui,i=this._get_node(n.rslt.obj),s=i&&i.length?i.children("ul").find("a.jstree-clicked"):e(),o=this;if(r.selected_parent_close===!1||!s.length)return;s.each(function(){o.deselect_node(this),r.selected_parent_close==="select_parent"&&o.select_node(i)})},this)).bind("delete_node.jstree",e.proxy(function(e,t){var n=this._get_settings().ui.select_prev_on_delete,r=this._get_node(t.rslt.obj),i=r&&r.length?r.find("a.jstree-clicked"):[],s=this;i.each(function(){s.deselect_node(this)}),n&&i.length&&t.rslt.prev.each(function(){if(this.parentNode)return s.select_node(this),!1})},this)).bind("move_node.jstree",e.proxy(function(e,t){t.rslt.cy&&t.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:!0,select_prev_on_delete:!0,disable_selecting_children:!1,initially_select:[]},_fn:{_get_node:function(t,n){if(typeof t=="undefined"||t===null)return n?this.data.ui.selected:this.data.ui.last_selected;var r=e(t,this.get_container());return r.is(".jstree")||t==-1?-1:(r=r.closest("li",this.get_container()),r.length?r:!1)},_ui_notify:function(e,t){t.selected&&this.select_node(e,!1)},save_selected:function(){var e=this;this.data.ui.to_select=[],this.data.ui.selected.each(function(){this.id&&e.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}),this.__callback(this.data.ui.to_select)},reselect:function(){var t=this,n=this.data.ui.to_select;n=e.map(e.makeArray(n),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),e.each(n,function(e,n){n&&n!=="#"&&t.select_node(n)}),this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode}),this.__callback()},refresh:function(e){return this.save_selected(),this.__call_old()},hover_node:function(e){e=this._get_node(e);if(!e.length)return!1;e.hasClass("jstree-hovered")||this.dehover_node(),this.data.ui.hovered=e.children("a").addClass("jstree-hovered").parent(),this.__callback({obj:e})},dehover_node:function(){var e=this.data.ui.hovered,t;if(!e||!e.length)return!1;t=e.children("a").removeClass("jstree-hovered").parent(),this.data.ui.hovered[0]===t[0]&&(this.data.ui.hovered=null),this.__callback({obj:e})},select_node:function(e,t,n){e=this._get_node(e);if(e==-1||!e||!e.length)return!1;var r=this._get_settings().ui,i=r.select_multiple_modifier=="on"||r.select_multiple_modifier!==!1&&n&&n[r.select_multiple_modifier+"Key"],s=r.select_range_modifier!==!1&&n&&n[r.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==e[0]&&this.data.ui.last_selected.parent()[0]===e.parent()[0],o=this.is_selected(e),u=!0,a=this;if(t){if(r.disable_selecting_children&&i&&(e.parentsUntil(".jstree","li").children("a.jstree-clicked").length||e.children("ul").find("a.jstree-clicked:eq(0)").length))return!1;u=!1;switch(!0){case s:this.data.ui.last_selected.addClass("jstree-last-selected"),e=e[e.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").addBack(),r.select_limit==-1||e.length<r.select_limit?(this.data.ui.last_selected.removeClass("jstree-last-selected"),this.data.ui.selected.each(function(){this!==a.data.ui.last_selected[0]&&a.deselect_node(this)}),o=!1,u=!0):u=!1;break;case o&&!i:this.deselect_all(),o=!1,u=!0;break;case!o&&!i:if(r.select_limit==-1||r.select_limit>0)this.deselect_all(),u=!0;break;case o&&i:this.deselect_node(e);break;case!o&&i:if(r.select_limit==-1||this.data.ui.selected.length+1<=r.select_limit)u=!0}}u&&!o&&(s||(this.data.ui.last_selected=e),e.children("a").addClass("jstree-clicked"),r.selected_parent_open&&e.parents(".jstree-closed").each(function(){a.open_node(this,!1,!0)}),this.data.ui.selected=this.data.ui.selected.add(e),this._fix_scroll(e.eq(0)),this.__callback({obj:e,e:n}))},_fix_scroll:function(e){var n=this.get_container()[0],r;if(n.scrollHeight>n.offsetHeight){e=this._get_node(e);if(!e||e===-1||!e.length||!e.is(":visible"))return;r=e.offset().top-this.get_container().offset().top,r<0&&(n.scrollTop=n.scrollTop+r-1),r+this.data.core.li_height+(n.scrollWidth>n.offsetWidth?t:0)>n.offsetHeight&&(n.scrollTop=n.scrollTop+(r-n.offsetHeight+this.data.core.li_height+1+(n.scrollWidth>n.offsetWidth?t:0)))}},deselect_node:function(e){e=this._get_node(e);if(!e.length)return!1;this.is_selected(e)&&(e.children("a").removeClass("jstree-clicked"),this.data.ui.selected=this.data.ui.selected.not(e),this.data.ui.last_selected.get(0)===e.get(0)&&(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:e}))},toggle_select:function(e){e=this._get_node(e);if(!e.length)return!1;this.is_selected(e)?this.deselect_node(e):this.select_node(e)},is_selected:function(e){return this.data.ui.selected.index(this._get_node(e))>=0},get_selected:function(t){return t?e(t).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(t){var n=t?e(t).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();n.children("a.jstree-clicked").removeClass("jstree-clicked"),this.data.ui.selected=e([]),this.data.ui.last_selected=!1,this.__callback({obj:n})}}}),e.jstree.defaults.plugins.push("ui")}(jQuery),function(e){e.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",e.proxy(function(e,t){if(this._get_settings().crrm.move.open_onmove){var n=this;t.rslt.np.parentsUntil(".jstree").addBack().filter(".jstree-closed").each(function(){n.open_node(this,!1,!0)})}},this))},defaults:{input_width_limit:200,move:{always_copy:!1,open_onmove:!0,default_position:"last",check_move:function(e){return!0}}},_fn:{_show_input:function(t,n){t=this._get_node(t);var r=this._get_settings().core.rtl,i=this._get_settings().crrm.input_width_limit,s=t.children("ins").width(),o=t.find("> a:visible > ins").width()*t.find("> a:visible > ins").length,u=this.get_text(t),a=e("<div />",{css:{position:"absolute",top:"-200px",left:r?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),f=t.css("position","relative").append(e("<input />",{value:u,"class":"jstree-rename-input",css:{right:r?s+o+4+"px":"auto",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px"},blur:e.proxy(function(){var e=t.children(".jstree-rename-input"),r=e.val();r===""&&(r=u),a.remove(),e.remove(),this.set_text(t,u),this.rename_node(t,r),n.call(this,t,r,u),t.css("position","")},this),keyup:function(e){var t=e.keyCode||e.which;if(t==27){this.value=u,this.blur();return}if(t==13){this.blur();return}f.width(Math.min(a.text("pW"+this.value).width(),i))},keypress:function(e){var t=e.keyCode||e.which;if(t==13)return!1}})).children(".jstree-rename-input");this.set_text(t,""),a.css({fontFamily:f.css("fontFamily")||"",fontSize:f.css("fontSize")||"",fontWeight:f.css("fontWeight")||"",fontStyle:f.css("fontStyle")||"",fontStretch:f.css("fontStretch")||"",fontVariant:f.css("fontVariant")||"",letterSpacing:f.css("letterSpacing")||"",wordSpacing:f.css("wordSpacing")||""}),f.width(Math.min(a.text("pW"+f[0].value).width(),i))[0].select()},rename:function(e){e=this._get_node(e),this.__rollback();var t=this.__callback;this._show_input(e,function(e,n,r){t.call(this,{obj:e,new_name:n,old_name:r})})},create:function(t,n,r,i,s){var o,u=this;return t=this._get_node(t),t||(t=-1),this.__rollback(),o=this.create_node(t,n,r,function(t){var n=this._get_parent(t),r=e(t).index();i&&i.call(this,t),n.length&&n.hasClass("jstree-closed")&&this.open_node(n,!1,!0),s?u.__callback({obj:t,name:this.get_text(t),parent:n,position:r}):this._show_input(t,function(e,t,i){u.__callback({obj:e,name:t,parent:n,position:r})})}),o},remove:function(e){e=this._get_node(e,!0);var t=this._get_parent(e),n=this._get_prev(e);this.__rollback(),e=this.delete_node(e),e!==!1&&this.__callback({obj:e,prev:n,parent:t})},check_move:function(){if(!this.__call_old())return!1;var e=this._get_settings().crrm.move;return e.check_move.call(this,this._get_move())?!0:!1},move_node:function(e,t,n,r,i,s){var o=this._get_settings().crrm.move;if(!i)return typeof n=="undefined"&&(n=o.default_position),n==="inside"&&!o.default_position.match(/^(before|after)$/)&&(n=o.default_position),this.__call_old(!0,e,t,n,r,!1,s);if(o.always_copy===!0||o.always_copy==="multitree"&&e.rt.get_index()!==e.ot.get_index())r=!0;this.__call_old(!0,e,t,n,r,!0,s)},cut:function(e){e=this._get_node(e,!0);if(!e||!e.length)return!1;this.data.crrm.cp_nodes=!1,this.data.crrm.ct_nodes=e,this.__callback({obj:e})},copy:function(e){e=this._get_node(e,!0);if(!e||!e.length)return!1;this.data.crrm.ct_nodes=!1,this.data.crrm.cp_nodes=e,this.__callback({obj:e})},paste:function(e){e=this._get_node(e);if(!e||!e.length)return!1;var t=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes)return!1;this.data.crrm.ct_nodes&&(this.move_node(this.data.crrm.ct_nodes,e),this.data.crrm.ct_nodes=!1),this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,e,!1,!0),this.__callback({obj:e,nodes:t})}}})}(jQuery),function(e){var t=[];e.jstree._themes=!1,e.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",e.proxy(function(){var e=this._get_settings().themes;this.data.themes.dots=e.dots,this.data.themes.icons=e.icons,this.set_theme(e.theme,e.url)},this)).bind("loaded.jstree",e.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:!1,dots:!0,icons:!0},_fn:{set_theme:function(n,r){if(!n)return!1;r||(r=e.jstree._themes+n+"/style.css"),e.inArray(r,t)==-1&&(e.vakata.css.add_sheet({url:r}),t.push(r)),this.data.themes.theme!=n&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=n),this.get_container().addClass("jstree-"+n),this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons(),this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=!0,this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=!1,this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0,this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1,this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}}),e(function(){e.jstree._themes===!1&&e("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/))return e.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1}),e.jstree._themes===!1&&(e.jstree._themes="themes/")}),e.jstree.defaults.plugins.push("themes")}(jQuery),function(e){function n(t,n){var r=e.jstree._focused(),i;if(r&&r.data&&r.data.hotkeys&&r.data.hotkeys.enabled){i=r._get_settings().hotkeys[t];if(i)return i.call(r,n)}}var t=[];e.jstree.plugin("hotkeys",{__init:function(){if(typeof e.hotkeys=="undefined")throw"jsTree hotkeys: jQuery hotkeys plugin not included.";if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";e.each(this._get_settings().hotkeys,function(r,i){i!==!1&&e.inArray(r,t)==-1&&(e(document).bind("keydown",r,function(e){return n(r,e)}),t.push(r))}),this.get_container().bind("lock.jstree",e.proxy(function(){this.data.hotkeys.enabled&&(this.data.hotkeys.enabled=!1,this.data.hotkeys.revert=!0)},this)).bind("unlock.jstree",e.proxy(function(){this.data.hotkeys.revert&&(this.data.hotkeys.enabled=!0)},this)),this.enable_hotkeys()},defaults:{up:function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(e)),!1},"ctrl+up":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(e)),!1},"shift+up":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(e)),!1},down:function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(e)),!1},"ctrl+down":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(e)),!1},"shift+down":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(e)),!1},left:function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e))),!1},"ctrl+left":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e))),!1},"shift+left":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e))),!1},right:function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e))),!1},"ctrl+right":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e))),!1},"shift+right":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e))),!1},space:function(){return this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click(),!1},"ctrl+space":function(e){return e.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(e),!1},"shift+space":function(e){return e.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(e),!1},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=!1}}})}(jQuery),function(e){e.jstree.plugin("json_data",{__init:function(){var e=this._get_settings().json_data;e.progressive_unload&&this.get_container().bind("after_close.jstree",function(e,t){t.rslt.obj.children("ul").remove()})},defaults:{data:!1,ajax:!1,correct_state:!0,progressive_render:!1,progressive_unload:!1},_fn:{load_node:function(e,t,n){var r=this;this.load_node_json(e,function(){r.__callback({obj:r._get_node(e)}),t.call(this)},n)},_is_loaded:function(t){var n=this._get_settings().json_data;return t=this._get_node(t),t==-1||!t||!n.ajax&&!n.progressive_render&&!e.isFunction(n.data)||t.is(".jstree-open, .jstree-leaf")||t.children("ul").children("li").length>0},refresh:function(t){t=this._get_node(t);var n=this._get_settings().json_data;return t&&t!==-1&&n.progressive_unload&&(e.isFunction(n.data)||!!n.ajax)&&t.removeData("jstree_children"),this.__call_old()},load_node_json:function(t,n,r){var i=this.get_settings().json_data,s,o=function(){},u=function(){};t=this._get_node(t);if(t&&t!==-1&&(i.progressive_render||i.progressive_unload)&&!t.is(".jstree-open, .jstree-leaf")&&t.children("ul").children("li").length===0&&t.data("jstree_children")){s=this._parse_json(t.data("jstree_children"),t),s&&(t.append(s),i.progressive_unload||t.removeData("jstree_children")),this.clean_node(t),n&&n.call(this);return}if(t&&t!==-1){if(t.data("jstree_is_loading"))return;t.data("jstree_is_loading",!0)}switch(!0){case!i.data&&!i.ajax:throw"Neither data nor ajax settings supplied.";case e.isFunction(i.data):i.data.call(this,t,e.proxy(function(e){e=this._parse_json(e,t),e?(t===-1||!t?this.get_container().children("ul").empty().append(e.children()):(t.append(e).children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading")),this.clean_node(t),n&&n.call(this)):(t===-1||!t?i.correct_state&&this.get_container().children("ul").empty():(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),i.correct_state&&this.correct_state(t)),r&&r.call(this))},this));break;case!!i.data&&!i.ajax||!!i.data&&!!i.ajax&&(!t||t===-1):if(!t||t==-1)s=this._parse_json(i.data,t),s?(this.get_container().children("ul").empty().append(s.children()),this.clean_node()):i.correct_state&&this.get_container().children("ul").empty();n&&n.call(this);break;case!i.data&&!!i.ajax||!!i.data&&!!i.ajax&&t&&t!==-1:o=function(e,n,s){var o=this.get_settings().json_data.ajax.error;o&&o.call(this,e,n,s),t!=-1&&t.length?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),n==="success"&&i.correct_state&&this.correct_state(t)):n==="success"&&i.correct_state&&this.get_container().children("ul").empty(),r&&r.call(this)},u=function(r,s,u){var a=this.get_settings().json_data.ajax.success;a&&(r=a.call(this,r,s,u)||r);if(r===""||r&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")===""||!e.isArray(r)&&!e.isPlainObject(r))return o.call(this,u,s,"");r=this._parse_json(r,t),r?(t===-1||!t?this.get_container().children("ul").empty().append(r.children()):(t.append(r).children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading")),this.clean_node(t),n&&n.call(this)):t===-1||!t?i.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this)):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),i.correct_state&&(this.correct_state(t),n&&n.call(this)))},i.ajax.context=this,i.ajax.error=o,i.ajax.success=u,i.ajax.dataType||(i.ajax.dataType="json"),e.isFunction(i.ajax.url)&&(i.ajax.url=i.ajax.url.call(this,t)),e.isFunction(i.ajax.data)&&(i.ajax.data=i.ajax.data.call(this,t)),e.ajax(i.ajax)}},_parse_json:function(t,n,r){var i=!1,s=this._get_settings(),o=s.json_data,u=s.core.html_titles,a,f,l,c,h;if(!t)return i;o.progressive_unload&&n&&n!==-1&&n.data("jstree_children",i);if(e.isArray(t)){i=e();if(!t.length)return!1;for(f=0,l=t.length;f<l;f++)a=this._parse_json(t[f],n,!0),a.length&&(i=i.add(a))}else{typeof t=="string"&&(t={data:t});if(!t.data&&t.data!=="")return i;i=e("<li />"),t.attr&&i.attr(t.attr),t.metadata&&i.data(t.metadata),t.state&&i.addClass("jstree-"+t.state),e.isArray(t.data)||(a=t.data,t.data=[],t.data.push(a)),e.each(t.data,function(n,r){a=e("<a />"),e.isFunction(r)&&(r=r.call(this,t)),typeof r=="string"?a.attr("href","#")[u?"html":"text"](r):(r.attr||(r.attr={}),r.attr.href||(r.attr.href="#"),a.attr(r.attr)[u?"html":"text"](r.title),r.language&&a.addClass(r.language)),a.prepend("<ins class='jstree-icon'>&#160;</ins>"),!r.icon&&t.icon&&(r.icon=t.icon),r.icon&&(r.icon.indexOf("/")===-1?a.children("ins").addClass(r.icon):a.children("ins").css("background","url('"+r.icon+"') center center no-repeat")),i.append(a)}),i.prepend("<ins class='jstree-icon'>&#160;</ins>"),t.children&&(o.progressive_render&&t.state!=="open"?i.addClass("jstree-closed").data("jstree_children",t.children):(o.progressive_unload&&i.data("jstree_children",t.children),e.isArray(t.children)&&t.children.length&&(a=this._parse_json(t.children,n,!0),a.length&&(h=e("<ul />"),h.append(a),i.append(h)))))}return r||(c=e("<ul />"),c.append(i),i=c),i},get_json:function(t,n,r,i){var s=[],o=this._get_settings(),u=this,a,f,l,c,h,p;t=this._get_node(t);if(!t||t===-1)t=this.get_container().find("> ul > li");return n=e.isArray(n)?n:["id","class"],!i&&this.data.types&&n.push(o.types.type_attr),r=e.isArray(r)?r:[],t.each(function(){l=e(this),a={data:[]},n.length&&(a.attr={}),e.each(n,function(e,t){f=l.attr(t),f&&f.length&&f.replace(/jstree[^ ]*/ig,"").length&&(a.attr[t]=(" "+f).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))}),l.hasClass("jstree-open")&&(a.state="open"),l.hasClass("jstree-closed")&&(a.state="closed"),l.data()&&(a.metadata=l.data()),c=l.children("a"),c.each(function(){h=e(this),r.length||e.inArray("languages",o.plugins)!==-1||h.children("ins").get(0).style.backgroundImage.length||h.children("ins").get(0).className&&h.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length?(p=!1,e.inArray("languages",o.plugins)!==-1&&e.isArray(o.languages)&&o.languages.length&&e.each(o.languages,function(e,t){if(h.hasClass(t))return p=t,!1}),f={attr:{},title:u.get_text(h,p)},e.each(r,function(e,t){f.attr[t]=(" "+(h.attr(t)||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")}),e.inArray("languages",o.plugins)!==-1&&e.isArray(o.languages)&&o.languages.length&&e.each(o.languages,function(e,t){if(h.hasClass(t))return f.language=t,!0}),h.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(f.icon=h.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")),h.children("ins").get(0).style.backgroundImage.length&&(f.icon=h.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")",""))):f=u.get_text(h),c.length>1?a.data.push(f):a.data=f}),l=l.find("> ul > li"),l.length&&(a.children=u.get_json(l,n,r,!0)),s.push(a)}),s}}})}(jQuery),function(e){e.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(t){var n=this._get_settings().languages,r=!1,i=".jstree-"+this.get_index()+" a";if(!e.isArray(n)||n.length===0)return!1;if(e.inArray(t,n)==-1){if(!n[t])return!1;t=n[t]}return t==this.data.languages.current_language?!0:(r=e.vakata.css.get_css(i+"."+this.data.languages.current_language,!1,this.data.languages.language_css),r!==!1&&(r.style.display="none"),r=e.vakata.css.get_css(i+"."+t,!1,this.data.languages.language_css),r!==!1&&(r.style.display=""),this.data.languages.current_language=t,this.__callback(t),!0)},get_lang:function(){return this.data.languages.current_language},_get_string:function(t,n){var r=this._get_settings().languages,i=this._get_settings().core.strings;return e.isArray(r)&&r.length&&(n=n&&e.inArray(n,r)!=-1?n:this.data.languages.current_language),i[n]&&i[n][t]?i[n][t]:i[t]?i[t]:t},get_text:function(t,n){t=this._get_node(t)||this.data.ui.last_selected;if(!t.length)return!1;var r=this._get_settings().languages,i=this._get_settings().core.html_titles;return e.isArray(r)&&r.length?(n=n&&e.inArray(n,r)!=-1?n:this.data.languages.current_language,t=t.children("a."+n)):t=t.children("a:eq(0)"),i?(t=t.clone(),t.children("INS").remove(),t.html()):(t=t.contents().filter(function(){return this.nodeType==3})[0],t.nodeValue)},set_text:function(t,n,r){t=this._get_node(t)||this.data.ui.last_selected;if(!t.length)return!1;var i=this._get_settings().languages,s=this._get_settings().core.html_titles,o;return e.isArray(i)&&i.length?(r=r&&e.inArray(r,i)!=-1?r:this.data.languages.current_language,t=t.children("a."+r)):t=t.children("a:eq(0)"),s?(o=t.children("INS").clone(),t.html(n).prepend(o),this.__callback({obj:t,name:n,lang:r}),!0):(t=t.contents().filter(function(){return this.nodeType==3})[0],this.__callback({obj:t,name:n,lang:r}),t.nodeValue=n)},_load_css:function(){var t=this._get_settings().languages,n="/* languages css */",r=".jstree-"+this.get_index()+" a",i;if(e.isArray(t)&&t.length){this.data.languages.current_language=t[0];for(i=0;i<t.length;i++)n+=r+"."+t[i]+" {",t[i]!=this.data.languages.current_language&&(n+=" display:none; "),n+=" } ";this.data.languages.language_css=e.vakata.css.add_sheet({str:n,title:"jstree-languages"})}},create_node:function(t,n,r,i){var s=this.__call_old(!0,t,n,r,function(t){var n=this._get_settings().languages,r=t.children("a"),s;if(e.isArray(n)&&n.length){for(s=0;s<n.length;s++)r.is("."+n[s])||t.append(r.eq(0).clone().removeClass(n.join(" ")).addClass(n[s]));r.not("."+n.join(", .")).remove()}i&&i.call(this,t)});return s}}})}(jQuery),function(e){e.jstree.plugin("cookies",{__init:function(){if(typeof e.cookie=="undefined")throw"jsTree cookie: jQuery cookie plugin not included.";var t=this._get_settings().cookies,n;!t.save_loaded||(n=e.cookie(t.save_loaded),n&&n.length&&(this.data.core.to_load=n.split(","))),!t.save_opened||(n=e.cookie(t.save_opened),n&&n.length&&(this.data.core.to_open=n.split(","))),!t.save_selected||(n=e.cookie(t.save_selected),n&&n.length&&this.data.ui&&(this.data.ui.to_select=n.split(","))),this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",e.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",e.proxy(function(e){this._get_settings().cookies.auto_save&&this.save_cookie((e.handleObj.namespace+e.handleObj.type).replace("jstree",""))},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:!0,cookie_options:{}},_fn:{save_cookie:function(t){if(this.data.core.refreshing)return;var n=this._get_settings().cookies;if(!t){n.save_loaded&&(this.save_loaded(),e.cookie(n.save_loaded,this.data.core.to_load.join(","),n.cookie_options)),n.save_opened&&(this.save_opened(),e.cookie(n.save_opened,this.data.core.to_open.join(","),n.cookie_options)),n.save_selected&&this.data.ui&&(this.save_selected(),e.cookie(n.save_selected,this.data.ui.to_select.join(","),n.cookie_options));return}switch(t){case"open_node":case"close_node":!n.save_opened||(this.save_opened(),e.cookie(n.save_opened,this.data.core.to_open.join(","),n.cookie_options)),!n.save_loaded||(this.save_loaded(),e.cookie(n.save_loaded,this.data.core.to_load.join(","),n.cookie_options));break;case"select_node":case"deselect_node":!!n.save_selected&&this.data.ui&&(this.save_selected(),e.cookie(n.save_selected,this.data.ui.to_select.join(","),n.cookie_options))}}}})}(jQuery),function(e){e.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",e.proxy(function(e,t){var n=this._get_node(t.rslt.obj);n=n===-1?this.get_container().children("ul"):n.children("ul"),this.sort(n)},this)).bind("rename_node.jstree create_node.jstree create.jstree",e.proxy(function(e,t){this.sort(t.rslt.obj.parent())},this)).bind("move_node.jstree",e.proxy(function(e,t){var n=t.rslt.np==-1?this.get_container():t.rslt.np;this.sort(n.children("ul"))},this))},defaults:function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},_fn:{sort:function(t){var n=this._get_settings().sort,r=this;t.append(e.makeArray(t.children("li")).sort(e.proxy(n,r))),t.find("> li > ul").each(function(){r.sort(e(this))}),this.clean_node(t)}}})}(jQuery),function(e){var t=!1,n=!1,r=!1,i=!1,s=!1,o=!1,u=!1,a=!1,f=!1;e.vakata.dnd={is_down:!1,is_drag:!1,helper:!1,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(t,n,r){e.vakata.dnd.is_drag&&e.vakata.drag_stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.MozUserSelect="none")}catch(i){}return e.vakata.dnd.init_x=t.pageX,e.vakata.dnd.init_y=t.pageY,e.vakata.dnd.user_data=n,e.vakata.dnd.is_down=!0,e.vakata.dnd.helper=e("<div id='vakata-dragged' />").html(r),e(document).bind("mousemove",e.vakata.dnd.drag),e(document).bind("mouseup",e.vakata.dnd.drag_stop),!1},drag:function(t){if(!e.vakata.dnd.is_down)return;if(!e.vakata.dnd.is_drag){if(!(Math.abs(t.pageX-e.vakata.dnd.init_x)>5||Math.abs(t.pageY-e.vakata.dnd.init_y)>5))return;e.vakata.dnd.helper.appendTo("body"),e.vakata.dnd.is_drag=!0,e(document).triggerHandler("drag_start.vakata",{event:t,data:e.vakata.dnd.user_data})}if(t.type==="mousemove"){var n=e(document),r=n.scrollTop(),i=n.scrollLeft();t.pageY-r<20?(o&&u==="down"&&(clearInterval(o),o=!1),o||(u="up",o=setInterval(function(){e(document).scrollTop(e(document).scrollTop()-e.vakata.dnd.scroll_spd)},150))):o&&u==="up"&&(clearInterval(o),o=!1),e(window).height()-(t.pageY-r)<20?(o&&u==="up"&&(clearInterval(o),o=!1),o||(u="down",o=setInterval(function(){e(document).scrollTop(e(document).scrollTop()+e.vakata.dnd.scroll_spd)},150))):o&&u==="down"&&(clearInterval(o),o=!1),t.pageX-i<20?(s&&a==="right"&&(clearInterval(s),s=!1),s||(a="left",s=setInterval(function(){e(document).scrollLeft(e(document).scrollLeft()-e.vakata.dnd.scroll_spd)},150))):s&&a==="left"&&(clearInterval(s),s=!1),e(window).width()-(t.pageX-i)<20?(s&&a==="left"&&(clearInterval(s),s=!1),s||(a="right",s=setInterval(function(){e(document).scrollLeft(e(document).scrollLeft()+e.vakata.dnd.scroll_spd)},150))):s&&a==="right"&&(clearInterval(s),s=!1)}e.vakata.dnd.helper.css({left:t.pageX+e.vakata.dnd.helper_left+"px",top:t.pageY+e.vakata.dnd.helper_top+"px"}),e(document).triggerHandler("drag.vakata",{event:t,data:e.vakata.dnd.user_data})},drag_stop:function(t){s&&clearInterval(s),o&&clearInterval(o),e(document).unbind("mousemove",e.vakata.dnd.drag),e(document).unbind("mouseup",e.vakata.dnd.drag_stop),e(document).triggerHandler("drag_stop.vakata",{event:t,data:e.vakata.dnd.user_data}),e.vakata.dnd.helper.remove(),e.vakata.dnd.init_x=0,e.vakata.dnd.init_y=0,e.vakata.dnd.user_data={},e.vakata.dnd.is_down=!1,e.vakata.dnd.is_drag=!1}},e(function(){var t="#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ";e.vakata.css.add_sheet({str:t,title:"vakata"})}),e.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:!1,after:!1,inside:!1,before:!1,off:!1,prepared:!1,w:0,to1:!1,to2:!1,cof:!1,cw:!1,ch:!1,i1:!1,i2:!1,mto:!1},this.get_container().bind("mouseenter.jstree",e.proxy(function(n){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){this.data.themes&&(r.attr("class","jstree-"+this.data.themes.theme),i&&i.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme));if(n.currentTarget===n.target&&e.vakata.dnd.user_data.obj&&e(e.vakata.dnd.user_data.obj).length&&e(e.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==n.target){var s=e.jstree._reference(n.target),o;s.data.dnd.foreign?(o=s._get_settings().dnd.drag_check.call(this,{o:t,r:s.get_container(),is_root:!0}),(o===!0||o.inside===!0||o.before===!0||o.after===!0)&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok")):(s.prepare_move(t,s.get_container(),"last"),s.check_move()&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok"))}}},this)).bind("mouseup.jstree",e.proxy(function(n){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&n.currentTarget===n.target&&e.vakata.dnd.user_data.obj&&e(e.vakata.dnd.user_data.obj).length&&e(e.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==n.target){var r=e.jstree._reference(n.currentTarget),i;r.data.dnd.foreign?(i=r._get_settings().dnd.drag_check.call(this,{o:t,r:r.get_container(),is_root:!0}),(i===!0||i.inside===!0||i.before===!0||i.after===!0)&&r._get_settings().dnd.drag_finish.call(this,{o:t,r:r.get_container(),is_root:!0})):r.move_node(t,r.get_container(),"last",n[r._get_settings().dnd.copy_modifier+"Key"])}},this)).bind("mouseleave.jstree",e.proxy(function(t){if(t.relatedTarget&&t.relatedTarget.id&&t.relatedTarget.id==="jstree-marker-line")return!1;e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),e.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"))},this)).bind("mousemove.jstree",e.proxy(function(t){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){var n=this.get_container()[0];t.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(e.proxy(function(){this.scrollLeft+=e.vakata.dnd.scroll_spd},n),100)):t.pageX-24<this.data.dnd.cof.left?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(e.proxy(function(){this.scrollLeft-=e.vakata.dnd.scroll_spd},n),100)):this.data.dnd.i1&&clearInterval(this.data.dnd.i1),t.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(e.proxy(function(){this.scrollTop+=e.vakata.dnd.scroll_spd},n),100)):t.pageY-24<this.data.dnd.cof.top?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(e.proxy(function(){this.scrollTop-=e.vakata.dnd.scroll_spd},n),100)):this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).bind("scroll.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&r&&i&&(r.hide(),i.hide())},this)).delegate("a","mousedown.jstree",e.proxy(function(e){if(e.which===1)return this.start_drag(e.currentTarget,e),!1},this)).delegate("a","mouseenter.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&this.dnd_enter(t.currentTarget)},this)).delegate("a","mousemove.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&((!n||!n.length||n.children("a")[0]!==t.currentTarget)&&this.dnd_enter(t.currentTarget),typeof this.data.dnd.off.top=="undefined"&&(this.data.dnd.off=e(t.target).offset()),this.data.dnd.w=(t.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height,this.data.dnd.w<0&&(this.data.dnd.w+=this.data.core.li_height),this.dnd_show())},this)).delegate("a","mouseleave.jstree",e.proxy(function(t){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){if(t.relatedTarget&&t.relatedTarget.id&&t.relatedTarget.id==="jstree-marker-line")return!1;r&&r.hide(),i&&i.hide(),this.data.dnd.mto=setTimeout(function(e){return function(){e.dnd_leave(t)}}(this),0)}},this)).delegate("a","mouseup.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&this.dnd_finish(t)},this)),e(document).bind("drag_stop.vakata",e.proxy(function(){this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,this.data.dnd.off=!1,this.data.dnd.prepared=!1,this.data.dnd.w=!1,this.data.dnd.to1=!1,this.data.dnd.to2=!1,this.data.dnd.i1=!1,this.data.dnd.i2=!1,this.data.dnd.active=!1,this.data.dnd.foreign=!1,r&&r.css({top:"-2000px"}),i&&i.css({top:"-2000px"})},this)).bind("drag_start.vakata",e.proxy(function(t,n){if(n.data.jstree){var r=e(n.event.target);r.closest(".jstree").hasClass("jstree-"+this.get_index())&&this.dnd_enter(r)}},this));var s=this._get_settings().dnd;s.drag_target&&e(document).delegate(s.drag_target,"mousedown.jstree-"+this.get_index(),e.proxy(function(n){t=n.target,e.vakata.dnd.drag_start(n,{jstree:!0,obj:n.target},"<ins class='jstree-icon'></ins>"+e(n.target).text()),this.data.themes&&(r&&r.attr("class","jstree-"+this.data.themes.theme),i&&i.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var s=this.get_container();this.data.dnd.cof=s.offset(),this.data.dnd.cw=parseInt(s.width(),10),this.data.dnd.ch=parseInt(s.height(),10),this.data.dnd.foreign=!0,n.preventDefault()},this)),s.drop_target&&e(document).delegate(s.drop_target,"mouseenter.jstree-"+this.get_index(),e.proxy(function(n){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:t,r:e(n.target),e:n})&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok")},this)).delegate(s.drop_target,"mouseleave.jstree-"+this.get_index(),e.proxy(function(t){this.data.dnd.active&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(s.drop_target,"mouseup.jstree-"+this.get_index(),e.proxy(function(n){this.data.dnd.active&&e.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:t,r:e(n.target),e:n})},this))},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,drop_target:".jstree-drop",drop_check:function(e){return!0},drop_finish:e.noop,drag_target:".jstree-draggable",drag_finish:e.noop,drag_check:function(e){return{after:!1,before:!1,inside:!0}}},_fn:{dnd_prepare:function(){if(!n||!n.length)return;this.data.dnd.off=n.offset(),this._get_settings().core.rtl&&(this.data.dnd.off.right=this.data.dnd.off.left+n.width());if(this.data.dnd.foreign){var e=this._get_settings().dnd.drag_check.call(this,{o:t,r:n});return this.data.dnd.after=e.after,this.data.dnd.before=e.before,this.data.dnd.inside=e.inside,this.data.dnd.prepared=!0,this.dnd_show()}return this.prepare_move(t,n,"before"),this.data.dnd.before=this.check_move(),this.prepare_move(t,n,"after"),this.data.dnd.after=this.check_move(),this._is_loaded(n)?(this.prepare_move(t,n,"inside"),this.data.dnd.inside=this.check_move()):this.data.dnd.inside=!1,this.data.dnd.prepared=!0,this.dnd_show()},dnd_show:function(){if(!this.data.dnd.prepared)return;var t=["before","inside","after"],n=!1,s=this._get_settings().core.rtl,o;this.data.dnd.w<this.data.core.li_height/3?t=["before","inside","after"]:this.data.dnd.w<=this.data.core.li_height*2/3?t=this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]:t=["after","inside","before"],e.each(t,e.proxy(function(t,r){if(this.data.dnd[r])return e.vakata.dnd.helper.children("ins").attr("class","jstree-ok"),n=r,!1},this)),n===!1&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),o=s?this.data.dnd.off.right-18:this.data.dnd.off.left+10;switch(n){case"before":r.css({left:o+"px",top:this.data.dnd.off.top-6+"px"}).show(),i&&i.css({left:o+8+"px",top:this.data.dnd.off.top-1+"px"}).show();break;case"after":r.css({left:o+"px",top:this.data.dnd.off.top+this.data.core.li_height-6+"px"}).show(),i&&i.css({left:o+8+"px",top:this.data.dnd.off.top+this.data.core.li_height-1+"px"}).show();break;case"inside":r.css({left:o+(s?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show(),i&&i.hide();break;default:r.hide(),i&&i.hide()}return f=n,n},dnd_open:function(){this.data.dnd.to2=!1,this.open_node(n,e.proxy(this.dnd_prepare,this),!0)},dnd_finish:function(e){this.data.dnd.foreign?(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)&&this._get_settings().dnd.drag_finish.call(this,{o:t,r:n,p:f}):(this.dnd_prepare(),this.move_node(t,n,f,e[this._get_settings().dnd.copy_modifier+"Key"])),t=!1,n=!1,r.hide(),i&&i.hide()},dnd_enter:function(t){this.data.dnd.mto&&(clearTimeout(this.data.dnd.mto),this.data.dnd.mto=!1);var r=this._get_settings().dnd;this.data.dnd.prepared=!1,n=this._get_node(t),r.check_timeout?(this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to1=setTimeout(e.proxy(this.dnd_prepare,this),r.check_timeout)):this.dnd_prepare(),r.open_timeout?(this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),n&&n.length&&n.hasClass("jstree-closed")&&(this.data.dnd.to2=setTimeout(e.proxy(this.dnd_open,this),r.open_timeout))):n&&n.length&&n.hasClass("jstree-closed")&&this.dnd_open()},dnd_leave:function(t){this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),r.hide(),i&&i.hide(),n&&n[0]===t.target.parentNode&&(this.data.dnd.to1&&(clearTimeout(this.data.dnd.to1),this.data.dnd.to1=!1),this.data.dnd.to2&&(clearTimeout(this.data.dnd.to2),this.data.dnd.to2=!1))},start_drag:function(n,s){t=this._get_node(n),this.data.ui&&this.is_selected(t)&&(t=this._get_node(null,!0));var o=t.length>1?this._get_string("multiple_selection"):this.get_text(t),u=this.get_container();this._get_settings().core.html_titles||(o=o.replace(/</ig,"&lt;").replace(/>/ig,"&gt;")),e.vakata.dnd.drag_start(s,{jstree:!0,obj:t},"<ins class='jstree-icon'></ins>"+o),this.data.themes&&(r&&r.attr("class","jstree-"+this.data.themes.theme),i&&i.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),this.data.dnd.cof=u.offset(),this.data.dnd.cw=parseInt(u.width(),10),this.data.dnd.ch=parseInt(u.height(),10),this.data.dnd.active=!0}}}),e(function(){var t="#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }";e.vakata.css.add_sheet({str:t,title:"jstree"}),r=e("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(e){return r.hide(),i.hide(),e.preventDefault(),e.stopImmediatePropagation(),!1}).appendTo("body"),i=e("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(e){if(n&&n.length)return n.children("a").trigger(e),e.preventDefault(),e.stopImmediatePropagation(),!1}).bind("mouseleave",function(t){var s=e(t.relatedTarget);if(s.is(".jstree")||s.closest(".jstree").length===0)if(n&&n.length)return n.children("a").trigger(t),r.hide(),i.hide(),t.preventDefault(),t.stopImmediatePropagation(),!1}).appendTo("body"),e(document).bind("drag_start.vakata",function(e,t){t.data.jstree&&(r.show(),i&&i.show())}),e(document).bind("drag_stop.vakata",function(e,t){t.data.jstree&&(r.hide(),i&&i.hide())})})}(jQuery),function(e){e.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui,this.data.ui&&this.data.checkbox.noui&&(this.select_node=this.deselect_node=this.deselect_all=e.noop,this.get_selected=this.get_checked),this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",e.proxy(function(e,t){this._prepare_checkboxes(t.rslt.obj)},this)).bind("loaded.jstree",e.proxy(function(e){this._prepare_checkboxes()},this)).delegate(this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox","click.jstree",e.proxy(function(e){e.preventDefault(),this._get_node(e.target).hasClass("jstree-checked")?this.uncheck_node(e.target):this.check_node(e.target);if(!this.data.ui||!this.data.checkbox.noui)return e.stopImmediatePropagation(),!1;this.save_selected(),this.data.cookies&&this.save_cookie("select_node")},this))},defaults:{override_ui:!1,two_state:!1,real_checkboxes:!1,checked_parent_open:!0,real_checkboxes_names:function(e){return["check_"+(e[0].id||Math.ceil(Math.random()*1e4)),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},_fn:{_checkbox_notify:function(e,t){t.checked&&this.check_node(e,!1)},_prepare_checkboxes:function(t){t=!t||t==-1?this.get_container().find("> ul > li"):this._get_node(t);if(t===!1)return;var n,r=this,i,s=this._get_settings().checkbox.two_state,o=this._get_settings().checkbox.real_checkboxes,u=this._get_settings().checkbox.real_checkboxes_names;t.each(function(){i=e(this),n=i.is("li")&&(i.hasClass("jstree-checked")||o&&i.children(":checked").length)?"jstree-checked":"jstree-unchecked",i.find("li").addBack().each(function(){var t=e(this),i;t.children("a"+(r.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(s?"jstree-unchecked":n),o&&(t.children("[type=checkbox]").length?t.children("[type=checkbox]").addClass("jstree-real-checkbox"):(i=u.call(r,t),t.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+i[0]+"' name='"+i[0]+"' value='"+i[1]+"' />"))),s?(t.hasClass("jstree-checked")||t.children(":checked").length)&&t.addClass("jstree-checked").children("[type=checkbox]").prop("checked",!0):(n==="jstree-checked"||t.hasClass("jstree-checked")||t.children(":checked").length)&&t.find("li").addBack().addClass("jstree-checked").children("[type=checkbox]").prop("checked",!0)})}),s||t.find(".jstree-checked").parent().parent().each(function(){r._repair_state(this)})},change_state:function(t,n){t=this._get_node(t);var r=!1,i=this._get_settings().checkbox.real_checkboxes;if(!t||t===-1)return!1;n=n===!1||n===!0?n:t.hasClass("jstree-checked");if(this._get_settings().checkbox.two_state)n?(t.removeClass("jstree-checked").addClass("jstree-unchecked"),i&&t.children("[type=checkbox]").prop("checked",!1)):(t.removeClass("jstree-unchecked").addClass("jstree-checked"),i&&t.children("[type=checkbox]").prop("checked",!0));else{if(n){r=t.find("li").addBack();if(!r.filter(".jstree-checked, .jstree-undetermined").length)return!1;r.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"),i&&r.children("[type=checkbox]").prop("checked",!1)}else{r=t.find("li").addBack();if(!r.filter(".jstree-unchecked, .jstree-undetermined").length)return!1;r.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"),i&&r.children("[type=checkbox]").prop("checked",!0),this.data.ui&&(this.data.ui.last_selected=t),this.data.checkbox.last_selected=t}t.parentsUntil(".jstree","li").each(function(){var t=e(this);if(n){if(t.children("ul").children("li.jstree-checked, li.jstree-undetermined").length)return t.parentsUntil(".jstree","li").addBack().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),i&&t.parentsUntil(".jstree","li").addBack().children("[type=checkbox]").prop("checked",!1),!1;t.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"),i&&t.children("[type=checkbox]").prop("checked",!1)}else{if(t.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length)return t.parentsUntil(".jstree","li").addBack().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),i&&t.parentsUntil(".jstree","li").addBack().children("[type=checkbox]").prop("checked",!1),!1;t.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"),i&&t.children("[type=checkbox]").prop("checked",!0)}})}return this.data.ui&&this.data.checkbox.noui&&(this.data.ui.selected=this.get_checked()),this.__callback(t),!0},check_node:function(e){if(this.change_state(e,!1)){e=this._get_node(e);if(this._get_settings().checkbox.checked_parent_open){var t=this;e.parents(".jstree-closed").each(function(){t.open_node(this,!1,!0)})}this.__callback({obj:e})}},uncheck_node:function(e){this.change_state(e,!0)&&this.__callback({obj:this._get_node(e)})},check_all:function(){var e=this,t=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");t.each(function(){e.change_state(this,!1)}),this.__callback()},uncheck_all:function(){var e=this,t=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");t.each(function(){e.change_state(this,!0)}),this.__callback()},is_checked:function(e){return e=this._get_node(e),e.length?e.is(".jstree-checked"):!1},get_checked:function(e,t){return e=!e||e===-1?this.get_container():this._get_node(e),t||this._get_settings().checkbox.two_state?e.find(".jstree-checked"):e.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(e,t){return e=!e||e===-1?this.get_container():this._get_node(e),t||this._get_settings().checkbox.two_state?e.find(".jstree-unchecked"):e.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(e){e=this._get_node(e);if(!e.length)return;if(this._get_settings().checkbox.two_state){e.find("li").addBack().not(".jstree-checked").removeClass("jstree-undetermined").addClass("jstree-unchecked").children("[type=checkbox]").prop("checked",!0);return}var t=this._get_settings().checkbox.real_checkboxes,n=e.find("> ul > .jstree-checked").length,r=e.find("> ul > .jstree-undetermined").length,i=e.find("> ul > li").length;i===0?e.hasClass("jstree-undetermined")&&this.change_state(e,!1):n===0&&r===0?this.change_state(e,!0):n===i?this.change_state(e,!1):(e.parentsUntil(".jstree","li").addBack().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),t&&e.parentsUntil(".jstree","li").addBack().children("[type=checkbox]").prop("checked",!1))},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var t=this,n=this.data.ui.to_select;n=e.map(e.makeArray(n),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.deselect_all(),e.each(n,function(e,n){t.check_node(n)}),this.__callback()}else this.__call_old()},save_loaded:function(){var e=this;this.data.core.to_load=[],this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){this.id&&e.data.core.to_load.push("#"+this.id)})}}}),e(function(){var t=".jstree .jstree-real-checkbox { display:none; } ";e.vakata.css.add_sheet({str:t,title:"jstree"})})}(jQuery),function(e){e.vakata.xslt=function(t,n,r){var i="",s,o,u,a;return document.recalc?(s=document.createElement("xml"),o=document.createElement("xml"),s.innerHTML=t,o.innerHTML=n,e("body").append(s).append(o),setTimeout(function(t,n,r){return function(){r.call(null,t.transformNode(n.XMLDocument)),setTimeout(function(t,n){return function(){e(t).remove(),e(n).remove()}}(t,n),200)}}(s,o,r),100),!0):(typeof window.DOMParser!="undefined"&&typeof window.XMLHttpRequest!="undefined"&&typeof window.XSLTProcessor=="undefined"&&(t=(new DOMParser).parseFromString(t,"text/xml"),n=(new DOMParser).parseFromString(n,"text/xml")),typeof window.DOMParser!="undefined"&&typeof window.XMLHttpRequest!="undefined"&&typeof window.XSLTProcessor!="undefined"?(u=new XSLTProcessor,a=e.isFunction(u.transformDocument)?typeof window.XMLSerializer!="undefined":!0,a?(t=(new DOMParser).parseFromString(t,"text/xml"),n=(new DOMParser).parseFromString(n,"text/xml"),e.isFunction(u.transformDocument)?(i=document.implementation.createDocument("","",null),u.transformDocument(t,n,i,null),r.call(null,(new XMLSerializer).serializeToString(i)),!0):(u.importStylesheet(n),i=u.transformToFragment(t,document),r.call(null,e("<div />").append(i).html()),!0)):!1):!1)};var t={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">	<xsl:call-template name="nodes">		<xsl:with-param name="node" select="/root" />	</xsl:call-template></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<ul>	<xsl:for-each select="$node/item">		<xsl:variable name="children" select="count(./item) &gt; 0" />		<li>			<xsl:attribute name="class">				<xsl:if test="position() = last()">jstree-last </xsl:if>				<xsl:choose>					<xsl:when test="@state = \'open\'">jstree-open </xsl:when>					<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>					<xsl:otherwise>jstree-leaf </xsl:otherwise>				</xsl:choose>				<xsl:value-of select="@class" />			</xsl:attribute>			<xsl:for-each select="@*">				<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">					<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>				</xsl:if>			</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>			<xsl:for-each select="content/name">				<a>				<xsl:attribute name="href">					<xsl:choose>					<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>					<xsl:otherwise>#</xsl:otherwise>					</xsl:choose>				</xsl:attribute>				<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>				<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>				<xsl:for-each select="@*">					<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">						<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>					</xsl:if>				</xsl:for-each>					<ins>						<xsl:attribute name="class">jstree-icon 							<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>						</xsl:attribute>						<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>						<xsl:text>&#xa0;</xsl:text>					</ins>					<xsl:copy-of select="./child::node()" />				</a>			</xsl:for-each>			<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>		</li>	</xsl:for-each>	</ul></xsl:template></xsl:stylesheet>',flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">	<ul>	<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">		<xsl:call-template name="nodes">			<xsl:with-param name="node" select="." />			<xsl:with-param name="is_last" select="number(position() = last())" />		</xsl:call-template>	</xsl:for-each>	</ul></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<xsl:param name="is_last" />	<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />	<li>	<xsl:attribute name="class">		<xsl:if test="$is_last = true()">jstree-last </xsl:if>		<xsl:choose>			<xsl:when test="@state = \'open\'">jstree-open </xsl:when>			<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>			<xsl:otherwise>jstree-leaf </xsl:otherwise>		</xsl:choose>		<xsl:value-of select="@class" />	</xsl:attribute>	<xsl:for-each select="@*">		<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">		<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>		</xsl:if>	</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>	<xsl:for-each select="content/name">		<a>		<xsl:attribute name="href">			<xsl:choose>			<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>			<xsl:otherwise>#</xsl:otherwise>			</xsl:choose>		</xsl:attribute>		<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>		<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>		<xsl:for-each select="@*">			<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">				<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>			</xsl:if>		</xsl:for-each>			<ins>				<xsl:attribute name="class">jstree-icon 					<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>				</xsl:attribute>				<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>				<xsl:text>&#xa0;</xsl:text>			</ins>			<xsl:copy-of select="./child::node()" />		</a>	</xsl:for-each>	<xsl:if test="$children">		<ul>		<xsl:for-each select="//item[@parent_id=$node/attribute::id]">			<xsl:call-template name="nodes">				<xsl:with-param name="node" select="." />				<xsl:with-param name="is_last" select="number(position() = last())" />			</xsl:call-template>		</xsl:for-each>		</ul>	</xsl:if>	</li></xsl:template></xsl:stylesheet>'},n=function(e){return e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};e.jstree.plugin("xml_data",{defaults:{data:!1,ajax:!1,xsl:"flat",clean_node:!1,correct_state:!0,get_skip_empty:!1,get_include_preamble:!0},_fn:{load_node:function(e,t,n){var r=this;this.load_node_xml(e,function(){r.__callback({obj:r._get_node(e)}),t.call(this)},n)},_is_loaded:function(t){var n=this._get_settings().xml_data;return t=this._get_node(t),t==-1||!t||!n.ajax&&!e.isFunction(n.data)||t.is(".jstree-open, .jstree-leaf")||t.children("ul").children("li").length>0},load_node_xml:function(t,n,r){var i=this.get_settings().xml_data,s=function(){},o=function(){};t=this._get_node(t);if(t&&t!==-1){if(t.data("jstree_is_loading"))return;t.data("jstree_is_loading",!0)}switch(!0){case!i.data&&!i.ajax:throw"Neither data nor ajax settings supplied.";case e.isFunction(i.data):i.data.call(this,t,e.proxy(function(r){this.parse_xml(r,e.proxy(function(r){r&&(r=r.replace(/ ?xmlns="[^"]*"/ig,""),r.length>10?(r=e(r),t===-1||!t?this.get_container().children("ul").empty().append(r.children()):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(r),t.removeData("jstree_is_loading")),i.clean_node&&this.clean_node(t),n&&n.call(this)):t&&t!==-1?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),i.correct_state&&(this.correct_state(t),n&&n.call(this))):i.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this)))},this))},this));break;case!!i.data&&!i.ajax||!!i.data&&!!i.ajax&&(!t||t===-1):(!t||t==-1)&&this.parse_xml(i.data,e.proxy(function(r){r?(r=r.replace(/ ?xmlns="[^"]*"/ig,""),r.length>10&&(r=e(r),this.get_container().children("ul").empty().append(r.children()),i.clean_node&&this.clean_node(t),n&&n.call(this))):i.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this))},this));break;case!i.data&&!!i.ajax||!!i.data&&!!i.ajax&&t&&t!==-1:s=function(e,n,s){var o=this.get_settings().xml_data.ajax.error;o&&o.call(this,e,n,s),t!==-1&&t.length?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),n==="success"&&i.correct_state&&this.correct_state(t)):n==="success"&&i.correct_state&&this.get_container().children("ul").empty(),r&&r.call(this)},o=function(r,o,u){r=u.responseText;var a=this.get_settings().xml_data.ajax.success;a&&(r=a.call(this,r,o,u)||r);if(r===""||r&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")==="")return s.call(this,u,o,"");this.parse_xml(r,e.proxy(function(r){r&&(r=r.replace(/ ?xmlns="[^"]*"/ig,""),r.length>10?(r=e(r),t===-1||!t?this.get_container().children("ul").empty().append(r.children()):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(r),t.removeData("jstree_is_loading")),i.clean_node&&this.clean_node(t),n&&n.call(this)):t&&t!==-1?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),i.correct_state&&(this.correct_state(t),n&&n.call(this))):i.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this)))},this))},i.ajax.context=this,i.ajax.error=s,i.ajax.success=o,i.ajax.dataType||(i.ajax.dataType="xml"),e.isFunction(i.ajax.url)&&(i.ajax.url=i.ajax.url.call(this,t)),e.isFunction(i.ajax.data)&&(i.ajax.data=i.ajax.data.call(this,t)),e.ajax(i.ajax)}},parse_xml:function(n,r){var i=this._get_settings().xml_data;e.vakata.xslt(n,t[i.xsl],r)},get_xml:function(t,r,i,s,o){var u="",a=this._get_settings(),f=this,l,c,h,p,d;t||(t="flat"),o||(o=0),r=this._get_node(r);if(!r||r===-1)r=this.get_container().find("> ul > li");return i=e.isArray(i)?i:["id","class"],!o&&this.data.types&&e.inArray(a.types.type_attr,i)===-1&&i.push(a.types.type_attr),s=e.isArray(s)?s:[],o||(a.xml_data.get_include_preamble&&(u+='<?xml version="1.0" encoding="UTF-8"?>'),u+="<root>"),r.each(function(){u+="<item",h=e(this),e.each(i,function(e,t){var r=h.attr(t);if(!a.xml_data.get_skip_empty||typeof r!="undefined")u+=" "+t+'="'+n((" "+(r||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}),h.hasClass("jstree-open")&&(u+=' state="open"'),h.hasClass("jstree-closed")&&(u+=' state="closed"'),t==="flat"&&(u+=' parent_id="'+n(o)+'"'),u+=">",u+="<content>",p=h.children("a"),p.each(function(){l=e(this),d=!1,u+="<name",e.inArray("languages",a.plugins)!==-1&&e.each(a.languages,function(e,t){if(l.hasClass(t))return u+=' lang="'+n(t)+'"',d=t,!1}),s.length&&e.each(s,function(e,t){var r=l.attr(t);if(!a.xml_data.get_skip_empty||typeof r!="undefined")u+=" "+t+'="'+n((" "+r||"").replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}),l.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(u+=' icon="'+n(l.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'),l.children("ins").get(0).style.backgroundImage.length&&(u+=' icon="'+n(l.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"'),u+=">",u+="<![CDATA["+f.get_text(l,d)+"]]>",u+="</name>"}),u+="</content>",c=h[0].id||!0,h=h.find("> ul > li"),h.length?c=f.get_xml(t,h,i,s,c):c="",t=="nest"&&(u+=c),u+="</item>",t=="flat"&&(u+=c)}),o||(u+="</root>"),u}}})}(jQuery),function(e){e.expr[":"].jstree_contains=function(e,t,n){return(e.textContent||e.innerText||"").toLowerCase().indexOf(n[3].toLowerCase())>=0},e.expr[":"].jstree_title_contains=function(e,t,n){return(e.getAttribute("title")||"").toLowerCase().indexOf(n[3].toLowerCase())>=0},e.jstree.plugin("search",{__init:function(){this.data.search.str="",this.data.search.result=e(),this._get_settings().search.show_only_matches&&this.get_container().bind("search.jstree",function(t,n){e(this).children("ul").find("li").hide().removeClass("jstree-last"),n.rslt.nodes.parentsUntil(".jstree").addBack().show().filter("ul").each(function(){e(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",function(){e(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})},defaults:{ajax:!1,search_method:"jstree_contains",show_only_matches:!1},_fn:{search:function(t,n){if(e.trim(t)===""){this.clear_search();return}var r=this.get_settings().search,i=this,s=function(){},o=function(){};this.data.search.str=t;if(!n&&r.ajax!==!1&&this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length>0){this.search.supress_callback=!0,s=function(){},o=function(e,t,n){var r=this.get_settings().search.ajax.success;r&&(e=r.call(this,e,t,n)||e),this.data.search.to_open=e,this._search_open()},r.ajax.context=this,r.ajax.error=s,r.ajax.success=o,e.isFunction(r.ajax.url)&&(r.ajax.url=r.ajax.url.call(this,t)),e.isFunction(r.ajax.data)&&(r.ajax.data=r.ajax.data.call(this,t)),r.ajax.data||(r.ajax.data={search_string:t});if(!r.ajax.dataType||/^json/.exec(r.ajax.dataType))r.ajax.dataType="json";e.ajax(r.ajax);return}this.data.search.result.length&&this.clear_search(),this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+r.search_method+"("+this.data.search.str+")"),this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){i.open_node(this,!1,!0)}),this.__callback({nodes:this.data.search.result,str:t})},clear_search:function(t){this.data.search.result.removeClass("jstree-search"),this.__callback(this.data.search.result),this.data.search.result=e()},_search_open:function(t){var n=this,r=!0,i=[],s=[];this.data.search.to_open.length&&(e.each(this.data.search.to_open,function(t,n){if(n=="#")return!0;e(n).length&&e(n).is(".jstree-closed")?i.push(n):s.push(n)}),i.length&&(this.data.search.to_open=s,e.each(i,function(e,t){n.open_node(t,function(){n._search_open(!0)})}),r=!1)),r&&this.search(this.data.search.str,!0)}}})}(jQuery),function(e){e.vakata.context={hide_on_mouseleave:!1,cnt:e("<div id='vakata-contextmenu' />"),vis:!1,tgt:!1,par:!1,func:!1,data:!1,rtl:!1,show:function(t,n,r,i,s,o,u){e.vakata.context.rtl=!!u;var a=e.vakata.context.parse(t),f,l;if(!a)return;e.vakata.context.vis=!0,e.vakata.context.tgt=n,e.vakata.context.par=o||n||null,e.vakata.context.data=s||null,e.vakata.context.cnt.html(a).css({visibility:"hidden",display:"block",left:0,top:0}),e.vakata.context.hide_on_mouseleave&&e.vakata.context.cnt.one("mouseleave",function(t){e.vakata.context.hide()}),f=e.vakata.context.cnt.height(),l=e.vakata.context.cnt.width(),r+l>e(document).width()&&(r=e(document).width()-(l+5),e.vakata.context.cnt.find("li > ul").addClass("right")),i+f>e(document).height()&&(i-=f+n[0].offsetHeight,e.vakata.context.cnt.find("li > ul").addClass("bottom")),e.vakata.context.cnt.css({left:r,top:i}).find("li:has(ul)").bind("mouseenter",function(t){var n=e(document).width(),r=e(document).height(),i=e(this).children("ul").show();n!==e(document).width()&&i.toggleClass("right"),r!==e(document).height()&&i.toggleClass("bottom")}).bind("mouseleave",function(t){e(this).children("ul").hide()}).end().css({visibility:"visible"}).show(),e(document).triggerHandler("context_show.vakata")},hide:function(){e.vakata.context.vis=!1,e.vakata.context.cnt.attr("class","").css({visibility:"hidden"}),e(document).triggerHandler("context_hide.vakata")},parse:function(t,n){if(!t)return!1;var r="",i=!1,s=!0;return n||(e.vakata.context.func={}),r+="<ul>",e.each(t,function(t,n){if(!n)return!0;e.vakata.context.func[t]=n.action,!s&&n.separator_before&&(r+="<li class='vakata-separator vakata-separator-before'></li>"),s=!1,r+="<li class='"+(n._class||"")+(n._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ",n.icon&&n.icon.indexOf("/")===-1&&(r+=" class='"+n.icon+"' "),n.icon&&n.icon.indexOf("/")!==-1&&(r+=" style='background:url("+n.icon+") center center no-repeat;' "),r+=">&#160;</ins><a href='#' rel='"+t+"'>",n.submenu&&(r+="<span style='float:"+(e.vakata.context.rtl?"left":"right")+";'>&raquo;</span>"),r+=n.label+"</a>",n.submenu&&(i=e.vakata.context.parse(n.submenu,!0),i&&(r+=i)),r+="</li>",n.separator_after&&(r+="<li class='vakata-separator vakata-separator-after'></li>",s=!0)}),r=r.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,""),r+="</ul>",e(document).triggerHandler("context_parse.vakata"),r.length>10?r:!1},exec:function(t){return e.isFunction(e.vakata.context.func[t])?(e.vakata.context.func[t].call(e.vakata.context.data,e.vakata.context.par),!0):!1}},e(function(){var t="#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ";e.vakata.css.add_sheet({str:t,title:"vakata"}),e.vakata.context.cnt.delegate("a","click",function(e){e.preventDefault()}).delegate("a","mouseup",function(t){!e(this).parent().hasClass("jstree-contextmenu-disabled")&&e.vakata.context.exec(e(this).attr("rel"))?e.vakata.context.hide():e(this).blur()}).delegate("a","mouseover",function(){e.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body"),e(document).bind("mousedown",function(t){e.vakata.context.vis&&!e.contains(e.vakata.context.cnt[0],t.target)&&e.vakata.context.hide()}),typeof e.hotkeys!="undefined"&&e(document).bind("keydown","up",function(t){if(e.vakata.context.vis){var n=e.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();n.length||(n=e.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last()),n.addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault()}}).bind("keydown","down",function(t){if(e.vakata.context.vis){var n=e.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();n.length||(n=e.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first()),n.addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault()}}).bind("keydown","right",function(t){e.vakata.context.vis&&(e.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault())}).bind("keydown","left",function(t){e.vakata.context.vis&&(e.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault())}).bind("keydown","esc",function(t){e.vakata.context.hide(),t.preventDefault()}).bind("keydown","space",function(t){e.vakata.context.cnt.find(".vakata-hover").last().children("a").click(),t.preventDefault()})}),e.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",e.proxy(function(t){t.preventDefault(),e(t.currentTarget).hasClass("jstree-loading")||this.show_contextmenu(t.currentTarget,t.pageX,t.pageY)},this)).delegate("a","click.jstree",e.proxy(function(t){this.data.contextmenu&&e.vakata.context.hide()},this)).bind("destroy.jstree",e.proxy(function(){this.data.contextmenu&&e.vakata.context.hide()},this)),e(document).bind("context_hide.vakata",e.proxy(function(){this.data.contextmenu=!1},this))},defaults:{select_node:!1,show_at_node:!0,items:{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(e){this.create(e)}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(e){this.rename(e)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(e){this.is_selected(e)?this.remove():this.remove(e)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(e){this.cut(e)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(e){this.copy(e)}},paste:{separator_before:!1,icon:!1,separator_after:!1,label:"Paste",action:function(e){this.paste(e)}}}}}},_fn:{show_contextmenu:function(t,n,r){t=this._get_node(t);var i=this.get_settings().contextmenu,s=t.children("a:visible:eq(0)"),o=!1,u=!1;i.select_node&&this.data.ui&&!this.is_selected(t)&&(this.deselect_all(),this.select_node(t,!0));if(i.show_at_node||typeof n=="undefined"||typeof r=="undefined")o=s.offset(),n=o.left,r=o.top+this.data.core.li_height;u=t.data("jstree")&&t.data("jstree").contextmenu?t.data("jstree").contextmenu:i.items,e.isFunction(u)&&(u=u.call(this,t)),this.data.contextmenu=!0,e.vakata.context.show(u,s,n,r,this,t,this._get_settings().core.rtl),this.data.themes&&e.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}})}(jQuery),function(t){t.jstree.plugin("types",{__init:function(){var n=this._get_settings().types;this.data.types.attach_to=[],this.get_container().bind("init.jstree",t.proxy(function(){var e=n.types,r=n.type_attr,i="",o=this;t.each(e,function(e,n){t.each(n,function(e,t){/^(max_depth|max_children|icon|valid_children)$/.test(e)||o.data.types.attach_to.push(e)});if(!n.icon)return!0;if(n.icon.image||n.icon.position)e=="default"?i+=".jstree-"+o.get_index()+" a > .jstree-icon { ":i+=".jstree-"+o.get_index()+" li["+r+'="'+e+'"] > a > .jstree-icon { ',n.icon.image&&(i+=" background-image:url("+n.icon.image+"); "),n.icon.position?i+=" background-position:"+n.icon.position+"; ":i+=" background-position:0 0; ",i+="} "}),i!==""&&t.vakata.css.add_sheet({str:i,title:"jstree-types"})},this)).bind("before.jstree",t.proxy(function(e,n){var r,i,s=this._get_settings().types.use_data?this._get_node(n.args[0]):!1,o=s&&s!==-1&&s.length?s.data("jstree"):!1;if(o&&o.types&&o.types[n.func]===!1)return e.stopImmediatePropagation(),!1;if(t.inArray(n.func,this.data.types.attach_to)!==-1){if(!n.args[0]||!n.args[0].tagName&&!n.args[0].jquery)return;r=this._get_settings().types.types,i=this._get_type(n.args[0]);if((r[i]&&typeof r[i][n.func]!="undefined"||r["default"]&&typeof r["default"][n.func]!="undefined")&&this._check(n.func,n.args[0])===!1)return e.stopImmediatePropagation(),!1}},this)),e&&this.get_container().bind("load_node.jstree set_type.jstree",t.proxy(function(e,n){var r=n&&n.rslt&&n.rslt.obj&&n.rslt.obj!==-1?this._get_node(n.rslt.obj).parent():this.get_container_ul(),i=!1,s=this._get_settings().types;t.each(s.types,function(e,t){t.icon&&(t.icon.image||t.icon.position)&&(i=e==="default"?r.find("li > a > .jstree-icon"):r.find("li["+s.type_attr+"='"+e+"'] > a > .jstree-icon"),t.icon.image&&i.css("backgroundImage","url("+t.icon.image+")"),i.css("backgroundPosition",t.icon.position||"0 0"))})},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:!1,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(e,t){t.type&&this._get_settings().types.use_data&&this.set_type(t.type,e)},_get_type:function(e){return e=this._get_node(e),!e||!e.length?!1:e.attr(this._get_settings().types.type_attr)||"default"},set_type:function(e,t){t=this._get_node(t);var n=!t.length||!e?!1:t.attr(this._get_settings().types.type_attr,e);return n&&this.__callback({obj:t,type:e}),n},_check:function(e,n,r){n=this._get_node(n);var i=!1,s=this._get_type(n),o=0,u=this,a=this._get_settings().types,f=!1;if(n===-1){if(!a[e])return;i=a[e]}else{if(s===!1)return;f=a.use_data?n.data("jstree"):!1,f&&f.types&&typeof f.types[e]!="undefined"?i=f.types[e]:!a.types[s]||typeof a.types[s][e]=="undefined"?!!a.types["default"]&&typeof a.types["default"][e]!="undefined"&&(i=a.types["default"][e]):i=a.types[s][e]}return t.isFunction(i)&&(i=i.call(this,n)),e==="max_depth"&&n!==-1&&r!==!1&&a.max_depth!==-2&&i!==0&&n.children("a:eq(0)").parentsUntil(".jstree","li").each(function(t){if(a.max_depth!==-1&&a.max_depth-(t+1)<=0)return i=0,!1;o=t===0?i:u._check(e,this,!1);if(o!==-1&&o-(t+1)<=0)return i=0,!1;o>=0&&(o-(t+1)<i||i<0)&&(i=o-(t+1)),a.max_depth>=0&&(a.max_depth-(t+1)<i||i<0)&&(i=a.max_depth-(t+1))}),i},check_move:function(){if(!this.__call_old())return!1;var e=this._get_move(),n=e.rt._get_settings().types,r=e.rt._check("max_children",e.cr),i=e.rt._check("max_depth",e.cr),s=e.rt._check("valid_children",e.cr),o=0,u=1,a;if(s==="none")return!1;if(t.isArray(s)&&e.ot&&e.ot._get_type){e.o.each(function(){if(t.inArray(e.ot._get_type(this),s)===-1)return u=!1,!1});if(u===!1)return!1}if(n.max_children!==-2&&r!==-1){o=e.cr===-1?this.get_container().find("> ul > li").not(e.o).length:e.cr.find("> ul > li").not(e.o).length;if(o+e.o.length>r)return!1}if(n.max_depth!==-2&&i!==-1){u=0;if(i===0)return!1;if(typeof e.o.d=="undefined"){a=e.o;while(a.length>0)a=a.find("> ul > li"),u++;e.o.d=u}if(i-e.o.d<0)return!1}return!0},create_node:function(e,n,r,i,s,o){if(!o&&(s||this._is_loaded(e))){var u=typeof n=="string"&&n.match(/^before|after$/i)&&e!==-1?this._get_parent(e):this._get_node(e),a=this._get_settings().types,f=this._check("max_children",u),l=this._check("max_depth",u),c=this._check("valid_children",u),h;typeof r=="string"&&(r={data:r}),r||(r={});if(c==="none")return!1;if(t.isArray(c))if(!r.attr||!r.attr[a.type_attr])r.attr||(r.attr={}),r.attr[a.type_attr]=c[0];else if(t.inArray(r.attr[a.type_attr],c)===-1)return!1;if(a.max_children!==-2&&f!==-1){h=u===-1?this.get_container().find("> ul > li").length:u.find("> ul > li").length;if(h+1>f)return!1}if(a.max_depth!==-2&&l!==-1&&l-1<0)return!1}return this.__call_old(!0,e,n,r,i,s,o)}}})}(jQuery),function(e){e.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(!0),this.data.html_data.original_container_html.find("li").addBack().contents().filter(function(){return this.nodeType==3}).remove()},defaults:{data:!1,ajax:!1,correct_state:!0},_fn:{load_node:function(e,t,n){var r=this;this.load_node_html(e,function(){r.__callback({obj:r._get_node(e)}),t.call(this)},n)},_is_loaded:function(t){return t=this._get_node(t),t==-1||!t||!this._get_settings().html_data.ajax&&!e.isFunction(this._get_settings().html_data.data)||t.is(".jstree-open, .jstree-leaf")||t.children("ul").children("li").length>0},load_node_html:function(t,n,r){var i,s=this.get_settings().html_data,o=function(){},u=function(){};t=this._get_node(t);if(t&&t!==-1){if(t.data("jstree_is_loading"))return;t.data("jstree_is_loading",!0)}switch(!0){case e.isFunction(s.data):s.data.call(this,t,e.proxy(function(r){r&&r!==""&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")!==""?(r=e(r),r.is("ul")||(r=e("<ul />").append(r)),t==-1||!t?this.get_container().children("ul").empty().append(r.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(r).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),t.removeData("jstree_is_loading")),this.clean_node(t),n&&n.call(this)):t&&t!==-1?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),s.correct_state&&(this.correct_state(t),n&&n.call(this))):s.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this))},this));break;case!s.data&&!s.ajax:if(!t||t==-1)this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();n&&n.call(this);break;case!!s.data&&!s.ajax||!!s.data&&!!s.ajax&&(!t||t===-1):if(!t||t==-1)i=e(s.data),i.is("ul")||(i=e("<ul />").append(i)),this.get_container().children("ul").empty().append(i.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();n&&n.call(this);break;case!s.data&&!!s.ajax||!!s.data&&!!s.ajax&&t&&t!==-1:t=this._get_node(t),o=function(e,n,i){var o=this.get_settings().html_data.ajax.error;o&&o.call(this,e,n,i),t!=-1&&t.length?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),n==="success"&&s.correct_state&&this.correct_state(t)):n==="success"&&s.correct_state&&this.get_container().children("ul").empty(),r&&r.call(this)},u=function(r,i,u){var a=this.get_settings().html_data.ajax.success;a&&(r=a.call(this,r,i,u)||r);if(r===""||r&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")==="")return o.call(this,u,i,"");r?(r=e(r),r.is("ul")||(r=e("<ul />").append(r)),t==-1||!t?this.get_container().children("ul").empty().append(r.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(r).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),t.removeData("jstree_is_loading")),this.clean_node(t),n&&n.call(this)):t&&t!==-1?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),s.correct_state&&(this.correct_state(t),n&&n.call(this))):s.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this))},s.ajax.context=this,s.ajax.error=o,s.ajax.success=u,s.ajax.dataType||(s.ajax.dataType="html"),e.isFunction(s.ajax.url)&&(s.ajax.url=s.ajax.url.call(this,t)),e.isFunction(s.ajax.data)&&(s.ajax.data=s.ajax.data.call(this,t)),e.ajax(s.ajax)}}}}),e.jstree.defaults.plugins.push("html_data")}(jQuery),function(e){e.jstree.plugin("themeroller",{__init:function(){var t=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(n){e(n.currentTarget).hasClass("jstree-loading")||e(this).addClass(t.item_h)}).delegate("a","mouseleave.jstree",function(){e(this).removeClass(t.item_h)}).bind("init.jstree",e.proxy(function(e,t){t.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh"),this._themeroller(t.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",e.proxy(function(e){this._themeroller()},this)).bind("close_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.obj)},this)).bind("delete_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.parent)},this)).bind("correct_state.jstree",e.proxy(function(e,n){n.rslt.obj.children("ins.jstree-icon").removeClass(t.opened+" "+t.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(t.item_open+" "+t.item_clsd).addClass(t.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",e.proxy(function(e,n){n.rslt.obj.children("a").addClass(t.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",e.proxy(function(e,n){this.get_container().find("a."+t.item_a).removeClass(t.item_a).end().find("a.jstree-clicked").addClass(t.item_a)},this)).bind("dehover_node.jstree",e.proxy(function(e,n){n.rslt.obj.children("a").removeClass(t.item_h)},this)).bind("hover_node.jstree",e.proxy(function(e,n){this.get_container().find("a."+t.item_h).not(n.rslt.obj).removeClass(t.item_h),n.rslt.obj.children("a").addClass(t.item_h)},this)).bind("move_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.o),this._themeroller(t.rslt.op)},this))},__destroy:function(){var t=this._get_settings().themeroller,n=["ui-icon"];e.each(t,function(e,t){t=t.split(" "),t.length&&(n=n.concat(t))}),this.get_container().removeClass("ui-widget-content").find("."+n.join(", .")).removeClass(n.join(" "))},_fn:{_themeroller:function(e){var t=this._get_settings().themeroller;e=!e||e==-1?this.get_container_ul():this._get_node(e).parent(),e.find("li.jstree-closed").children("ins.jstree-icon").removeClass(t.opened).addClass("ui-icon "+t.closed).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(t.item_leaf+" "+t.item_open).addClass(t.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(t.closed).addClass("ui-icon "+t.opened).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(t.item_leaf+" "+t.item_clsd).addClass(t.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(t.closed+" ui-icon "+t.opened).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(t.item_clsd+" "+t.item_open).addClass(t.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}}),e(function(){var t=".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }";e.vakata.css.add_sheet({str:t,title:"jstree"})})}(jQuery),function(e){e.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",e.proxy(function(t,n){var r=[],i=!0,s,o;n.func=="move_node"&&n.args[4]===!0&&n.args[0].o&&n.args[0].o.length&&(n.args[0].o.children("a").each(function(){r.push(e(this).text().replace(/^\s+/g,""))}),i=this._check_unique(r,n.args[0].np.find("> ul > li").not(n.args[0].o),"move_node"));if(n.func=="create_node")if(n.args[4]||this._is_loaded(n.args[0])){s=this._get_node(n.args[0]);if(n.args[1]&&(n.args[1]==="before"||n.args[1]==="after")){s=this._get_parent(n.args[0]);if(!s||s===-1)s=this.get_container()}typeof n.args[2]=="string"?r.push(n.args[2]):!n.args[2]||!n.args[2].data?r.push(this._get_string("new_node")):r.push(n.args[2].data),i=this._check_unique(r,s.find("> ul > li"),"create_node")}if(n.func=="rename_node"){r.push(n.args[1]),o=this._get_node(n.args[0]),s=this._get_parent(o);if(!s||s===-1)s=this.get_container();i=this._check_unique(r,s.find("> ul > li").not(o),"rename_node")}if(!i)return t.stopPropagation(),!1},this))},defaults:{error_callback:e.noop},_fn:{_check_unique:function(t,n,r){var i=[];return n.children("a").each(function(){i.push(e(this).text().replace(/^\s+/g,""))}),!i.length||!t.length?!0:(i=i.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(","),i.length+t.length!=i.concat(t).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length?(this._get_settings().unique.error_callback.call(null,t,n,r),!1):!0)},check_move:function(){if(!this.__call_old())return!1;var t=this._get_move(),n=[];return t.o&&t.o.length?(t.o.children("a").each(function(){n.push(e(this).text().replace(/^\s+/g,""))}),this._check_unique(n,t.np.find("> ul > li").not(t.o),"check_move")):!0}}})}(jQuery),function(r){r.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui)throw"jsTree wholerow: jsTree UI plugin not included.";this.data.wholerow.html=!1,this.data.wholerow.to=!1,this.get_container().bind("init.jstree",r.proxy(function(e,t){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",r.proxy(function(e,t){this._prepare_wholerow_span(t&&t.rslt&&t.rslt.obj?t.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",r.proxy(function(e,t){this.data.to&&clearTimeout(this.data.to),this.data.to=setTimeout(function(e,t){return function(){e._prepare_wholerow_ul(t)}}(this,t&&t.rslt&&t.rslt.obj?t.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",r.proxy(function(e,t){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",r.proxy(function(e,t){t.rslt.obj.each(function(){var e=t.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((r(this).offset().top-t.inst.get_container().offset().top+t.inst.get_container()[0].scrollTop)/t.inst.data.core.li_height,10)+")");e.children("a").attr("class",t.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",r.proxy(function(e,t){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));if(e.type==="hover_node"){var n=this.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((t.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height,10)+")");n.children("a").attr("class",t.rslt.obj.children(".jstree-hovered").attr("class"))}},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(e){var t=r(e.currentTarget);if(e.target.tagName==="A"||e.target.tagName==="INS"&&t.closest("li").is(".jstree-open, .jstree-closed"))return;t.closest("li").children("a:visible:eq(0)").click(),e.stopImmediatePropagation()}).delegate("li","mouseover.jstree",r.proxy(function(e){return e.stopImmediatePropagation(),r(e.currentTarget).children(".jstree-hovered, .jstree-clicked").length?!1:(this.hover_node(e.currentTarget),!1)},this)).delegate("li","mouseleave.jstree",r.proxy(function(e){if(r(e.currentTarget).children("a").hasClass("jstree-hovered").length)return;this.dehover_node(e.currentTarget)},this)),(t||e)&&r.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove(),this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(e){e=!e||e==-1?this.get_container().find("> ul > li"):this._get_node(e);if(e===!1)return;e.each(function(){r(this).find("li").addBack().each(function(){var e=r(this);if(e.children(".jstree-wholerow-span").length)return!0;e.prepend("<span class='jstree-wholerow-span' style='width:"+e.parentsUntil(".jstree","li").length*18+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var e=this.get_container().children("ul").eq(0),n=e.html();e.addClass("jstree-wholerow-real"),this.data.wholerow.last_html!==n&&(this.data.wholerow.last_html=n,this.get_container().children(".jstree-wholerow").remove(),this.get_container().append(e.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(e.parent()[0].scrollWidth).css("top",(e.height()+(t?5:0))*-1).find("li[id]").each(function(){this.removeAttribute("id")}).end()))}}}),r(function(){var i=".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";n&&(i+=".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } ");if(t||e)i+=".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } ";r.vakata.css.add_sheet({str:i,title:"jstree"})})}(jQuery),function(e){var t=["getChildren","getChildrenCount","getAttr","getName","getProps"],n=function(t,n){var r=!0;return t=t||{},n=[].concat(n),e.each(n,function(n,i){if(!e.isFunction(t[i]))return r=!1,!1}),r};e.jstree.plugin("model",{__init:function(){if(!this.data.json_data)throw"jsTree model: jsTree json_data plugin not included.";this._get_settings().json_data.data=function(r,i){var s=r==-1?this._get_settings().model.object:r.data("jstree_model");if(!n(s,t))return i.call(null,!1);this._get_settings().model.async?s.getChildren(e.proxy(function(e){this.model_done(e,i)},this)):this.model_done(s.getChildren(),i)}},defaults:{object:!1,id_prefix:!1,async:!1},_fn:{model_done:function(t,n){var r=[],i=this._get_settings(),s=this;e.isArray(t)||(t=[t]),e.each(t,function(t,n){var o=n.getProps()||{};o.attr=n.getAttr()||{},n.getChildrenCount()&&(o.state="closed"),o.data=n.getName(),e.isArray(o.data)||(o.data=[o.data]),s.data.types&&e.isFunction(n.getType)&&(o.attr[i.types.type_attr]=n.getType()),o.attr.id&&i.model.id_prefix&&(o.attr.id=i.model.id_prefix+o.attr.id),o.metadata||(o.metadata={}),o.metadata.jstree_model=n,r.push(o)}),n.call(null,r)}}})}(jQuery)}(),define("thirdparty/jstree_pre1.0_fix_1/jquery.jstree",function(){}),define("preferences/PreferenceStorage",["require","exports","module","thirdparty/lodash","preferences/PreferencesManager","utils/DeprecationWarning"],function(e,t,n){function o(e,t){if(typeof e=="string"){var n={},r=null;n[e]=t;try{n=JSON.parse(JSON.stringify(n))}catch(i){r=i}return!r&&n[e]!==undefined?!0:(console.error("Value '"+t+"' for key '"+e+"' must be a valid JSON value"),!1)}return console.error("Preference key '"+e+"' must be a string"),!1}function u(){i.savePreferences()}function a(e,t){this._clientID=e,this._json=t}var r=e("thirdparty/lodash"),i=e("preferences/PreferencesManager"),s=e("utils/DeprecationWarning");a.prototype.getClientID=function(){return this._clientID},a.prototype.remove=function(e){s.deprecationWarning("remove is called to remove a preference '"+e+",' use PreferencesManager.set (with value of undefined) instead."),delete this._json[e],u()},a.prototype.setValue=function(e,t){s.deprecationWarning("setValue is called to set preference '"+e+",' use PreferencesManager.set instead."),o(e,t)&&(this._json[e]=t,u())},a.prototype.getValue=function(e){return s.deprecationWarning("getValue is called to get preference '"+e+",' use PreferencesManager.get instead."),this._json[e]},a.prototype.getAllValues=function(){return JSON.parse(JSON.stringify(this._json))},a.prototype.setAllValues=function(e,t){s.deprecationWarning("setAllValues is called to set preferences '"+Object.keys(e)+",' use PreferencesManager.set (probably with doNotSave flag) instead.");var n=this,i=null;r.some(e,function(e,t){try{o(t,e)}catch(n){return i=n,!0}});if(i){console.error(i);return}t||r.forEach(this._json,function(e,t){delete n._json[t]}),r.forEach(e,function(e,t){n._json[t]=e}),u()},a.prototype.convert=function(e,t,n,s){var o=this._json,a=this,f=!0,l=n?i.stateManager:i,c=new $.Deferred;return t||(t=[]),Object.keys(o).forEach(function(n){if(t.indexOf(n)>-1)return;var i=e[n];if(!i&&s)i=s(n);else if(s){var u=s(n,o[n]);u&&(i=r.cloneDeep(u))}if(!i)console.warn("Preferences conversion for ",a._clientID," has no rule for",n),f=!1;else if(r.isString(i)){var c=i.split(" ");if(c[0]==="user"){var h=c.length>1?c[1]:n,p=null;if(c.length>2&&c[2].indexOf("/")!==-1){var d=i.substr(i.indexOf(c[2]));p={location:{scope:"user",layer:"project",layerID:d}}}l.set(h,o[n],p),t.push(n)}}else r.isObject(i)?(Object.keys(i).forEach(function(e){l.set(e,i[e])}),t.push(n)):f=!1}),t.length>0?l.save().done(function(){u(),c.resolve(f,t)}).fail(function(e){c.reject(e)}):c.resolve(f,t),c.promise()},t.PreferenceStorage=a}),define("filesystem/WatchedRoot",["require","exports","module"],function(e,t,n){function r(e,t){this.entry=e,this.filter=t}r.INACTIVE=0,r.STARTING=1,r.ACTIVE=2,r.prototype.entry=null,r.prototype.filter=null,r.prototype.status=r.INACTIVE,n.exports=r}),define("filesystem/FileSystemEntry",["require","exports","module","filesystem/FileSystemError","filesystem/WatchedRoot"],function(e,t,n){function a(e,t){this._setPath(e),this._fileSystem=t,this._id=u++}var r=e("filesystem/FileSystemError"),i=e("filesystem/WatchedRoot"),s=100,o=3e4,u=0;Object.defineProperties(a.prototype,{fullPath:{get:function(){return this._path},set:function(){throw new Error("Cannot set fullPath")}},name:{get:function(){return this._name},set:function(){throw new Error("Cannot set name")}},parentPath:{get:function(){return this._parentPath},set:function(){throw new Error("Cannot set parentPath")}},id:{get:function(){return this._id},set:function(){throw new Error("Cannot set id")}},isFile:{get:function(){return this._isFile},set:function(){throw new Error("Cannot set isFile")}},isDirectory:{get:function(){return this._isDirectory},set:function(){throw new Error("Cannot set isDirectory")}},_impl:{get:function(){return this._fileSystem._impl},set:function(){throw new Error("Cannot set _impl")}}}),a.prototype._stat=null,a.prototype._fileSystem=null,a.prototype._path=null,a.prototype._name=null,a.prototype._parentPath=null,a.prototype._isFile=!1,a.prototype._isDirectory=!1,a.prototype._watchedRoot=null,a.prototype._watchedRootFilterResult=!1,a.prototype._isWatched=function(e){var t=this._watchedRoot,n=this._watchedRootFilterResult;t||(t=this._fileSystem._findWatchedRootForPath(this._path),t&&(this._watchedRoot=t,n=t.filter(this._name,this._parentPath),this._watchedRootFilterResult=n));if(t){if(t.status===i.ACTIVE||e&&t.status===i.STARTING)return n;this._watchedRoot=undefined,this._watchedRootFilterResult=!1,this._clearCachedData()}return!1},a.prototype._setPath=function(e){var t=e.split("/");this.isDirectory&&t.pop(),this._name=t[t.length-1],t.pop(),t.length>0?this._parentPath=t.join("/")+"/":this._parentPath=null,this._path=e;var n=this._watchedRoot;n&&(e.indexOf(n.entry.fullPath)===0?this._watchedRootFilterResult=n.filter(this._name,this._parentPath):(this._watchedRoot=null,this._watchedRootFilterResult=!1))},a.prototype._clearCachedData=function(){this._stat=undefined},a.prototype.toString=function(){return"["+(this.isDirectory?"Directory ":"File ")+this._path+"]"},a.prototype.exists=function(e){if(this._stat){e(null,!0);return}this._impl.exists(this._path,function(t,n){if(t){this._clearCachedData(),e(t);return}n||this._clearCachedData(),e(null,n)}.bind(this))},a.prototype.stat=function(e){if(this._stat){e(null,this._stat);return}this._impl.stat(this._path,function(t,n){if(t){this._clearCachedData(),e(t);return}this._isWatched()&&(this._stat=n),e(null,n)}.bind(this))},a.prototype.rename=function(e,t){t=t||function(){},this._fileSystem._beginChange(),this._impl.rename(this._path,e,function(n){var r=this._path;try{if(n){this._clearCachedData(),t(n);return}this._fileSystem._handleRename(this._path,e,this.isDirectory);try{t(null)}finally{this._fileSystem._fireRenameEvent(r,e)}}finally{this._fileSystem._endChange()}}.bind(this))},a.prototype.unlink=function(e){e=e||function(){},this._fileSystem._beginChange(),this._clearCachedData(),this._impl.unlink(this._path,function(t){var n=this._fileSystem.getDirectoryForPath(this.parentPath);this._fileSystem._handleDirectoryChange(n,function(r,i){try{e(t)}finally{this._fileSystem._fireChangeEvent(n,r,i),this._fileSystem._endChange()}}.bind(this))}.bind(this))},a.prototype.moveToTrash=function(e){if(!this._impl.moveToTrash){this.unlink(e);return}e=e||function(){},this._fileSystem._beginChange(),this._clearCachedData(),this._impl.moveToTrash(this._path,function(t){var n=this._fileSystem.getDirectoryForPath(this.parentPath);this._fileSystem._handleDirectoryChange(n,function(r,i){try{e(t)}finally{this._fileSystem._fireChangeEvent(n,r,i),this._fileSystem._endChange()}}.bind(this))}.bind(this))},a.prototype._visitHelper=function(e,t,n,r,i){var s=r.maxDepth,o=r.maxEntriesCounter;if(o.value--<=0||s--<0){i(null);return}if(this.isDirectory){var u=e.realPath||this.fullPath;if(t.hasOwnProperty(u)){i(null);return}t[u]=!0}if(!n(this)||this.isFile){i(null);return}this.getContents(function(e,r,u){function f(e){--a===0&&i(null)}if(e){i(e);return}var a=r.length;if(a===0){i(null);return}var l={maxDepth:s,maxEntriesCounter:o};r.forEach(function(e,r){var i=u[r];e._visitHelper(i,t,n,l,f)})}.bind(this))},a.prototype.visit=function(e,t,n){typeof t=="function"?(n=t,t={}):(t===undefined&&(t={}),n=n||function(){}),t.maxDepth===undefined&&(t.maxDepth=s),t.maxEntries===undefined&&(t.maxEntries=o),t.maxEntriesCounter={value:t.maxEntries},this.stat(function(i,s){if(i){n(i);return}this._visitHelper(s,{},e,t,function(e){if(n){if(e){n(e);return}if(t.maxEntriesCounter.value<0){n(r.TOO_MANY_ENTRIES);return}n(null)}}.bind(this))}.bind(this))},n.exports=a}),define("filesystem/Directory",["require","exports","module","filesystem/FileSystemEntry"],function(e,t,n){function i(e,t){this._isDirectory=!0,r.call(this,e,t)}function s(e,t){if(e.length>0){var n=e.pop();try{n.apply(undefined,t)}finally{s(e,t)}}}var r=e("filesystem/FileSystemEntry");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,i.prototype.parentClass=r.prototype,i.prototype._contents=null,i.prototype._contentsStats=null,i.prototype._contentsStatsErrors=null,i.prototype._clearCachedData=function(e){r.prototype._clearCachedData.apply(this);if(!e)if(this._contents)this._contents.forEach(function(e){e._clearCachedData(!0)});else{var t=this.fullPath;this._fileSystem._index.visitAll(function(e){e.parentPath===t&&e._clearCachedData(!0)})}this._contents=undefined,this._contentsStats=undefined,this._contentsStatsErrors=undefined},i.prototype.getContents=function(e){if(this._contentsCallbacks){this._contentsCallbacks.push(e);return}if(this._contents){e(null,this._contents,this._contentsStats,this._contentsStatsErrors);return}this._contentsCallbacks=[e],this._impl.readdir(this.fullPath,function(e,t,n){var r=[],i=[],o;if(e)this._clearCachedData();else{var u=this._isWatched(!0);t.forEach(function(e,t){var s=this.fullPath+e;if(this._fileSystem._indexFilter(s,e)){var a=n[t],f;typeof a=="string"?(o===undefined&&(o={}),o[s]=a):(a.isFile?f=this._fileSystem.getFileForPath(s):f=this._fileSystem.getDirectoryForPath(s),u&&(f._stat=a),r.push(f),i.push(a))}},this),u&&(this._contents=r,this._contentsStats=i,this._contentsStatsErrors=o)}var a=this._contentsCallbacks;this._contentsCallbacks=null;var f=[e,r,i,o];s(a,f)}.bind(this))},i.prototype.create=function(e){e=e||function(){},this._fileSystem._beginChange(),this._impl.mkdir(this._path,function(t,n){if(t){this._clearCachedData();try{e(t);return}finally{this._fileSystem._endChange()}}var r=this._fileSystem.getDirectoryForPath(this.parentPath);this._isWatched()&&(this._stat=n),this._fileSystem._handleDirectoryChange(r,function(t,i){try{e(null,n)}finally{this._fileSystem._fireChangeEvent(r,t,i),this._fileSystem._endChange()}}.bind(this))}.bind(this))},n.exports=i}),define("filesystem/File",["require","exports","module","filesystem/FileSystemEntry","filesystem/FileSystemError"],function(e,t,n){function s(e,t){this._isFile=!0,r.call(this,e,t)}var r=e("filesystem/FileSystemEntry"),i=e("filesystem/FileSystemError");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.parentClass=r.prototype,s.prototype._contents=null,s.prototype._hash=null,s.prototype._clearCachedData=function(){r.prototype._clearCachedData.apply(this),this._contents=null},s.prototype.read=function(e,t){typeof e=="function"&&(t=e,e={});if(this._contents!==null&&this._stat){t(null,this._contents,this._stat);return}var n=this._isWatched();n&&(e.stat=this._stat),this._impl.readFile(this._path,e,function(e,r,i){if(e){this._clearCachedData(),t(e);return}this._hash=i._hash,n&&(this._stat=i,this._contents=r),t(e,r,i)}.bind(this))},s.prototype.write=function(e,t,n){typeof t=="function"?(n=t,t={}):(t===undefined&&(t={}),n=n||function(){}),t.blind||(t.expectedHash=this._hash,t.expectedContents=this._contents),this._fileSystem._beginChange(),this._impl.writeFile(this._path,e,t,function(t,r,i){if(t){this._clearCachedData();try{n(t);return}finally{this._fileSystem._endChange()}}this._hash=r._hash,this._isWatched()&&(this._stat=r,this._contents=e);if(i){var s=this._fileSystem.getDirectoryForPath(this.parentPath);this._fileSystem._handleDirectoryChange(s,function(e,t){try{n(null,r)}finally{this._fileSystem._fireChangeEvent(s,e,t),this._fileSystem._endChange()}}.bind(this))}else try{n(null,r)}finally{this._fileSystem._fireChangeEvent(this),this._fileSystem._endChange()}}.bind(this))},n.exports=s}),define("filesystem/FileIndex",["require","exports","module"],function(e,t,n){function r(){this._index={}}r.prototype._index=null,r.prototype.clear=function(){this._index={}},r.prototype.visitAll=function(e){var t;for(t in this._index)this._index.hasOwnProperty(t)&&e(this._index[t],t)},r.prototype.addEntry=function(e){this._index[e.fullPath]=e},r.prototype.removeEntry=function(e){function i(n){var r=e[n];typeof r=="function"&&(e[n]=function(){return console.warn("FileSystemEntry used after being removed from index: ",t),r.apply(e,arguments)})}var t=e.fullPath,n,r;delete this._index[t];for(n in e)e.hasOwnProperty(n)&&i(n)},r.prototype.entryRenamed=function(e,t,n){var r,i=e.split("/"),s=i.length-1,o={};for(r in this._index)this._index.hasOwnProperty(r)&&(n?r.indexOf(e)===0:r===e)&&(o[r]=t+r.substr(e.length));for(r in o)if(o.hasOwnProperty(r)){var u=this._index[r];console.assert(u.fullPath===r),delete this._index[r],this._index[o[r]]=u,u._setPath(o[r])}},r.prototype.getEntry=function(e){return this._index[e]},n.exports=r}),define("filesystem/FileSystemStats",["require","exports","module"],function(e,t,n){function r(e){var t=e.isFile;this._isFile=t,this._isDirectory=!t,this._mtime=e.mtime,this._size=e.size,this._hash=e.hash;var n=e.realPath;n&&(!t&&n[n.length-1]!=="/"&&(n+="/"),this._realPath=n)}Object.defineProperties(r.prototype,{isFile:{get:function(){return this._isFile},set:function(){throw new Error("Cannot set isFile")}},isDirectory:{get:function(){return this._isDirectory},set:function(){throw new Error("Cannot set isDirectory")}},mtime:{get:function(){return this._mtime},set:function(){throw new Error("Cannot set mtime")}},size:{get:function(){return this._size},set:function(){throw new Error("Cannot set size")}},realPath:{get:function(){return this._realPath},set:function(){throw new Error("Cannot set realPath")}}}),r.prototype._isFile=!1,r.prototype._isDirectory=!1,r.prototype._mtime=null,r.prototype._size=null,r.prototype._hash=null,r.prototype._realPath=null,n.exports=r}),!function(e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define("socket.io",e):"undefined"!=typeof window?window.io=e():"undefined"!=typeof global?global.io=e():"undefined"!=typeof self&&(self.io=e())}(function(){var e,t,n;return function r(e,t,n){function i(o,u){if(!t[o]){if(!e[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=t[o]={exports:{}};e[o][0].call(f.exports,function(t){var n=e[o][1][t];return i(n?n:t)},f,f.exports,r,e,t,n)}return t[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":2}],2:[function(e,t,n){function a(e,t){typeof e=="object"&&(t=e,e=undefined),t=t||{};var n=r(e),i=n.source,a=n.id,f;return t.forceNew||t["force new connection"]||!1===t.multiplex?(o("ignoring socket cache for %s",i),f=s(i,t)):(u[a]||(o("new io instance for %s",i),u[a]=s(i,t)),f=u[a]),f.socket(n.path)}var r=e("./url"),i=e("socket.io-parser"),s=e("./manager"),o=e("debug")("socket.io-client");t.exports=n=a;var u=n.managers={};n.protocol=i.protocol,n.connect=a,n.Manager=e("./manager"),n.Socket=e("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:9,"socket.io-parser":40}],3:[function(e,t,n){function h(e,t){if(!(this instanceof h))return new h(e,t);e&&"object"==typeof e&&(t=e,e=undefined),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||Infinity),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connected=0,this.attempts=0,this.encoding=!1,this.packetBuffer=[],this.encoder=new u.Encoder,this.decoder=new u.Decoder,this.open()}var r=e("./url"),i=e("engine.io-client"),s=e("./socket"),o=e("component-emitter"),u=e("socket.io-parser"),a=e("./on"),f=e("component-bind"),l=e("object-component"),c=e("debug")("socket.io-client:manager");t.exports=h,h.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)this.nsps[e].emit.apply(this.nsps[e],arguments)},o(h.prototype),h.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},h.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},h.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this):this._reconnectionDelay},h.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this):this._reconnectionDelayMax},h.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},h.prototype.maybeReconnectOnOpen=function(){!this.openReconnect&&!this.reconnecting&&this._reconnection&&(this.openReconnect=!0,this.reconnect())},h.prototype.open=h.prototype.connect=function(e){c("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=i(this.uri,this.opts);var t=this.engine,n=this;this.readyState="opening";var r=a(t,"open",function(){n.onopen(),e&&e()}),s=a(t,"error",function(t){c("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t);if(e){var r=new Error("Connection error");r.data=t,e(r)}n.maybeReconnectOnOpen()});if(!1!==this._timeout){var o=this._timeout;c("connect attempt will timeout after %d",o);var u=setTimeout(function(){c("connect attempt timed out after %d",o),r.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",o)},o);this.subs.push({destroy:function(){clearTimeout(u)}})}return this.subs.push(r),this.subs.push(s),this},h.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(a(e,"data",f(this,"ondata"))),this.subs.push(a(this.decoder,"decoded",f(this,"ondecoded"))),this.subs.push(a(e,"error",f(this,"onerror"))),this.subs.push(a(e,"close",f(this,"onclose")))},h.prototype.ondata=function(e){this.decoder.add(e)},h.prototype.ondecoded=function(e){this.emit("packet",e)},h.prototype.onerror=function(e){c("error",e),this.emitAll("error",e)},h.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new s(this,e),this.nsps[e]=t;var n=this;t.on("connect",function(){n.connected++})}return t},h.prototype.destroy=function(e){--this.connected||this.close()},h.prototype.packet=function(e){c("writing packet %j",e);var t=this;t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(e){for(var n=0;n<e.length;n++)t.engine.write(e[n]);t.encoding=!1,t.processPacketQueue()}))},h.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},h.prototype.cleanup=function(){var e;while(e=this.subs.shift())e.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},h.prototype.close=h.prototype.disconnect=function(){this.skipReconnect=!0,this.engine.close()},h.prototype.onclose=function(e){c("close"),this.cleanup(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},h.prototype.reconnect=function(){if(this.reconnecting)return this;var e=this;this.attempts++;if(this.attempts>this._reconnectionAttempts)c("reconnect failed"),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.attempts*this.reconnectionDelay();t=Math.min(t,this.reconnectionDelayMax()),c("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){c("attempting reconnect"),e.emitAll("reconnect_attempt",e.attempts),e.emitAll("reconnecting",e.attempts),e.open(function(t){t?(c("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(c("reconnect success"),e.onreconnect())})},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},h.prototype.onreconnect=function(){var e=this.attempts;this.attempts=0,this.reconnecting=!1,this.emitAll("reconnect",e)}},{"./on":4,"./socket":5,"./url":6,"component-bind":7,"component-emitter":8,debug:9,"engine.io-client":11,"object-component":37,"socket.io-parser":40}],4:[function(e,t,n){function r(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}t.exports=r},{}],5:[function(e,t,n){function p(e,t){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.subEvents()}var r=e("socket.io-parser"),i=e("component-emitter"),s=e("to-array"),o=e("./on"),u=e("component-bind"),a=e("debug")("socket.io-client:socket"),f=e("has-binary-data"),l=e("indexof");t.exports=n=p;var c={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},h=i.prototype.emit;i(p.prototype),p.prototype.subEvents=function(){var e=this.io;this.subs=[o(e,"open",u(this,"onopen")),o(e,"packet",u(this,"onpacket")),o(e,"close",u(this,"onclose"))]},p.prototype.open=p.prototype.connect=function(){return this.connected?this:(this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},p.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},p.prototype.emit=function(e){if(c.hasOwnProperty(e))return h.apply(this,arguments),this;var t=s(arguments),n=r.EVENT;f(t)&&(n=r.BINARY_EVENT);var i={type:n,data:t};return"function"==typeof t[t.length-1]&&(a("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),this},p.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},p.prototype.onopen=function(){a("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:r.CONNECT})},p.prototype.onclose=function(e){a("close (%s)",e),this.connected=!1,this.disconnected=!0,this.emit("disconnect",e)},p.prototype.onpacket=function(e){if(e.nsp!=this.nsp)return;switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:this.onevent(e);break;case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:this.onack(e);break;case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},p.prototype.onevent=function(e){var t=e.data||[];a("emitting event %j",t),null!=e.id&&(a("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?h.apply(this,t):this.receiveBuffer.push(t)},p.prototype.ack=function(e){var t=this,n=!1;return function(){if(n)return;n=!0;var i=s(arguments);a("sending ack %j",i);var o=f(i)?r.BINARY_ACK:r.ACK;t.packet({type:o,id:e,data:i})}},p.prototype.onack=function(e){a("calling ack %s with %j",e.id,e.data);var t=this.acks[e.id];t.apply(this,e.data),delete this.acks[e.id]},p.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},p.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)h.apply(this,this.receiveBuffer[e]);this.receiveBuffer=[];for(e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},p.prototype.ondisconnect=function(){a("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},p.prototype.destroy=function(){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.io.destroy(this)},p.prototype.close=p.prototype.disconnect=function(){return this.connected?(a("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT}),this.destroy(),this.onclose("io client disconnect"),this):this}},{"./on":4,"component-bind":7,"component-emitter":8,debug:9,"has-binary-data":32,indexof:36,"socket.io-parser":40,"to-array":43}],6:[function(e,t,n){function o(e,t){var n=e,t=t||r.location;return null==e&&(e=t.protocol+"//"+t.hostname),"string"==typeof e&&("/"==e.charAt(0)&&"undefined"!=typeof t&&(e=t.hostname+e),/^(https?|wss?):\/\//.test(e)||(s("protocol-less url %s",e),"undefined"!=typeof t?e=t.protocol+"//"+e:e="https://"+e),s("parse %s",e),n=i(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/",n.id=n.protocol+"://"+n.host+":"+n.port,n.href=n.protocol+"://"+n.host+(t&&t.port==n.port?"":":"+n.port),n}var r=typeof self!="undefined"?self:typeof window!="undefined"?window:{},i=e("parseuri"),s=e("debug")("socket.io-client:url");t.exports=o},{debug:9,parseuri:38}],7:[function(e,t,n){var r=[].slice;t.exports=function(e,t){"string"==typeof t&&(t=e[t]);if("function"!=typeof t)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}},{}],8:[function(e,t,n){function r(e){if(e)return i(e)}function i(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},r.prototype.once=function(e,t){function r(){n.off(e,r),t.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},r.fn=t,this.on(e,r),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;var r;for(var i=0;i<n.length;i++){r=n[i];if(r===t||r.fn===t){n.splice(i,1);break}}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],9:[function(e,t,n){function r(e){return r.enabled(e)?function(t){t=i(t);var n=new Date,s=n-(r[e]||n);r[e]=n,t=e+" "+t+" +"+r.humanize(s),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function i(e){return e instanceof Error?e.stack||e.message:e}t.exports=r,r.names=[],r.skips=[],r.enable=function(e){try{localStorage.debug=e}catch(t){}var n=(e||"").split(/[\s,]+/),i=n.length;for(var s=0;s<i;s++)e=n[s].replace("*",".*?"),e[0]==="-"?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$"))},r.disable=function(){r.enable("")},r.humanize=function(e){var t=1e3,n=6e4,r=60*n;return e>=r?(e/r).toFixed(1)+"h":e>=n?(e/n).toFixed(1)+"m":e>=t?(e/t|0)+"s":e+"ms"},r.enabled=function(e){for(var t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(var t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1};try{window.localStorage&&r.enable(localStorage.debug)}catch(s){}},{}],10:[function(e,t,n){function i(e){if(e)return s(e)}function s(e){for(var t in i.prototype)e[t]=i.prototype[t];return e}var r=e("indexof");t.exports=i,i.prototype.on=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},i.prototype.once=function(e,t){function r(){n.off(e,r),t.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},t._off=r,this.on(e,r),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=function(e,t){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;var i=r(n,t._off||t);return~i&&n.splice(i,1),this},i.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},i.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},i.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{indexof:36}],11:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":12}],12:[function(e,t,n){t.exports=e("./socket"),t.exports.parser=e("engine.io-parser")},{"./socket":13,"engine.io-parser":22}],13:[function(e,t,n){function h(){}function p(e,t){if(!(this instanceof p))return new p(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e&&(e=f(e),t.host=e.host,t.secure=e.protocol=="https"||e.protocol=="wss",t.port=e.port,e.query&&(t.query=e.query)),this.secure=null!=t.secure?t.secure:r.location&&"https:"==location.protocol;if(t.host){var n=t.host.split(":");t.hostname=n.shift(),n.length&&(t.port=n.pop())}this.agent=t.agent||!1,this.hostname=t.hostname||(r.location?location.hostname:"localhost"),this.port=t.port||(r.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.forceBase64=!!t.forceBase64,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.open(),this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades}function d(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var r=typeof self!="undefined"?self:typeof window!="undefined"?window:{},i=e("./transports"),s=e("component-emitter"),o=e("debug")("engine.io-client:socket"),u=e("indexof"),a=e("engine.io-parser"),f=e("parseuri"),l=e("parsejson"),c=e("parseqs");t.exports=p,p.priorWebsocketSuccess=!1,s(p.prototype),p.protocol=a.protocol,p.Socket=p,p.Transport=e("./transport"),p.transports=e("./transports"),p.parser=e("engine.io-parser"),p.prototype.createTransport=function(e){o('creating transport "%s"',e);var t=d(this.query);t.EIO=a.protocol,t.transport=e,this.id&&(t.sid=this.id);var n=new i[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,forceBase64:this.forceBase64,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this});return n},p.prototype.open=function(){var e;this.rememberUpgrade&&p.priorWebsocketSuccess&&this.transports.indexOf("websocket")!=-1?e="websocket":e=this.transports[0],this.readyState="opening";var e=this.createTransport(e);e.open(),this.setTransport(e)},p.prototype.setTransport=function(e){o("setting transport %s",e.name);var t=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},p.prototype.probe=function(e){function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}if(n)return;o('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(i){if(n)return;if("pong"==i.type&&"probe"==i.data)o('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),p.priorWebsocketSuccess="websocket"==t.name,o('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){if(n)return;if("closed"==r.readyState||"closing"==r.readyState)return;o("changing transport and sending upgrade packet"),c(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush()});else{o('probe transport "%s" failed',e);var s=new Error("probe error");s.transport=t.name,r.emit("upgradeError",s)}})}function s(){if(n)return;n=!0,c(),t.close(),t=null}function u(n){var i=new Error("probe error: "+n);i.transport=t.name,s(),o('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",i)}function a(){u("transport closed")}function f(){u("socket closed")}function l(e){t&&e.name!=t.name&&(o('"%s" works - aborting "%s"',e.name,t.name),s())}function c(){t.removeListener("open",i),t.removeListener("error",u),t.removeListener("close",a),r.removeListener("close",f),r.removeListener("upgrading",l)}o('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;p.priorWebsocketSuccess=!1,t.once("open",i),t.once("error",u),t.once("close",a),this.once("close",f),this.once("upgrading",l),t.open()},p.prototype.onOpen=function(){o("socket open"),this.readyState="open",p.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},p.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState){o('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat");switch(e.type){case"open":this.onHandshake(l(e.data));break;case"pong":this.setPing();break;case"error":var t=new Error("server error");t.code=e.data,this.emit("error",t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}}else o('packet received with socket readyState "%s"',this.readyState)},p.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen();if("closed"==this.readyState)return;this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat)},p.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){if("closed"==t.readyState)return;t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},p.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){o("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},p.prototype.ping=function(){this.sendPacket("ping")},p.prototype.onDrain=function(){for(var e=0;e<this.prevBufferLen;e++)this.callbackBuffer[e]&&this.callbackBuffer[e]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length==0?this.emit("drain"):this.flush()},p.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},p.prototype.write=p.prototype.send=function(e,t){return this.sendPacket("message",e,t),this},p.prototype.sendPacket=function(e,t,n){var r={type:e,data:t};this.emit("packetCreate",r),this.writeBuffer.push(r),this.callbackBuffer.push(n),this.flush()},p.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.onClose("forced close"),o("socket closing - telling transport to close"),this.transport.close();return this},p.prototype.onError=function(e){o("socket error %j",e),p.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},p.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState){o('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){n.writeBuffer=[],n.callbackBuffer=[],n.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t)}},p.prototype.filterUpgrades=function(e){var t=[];for(var n=0,r=e.length;n<r;n++)~u(this.transports,e[n])&&t.push(e[n]);return t}},{"./transport":14,"./transports":15,"component-emitter":8,debug:9,"engine.io-parser":22,indexof:36,parsejson:29,parseqs:30,parseuri:38}],14:[function(e,t,n){function s(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket}var r=e("engine.io-parser"),i=e("component-emitter");t.exports=s,i(s.prototype),s.timestamps=0,s.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},s.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this},s.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),this.onClose();return this},s.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},s.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},s.prototype.onData=function(e){try{var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)}catch(n){n.data=e,this.onError("parser decode error",n)}},s.prototype.onPacket=function(e){this.emit("packet",e)},s.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":8,"engine.io-parser":22}],15:[function(e,t,n){function a(e){var t,n=!1;if(r.location){var u="https:"==location.protocol,a=location.port;a||(a=u?443:80),n=e.hostname!=location.hostname||a!=e.port}return e.xdomain=n,t=new i(e),"open"in t&&!e.forceJSONP?new s(e):new o(e)}var r=typeof self!="undefined"?self:typeof window!="undefined"?window:{},i=e("xmlhttprequest"),s=e("./polling-xhr"),o=e("./polling-jsonp"),u=e("./websocket");n.polling=a,n.websocket=u},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(e,t,n){function l(){}function c(e){i.call(this,e),this.query=this.query||{},a||(r.___eio||(r.___eio=[]),a=r.___eio),this.index=a.length;var t=this;a.push(function(e){t.onData(e)}),this.query.j=this.index,r.document&&r.addEventListener&&r.addEventListener("beforeunload",function(){t.script&&(t.script.onerror=l)})}var r=typeof self!="undefined"?self:typeof window!="undefined"?window:{},i=e("./polling"),s=e("component-inherit");t.exports=c;var o=/\n/g,u=/\\n/g,a,f=0;s(c,i),c.prototype.supportsBinary=!1,c.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null),i.prototype.doClose.call(this)},c.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),this.script=t;var r="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);r&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},c.prototype.doWrite=function(e,t){function f(){l(),t()}function l(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var t='<iframe src="javascript:0" name="'+n.iframeId+'">';a=document.createElement(t)}catch(e){a=document.createElement("iframe"),a.name=n.iframeId,a.src="javascript:0"}a.id=n.iframeId,n.form.appendChild(a),n.iframe=a}var n=this;if(!this.form){var r=document.createElement("form"),i=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index,a;r.className="socketio",r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",r.target=s,r.method="POST",r.setAttribute("accept-charset","utf-8"),i.name="d",r.appendChild(i),document.body.appendChild(r),this.form=r,this.area=i}this.form.action=this.uri(),l(),e=e.replace(u,"\\\n"),this.area.value=e.replace(o,"\\n");try{this.form.submit()}catch(c){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){n.iframe.readyState=="complete"&&f()}:this.iframe.onload=f}},{"./polling":18,"component-inherit":21}],17:[function(e,t,n){function f(){}function l(e){s.call(this,e);if(r.location){var t="https:"==location.protocol,n=location.port;n||(n=t?443:80),this.xd=e.hostname!=r.location.hostname||n!=e.port}}function c(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.async=!1!==e.async,this.data=undefined!=e.data?e.data:null,this.agent=e.agent,this.create(e.isBinary,e.supportsBinary)}function h(){for(var e in c.requests)c.requests.hasOwnProperty(e)&&c.requests[e].abort()}var r=typeof self!="undefined"?self:typeof window!="undefined"?window:{},i=e("xmlhttprequest"),s=e("./polling"),o=e("component-emitter"),u=e("component-inherit"),a=e("debug")("engine.io-client:polling-xhr");t.exports=l,t.exports.Request=c,u(l,s),l.prototype.supportsBinary=!0,l.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,new c(e)},l.prototype.doWrite=function(e,t){var n=typeof e!="string"&&e!==undefined,r=this.request({method:"POST",data:e,isBinary:n}),i=this;r.on("success",t),r.on("error",function(e){i.onError("xhr post error",e)}),this.sendXhr=r},l.prototype.doPoll=function(){a("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},o(c.prototype),c.prototype.create=function(e,t){var n=this.xhr=new i({agent:this.agent,xdomain:this.xd}),s=this;try{a("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,this.async),t&&(n.responseType="arraybuffer");if("POST"==this.method)try{e?n.setRequestHeader("Content-type","application/octet-stream"):n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(o){}"withCredentials"in n&&(n.withCredentials=!0),n.onreadystatechange=function(){var e;try{if(4!=n.readyState)return;if(200==n.status||1223==n.status){var r=n.getResponseHeader("Content-Type");r==="application/octet-stream"?e=n.response:t?e="ok":e=n.responseText}else setTimeout(function(){s.onError(n.status)},0)}catch(i){s.onError(i)}null!=e&&s.onData(e)},a("xhr data %s",this.data),n.send(this.data)}catch(o){setTimeout(function(){s.onError(o)},0);return}r.document&&(this.index=c.requestsCount++,c.requests[this.index]=this)},c.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},c.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},c.prototype.onError=function(e){this.emit("error",e),this.cleanup()},c.prototype.cleanup=function(){if("undefined"==typeof this.xhr||null===this.xhr)return;this.xhr.onreadystatechange=f;try{this.xhr.abort()}catch(e){}r.document&&delete c.requests[this.index],this.xhr=null},c.prototype.abort=function(){this.cleanup()},r.document&&(c.requestsCount=0,c.requests={},r.attachEvent?r.attachEvent("onunload",h):r.addEventListener&&r.addEventListener("beforeunload",h))},{"./polling":18,"component-emitter":8,"component-inherit":21,debug:9,xmlhttprequest:20}],18:[function(e,t,n){function f(e){var t=e&&e.forceBase64;if(!a||t)this.supportsBinary=!1;r.call(this,e)}var r=e("../transport"),i=e("parseqs"),s=e("engine.io-parser"),o=e("component-inherit"),u=e("debug")("engine.io-client:polling");t.exports=f;var a=function(){var t=e("xmlhttprequest"),n=new t({agent:this.agent,xdomain:!1});return null!=n.responseType}();o(f,r),f.prototype.name="polling",f.prototype.doOpen=function(){this.poll()},f.prototype.pause=function(e){function r(){u("paused"),n.readyState="paused",e()}var t=0,n=this;this.readyState="pausing";if(this.polling||!this.writable){var i=0;this.polling&&(u("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){u("pre-pause polling complete"),--i||r()})),this.writable||(u("we are currently writing - waiting to pause"),i++,this.once("drain",function(){u("pre-pause writing complete"),--i||r()}))}else r()},f.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},f.prototype.onData=function(e){var t=this;u("polling got data %s",e);var n=function(e,n,r){"opening"==t.readyState&&t.onOpen();if("close"==e.type)return t.onClose(),!1;t.onPacket(e)};s.decodePayload(e,this.socket.binaryType,n),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},f.prototype.doClose=function(){function t(){u("writing close packet"),e.write([{type:"close"}])}var e=this;"open"==this.readyState?(u("transport open - closing"),t()):(u("transport not open - deferring close"),this.once("open",t))},f.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")},t=this;s.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},f.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=+(new Date)+"-"+r.timestamps++),!this.supportsBinary&&!e.sid&&(e.b64=1),e=i.encode(e),this.port&&("https"==t&&this.port!=443||"http"==t&&this.port!=80)&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e}},{"../transport":14,"component-inherit":21,debug:9,"engine.io-parser":22,parseqs:30,xmlhttprequest:20}],19:[function(e,t,n){function f(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),r.call(this,e)}var r=e("../transport"),i=e("engine.io-parser"),s=e("parseqs"),o=e("component-inherit"),u=e("debug")("engine.io-client:websocket"),a=e("ws");t.exports=f,o(f,r),f.prototype.name="websocket",f.prototype.supportsBinary=!0,f.prototype.doOpen=function(){if(!this.check())return;var e=this,t=this.uri(),n=void 0,r={agent:this.agent};this.ws=new a(t,n,r),this.ws.binaryType===undefined&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()},f.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(f.prototype.onData=function(e){var t=this;setTimeout(function(){r.prototype.onData.call(t,e)},0)}),f.prototype.write=function(e){function s(){t.writable=!0,t.emit("drain")}var t=this;this.writable=!1;for(var n=0,r=e.length;n<r;n++)i.encodePacket(e[n],this.supportsBinary,function(e){try{t.ws.send(e)}catch(n){u("websocket closed before onclose event")}});setTimeout(s,0)},f.prototype.onClose=function(){r.prototype.onClose.call(this)},f.prototype.doClose=function(){typeof this.ws!="undefined"&&this.ws.close()},f.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&this.port!=443||"ws"==t&&this.port!=80)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=+(new Date)),this.supportsBinary||(e.b64=1),e=s.encode(e),e.length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e},f.prototype.check=function(){return!!a&&!("__initialize"in a&&this.name===f.prototype.name)}},{"../transport":14,"component-inherit":21,debug:9,"engine.io-parser":22,parseqs:30,ws:31}],20:[function(e,t,n){var r=e("has-cors");t.exports=function(e){var t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(n){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(n){}}},{"has-cors":34}],21:[function(e,t,n){t.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],22:[function(e,t,n){function d(e,t,r){if(!t)return n.encodeBase64Packet(e,r);var i=e.data,s=new Uint8Array(i),o=new Uint8Array(1+i.byteLength);o[0]=l[e.type];for(var u=0;u<s.length;u++)o[u+1]=s[u];return r(o.buffer)}function v(e,t,r){if(!t)return n.encodeBase64Packet(e,r);var i=new FileReader;return i.onload=function(){e.data=i.result,n.encodePacket(e,t,r)},i.readAsArrayBuffer(e.data)}function m(e,t,r){if(!t)return n.encodeBase64Packet(e,r);if(f)return v(e,t,r);var i=new Uint8Array(1);i[0]=l[e.type];var s=new p([i.buffer,e.data]);return r(s)}function g(e,t,n){var r=new Array(e.length),i=u(e.length,n),s=function(e,n,i){t(n,function(t,n){r[e]=n,i(t,r)})};for(var o=0;o<e.length;o++)s(o,e[o],i)}var r=typeof self!="undefined"?self:typeof window!="undefined"?window:{},i=e("./keys"),s=e("arraybuffer.slice"),o=e("base64-arraybuffer"),u=e("after"),a=e("utf8"),f=navigator.userAgent.match(/Android/i);n.protocol=2;var l=n.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},c=i(l),h={type:"error",data:"parser error"},p=e("blob");n.encodePacket=function(e,t,n){typeof t=="function"&&(n=t,t=!1);var i=e.data===undefined?undefined:e.data.buffer||e.data;if(r.ArrayBuffer&&i instanceof ArrayBuffer)return d(e,t,n);if(p&&i instanceof r.Blob)return m(e,t,n);var s=l[e.type];return undefined!==e.data&&(s+=a.encode(String(e.data))),n(""+s)},n.encodeBase64Packet=function(e,t){var i="b"+n.packets[e.type];if(p&&e.data instanceof p){var s=new FileReader;return s.onload=function(){var e=s.result.split(",")[1];t(i+e)},s.readAsDataURL(e.data)}var o;try{o=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(u){var a=new Uint8Array(e.data),f=new Array(a.length);for(var l=0;l<a.length;l++)f[l]=a[l];o=String.fromCharCode.apply(null,f)}return i+=r.btoa(o),t(i)},n.decodePacket=function(e,t){if(typeof e=="string"||e===undefined){if(e.charAt(0)=="b")return n.decodeBase64Packet(e.substr(1),t);e=a.decode(e);var r=e.charAt(0);return Number(r)!=r||!c[r]?h:e.length>1?{type:c[r],data:e.substring(1)}:{type:c[r]}}var i=new Uint8Array(e),r=i[0],o=s(e,1);return p&&t==="blob"&&(o=new p([o])),{type:c[r],data:o}},n.decodeBase64Packet=function(e,t){var n=c[e.charAt(0)];if(!r.ArrayBuffer)return{type:n,data:{base64:!0,data:e.substr(1)}};var i=o.decode(e.substr(1));return t==="blob"&&p&&(i=new p([i])),{type:n,data:i}},n.encodePayload=function(e,t,r){function i(e){return e.length+":"+e}function s(e,r){n.encodePacket(e,t,function(e){r(null,i(e))})}typeof t=="function"&&(r=t,t=null);if(t)return p&&!f?n.encodePayloadAsBlob(e,r):n.encodePayloadAsArrayBuffer(e,r);if(!e.length)return r("0:");g(e,s,function(e,t){return r(t.join(""))})},n.decodePayload=function(e,t,r){if(typeof e!="string")return n.decodePayloadAsBinary(e,t,r);typeof t=="function"&&(r=t,t=null);var i;if(e=="")return r(h,0,1);var s="",o,u;for(var a=0,f=e.length;a<f;a++){var l=e.charAt(a);if(":"!=l)s+=l;else{if(""==s||s!=(o=Number(s)))return r(h,0,1);u=e.substr(a+1,o);if(s!=u.length)return r(h,0,1);if(u.length){i=n.decodePacket(u,t);if(h.type==i.type&&h.data==i.data)return r(h,0,1);var c=r(i,a+o,f);if(!1===c)return}a+=o,s=""}}if(s!="")return r(h,0,1)},n.encodePayloadAsArrayBuffer=function(e,t){function r(e,t){n.encodePacket(e,!0,function(e){return t(null,e)})}if(!e.length)return t(new ArrayBuffer(0));g(e,r,function(e,n){var r=n.reduce(function(e,t){var n;return typeof t=="string"?n=t.length:n=t.byteLength,e+n.toString().length+n+2},0),i=new Uint8Array(r),s=0;return n.forEach(function(e){var t=typeof e=="string",n=e;if(t){var r=new Uint8Array(e.length);for(var o=0;o<e.length;o++)r[o]=e.charCodeAt(o);n=r.buffer}t?i[s++]=0:i[s++]=1;var u=n.byteLength.toString();for(var o=0;o<u.length;o++)i[s++]=parseInt(u[o]);i[s++]=255;var r=new Uint8Array(n);for(var o=0;o<r.length;o++)i[s++]=r[o]}),t(i.buffer)})},n.encodePayloadAsBlob=function(e,t){function r(e,t){n.encodePacket(e,!0,function(e){var n=new Uint8Array(1);n[0]=1;if(typeof e=="string"){var r=new Uint8Array(e.length);for(var i=0;i<e.length;i++)r[i]=e.charCodeAt(i);e=r.buffer,n[0]=0}var s=e instanceof ArrayBuffer?e.byteLength:e.size,o=s.toString(),u=new Uint8Array(o.length+1);for(var i=0;i<o.length;i++)u[i]=parseInt(o[i]);u[o.length]=255;if(p){var a=new p([n.buffer,u.buffer,e]);t(null,a)}})}g(e,r,function(e,n){return t(new p(n))})},n.decodePayloadAsBinary=function(e,t,r){typeof t=="function"&&(r=t,t=null);var i=e,o=[];while(i.byteLength>0){var u=new Uint8Array(i),a=u[0]===0,f="";for(var l=1;;l++){if(u[l]==255)break;f+=u[l]}i=s(i,2+f.length),f=parseInt(f);var c=s(i,0,f);if(a)try{c=String.fromCharCode.apply(null,new Uint8Array(c))}catch(h){var p=new Uint8Array(c);c="";for(var l=0;l<p.length;l++)c+=String.fromCharCode(p[l])}o.push(c),i=s(i,f)}var d=o.length;o.forEach(function(e,i){r(n.decodePacket(e,t),i,d)})}},{"./keys":23,after:24,"arraybuffer.slice":25,"base64-arraybuffer":26,blob:27,utf8:28}],23:[function(e,t,n){t.exports=Object.keys||function(t){var n=[],r=Object.prototype.hasOwnProperty;for(var i in t)r.call(t,i)&&n.push(i);return n}},{}],24:[function(e,t,n){function r(e,t,n){function s(e,i){if(s.count<=0)throw new Error("after called too many times");--s.count,e?(r=!0,t(e),t=n):s.count===0&&!r&&t(null,i)}var r=!1;return n=n||i,s.count=e,e===0?t():s}function i(){}t.exports=r},{}],25:[function(e,t,n){t.exports=function(e,t,n){var r=e.byteLength;t=t||0,n=n||r;if(e.slice)return e.slice(t,n);t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r);if(t>=r||t>=n||r===0)return new ArrayBuffer(0);var i=new Uint8Array(e),s=new Uint8Array(n-t);for(var o=t,u=0;o<n;o++,u++)s[u]=i[o];return s.buffer}},{}],26:[function(e,t,n){(function(e){n.encode=function(t){var n=new Uint8Array(t),r,i=n.length,s="";for(r=0;r<i;r+=3)s+=e[n[r]>>2],s+=e[(n[r]&3)<<4|n[r+1]>>4],s+=e[(n[r+1]&15)<<2|n[r+2]>>6],s+=e[n[r+2]&63];return i%3===2?s=s.substring(0,s.length-1)+"=":i%3===1&&(s=s.substring(0,s.length-2)+"=="),s},n.decode=function(t){var n=t.length*.75,r=t.length,i,s=0,o,u,a,f;t[t.length-1]==="="&&(n--,t[t.length-2]==="="&&n--);var l=new ArrayBuffer(n),c=new Uint8Array(l);for(i=0;i<r;i+=4)o=e.indexOf(t[i]),u=e.indexOf(t[i+1]),a=e.indexOf(t[i+2]),f=e.indexOf(t[i+3]),c[s++]=o<<2|u>>4,c[s++]=(u&15)<<4|a>>2,c[s++]=(a&3)<<6|f&63;return l}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],27:[function(e,t,n){function u(e,t){t=t||{};var n=new i;for(var r=0;r<e.length;r++)n.append(e[r]);return t.type?n.getBlob(t.type):n.getBlob()}var r=typeof self!="undefined"?self:typeof window!="undefined"?window:{},i=r.BlobBuilder||r.WebKitBlobBuilder||r.MSBlobBuilder||r.MozBlobBuilder,s=function(){try{var e=new Blob(["hi"]);return e.size==2}catch(t){return!1}}(),o=i&&i.prototype.append&&i.prototype.getBlob;t.exports=function(){return s?r.Blob:o?u:undefined}()},{}],28:[function(t,n,r){var i=typeof self!="undefined"?self:typeof window!="undefined"?window:{};(function(t){function f(e){var t=[],n=0,r=e.length,i,s;while(n<r)i=e.charCodeAt(n++),i>=55296&&i<=56319&&n<r?(s=e.charCodeAt(n++),(s&64512)==56320?t.push(((i&1023)<<10)+(s&1023)+65536):(t.push(i),n--)):t.push(i);return t}function l(e){var t=e.length,n=-1,r,i="";while(++n<t)r=e[n],r>65535&&(r-=65536,i+=a(r>>>10&1023|55296),r=56320|r&1023),i+=a(r);return i}function c(e,t){return a(e>>t&63|128)}function h(e){if((e&4294967168)==0)return a(e);var t="";return(e&4294965248)==0?t=a(e>>6&31|192):(e&4294901760)==0?(t=a(e>>12&15|224),t+=c(e,6)):(e&4292870144)==0&&(t=a(e>>18&7|240),t+=c(e,12),t+=c(e,6)),t+=a(e&63|128),t}function p(e){var t=f(e),n=t.length,r=-1,i,s="";while(++r<n)i=t[r],s+=h(i);return s}function d(){if(y>=g)throw Error("Invalid byte index");var e=m[y]&255;y++;if((e&192)==128)return e&63;throw Error("Invalid continuation byte")}function v(){var e,t,n,r,i;if(y>g)throw Error("Invalid byte index");if(y==g)return!1;e=m[y]&255,y++;if((e&128)==0)return e;if((e&224)==192){var t=d();i=(e&31)<<6|t;if(i>=128)return i;throw Error("Invalid continuation byte")}if((e&240)==224){t=d(),n=d(),i=(e&15)<<12|t<<6|n;if(i>=2048)return i;throw Error("Invalid continuation byte")}if((e&248)==240){t=d(),n=d(),r=d(),i=(e&15)<<18|t<<12|n<<6|r;if(i>=65536&&i<=1114111)return i}throw Error("Invalid UTF-8 detected")}function b(e){m=f(e),g=m.length,y=0;var t=[],n;while((n=v())!==!1)t.push(n);return l(t)}var s=typeof r=="object"&&r,o=typeof n=="object"&&n&&n.exports==s&&n,u=typeof i=="object"&&i;if(u.global===u||u.window===u)t=u;var a=String.fromCharCode,m,g,y,w={version:"2.0.0",encode:p,decode:b};if(typeof e=="function"&&typeof e.amd=="object"&&e.amd)e(function(){return w});else if(s&&!s.nodeType)if(o)o.exports=w;else{var E={},S=E.hasOwnProperty;for(var x in w)S.call(w,x)&&(s[x]=w[x])}else t.utf8=w})(this)},{}],29:[function(e,t,n){var r=typeof self!="undefined"?self:typeof window!="undefined"?window:{},i=/^[\],:{}\s]*$/,s=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,o=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,u=/(?:^|:|,)(?:\s*\[)+/g,a=/^\s+/,f=/\s+$/;t.exports=function(t){if("string"!=typeof t||!t)return null;t=t.replace(a,"").replace(f,"");if(r.JSON&&JSON.parse)return JSON.parse(t);if(i.test(t.replace(s,"@").replace(o,"]").replace(u,"")))return(new Function("return "+t))()}},{}],30:[function(e,t,n){n.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},n.decode=function(e){var t={},n=e.split("&");for(var r=0,i=n.length;r<i;r++){var s=n[r].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}},{}],31:[function(e,t,n){function s(e,t,n){var r;return t?r=new i(e,t):r=new i(e),r}var r=function(){return this}(),i=r.WebSocket||r.MozWebSocket;t.exports=i?s:null,i&&(s.prototype=i.prototype)},{}],32:[function(e,t,n){function s(e){function t(e){if(!e)return!1;if(r.Buffer&&Buffer.isBuffer(e)||r.ArrayBuffer&&e instanceof ArrayBuffer||r.Blob&&e instanceof Blob||r.File&&e instanceof File)return!0;if(i(e)){for(var n=0;n<e.length;n++)if(t(e[n]))return!0}else if(e&&"object"==typeof e){e.toJSON&&(e=e.toJSON());for(var s in e)if(t(e[s]))return!0}return!1}return t(e)}var r=typeof self!="undefined"?self:typeof window!="undefined"?window:{},i=e("isarray");t.exports=s},{isarray:33}],33:[function(e,t,n){t.exports=Array.isArray||function(e){return Object.prototype.toString.call(e)=="[object Array]"}},{}],34:[function(e,t,n){var r=e("global");try{t.exports="XMLHttpRequest"in r&&"withCredentials"in new r.XMLHttpRequest}catch(i){t.exports=!1}},{global:35}],35:[function(e,t,n){t.exports=function(){return this}()},{}],36:[function(e,t,n){var r=[].indexOf;t.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},{}],37:[function(e,t,n){var r=Object.prototype.hasOwnProperty;n.keys=Object.keys||function(e){var t=[];for(var n in e)r.call(e,n)&&t.push(n);return t},n.values=function(e){var t=[];for(var n in e)r.call(e,n)&&t.push(e[n]);return t},n.merge=function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);return e},n.length=function(e){return n.keys(e).length},n.isEmpty=function(e){return 0==n.length(e)}},{}],38:[function(e,t,n){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var n=r.exec(t||""),s={},o=14;while(o--)s[i[o]]=n[o]||"";return s}},{}],39:[function(e,t,n){function s(e){return r.Buffer&&Buffer.isBuffer(e)||r.ArrayBuffer&&e instanceof ArrayBuffer}var r=typeof self!="undefined"?self:typeof window!="undefined"?window:{},i=e("isarray");n.deconstructPacket=function(e){function s(e){if(!e)return e;if(r.Buffer&&Buffer.isBuffer(e)||r.ArrayBuffer&&e instanceof ArrayBuffer){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(i(e)){var o=new Array(e.length);for(var u=0;u<e.length;u++)o[u]=s(e[u]);return o}if("object"!=typeof e||e instanceof Date)return e;var o={};for(var a in e)o[a]=s(e[a]);return o}var t=[],n=e.data,o=e;return o.data=s(n),o.attachments=t.length,{packet:o,buffers:t}},n.reconstructPacket=function(e,t){function r(e){if(e&&e._placeholder){var n=t[e.num];return n}if(i(e)){for(var s=0;s<e.length;s++)e[s]=r(e[s]);return e}if(e&&"object"==typeof e){for(var o in e)e[o]=r(e[o]);return e}return e}var n=0;return e.data=r(e.data),e.attachments=undefined,e},n.removeBlobs=function(e,t){function n(e,a,f){if(!e)return e;if(r.Blob&&e instanceof Blob||r.File&&e instanceof File){o++;var l=new FileReader;l.onload=function(){f?f[a]=this.result:u=this.result,--o||t(u)},l.readAsArrayBuffer(e)}if(i(e))for(var c=0;c<e.length;c++)n(e[c],c,e);else if(e&&"object"==typeof e&&!s(e))for(var h in e)n(e[h],h,e)}var o=0,u=e;n(u),o||t(u)}},{isarray:41}],40:[function(e,t,n){function f(){}function l(e){var t="",r=!1;t+=e.type;if(n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type)t+=e.attachments,t+="-";return e.nsp&&"/"!=e.nsp&&(r=!0,t+=e.nsp),null!=e.id&&(r&&(t+=",",r=!1),t+=e.id),null!=e.data&&(r&&(t+=","),t+=s.stringify(e.data)),i("encoded %j as %s",e,t),t}function c(e,t){function n(e){var n=a.deconstructPacket(e),r=l(n.packet),i=n.buffers;i.unshift(r),t(i)}a.removeBlobs(e,n)}function h(){this.reconstructor=null}function p(e){var t={},r=0;t.type=Number(e.charAt(0));if(null==n.types[t.type])return v();if(n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type){t.attachments="";while(e.charAt(++r)!="-")t.attachments+=e.charAt(r);t.attachments=Number(t.attachments)}if("/"==e.charAt(r+1)){t.nsp="";while(++r){var o=e.charAt(r);if(","==o)break;t.nsp+=o;if(r+1==e.length)break}}else t.nsp="/";var u=e.charAt(r+1);if(""!=u&&Number(u)==u){t.id="";while(++r){var o=e.charAt(r);if(null==o||Number(o)!=o){--r;break}t.id+=e.charAt(r);if(r+1==e.length)break}t.id=Number(t.id)}if(e.charAt(++r))try{t.data=s.parse(e.substr(r))}catch(a){return v()}return i("decoded %s as %j",e,t),t}function d(e){this.reconPack=e,this.buffers=[]}function v(e){return{type:n.ERROR,data:"parser error"}}var r=typeof self!="undefined"?self:typeof window!="undefined"?window:{},i=e("debug")("socket.io-parser"),s=e("json3"),o=e("isarray"),u=e("emitter"),a=e("./binary");n.protocol=3,n.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],n.CONNECT=0,n.DISCONNECT=1,n.EVENT=2,n.ACK=3,n.ERROR=4,n.BINARY_EVENT=5,n.BINARY_ACK=6,n.Encoder=f,f.prototype.encode=function(e,t){i("encoding packet %j",e);if(n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type)c(e,t);else{var r=l(e);t([r])}},n.Decoder=h,u(h.prototype),h.prototype.add=function(e){var t;if("string"==typeof e)t=p(e),n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type?(this.reconstructor=new d(t),this.reconstructor.reconPack.attachments==0&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!(r.Buffer&&Buffer.isBuffer(e)||r.ArrayBuffer&&e instanceof ArrayBuffer||e.base64))throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,this.emit("decoded",t))}},h.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},d.prototype.takeBinaryData=function(e){this.buffers.push(e);if(this.buffers.length==this.reconPack.attachments){var t=a.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},d.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":39,debug:9,emitter:10,isarray:41,json3:42}],41:[function(e,t,n){t.exports=e(33)},{}],42:[function(t,n,r){(function(t){function h(e){if(h[e]!==o)return h[e];var t;if(e=="bug-string-char-index")t="a"[0]!="a";else if(e=="json")t=h("json-stringify")&&h("json-parse");else{var r,i='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if(e=="json-stringify"){var s=f.stringify,u=typeof s=="function"&&l;if(u){(r=function(){return 1}).toJSON=r;try{u=s(0)==="0"&&s(new Number)==="0"&&s(new String)=='""'&&s(n)===o&&s(o)===o&&s()===o&&s(r)==="1"&&s([r])=="[1]"&&s([o])=="[null]"&&s(null)=="null"&&s([o,n,null])=="[null,null,null]"&&s({a:[r,true,false,null,"\0\b\n\f\r	"]})==i&&s(null,r)==="1"&&s([1,2],null,1)=="[\n 1,\n 2\n]"&&s(new Date(-864e13))=='"-271821-04-20T00:00:00.000Z"'&&s(new Date(864e13))=='"+275760-09-13T00:00:00.000Z"'&&s(new Date(-621987552e5))=='"-000001-01-01T00:00:00.000Z"'&&s(new Date(-1))=='"1969-12-31T23:59:59.999Z"'}catch(a){u=!1}}t=u}if(e=="json-parse"){var c=f.parse;if(typeof c=="function")try{if(c("0")===0&&!c(!1)){r=c(i);var p=r["a"].length==5&&r.a[0]===1;if(p){try{p=!c('"	"')}catch(a){}if(p)try{p=c("01")!==1}catch(a){}if(p)try{p=c("1.")!==1}catch(a){}}}}catch(a){p=!1}t=p}}return h[e]=!!t}var n={}.toString,i,s,o,u=typeof e=="function"&&e.amd,a=typeof JSON=="object"&&JSON,f=typeof r=="object"&&r&&!r.nodeType&&r;f&&a?(f.stringify=a.stringify,f.parse=a.parse):f=t.JSON=a||{};var l=new Date(-0xc782b5b800cec);try{l=l.getUTCFullYear()==-109252&&l.getUTCMonth()===0&&l.getUTCDate()===1&&l.getUTCHours()==10&&l.getUTCMinutes()==37&&l.getUTCSeconds()==6&&l.getUTCMilliseconds()==708}catch(c){}if(!h("json")){var p="[object Function]",d="[object Date]",v="[object Number]",m="[object String]",g="[object Array]",y="[object Boolean]",b=h("bug-string-char-index");if(!l)var w=Math.floor,E=[0,31,59,90,120,151,181,212,243,273,304,334],S=function(e,t){return E[t]+365*(e-1970)+w((e-1969+(t=+(t>1)))/4)-w((e-1901+t)/100)+w((e-1601+t)/400)};(i={}.hasOwnProperty)||(i=function(e){var t={},r;return(t.__proto__=null,t.__proto__={toString:1},t).toString!=n?i=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(r=t.constructor,i=function(e){var t=(this.constructor||r).prototype;return e in this&&!(e in t&&this[e]===t[e])}),t=null,i.call(this,e)});var x={"boolean":1,number:1,string:1,"undefined":1},T=function(e,t){var n=typeof e[t];return n=="object"?!!e[t]:!x[n]};s=function(e,t){var r=0,o,u,a;(o=function(){this.valueOf=0}).prototype.valueOf=0,u=new o;for(a in u)i.call(u,a)&&r++;return o=u=null,r?r==2?s=function(e,t){var r={},s=n.call(e)==p,o;for(o in e)(!s||o!="prototype")&&!i.call(r,o)&&(r[o]=1)&&i.call(e,o)&&t(o)}:s=function(e,t){var r=n.call(e)==p,s,o;for(s in e)(!r||s!="prototype")&&i.call(e,s)&&!(o=s==="constructor")&&t(s);(o||i.call(e,s="constructor"))&&t(s)}:(u=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],s=function(e,t){var r=n.call(e)==p,s,o,a=!r&&typeof e.constructor!="function"&&T(e,"hasOwnProperty")?e.hasOwnProperty:i;for(s in e)(!r||s!="prototype")&&a.call(e,s)&&t(s);for(o=u.length;s=u[--o];a.call(e,s)&&t(s));}),s(e,t)};if(!h("json-stringify")){var N={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},C="000000",k=function(e,t){return(C+(t||0)).slice(-e)},L="\\u00",A=function(e){var t='"',n=0,r=e.length,i=r>10&&b,s;i&&(s=e.split(""));for(;n<r;n++){var o=e.charCodeAt(n);switch(o){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=N[o];break;default:if(o<32){t+=L+k(2,o.toString(16));break}t+=i?s[n]:b?e.charAt(n):e[n]}}return t+'"'},O=function(e,t,r,u,a,f,l){var c,h,p,b,E,x,T,N,C,L,M,_,D,P,H,B;try{c=t[e]}catch(j){}if(typeof c=="object"&&c){h=n.call(c);if(h==d&&!i.call(c,"toJSON"))if(c>-1/0&&c<1/0){if(S){E=w(c/864e5);for(p=w(E/365.2425)+1970-1;S(p+1,0)<=E;p++);for(b=w((E-S(p,0))/30.42);S(p,b+1)<=E;b++);E=1+E-S(p,b),x=(c%864e5+864e5)%864e5,T=w(x/36e5)%24,N=w(x/6e4)%60,C=w(x/1e3)%60,L=x%1e3}else p=c.getUTCFullYear(),b=c.getUTCMonth(),E=c.getUTCDate(),T=c.getUTCHours(),N=c.getUTCMinutes(),C=c.getUTCSeconds(),L=c.getUTCMilliseconds();c=(p<=0||p>=1e4?(p<0?"-":"+")+k(6,p<0?-p:p):k(4,p))+"-"+k(2,b+1)+"-"+k(2,E)+"T"+k(2,T)+":"+k(2,N)+":"+k(2,C)+"."+k(3,L)+"Z"}else c=null;else typeof c.toJSON=="function"&&(h!=v&&h!=m&&h!=g||i.call(c,"toJSON"))&&(c=c.toJSON(e))}r&&(c=r.call(t,e,c));if(c===null)return"null";h=n.call(c);if(h==y)return""+c;if(h==v)return c>-1/0&&c<1/0?""+c:"null";if(h==m)return A(""+c);if(typeof c=="object"){for(P=l.length;P--;)if(l[P]===c)throw TypeError();l.push(c),M=[],H=f,f+=a;if(h==g){for(D=0,P=c.length;D<P;D++)_=O(D,c,r,u,a,f,l),M.push(_===o?"null":_);B=M.length?a?"[\n"+f+M.join(",\n"+f)+"\n"+H+"]":"["+M.join(",")+"]":"[]"}else s(u||c,function(e){var t=O(e,c,r,u,a,f,l);t!==o&&M.push(A(e)+":"+(a?" ":"")+t)}),B=M.length?a?"{\n"+f+M.join(",\n"+f)+"\n"+H+"}":"{"+M.join(",")+"}":"{}";return l.pop(),B}};f.stringify=function(e,t,r){var i,s,o,u;if(typeof t=="function"||typeof t=="object"&&t)if((u=n.call(t))==p)s=t;else if(u==g){o={};for(var a=0,f=t.length,l;a<f;l=t[a++],(u=n.call(l),u==m||u==v)&&(o[l]=1));}if(r)if((u=n.call(r))==v){if((r-=r%1)>0)for(i="",r>10&&(r=10);i.length<r;i+=" ");}else u==m&&(i=r.length<=10?r:r.slice(0,10));return O("",(l={},l[""]=e,l),s,o,i,"",[])}}if(!h("json-parse")){var M=String.fromCharCode,_={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},D,P,H=function(){throw D=P=null,SyntaxError()},B=function(){var e=P,t=e.length,n,r,i,s,o;while(D<t){o=e.charCodeAt(D);switch(o){case 9:case 10:case 13:case 32:D++;break;case 123:case 125:case 91:case 93:case 58:case 44:return n=b?e.charAt(D):e[D],D++,n;case 34:for(n="@",D++;D<t;){o=e.charCodeAt(D);if(o<32)H();else if(o==92){o=e.charCodeAt(++D);switch(o){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:n+=_[o],D++;break;case 117:r=++D;for(i=D+4;D<i;D++)o=e.charCodeAt(D),o>=48&&o<=57||o>=97&&o<=102||o>=65&&o<=70||H();n+=M("0x"+e.slice(r,D));break;default:H()}}else{if(o==34)break;o=e.charCodeAt(D),r=D;while(o>=32&&o!=92&&o!=34)o=e.charCodeAt(++D);n+=e.slice(r,D)}}if(e.charCodeAt(D)==34)return D++,n;H();default:r=D,o==45&&(s=!0,o=e.charCodeAt(++D));if(o>=48&&o<=57){o==48&&(o=e.charCodeAt(D+1),o>=48&&o<=57)&&H(),s=!1;for(;D<t&&(o=e.charCodeAt(D),o>=48&&o<=57);D++);if(e.charCodeAt(D)==46){i=++D;for(;i<t&&(o=e.charCodeAt(i),o>=48&&o<=57);i++);i==D&&H(),D=i}o=e.charCodeAt(D);if(o==101||o==69){o=e.charCodeAt(++D),(o==43||o==45)&&D++;for(i=D;i<t&&(o=e.charCodeAt(i),o>=48&&o<=57);i++);i==D&&H(),D=i}return+e.slice(r,D)}s&&H();if(e.slice(D,D+4)=="true")return D+=4,!0;if(e.slice(D,D+5)=="false")return D+=5,!1;if(e.slice(D,D+4)=="null")return D+=4,null;H()}}return"$"},j=function(e){var t,n;e=="$"&&H();if(typeof e=="string"){if((b?e.charAt(0):e[0])=="@")return e.slice(1);if(e=="["){t=[];for(;;n||(n=!0)){e=B();if(e=="]")break;n&&(e==","?(e=B(),e=="]"&&H()):H()),e==","&&H(),t.push(j(e))}return t}if(e=="{"){t={};for(;;n||(n=!0)){e=B();if(e=="}")break;n&&(e==","?(e=B(),e=="}"&&H()):H()),(e==","||typeof e!="string"||(b?e.charAt(0):e[0])!="@"||B()!=":")&&H(),t[e.slice(1)]=j(B())}return t}H()}return e},F=function(e,t,n){var r=I(e,t,n);r===o?delete e[t]:e[t]=r},I=function(e,t,r){var i=e[t],o;if(typeof i=="object"&&i)if(n.call(i)==g)for(o=i.length;o--;)F(i,o,r);else s(i,function(e){F(i,e,r)});return r.call(e,t,i)};f.parse=function(e,t){var r,i;return D=0,P=""+e,r=j(B()),B()!="$"&&H(),D=P=null,t&&n.call(t)==p?I((i={},i[""]=r,i),"",t):r}}}u&&e(function(){return f})})(this)},{}],43:[function(e,t,n){function r(e,t){var n=[];t=t||0;for(var r=t||0;r<e.length;r++)n[r-t]=e[r];return n}t.exports=r},{}]},{},[1])(1)}),define("fileSystemImpl",["require","exports","module","filesystem/FileSystemStats","filesystem/FileSystemError","socket.io"],function(e,t){function o(e){if(!e)return null;switch(e.code){case"ERR_INVALID_PARAMS":return r.INVALID_PARAMS;case"ENOENT":return r.NOT_FOUND;case"ERR_CANT_READ":return r.NOT_READABLE;case"ERR_CANT_WRITE":return r.NOT_WRITABLE;case"ERR_UNSUPPORTED_ENCODING":return r.UNSUPPORTED_ENCODING;case"ENOSPC":return r.OUT_OF_SPACE;case"EEXIST":return r.ALREADY_EXISTS}return r.UNKNOWN}function a(e,t,n,r,i,s){if(s)return s("Not implemented!");throw"Not implemented!"}function f(e,t,n,r){if(r)return r("Not implemented!");throw"Not implemented!"}function l(e,t){u.emit("stat",e,function(e){e.err?t(o(e.err)):t(null,new n(e.stats))})}function c(e,t){l(e,function(e){if(e){e===r.NOT_FOUND?t(null,!1):t(e);return}t(null,!0)})}function h(e,t){u.emit("readdir",e,function(n){if(n.err)return t(o(n.err));var r=n.contents.length;if(!r)return t(null,[],[]);var i=[];n.contents.forEach(function(s,o){l(e+"/"+s,function(e,s){i[o]=e||s,r--,r<=0&&t(null,n.contents,i)})})})}function p(e,t,n){typeof t=="function"&&(n=t,t=parseInt("0755",8)),u.emit("mkdir",{path:e,mode:t},function(t){if(t)return n(o(t));l(e,function(e,t){n(e,t)})})}function d(e,t,n){u.emit("rename",{oldPath:e,newPath:t},function(e){n&&n(o(e))})}function v(e,t,n){var r=t.encoding||"utf8",i=!1,s,a,f;t.stat?(i=!0,a=t.stat):l(e,function(e,t){i?n(e,e?null:s,t):(i=!0,a=t,f=e)}),u.emit("readFile",{path:e,encoding:r},function(e){if(e.err){n(o(e.err));return}i?n(f,f?null:e.data,a):(i=!0,s=e.data)})}function m(e,t,n,i){function a(n){u.emit("writeFile",{path:e,data:t,encoding:s},function(t){t?i(o(t)):l(e,function(e,t){i(e,t,n)})})}var s=n.encoding||"utf8";l(e,function(t,s){if(t){switch(t){case r.NOT_FOUND:a(!0);break;default:i(t)}return}if(n.hasOwnProperty("expectedHash")&&n.expectedHash!==s._hash){console.error("Blind write attempted: ",e,s._hash,n.expectedHash);if(n.hasOwnProperty("expectedContents")){v(e,n,function(e,t){if(e||t!==n.expectedContents){i(r.CONTENTS_MODIFIED);return}a(!1)});return}i(r.CONTENTS_MODIFIED);return}a(!1)})}function g(e,t){u.emit("unlink",e,function(e){t(o(e))})}function y(e,t){u.emit("moveToTrash",e,function(e){t(o(e))})}function b(e,t){i=e,s=t}function w(e,t){if(t)return t("Not implemented!");throw"Not implemented!"}function E(e,t){if(t)return t("Not implemented!");throw"Not implemented!"}function S(e){if(e)return e("Not implemented!");throw"Not implemented!"}var n=e("filesystem/FileSystemStats"),r=e("filesystem/FileSystemError"),i,s,u=e("socket.io").connect("/brackets");u.on("greeting",function(e){e==="hi"&&console.log("Socket.io connected!")}),t.showOpenDialog=a,t.showSaveDialog=f,t.exists=c,t.readdir=h,t.mkdir=p,t.rename=d,t.stat=l,t.readFile=v,t.writeFile=m,t.unlink=g,t.moveToTrash=y,t.initWatchers=b,t.watchPath=w,t.unwatchPath=E,t.unwatchAll=S,t.recursiveWatch=!1,t.normalizeUNCPaths=!1}),define("filesystem/FileSystem",["require","exports","module","filesystem/Directory","filesystem/File","filesystem/FileIndex","filesystem/FileSystemError","filesystem/WatchedRoot","fileSystemImpl"],function(e,t,n){function a(){this._index=new s,this._watchedRoots={},this._watchRequests=[],this._externalChanges=[]}function f(e){return e[e.length-1]!=="/"&&(e+="/"),e}function h(e){return function(){return e.apply(c,arguments)}}var r=e("filesystem/Directory"),i=e("filesystem/File"),s=e("filesystem/FileIndex"),o=e("filesystem/FileSystemError"),u=e("filesystem/WatchedRoot");a.prototype._impl=null,a.prototype._index=null,a.prototype._activeChangeCount=0,a.prototype._getActiveChangeCount=function(){return this._activeChangeCount},a.prototype._externalChanges=null,a.prototype._triggerExternalChangesNow=function(){this._externalChanges.forEach(function(e){this._handleExternalChange(e.path,e.stat)},this),this._externalChanges.length=0},a.prototype._enqueueExternalChange=function(e,t){this._externalChanges.push({path:e,stat:t}),this._activeChangeCount||this._triggerExternalChangesNow()},a.prototype._watchRequests=null,a.prototype._dequeueWatchRequest=function(){if(this._watchRequests.length>0){var e=this._watchRequests[0];e.fn.call(null,function(){var t=arguments;try{e.cb.apply(null,t)}finally{this._watchRequests.shift(),this._dequeueWatchRequest()}}.bind(this))}},a.prototype._enqueueWatchRequest=function(e,t){this._watchRequests.push({fn:e,cb:t}),this._watchRequests.length===1&&this._dequeueWatchRequest()},a.prototype._watchedRoots=null,a.prototype._findWatchedRootForPath=function(e){var t=null;return Object.keys(this._watchedRoots).some(function(n){if(e.indexOf(n)===0)return t=this._watchedRoots[n],!0},this),t},a.prototype._watchOrUnwatchEntry=function(e,t,n,r){var i=this._impl,s=i.recursiveWatch,o=r?"watchPath":"unwatchPath";s?e!==t.entry?n(null):this._enqueueWatchRequest(function(t){i[o].call(i,e.fullPath,t)}.bind(this),n):r?this._enqueueWatchRequest(function(n){var r=[],s=function(e){return t.filter(e.name,e.parentPath)?((e.isDirectory||e===t.entry)&&r.push(e),!0):!1};e.visit(s,function(e){if(e){n(e);return}var t=r.length;if(t===0){n(null);return}var s=function(){--t===0&&n(null)};r.forEach(function(e){i.watchPath(e.fullPath,s)})})},n):this._enqueueWatchRequest(function(t){i.unwatchPath(e.fullPath,t)},n)},a.prototype._watchEntry=function(e,t,n){this._watchOrUnwatchEntry(e,t,n,!0)},a.prototype._unwatchEntry=function(e,t,n){this._watchOrUnwatchEntry(e,t,function(t){this._index.visitAll(function(t){t.fullPath.indexOf(e.fullPath)===0&&t._clearCachedData(!0)}.bind(this)),n(t)}.bind(this),!1)},a.prototype.init=function(e){console.assert(!this._impl,"This FileSystem has already been initialized!");var t=this._enqueueExternalChange.bind(this),n=this._unwatchAll.bind(this);this._impl=e,this._impl.initWatchers(t,n)},a.prototype.close=function(){this._impl.unwatchAll(),this._index.clear()},a.prototype._indexFilter=function(e,t){var n=this._findWatchedRootForPath(e);return n?n.filter(t,e):!0},a.prototype._beginChange=function(){this._activeChangeCount++},a.prototype._endChange=function(){this._activeChangeCount--,this._activeChangeCount<0&&console.error("FileSystem _activeChangeCount has fallen below zero!"),this._activeChangeCount||this._triggerExternalChangesNow()},a.isAbsolutePath=function(e){return e[0]==="/"||e[1]===":"&&e[2]==="/"};var l=/\/{2,}/g;a.prototype._normalizePath=function(e,t){if(!a.isAbsolutePath(e))throw new Error("Paths must be absolute: '"+e+"'");var n=this._impl.normalizeUNCPaths&&e.search(l)===0;e=e.replace(l,"/");if(e.indexOf("..")!==-1){var r=e.split("/"),i;for(i=1;i<r.length;i++)if(r[i]===".."){if(i<2)throw new Error("Invalid absolute path: '"+e+"'");r.splice(i-1,2),i-=2}e=r.join("/")}return t&&(e=f(e)),n&&(e="/"+e),e},a.prototype._getEntryForPath=function(e,t){var n=e===r;t=this._normalizePath(t,n);var i=this._index.getEntry(t);return i||(i=new e(t,this),this._index.addEntry(i)),i},a.prototype.getFileForPath=function(e){return this._getEntryForPath(i,e)},a.prototype.getDirectoryForPath=function(e){return this._getEntryForPath(r,e)},a.prototype.resolve=function(e,t){var n=this._normalizePath(e,!1),r=this._index.getEntry(n);r||(n=f(n),r=this._index.getEntry(n)),r?r.stat(function(e,n){if(e){t(e);return}t(null,r,n)}):this._impl.stat(e,function(n,i){if(n){t(n);return}i.isFile?r=this.getFileForPath(e):r=this.getDirectoryForPath(e),r._isWatched()&&(r._stat=i),t(null,r,i)}.bind(this))},a.prototype.showOpenDialog=function(e,t,n,r,i,s){this._impl.showOpenDialog(e,t,n,r,i,s)},a.prototype.showSaveDialog=function(e,t,n,r){this._impl.showSaveDialog(e,t,n,r)},a.prototype._fireRenameEvent=function(e,t){$(this).trigger("rename",[e,t])},a.prototype._fireChangeEvent=function(e,t,n){$(this).trigger("change",[e,t,n])},a.prototype._handleRename=function(e,t,n){this._index.entryRenamed(e,t,n)},a.prototype._handleDirectoryChange=function(e,t){var n=e._contents;e._clearCachedData(),e.getContents(function(r,i){var s=n&&i.filter(function(e){return n.indexOf(e)===-1}),o=n&&n.filter(function(e){return i.indexOf(e)===-1}),u=this._findWatchedRootForPath(e.fullPath);if(!u||!u.filter(e.name,e.parentPath)){this._index.visitAll(function(t){t.fullPath.indexOf(e.fullPath)===0&&t._clearCachedData(!0)}.bind(this)),t(s,o);return}var a=s?s.length:0,f=o?o.length:0,l=a+f;if(l===0){t(s,o);return}var c=function(e){e&&console.error("FileSystem error in _handleDirectoryChange after watch/unwatch entries: "+e),--l===0&&t(s,o)};s&&s.forEach(function(e){this._watchEntry(e,u,c)},this),o&&o.forEach(function(e){this._unwatchEntry(e,u,c)},this)}.bind(this))},a.prototype._handleExternalChange=function(e,t){if(!e){this._index.visitAll(function(e){e._clearCachedData(!0)}),this._fireChangeEvent(null);return}e=this._normalizePath(e,!1);var n=this._index.getEntry(e);if(n){var r=n._stat;if(n.isFile){if(!t||!r||t.mtime.getTime()!==r.mtime.getTime())n._clearCachedData(),n._stat=t,this._fireChangeEvent(n)}else this._handleDirectoryChange(n,function(e,r){n._stat=t,this._fireChangeEvent(n,e,r)}.bind(this))}},a.prototype.watch=function(e,t,n){var r=e.fullPath;n=n||function(){};var i=this._findWatchedRootForPath(r);if(!(!i||i.status!==u.STARTING&&i.status!==u.ACTIVE)){n("A parent of this root is already watched");return}var s=Object.keys(this._watchedRoots).some(function(e){var t=this._watchedRoots[e],n=t.entry.fullPath;return n.indexOf(r)===0},this);if(!(!s||s.status!==u.STARTING&&s.status!==u.ACTIVE)){n("A child of this root is already watched");return}var o=new u(e,t);this._watchedRoots[r]=o,o.status=u.STARTING,this._watchEntry(e,o,function(t){if(t){console.warn("Failed to watch root: ",e.fullPath,t),delete this._watchedRoots[r],n(t);return}o.status=u.ACTIVE,n(null)}.bind(this))},a.prototype.unwatch=function(e,t){var n=e.fullPath,r=this._watchedRoots[n];t=t||function(){};if(!r){t(o.ROOT_NOT_WATCHED);return}r.status=u.INACTIVE,this._unwatchEntry(e,r,function(r){delete this._watchedRoots[n],this._index.visitAll(function(t){t.fullPath.indexOf(e.fullPath)===0&&this._index.removeEntry(t)}.bind(this));if(r){console.warn("Failed to unwatch root: ",e.fullPath,r),t(r);return}t(null)}.bind(this))},a.prototype._unwatchAll=function(){console.warn("File watchers went offline!"),Object.keys(this._watchedRoots).forEach(function(e){var t=this._watchedRoots[e];t.status=u.INACTIVE,delete this._watchedRoots[e],this._unwatchEntry(t.entry,t,function(){console.warn("Watching disabled for",t.entry.fullPath)})},this),this._handleExternalChange(null)};var c;t.init=h(a.prototype.init),t.close=h(a.prototype.close),t.shouldShow=h(a.prototype.shouldShow),t.getFileForPath=h(a.prototype.getFileForPath),t.getDirectoryForPath=h(a.prototype.getDirectoryForPath),t.resolve=h(a.prototype.resolve),t.showOpenDialog=h(a.prototype.showOpenDialog),t.showSaveDialog=h(a.prototype.showSaveDialog),t.watch=h(a.prototype.watch),t.unwatch=h(a.prototype.unwatch),t.isAbsolutePath=a.isAbsolutePath,t._getActiveChangeCount=h(a.prototype._getActiveChangeCount),t.on=function(e,t){$(c).on(e,t)},t.off=function(e,t){$(c).off(e,t)},t._FileSystem=a,c=new a,c.init(e("fileSystemImpl"))}),define("utils/ExtensionUtils",["require","exports","module","filesystem/FileSystem","file/FileUtils"],function(e,t,n){function s(e){return $("<style>").text(e).appendTo("head")[0]}function o(e,t){var n={type:"text/css",rel:"stylesheet",href:e},r=$("<link/>").attr(n);return t&&r.on("load",t.resolve).on("error",t.reject),r.appendTo("head"),r[0]}function u(e){return brackets.platform==="win"?PathUtils.isAbsoluteUrl(e):r.isAbsolutePath(e)}function a(e,t){var n=new $.Deferred,r;if(t){var i=t.slice(0,t.lastIndexOf("/")+1),s=t.slice(i.length);r={filename:s,paths:[i],rootpath:i},u(t)&&(r.currentFileInfo={currentDirectory:i,entryPath:i,filename:t,rootFilename:t,rootpath:i})}var o=new less.Parser(r);return o.parse(e,function(t,r){t?n.reject(t):n.resolve(r.toCSS())}),n.promise()}function f(e,t){var n=e.uri.substr(0,e.uri.lastIndexOf("/")+1);return t&&(n+=t),n}function l(e,t){var n=encodeURI(f(e,t));return brackets.platform==="win"&&n.indexOf(":")!==-1&&(n="file:///"+n),n}function c(e,t){var n=PathUtils.isAbsoluteUrl(t)?t:l(e,t),r=$.get(n);return r}function h(e,t){var n=new $.Deferred;return c(e,t).done(function(e){var t=this.url;if(t.slice(-5)===".less")a(e,t).done(function(e){n.resolve(s(e))}).fail(n.reject);else{var r=new $.Deferred,i=o(t,r);r.done(function(){n.resolve(i)}).fail(n.reject)}}).fail(n.reject),n.promise()}function p(e){var t=r.getFileForPath(e+"/package.json"),n=new $.Deferred;return i.readAsText(t).done(function(e){try{var t=JSON.parse(e);n.resolve(t)}catch(r){n.reject()}}).fail(function(){n.reject()}),n.promise()}var r=e("filesystem/FileSystem"),i=e("file/FileUtils");t.addEmbeddedStyleSheet=s,t.addLinkedStyleSheet=o,t.parseLessCode=a,t.getModulePath=f,t.getModuleUrl=l,t.loadFile=c,t.loadStyleSheet=h,t.loadPackageJson=p}),define("utils/ExtensionLoader",["require","exports","module","utils/Global","thirdparty/lodash","filesystem/FileSystem","file/FileUtils","utils/Async","utils/ExtensionUtils","utils/UrlParams"],function(e,t,n){function m(){return brackets.app.getApplicationSupportDirectory?brackets.app.getApplicationSupportDirectory()+"/extensions/user":null}function g(e){return d[e]}function y(){return h}function b(e){h=e}function w(e){var t=new $.Deferred,n=i.getFileForPath(e.baseUrl+"/requirejs-config.json");return s.readAsText(n).done(function(n){try{var i=JSON.parse(n);r.extend(i.paths,e.paths),r.extend(i,r.omit(e,"paths")),t.resolve(i)}catch(s){t.reject("failed to parse requirejs-config.json")}}).fail(function(){t.resolve(e)}),t.promise()}function E(e,n,r){var i=new $.Deferred;return u.loadPackageJson(n.baseUrl).always(i.resolve),i.then(function(t){if(t&&"theme"in t)return;return S(e,n,r)}).then(function(){$(t).triggerHandler("load",n.baseUrl)},function(e){$(t).triggerHandler("loadFailed",n.baseUrl)})}function S(e,t,n){var r={context:e,baseUrl:t.baseUrl,paths:v,locale:brackets.getLocale()},i=w(r).then(function(t){var r=brackets.libRequire.config(t),i=new $.Deferred;return d[e]=r,r([n],i.resolve,i.reject),i.promise()}).then(function(t){var n;c[e]=t;if(t&&t.initExtension&&typeof t.initExtension=="function"){try{n=o.withTimeout(t.initExtension(),y())}catch(r){return console.error("[Extension] Error -- error thrown during initExtension for "+e+": "+r),(new $.Deferred).reject(r).promise()}if(n)return n.fail(function(t){t===o.ERROR_TIMEOUT?console.error("[Extension] Error -- timeout during initExtension for "+e):console.error("[Extension] Error -- failed initExtension for "+e+(t?": "+t:""))}),n}},function(n){console.error("[Extension] failed to load "+t.baseUrl+" "+n),n.requireType==="define"&&console.log(n.stack)});return i}function x(e,t,n){var r=new $.Deferred,s=t.baseUrl+"/"+n+".js";return i.resolve(s,function(i,s){if(!i&&s.isFile){var o=brackets.libRequire.config({context:e,baseUrl:t.baseUrl,paths:$.extend({},t.paths,v)});o([n],function(){r.resolve()})}else r.reject()}),r.promise()}function T(e,t,n,r){var s=new $.Deferred;return i.getDirectoryForPath(e).getContents(function(i,u){if(!i){var a,f=[];for(a=0;a<u.length;a++)u[a].isDirectory&&f.push(u[a].name);if(f.length===0){s.resolve();return}o.doInParallel(f,function(e){var i={baseUrl:t.baseUrl+"/"+e,paths:t.paths};return r(e,i,n)}).always(function(){s.resolve()})}else console.error("[Extension] Error -- could not read native directory: "+e),s.reject()}),s.promise()}function N(e){return T(e,{baseUrl:e},"main",E)}function C(e){var t=s.getNativeBracketsDirectoryPath(),n={baseUrl:e};return n.paths={perf:t+"/perf",spec:t+"/spec"},T(e,n,"unittests",x)}function k(e){var t=new a;if(l)return(new $.Deferred).resolve().promise();e||(t.parse(),t.get("reloadWithoutUserExts")==="true"?e=["default"]:e=["default","dev",m()]);var n=m();i.getDirectoryForPath(n).create();var r=n.replace(/\/user$/,"/disabled");i.getDirectoryForPath(r).create();var u=o.doSequentially(e,function(e){var t=e;return e.indexOf("/")===-1&&(t=s.getNativeBracketsDirectoryPath()+"/extensions/"+e),N(t)},!1);return u.always(function(){l=!0}),u}e("utils/Global");var r=e("thirdparty/lodash"),i=e("filesystem/FileSystem"),s=e("file/FileUtils"),o=e("utils/Async"),u=e("utils/ExtensionUtils"),a=e("utils/UrlParams").UrlParams,f=1e4,l=!1,c={},h=f,p=s.getNativeBracketsDirectoryPath(),d={};p=p.replace(/\/test$/,"/src");var v={text:p+"/thirdparty/text/text",i18n:p+"/thirdparty/i18n/i18n"};t._setInitExtensionTimeout=b,t._getInitExtensionTimeout=y,t.init=k,t.getUserExtensionPath=m,t.getRequireContextForExtension=g,t.loadExtension=E,t.testExtension=x,t.loadAllExtensionsInNativeDirectory=N,t.testAllExtensionsInNativeDirectory=C}),define("utils/CollectionUtils",["require","exports","module","thirdparty/lodash"],function(e,t,n){function i(e,t){return console.warn("CollectionUtils.indexOf is deprecated. Use _.findIndex instead."),r.findIndex(e,t)}function s(e,t){console.warn("CollectionUtils.forEach is deprecated. Use _.forEach instead."),r.forEach(e,t)}function o(e,t){return console.warn("CollectionUtils.some is deprecated. Use _.some instead."),r.some(e,t)}function u(e,t){return console.warn("CollectionUtils.hasProperty is deprecated. Use _.has instead."),r.has(e,t)}var r=e("thirdparty/lodash");t.indexOf=i,t.forEach=s,t.some=o,t.hasProperty=u}),define("thirdparty/globmatch",["require","exports","module"],function(e,t,n,r){function i(e,t){var n={dot:!0,noext:!0};return e[e.length-1]!=="/"&&(n.matchBase=!0),t=t.replace(/\*\*/g,"{*,**/**/**}"),w(e,t,n)}function v(e){return e.split("").reduce(function(e,t){return e[t]=!0,e},{})}function g(){var e=Object.getOwnPropertyDescriptor(String.prototype,"match"),t=e.value;e.value=function(e){return e instanceof E?e.match(this):t.call(this,e)},Object.defineProperty(String.prototype,e)}function y(e,t){return t=t||{},function(n,r,i){return w(n,e,t)}}function b(e,t){e=e||{},t=t||{};var n={};return Object.keys(t).forEach(function(e){n[e]=t[e]}),Object.keys(e).forEach(function(t){n[t]=e[t]}),n}function w(e,t,n){if(typeof t!="string")throw new TypeError("glob pattern string required");return n||(n={}),!n.nocomment&&t.charAt(0)==="#"?!1:t.trim()===""?e==="":(new E(t,n)).match(e)}function E(e,t){if(!(this instanceof E))return new E(e,t,o);if(typeof e!="string")throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),r==="win32"&&(e=e.split("\\").join("/"));var n=e+"\n"+a(t),i=w.cache.get(n);if(i)return i;w.cache.set(n,this),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function S(){if(this._made)return;var e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&console.error(this.pattern,n),n=this.globParts=n.map(function(e){return e.split(m)}),t.debug&&console.error(this.pattern,n),n=n.map(function(e,t,n){return e.map(this.parse,this)},this),t.debug&&console.error(this.pattern,n),n=n.filter(function(e){return-1===e.indexOf(!1)}),t.debug&&console.error(this.pattern,n),this.set=n}function x(){var e=this.pattern,t=!1,n=this.options,r=0;if(n.nonegate)return;for(var i=0,s=e.length;i<s&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.substr(r)),this.negate=t}function T(e,t){function b(){p.push(g),g=""}t=t||this.options,e=typeof e=="undefined"?this.pattern:e;if(typeof e=="undefined")throw new Error("undefined pattern");if(t.nobrace||!e.match(/\{.*\}/))return[e];var n=!1;if(e.charAt(0)!=="{"){var r=null;for(var i=0,s=e.length;i<s;i++){var o=e.charAt(i);if(o==="\\")n=!n;else if(o==="{"&&!n){r=e.substr(0,i);break}}if(r===null)return[e];var u=T(e.substr(i),t);return u.map(function(e){return r+e})}var a=e.match(/^\{(-?[0-9]+)\.\.(-?[0-9]+)\}/);if(a){var f=T(e.substr(a[0].length),t),l=+a[1],c=+a[2],h=l>c?-1:1,p=[];for(var i=l;i!=c+h;i+=h)for(var d=0,v=f.length;d<v;d++)p.push(i+f[d]);return p}var i=1,m=1,p=[],g="",y=!1,n=!1;e:for(i=1,s=e.length;i<s;i++){var o=e.charAt(i);if(n)n=!1,g+="\\"+o;else switch(o){case"\\":n=!0;continue;case"{":m++,g+="{";continue;case"}":m--;if(m===0){b(),i++;break e}g+=o;continue;case",":m===1?b():g+=o;continue;default:g+=o;continue}}if(m!==0)return T("\\"+e,t);var f=T(e.substr(i),t),w=p.length===1;p=p.map(function(e){return T(e,t)}),p=p.reduce(function(e,t){return e.concat(t)}),w&&(p=p.map(function(e){return"{"+e+"}"}));var E=[];for(var i=0,s=p.length;i<s;i++)for(var d=0,v=f.length;d<v;d++)E.push(p[i]+f[d]);return E}function C(e,t){function g(){if(f){switch(f){case"*":r+=c,i=!0;break;case"?":r+=l,i=!0;break;default:r+="\\"+f}f=!1}}var n=this.options;if(!n.noglobstar&&e==="**")return u;if(e==="")return"";var r="",i=!!n.nocase,s=!1,o=[],a,f,h=!1,p=-1,v=-1,m=e.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)";for(var y=0,b=e.length,w;y<b&&(w=e.charAt(y));y++){n.debug&&console.error("%s	%s %s %j",e,y,r,w);if(s&&d[w]){r+="\\"+w,s=!1;continue}switch(w){case"/":return!1;case"\\":g(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":n.debug&&console.error("%s	%s %s %j <-- stateChar",e,y,r,w);if(h){w==="!"&&y===v+1&&(w="^"),r+=w;continue}g(),f=w,n.noext&&g();continue;case"(":if(h){r+="(";continue}if(!f){r+="\\(";continue}a=f,o.push({type:a,start:y-1,reStart:r.length}),r+=f==="!"?"(?:(?!":"(?:",f=!1;continue;case")":if(h||!o.length){r+="\\)";continue}i=!0,r+=")",a=o.pop().type;switch(a){case"!":r+="[^/]*?)";break;case"?":case"+":case"*":r+=a;case"@":}continue;case"|":if(h||!o.length||s){r+="\\|",s=!1;continue}r+="|";continue;case"[":g();if(h){r+="\\"+w;continue}h=!0,v=y,p=r.length,r+=w;continue;case"]":if(y===v+1||!h){r+="\\"+w,s=!1;continue}i=!0,h=!1,r+=w;continue;default:g(),s?s=!1:d[w]&&(w!=="^"||!h)&&(r+="\\"),r+=w}}if(h){var E=e.substr(v+1),S=this.parse(E,N);r=r.substr(0,p)+"\\["+S[0],i=i||S[1]}var x;while(x=o.pop()){var T=r.slice(x.reStart+3);T=T.replace(/((?:\\{2})*)(\\?)\|/g,function(e,t,n){return n||(n="\\"),t+t+n+"|"});var C=x.type==="*"?c:x.type==="?"?l:"\\"+x.type;i=!0,r=r.slice(0,x.reStart)+C+"\\("+T}g(),s&&(r+="\\\\");var k=!1;switch(r.charAt(0)){case".":case"[":case"(":k=!0}r!==""&&i&&(r="(?=.)"+r),k&&(r=m+r);if(t===N)return[r,i];if(!i)return A(e);var L=n.nocase?"i":"",O=new RegExp("^"+r+"$",L);return O._glob=e,O._src=r,O}function k(){if(this.regexp||this.regexp===!1)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1;var t=this.options,n=t.noglobstar?c:t.dot?h:p,r=t.nocase?"i":"",i=e.map(function(e){return e.map(function(e){return e===u?n:typeof e=="string"?O(e):e._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{return this.regexp=new RegExp(i,r)}catch(s){return this.regexp=!1}}function L(e,t){if(this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;var n=this.options;r==="win32"&&(e=e.split("\\").join("/")),e=e.split(m),n.debug&&console.error(this.pattern,"split",e);var i=this.set;for(var s=0,o=i.length;s<o;s++){var u=i[s],a=this.matchOne(e,u,t);if(a)return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}function A(e){return e.replace(/\\(.)/g,"$1")}function O(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}n.exports=i,w.Minimatch=E;var s=function(){var t={},n=0;this.set=function(e,r){n++,n>=100&&(t={}),t[e]=r},this.get=function(e){return t[e]}},o=w.cache=new s({max:100}),u=w.GLOBSTAR=E.GLOBSTAR={},a=function(t){return JSON.stringify(t)},f={basename:function(e){e=e.split(/[\/\\]/);var t=e.pop();return t||(t=e.pop()),t}},l="[^/]",c=l+"*?",h="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",p="(?:(?!(?:\\/|^)\\.).)*?",d=v("().*{}+?[]^$\\!"),m=/\/+/;w.monkeyPatch=g,w.filter=y,w.defaults=function(e){if(!e||!Object.keys(e).length)return w;var t=w,n=function(r,i,s){return t.minimatch(r,i,b(e,s))};return n.Minimatch=function(r,i){return new t.Minimatch(r,b(e,i))},n},E.defaults=function(e){return!e||!Object.keys(e).length?E:w.defaults(e).Minimatch},E.prototype.make=S,E.prototype.parseNegate=x,w.braceExpand=function(e,t){return(new E(e,t)).braceExpand()},E.prototype.braceExpand=T,E.prototype.parse=C;var N={};w.makeRe=function(e,t){return(new E(e,t||{})).makeRe()},E.prototype.makeRe=k,w.match=function(e,t,n){var r=new E(t,n);return e=e.filter(function(e){return r.match(e)}),n.nonull&&!e.length&&e.push(t),e},E.prototype.match=L,E.prototype.matchOne=function(e,t,n){var r=this.options;r.debug&&console.error("matchOne",{"this":this,file:e,pattern:t}),r.matchBase&&t.length===1&&(e=f.basename(e.join("/")).split("/")),r.debug&&console.error("matchOne",e.length,t.length);for(var i=0,s=0,o=e.length,a=t.length;i<o&&s<a;i++,s++){r.debug&&console.error("matchOne loop");var l=t[s],c=e[i];r.debug&&console.error(t,l,c);if(l===!1)return!1;if(l===u){r.debug&&console.error("GLOBSTAR",[t,l,c]);var h=i,p=s+1;if(p===a){r.debug&&console.error("** at the end");for(;i<o;i++)if(e[i]==="."||e[i]===".."||!r.dot&&e[i].charAt(0)===".")return!1;return!0}e:while(h<o){var d=e[h];r.debug&&console.error("\nglobstar while",e,h,t,p,d);if(this.matchOne(e.slice(h),t.slice(p),n))return r.debug&&console.error("globstar found match!",h,o,d),!0;if(d==="."||d===".."||!r.dot&&d.charAt(0)==="."){r.debug&&console.error("dot detected!",e,h,t,p);break e}r.debug&&console.error("globstar swallow a segment, and continue"),h++}return n&&h===o?!0:!1}var v;typeof l=="string"?(r.nocase?v=c.toLowerCase()===l.toLowerCase():v=c===l,r.debug&&console.error("string match",l,c,v)):(v=c.match(l),r.debug&&console.error("pattern match",l,c,v));if(!v)return!1}if(i===o&&s===a)return!0;if(i===o)return n;if(s===a){var m=i===o-1&&e[i]==="";return m}throw new Error("wtf?")}}),define("preferences/PreferencesBase",["require","exports","module","file/FileUtils","filesystem/FileSystem","utils/ExtensionLoader","utils/CollectionUtils","thirdparty/lodash","utils/Async","thirdparty/globmatch"],function(e,t,n){function h(e){this.data=e||{}}function p(e){this.name="ParsingError",this.message=e||""}function d(e,t){this.path=e,this.createIfNew=t,this._lineEndings=r.getPlatformLineEndings()}function v(e){this.storage=e,$(e).on("changed",this.load.bind(this)),this.data={},this._dirty=!1,this._layers=[],this._layerMap={},this._exclusions=[]}function m(e,t){var n=Object.keys(e),r;if(!t)return;for(r=0;r<n.length;r++){var i=n[r];if(f(t,i))return i}}function g(){this.projectPath=null}function y(e){this.setPrefFilePath(e)}function b(e){u.extend(this,e)}function w(e,t){this.base=e,this.prefix=t,this._listenerInstalled=!1}function E(e){this.contextNormalizer=e,this._knownPrefs={},this._scopes={"default":new v(new h)},this._scopes["default"].load(),this._defaultContext={scopeOrder:["default"],_shadowScopeOrder:[{id:"default",scope:this._scopes["default"],promise:(new $.Deferred).resolve().promise()}]},this._pendingScopes={},this._saveInProgress=null,this._nextSaveDeferred=null,this.finalized=!1,this._pathScopeDefinitions={},this._pathScopeFilenames=[],this._pathScopes={},this._changeEventQueue=null;var t=function(e){var t=this._knownPrefs[e];t&&$(t).trigger(l)}.bind(this);$(this).on(l,function(e,n){n.ids.forEach(t)}.bind(this))}var r=e("file/FileUtils"),i=e("filesystem/FileSystem"),s=e("utils/ExtensionLoader"),o=e("utils/CollectionUtils"),u=e("thirdparty/lodash"),a=e("utils/Async"),f=e("thirdparty/globmatch"),l="change",c="scopeOrderChange";h.prototype={load:function(){var e=new $.Deferred;return e.resolve(this.data),e.promise()},save:function(e){var t=new $.Deferred;return this.data=e,t.resolve(),t.promise()},fileChanged:function(e){}},p.prototype=new Error,d.prototype={load:function(){var e=new $.Deferred,t=this.path,n=this.createIfNew,s=this;if(t){var o=i.getFileForPath(t);o.read({},function(i,o){if(i){n?e.resolve({}):e.reject(new Error("Unable to load prefs at "+t+" "+i));return}s._lineEndings=r.sniffLineEndings(o);if(/^\s*$/.test(o))e.resolve({});else try{e.resolve(JSON.parse(o))}catch(u){e.reject(new p("Invalid JSON settings at "+t+"("+u.toString()+")"))}})}else e.resolve({});return e.promise()},save:function(e){var t=new $.Deferred,n=this.path,s=i.getFileForPath(n);if(n)try{var o=JSON.stringify(e,null,4);o=r.translateLineEndings(o,this._lineEndings),s.write(o,{},function(e){e?t.reject("Unable to save prefs at "+n+" "+e):t.resolve()})}catch(u){t.reject("Unable to convert prefs to JSON"+u.toString())}else t.resolve();return t.promise()},setPath:function(e){this.path=e,$(this).trigger("changed")},fileChanged:function(e){e===this.path&&$(this).trigger("changed")}},u.extend(v.prototype,{load:function(){var e=new $.Deferred;return this.storage.load().then(function(t){var n=this.getKeys();this.data=t,e.resolve(),$(this).trigger(l,{ids:u.union(this.getKeys(),n)})}.bind(this)).fail(function(t){e.reject(t)}),e.promise()},save:function(){var e=this;return this._dirty?(e._dirty=!1,this.storage.save(this.data)):(new $.Deferred).resolve().promise()},set:function(e,t,n,r){r||(r=this.getPreferenceLocation(e,n));if(r&&r.layer){var i=this._layerMap[r.layer];if(i){this.data[i.key]===undefined&&(this.data[i.key]={});var s=i.set(this.data[i.key],e,t,n,r.layerID);return this._dirty=this._dirty||s,s}return!1}return this._performSet(e,t)},_performSet:function(e,t){return u.isEqual(this.data[e],t)?!1:(this._dirty=!0,t===undefined?delete this.data[e]:this.data[e]=u.cloneDeep(t),!0)},get:function(e,t){var n,r=this._layers,i,s=this.data,o;t=t||{};for(n=0;n<r.length;n++){i=r[n],o=i.get(s[i.key],e,t);if(o!==undefined)return o}if(this._exclusions.indexOf(e)===-1)return s[e]},getPreferenceLocation:function(e,t){var n,r=this._layers,i,s=this.data,o;t=t||{};for(n=0;n<r.length;n++){i=r[n],o=i.getPreferenceLocation(s[i.key],e,t);if(o!==undefined)return{layer:i.key,layerID:o}}return this._exclusions.indexOf(e)===-1&&s[e]!==undefined?{}:undefined},getKeys:function(e){e=e||{};var t,n=this._layers,r,i=this.data,s=[u.difference(u.keys(i),this._exclusions)];for(t=0;t<n.length;t++)r=n[t],s.push(r.getKeys(i[r.key],e));return u.union.apply(null,s)},addLayer:function(e){this._layers.push(e),this._layerMap[e.key]=e,this._exclusions.push(e.key),$(this).trigger(l,{ids:e.getKeys(this.data[e.key],{})})},fileChanged:function(e){this.storage.fileChanged(e)},defaultFilenameChanged:function(e,t){var n=[],r=this.data;return u.each(this._layers,function(i){if(i.defaultFilenameChanged&&r[i.key]){var s=i.defaultFilenameChanged(r[i.key],e,t);s&&n.push(s)}}),u.union.apply(null,n)}}),g.prototype={key:"project",get:function(e,t){if(!e||!this.projectPath)return;if(e[this.projectPath]&&e[this.projectPath][t])return e[this.projectPath][t];return},getPreferenceLocation:function(e,t){if(!e||!this.projectPath)return;if(e[this.projectPath]&&e[this.projectPath][t])return this.projectPath;return},set:function(e,t,n,r,i){i||(i=this.getPreferenceLocation(e,t));if(!i)return!1;var s=e[i];return s||(e[i]=s={}),u.isEqual(s[t],n)?!1:(n===undefined?delete s[t]:s[t]=u.cloneDeep(n),!0)},getKeys:function(e){if(!e)return;return u.union.apply(null,u.map(u.values(e),u.keys))},setProjectPath:function(e){this.projectPath=e}},y.prototype={key:"path",get:function(e,t,n){var r=this.getPreferenceLocation(e,t,n);if(!r)return;return e[r][t]},getPreferenceLocation:function(e,t,n){if(!e)return;var i=r.getRelativeFilename(this.prefFilePath,n.filename);if(!i)return;return m(e,i)},set:function(e,t,n,r,i){i||(i=this.getPreferenceLocation(e,t,r));if(!i)return!1;var s=e[i];return s||(e[i]=s={}),u.isEqual(s[t],n)?!1:(n===undefined?delete s[t]:s[t]=u.cloneDeep(n),!0)},getKeys:function(e,t){if(!e)return;var n=r.getRelativeFilename(this.prefFilePath,t.filename);if(n){var i=m(e,n);return i?u.keys(e[i]):[]}return u.union.apply(null,u.map(u.values(e),u.keys))},setPrefFilePath:function(e){e?this.prefFilePath=r.getDirectoryPath(e):this.prefFilePath="/"},defaultFilenameChanged:function(e,t,n){var i=m(e,r.getRelativeFilename(this.prefFilePath,t)),s=m(e,r.getRelativeFilename(this.prefFilePath,n));if(i===s)return;return i===undefined?u.keys(e[s]):s===undefined?u.keys(e[i]):u.union(u.keys(e[s]),u.keys(e[i]))}},u.extend(b.prototype,{on:function(e,t){$(this).on(e,t)},off:function(e,t){$(this).off(e,t)}}),w.prototype={definePreference:function(e,t,n,r){return this.base.definePreference(this.prefix+e,t,n,r)},getPreference:function(e){return this.base.getPreference(this.prefix+e)},get:function(e,t){return this.base.get(this.prefix+e,t)},getPreferenceLocation:function(e,t){return this.base.getPreferenceLocation(this.prefix+e,t)},set:function(e,t,n,r){return this.base.set(this.prefix+e,t,n,r)},_installListener:function(){if(this._listenerInstalled)return;var e=$(this),t=this.prefix,n=function(e){return e.substr(0,t.length)===t?!0:!1},r=function(e){return e.substr(t.length)};$(this.base).on(l,function(t,i){var s=i.ids.filter(n);s.length>0&&e.trigger(l,{ids:s.map(r)})}),this._listenerInstalled=!0},on:function(e,t,n){typeof t=="function"&&(n=t,t=null);if(t){var r=this.getPreference(t);r.on(e,n)}else this._installListener(),$(this).on(e,n)},off:function(e,t,n){typeof t=="function"&&(n=t,t=null);if(t){var r=this.getPreference(t);r.off(e,n)}else $(this).off(e,n)},save:function(){return this.base.save()}},u.extend(E.prototype,{definePreference:function(e,t,n,r){r=r||{};if(this._knownPrefs.hasOwnProperty(e))throw new Error("Preference "+e+" was redefined");var i=this._knownPrefs[e]=new b({type:t,initial:n,name:r.name,description:r.description,validator:r.validator});return this.set(e,n,{location:{scope:"default"}}),i},getPreference:function(e){return this._knownPrefs[e]},_pushToScopeOrder:function(e,t){var n=this._defaultContext.scopeOrder,r=u.findIndex(n,function(e){return e===t});if(!(r>-1))throw new Error("Internal error: scope "+t+" should be in the scope order");n.splice(r,0,e)},_tryAddToScopeOrder:function(e){var t=this._defaultContext.scopeOrder,n=this._defaultContext._shadowScopeOrder,r=u.findIndex(n,function(t){return t===e}),i=$(this),s=!1,o=r+1;while(o<n.length){if(n[o].promise.state()==="pending"||n[o].promise.state()==="resolved")break;o++}switch(n[o].promise.state()){case"pending":n[o].promise.always(function(){this._tryAddToScopeOrder(e)}.bind(this));break;case"resolved":this._pushToScopeOrder(e.id,n[o].id),i.trigger(c,{id:e.id,action:"added"}),this._triggerChange({ids:e.scope.getKeys()});break;default:throw new Error('Internal error: no scope found to add before. "default" is missing?..')}},_addToScopeOrder:function(e,t,n,r){var i=this._defaultContext.scopeOrder,s=this._defaultContext._shadowScopeOrder,o,a,f=!1,c=this;$(t).on(l+".prefsys",function(e,t){c._triggerChange(t)}.bind(this)),a=u.findIndex(s,function(t){return t.id===e});if(a>-1)o=s[a];else{o={id:e,promise:n,scope:t};if(!r)s.unshift(o);else{a=u.findIndex(s,function(e){return e.id===r});if(a>-1)s.splice(a,0,o);else{var h=this._pendingScopes[r];h||(h=[],this._pendingScopes[r]=h),h.unshift(o),f=!0}}}if(!f){n.then(function(){this._scopes[e]=t,this._tryAddToScopeOrder(o)}.bind(this)).fail(function(e){u.pull(s,o)}.bind(this));if(this._pendingScopes[e]){var p=this._pendingScopes[e];delete this._pendingScopes[e],p.forEach(function(t){this._addToScopeOrder(t.id,t.scope,t.promise,e)}.bind(this))}}},addToScopeOrder:function(e,t){var n=this._defaultContext._shadowScopeOrder,r=u.findIndex(n,function(t){return t.id===e}),i;r>-1&&(i=n[r],this._addToScopeOrder(i.id,i.scope,i.promise,t))},removeFromScopeOrder:function(e){var t=this._scopes[e];if(t){u.pull(this._defaultContext.scopeOrder,e);var n=$(this);$(t).off(".prefsys"),n.trigger(c,{id:e,action:"removed"}),this._triggerChange({ids:t.getKeys()})}},_getContext:function(e){return e?(this.contextNormalizer&&(e=this.contextNormalizer(e)),e):this._defaultContext},addScope:function(e,t,n){var r;n=n||{};if(this._scopes[e])throw new Error("Attempt to redefine preferences scope: "+e);return t.get||(t=new v(t)),r=t.load(),this._addToScopeOrder(e,t,r,n.before),r.fail(function(e){e instanceof p&&console.error(e)}),r},removeScope:function(e){var t=this._scopes[e],n;if(!t)return;this.removeFromScopeOrder(e),n=u.findIndex(this._defaultContext._shadowScopeOrder,function(t){return t.id===e}),this._defaultContext._shadowScopeOrder.splice(n,1),delete this._scopes[e]},_getScopeOrder:function(e){return e.scopeOrder||this._defaultContext.scopeOrder},get:function(e,t){var n;t=this._getContext(t);var r=this._getScopeOrder(t);for(n=0;n<r.length;n++){var i=this._scopes[r[n]];if(i){var s=i.get(e,t);if(s!==undefined){var o=this.getPreference(e),a=o&&o.validator;if(!a||a(s))return u.cloneDeep(s)}}}},getPreferenceLocation:function(e,t){var n,r;t=this._getContext(t);var i=this._getScopeOrder(t);for(n=0;n<i.length;n++){r=i[n];var s=this._scopes[r];if(s){var o=s.getPreferenceLocation(e,t);if(o!==undefined)return o.scope=r,o}}},set:function(e,t,n,r){n=n||{};var i=this._getContext(n.context),s=n.location&&n.location.scope==="default"?!0:!1,o=n.location||this.getPreferenceLocation(e,i);if(!o||o.scope==="default"&&!s){var u=this._getScopeOrder(i);if(!(u.length>1))return{valid:!0,stored:!1};o={scope:u[u.length-2]}}var a=this._scopes[o.scope];if(!a)return{valid:!0,stored:!1};var f=this.getPreference(e),l=f&&f.validator;if(l&&!l(t))return{valid:!1,stored:!1};var c=a.set(e,t,i,o);return c&&(r||this.save(),this._triggerChange({ids:[e]})),{valid:!0,stored:c}},save:function(){if(this.finalized)return console.log("PreferencesSystem.save() called after finalized!"),(new $.Deferred).reject().promise();if(this._saveInProgress)return this._nextSaveDeferred||(this._nextSaveDeferred=new $.Deferred),this._nextSaveDeferred.promise();var e=this._nextSaveDeferred||new $.Deferred;return this._saveInProgress=e,this._nextSaveDeferred=null,a.doInParallel(u.values(this._scopes),function(e){return e?e.save():(new $.Deferred).resolve().promise()}.bind(this)).then(function(){this._saveInProgress=null,this._nextSaveDeferred&&this.save(),e.resolve()}.bind(this)).fail(function(t){e.reject(t)}),e.promise()},setDefaultFilename:function(e){var t=this._defaultContext.filename;if(t===e)return;var n=[];u.each(this._scopes,function(r){var i=r.defaultFilenameChanged(e,t);i&&n.push(i)}),this._defaultContext.filename=e,n=u.union.apply(null,n),n.length>0&&this._triggerChange({ids:n})},buildContext:function(e){return u.defaults(e,this._defaultContext)},on:function(e,t,n){typeof t=="function"&&(n=t,t=null);if(t){var r=this.getPreference(t);r.on(e,n)}else $(this).on(e,n)},off:function(e,t,n){typeof t=="function"&&(n=t,t=null);if(t){var r=this.getPreference(t);r.off(e,n)}else $(this).off(e,n)},_triggerChange:function(e){this._changeEventQueue?this._changeEventQueue=u.union(this._changeEventQueue,e.ids):$(this).trigger(l,e)},pauseChangeEvents:function(){this._changeEventQueue||(this._changeEventQueue=[])},resumeChangeEvents:function(){this._changeEventQueue&&($(this).trigger(l,{ids:this._changeEventQueue}),this._changeEventQueue=null)},fileChanged:function(e){u.forEach(this._scopes,function(t){t.fileChanged(e)})},getPrefixedSystem:function(e){return new w(this,e+".")},_finalize:function(){function n(){t._saveInProgress?t._saveInProgress.done(n):(t.finalized=!0,e.resolve())}var e=new $.Deferred,t=this;return n(),e.promise()}}),t.PreferencesSystem=E,t.Scope=v,t.MemoryStorage=h,t.PathLayer=y,t.ProjectLayer=g,t.FileStorage=d}),define("preferences/PreferencesImpl",["require","exports","module","./PreferencesBase","utils/Async"],function(e,t,n){function l(){return f}function S(e){var t=brackets.app.getApplicationSupportDirectory()+"/";t.indexOf(e.fullPath)===0&&(h.fileChanged(u),g.fileChanged(y))}var r=e("./PreferencesBase"),i=e("utils/Async"),s="brackets.json",o="state.json",u=brackets.app.getApplicationSupportDirectory()+"/"+s,a=new $.Deferred,f=!1,c=[],h=new r.PreferencesSystem;h.pauseChangeEvents();var p=new r.FileStorage(undefined,!0),d=new r.Scope(p),v=new r.PathLayer;d.addLayer(v);var m=h.addScope("user",new r.FileStorage(u,!0));c.push(m),m.fail(function(e){c.push(h.addScope("user",new r.MemoryStorage,{before:"default"})),e.name&&e.name==="ParsingError"&&(f=!0)}).always(function(){c.push(h.addScope("project",d,{before:"user"})),c.push(h.addScope("session",new r.MemoryStorage)),i.waitForAll(c).always(function(){a.resolve()})});var g=new r.PreferencesSystem,y=brackets.app.getApplicationSupportDirectory()+"/"+o,b=new r.Scope(new r.FileStorage(y,!0)),w=new r.ProjectLayer;b.addLayer(w);var E=g.addScope("user",b);t.manager=h,t.projectStorage=p,t.projectPathLayer=v,t.userScopeLoading=m,t.stateManager=g,t.stateProjectLayer=w,t.smUserScopeLoading=E,t.userPrefFile=u,t.isUserScopeCorrupt=l,t.managerReady=a.promise(),t.reloadUserPrefs=S,t.STATE_FILENAME=o,t.SETTINGS_FILENAME=s}),define("preferences/PreferencesManager",["require","exports","module","preferences/PreferenceStorage","utils/AppInit","utils/Async","command/Commands","command/CommandManager","utils/DeprecationWarning","file/FileUtils","utils/ExtensionLoader","preferences/PreferencesBase","filesystem/FileSystem","strings","preferences/PreferencesImpl","thirdparty/lodash"],function(e,t,n){function x(){if(!E){var e=f.getNativeBracketsDirectoryPath();E=[e+"/extensions/default/",e+"/extensions/dev/",l.getUserExtensionPath()+"/"]}return E}function T(e){var n=t._getExtensionPaths(),r,i,s;return n.some(function(t){if(e.uri.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())===0)return i=t,!0}),i?s=g+e.uri.replace(i,""):s=g+e.id,s}function N(e,t,n){if(!n){var i=typeof e=="object"?e.uri:e;a.deprecationWarning("getPreferenceStorage is called with client ID '"+i+",' use PreferencesManager.definePreference instead.")}if(!e||typeof e=="object"&&(!e.id||!e.uri)){console.error("Invalid clientID");return}typeof e=="object"&&(e=T(e));var s=b[e];if(s===undefined){if(n)return;s=t&&JSON.stringify(t)?t:{},b[e]=s}else t&&v.forEach(t,function(e,t){s[t]===undefined&&(s[t]=e)});return new r(e,s)}function C(){w.setItem(y,JSON.stringify(b))}function k(){b={},w.setItem(y,JSON.stringify(b))}function L(e){w=e,S&&(b=JSON.parse(w.getItem(y))),b||k()}function _(e){return e=e||A,!e||!O?!1:f.getRelativeFilename(O,e)!==undefined}function D(){return d.userPrefFile}function P(){if(_()===M)return;M?d.manager.removeFromScopeOrder("project"):d.manager.addToScopeOrder("project","user"),M=!M}function H(e){O=f.getDirectoryPath(e),P(),d.projectPathLayer.setPrefFilePath(e),d.projectStorage.setPath(e)}function B(e){A=e,P(),d.manager.setDefaultFilename(e)}function j(e){return d.manager.getPrefixedSystem(e)}function F(e,t,n,r){d.smUserScopeLoading.done(function(){d.userScopeLoading.done(function(){if(!e||typeof e=="object"&&(!e.id||!e.uri)){console.error("Invalid clientID");return}var i=N(e,null,!0);if(!i)return;var s=typeof e=="object"?T(e):e;b.convertedKeysMap===undefined&&(b.convertedKeysMap={});var o=b.convertedKeysMap;i.convert(t,o[s],n,r).done(function(e,t){b.convertedKeysMap[s]=t,C()})}).fail(function(t){console.error("Error while converting ",typeof e=="object"?T(e):e),console.error(t)})})}function z(e,t){var n=e.indexOf("project")>-1;if(n===t)return e;var r;if(t){var i=e.indexOf("user");i===-1&&(i=e.length-2),r=v.first(e,i),r.push("project"),r.push.apply(r,v.rest(e,i))}else r=v.without(e,"project");return r}function W(e){return typeof e=="string"&&(e={filename:e},e.scopeOrder=_(e.filename)?R:U),e}function X(){var e=d.manager.buildContext({});delete e.filename,R=z(e.scopeOrder,!0),U=z(e.scopeOrder,!1),I.scopeOrder=R}function V(){var e=D(),t=h.getFileForPath(e);t.exists(function(n,r){r?u.execute(o.FILE_OPEN,{fullPath:e}):f.writeText(t,"",!0).done(function(){u.execute(o.FILE_OPEN,{fullPath:e})})})}function $(e,n,r){a.deprecationWarning("setValueAndSave called for "+e+". Use set instead.");var i=t.set(e,n,r).stored;return d.manager.save(),i}function J(e,t){return d.stateManager.get(e,t)}function K(e,t,n,r){d.stateManager.set(e,t,n),r||d.stateManager.save()}function Q(){var e=[d.managerReady,d.smUserScopeLoading,d.manager._finalize(),d.stateManager._finalize()],t=function(e){return e};return s.doSequentially(e,t,!1)}var r=e("preferences/PreferenceStorage").PreferenceStorage,i=e("utils/AppInit"),s=e("utils/Async"),o=e("command/Commands"),u=e("command/CommandManager"),a=e("utils/DeprecationWarning"),f=e("file/FileUtils"),l=e("utils/ExtensionLoader"),c=e("preferences/PreferencesBase"),h=e("filesystem/FileSystem"),p=e("strings"),d=e("preferences/PreferencesImpl"),v=e("thirdparty/lodash"),m="com.adobe.brackets.preferences",g="com.adobe.brackets.",y,b,w,E,S=!1;y=localStorage.getItem("preferencesKey"),y?S=!!localStorage.getItem("doLoadPreferences"):(y=m,S=!0),L(localStorage),t.getPreferenceStorage=N,t.savePreferences=C,t.getClientID=T,t._reset=k,t._getExtensionPaths=x;var A=null,O=null,M=!0,I={},q,R=null,U=null;d.manager.contextNormalizer=W,X(),d.manager.on("scopeOrderChange",X),u.register(p.CMD_OPEN_PREFERENCES,o.FILE_OPEN_PREFERENCES,V),i.appReady(function(){d.manager.resumeChangeEvents()}),t._isUserScopeCorrupt=d.isUserScopeCorrupt,t._manager=d.manager,t._setCurrentEditingFile=B,t._setProjectSettingsFile=H,t._smUserScopeLoading=d.smUserScopeLoading,t._stateProjectLayer=d.stateProjectLayer,t._reloadUserPrefs=d.reloadUserPrefs,t.CURRENT_FILE=q,t.CURRENT_PROJECT=I,t.ready=d.managerReady,t.getUserPrefFile=D,t.get=d.manager.get.bind(d.manager),t.set=d.manager.set.bind(d.manager),t.save=d.manager.save.bind(d.manager),t.on=d.manager.on.bind(d.manager),t.off=d.manager.off.bind(d.manager),t.getPreference=d.manager.getPreference.bind(d.manager),t.getExtensionPrefs=j,t.setValueAndSave=$,t.getViewState=J,t.setViewState=K,t.finalize=Q,t.addScope=d.manager.addScope.bind(d.manager),t.stateManager=d.stateManager,t.FileStorage=c.FileStorage,t.SETTINGS_FILENAME=d.SETTINGS_FILENAME,t.definePreference=d.manager.definePreference.bind(d.manager),t.fileChanged=d.manager.fileChanged.bind(d.manager),t.convertPreferences=F}),define("text!htmlContent/project-settings-dialog.html",[],function(){return'<div class="project-settings-dialog modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{title}}</h1>\n    </div>\n    <div class="modal-body">\n        <div class="field-container">\n            <label>\n                {{Strings.PROJECT_SETTING_BASE_URL}}: <input type="text" placeholder="{{Strings.PROJECT_SETTING_BASE_URL_HINT}}" value="{{baseUrl}}" class="url" />\n            </label>\n            {{#errorMessage}}<div class="alert" style="margin-bottom: 0">{{{errorMessage}}}</div>{{/errorMessage}}\n         </div>\n    </div>\n    <div class="modal-footer">\n        <button class="dialog-button btn" data-button-id="cancel">{{Strings.CANCEL}}</button>\n        <button class="dialog-button btn primary" data-button-id="ok">{{Strings.DONE}}</button>\n    </div>\n</div>\n'}),define("preferences/PreferencesDialogs",["require","exports","module","thirdparty/path-utils/path-utils.min","widgets/Dialogs","preferences/PreferencesManager","project/ProjectManager","utils/StringUtils","strings","text!htmlContent/project-settings-dialog.html"],function(e,t,n){function f(e){var t="";if(e==="")return t;var n=PathUtils.parseUrl(e);if(!n)t=u.BASEURL_ERROR_UNKNOWN_ERROR;else if(n.href.search(/^(http|https):\/\//i)!==0)t=o.format(u.BASEURL_ERROR_INVALID_PROTOCOL,n.href.substring(0,n.href.indexOf("//")));else if(n.search!=="")t=o.format(u.BASEURL_ERROR_SEARCH_DISALLOWED,n.search);else if(n.hash!=="")t=o.format(u.BASEURL_ERROR_HASH_DISALLOWED,n.hash);else{var r=e.search(/[ \^\[\]\{\}<>\\"\?]+/);r!==-1&&(t=o.format(u.BASEURL_ERROR_INVALID_CHAR,e[r]))}return t}function l(e,t){var n,i,c="",h=s.getProjectRoot(),p;h&&(c=h.name),p=o.format(u.PROJECT_SETTINGS_TITLE,c);var d={title:p,baseUrl:e,errorMessage:t,Strings:u};return i=r.showModalDialogUsingTemplate(Mustache.render(a,d)),i.done(function(e){if(e===r.DIALOG_BTN_OK){var t=n.val(),i=f(t);i===""?s.setBaseUrl(t):l(t,i)}}),n=i.getElement().find(".url"),n.focus(),i}e("thirdparty/path-utils/path-utils.min");var r=e("widgets/Dialogs"),i=e("preferences/PreferencesManager"),s=e("project/ProjectManager"),o=e("utils/StringUtils"),u=e("strings"),a=e("text!htmlContent/project-settings-dialog.html");t._validateBaseUrl=f,t.showProjectPreferencesDialog=l}),define("utils/Resizer",["require","exports","module","utils/AppInit","preferences/PreferencesManager"],function(e,t,n){function d(e){var t=$(e).data("show");t&&t.apply(e)}function v(e){var t=$(e).data("hide");t&&t.apply(e)}function m(e){$(e).is(":visible")?v(e):d(e)}function g(e){return $(e).is(":visible")}function y(e,n,r,l,h,d,g){function M(e){d!==undefined&&$(d,w).css("left",e)}function _(e,t){L.apply(b,[e]),E.length&&O.apply(E,[t])}function D(e){var t=e||1;(r===a||r===o)&&y.css(A,t)}var y=$('<div class="'+n+'-resizer"></div>'),b=$(e),w=b.parent(),E=$(b.find(".resizable-content:first")[0]),S=$(window.document.body),x=b.attr("id"),T=c.getViewState(x)||{},N=null,C=n===i?"clientX":"clientY",k=r===s||r===u?1:-1,L=n===i?b.width:b.height,A=n===i?"left":"top",O=n===i?E.width:E.height;if(!x){console.error("Resizable panels must have a DOM id to use as a preferences key:",e);return}l===undefined&&(l=f),h=h||!1,b.prepend(y),b.css("box-sizing","border-box"),w[0]&&w.is(".content")&&!g&&(console.warn("Deprecated: resizable panels should be created via PanelManager.createBottomPanel(). Using Resizer directly will stop working in the future. \nElement:",e),$(t).triggerHandler("deprecatedPanelAdded",[b])),b.data("show",function(){var e=b.offset(),t=L.apply(b)||T.size,n=O.apply(E)||T.contentSize,i=L.apply(y);_(t,n),b.show(),T.visible=!0,h&&(b.prepend(y),r===s?y.css(A,""):r===a&&y.css(A,e[A]+t)),M(t),b.trigger("panelExpanded",[t]),c.setViewState(x,T,null,p)}),b.data("hide",function(){var e=b.offset(),t=L.apply(b),n=L.apply(y);b.hide(),T.visible=!1,h&&(y.insertBefore(b),r===a?y.css(A,""):r===s&&y.css(A,e[A]+t-n)),M(0),b.trigger("panelCollapsed",[t]),c.setViewState(x,T,null,p)}),y.on("mousedown",function(e){function d(){if(!p)return;o!==u&&(u=o,b.is(":visible")?o<10?(m(b),L.apply(b,[0])):(f||(f=!0,b.trigger("panelResizeStart",o)),_(o,o-a),M(o),b.trigger("panelResizeUpdate",[o])):o>10&&(L.apply(b,[o]),m(b),f||(f=!0,b.trigger("panelResizeStart",o)))),N=window.requestAnimationFrame(d)}function v(e){o=Math.max(s+k*(r-e[C]),l);var t=b.data("maxsize");t!==undefined&&(o=Math.min(o,t)),e.preventDefault(),N===null&&(N=window.requestAnimationFrame(d))}function g(e){if(p){var n=L.apply(b);b.is(":visible")&&(T.size=n,E.length&&(T.contentSize=O.apply(E)),c.setViewState(x,T),D(n)),p=!1,f&&b.trigger("panelResizeEnd",[n]),window.setTimeout(function(){$(window.document).off("mousemove",v),t.off("mousedown"),t.remove(),N=null},300)}}var t=$("<div class='resizing-container "+n+"-resizing' />"),r=e[C],s=b.is(":visible")?L.apply(b):0,o=s,u=s,a=0,f=!1;p=!0,S.append(t),E.length&&b.children().not(".horz-resizer, .vert-resizer, .resizable-content").each(function(e,t){n===i?a+=$(t).outerWidth():a+=$(t).outerHeight()}),$(window.document).on("mousemove",v),h&&t.on("mousedown",function(e){$(window.document).off("mousemove",v),t.off("mousedown"),t.remove(),N=null,m(b)}),$(window.document).one("mouseup",g),e.preventDefault()}),T&&(T.size!==undefined&&L.apply(b,[T.size]),T.contentSize!==undefined&&O.apply(E,[T.contentSize]),T.visible!==undefined&&!T.visible?v(b):(M(L.apply(b)),D(L.apply(b))))}function b(e){return e?"user":null}var r="vert",i="horz",s="top",o="bottom",u="left",a="right",f=100,l=e("utils/AppInit"),c=e("preferences/PreferencesManager"),h,p=!1;l.htmlReady(function(){var e=f;h=$(".main-view"),$(".vert-resizable").each(function(t,n){$(n).data().minsize!==undefined&&(e=$(n).data().minsize),$(n).hasClass("top-resizer")&&y(n,r,s,e,$(n).hasClass("collapsible"))}),$(".horz-resizable").each(function(t,n){$(n).data().minsize!==undefined&&(e=$(n).data().minsize),$(n).hasClass("right-resizer")&&y(n,i,a,e,$(n).hasClass("collapsible"),$(n).data().forceleft)})}),c.convertPreferences(n,{panelState:"user"},!0,b),t.makeResizable=y,t.toggle=m,t.show=d,t.hide=v,t.isVisible=g,t.DIRECTION_VERTICAL=r,t.DIRECTION_HORIZONTAL=i,t.POSITION_TOP=s,t.POSITION_RIGHT=a}),define("view/PanelManager",["require","exports","module","utils/AppInit","utils/Resizer"],function(e,t,n){function a(){var e=s.height();return o.siblings().each(function(t,n){var r=$(n);r.css("display")!=="none"&&r.css("position")!=="absolute"&&(e-=r.outerHeight())}),Math.max(e,0)}function f(){var e=o.height();o.siblings().each(function(t,n){var r=$(n);r.css("display")==="none"?r.data("maxsize",e):r.data("maxsize",e+r.outerHeight())})}function l(e){var n=a();o.height(n),$(t).trigger("editorAreaResize",[n,e])}function c(){if(!s||!o)return;l(),u||(u=!0,$(window.document).one("mousemove",function(){u=!1,f()}))}function h(e){e.on("panelCollapsed panelExpanded panelResizeUpdate",function(){l()}),e.on("panelCollapsed panelExpanded panelResizeEnd",function(){f()})}function p(e,t){this.$panel=e,i.makeResizable(e[0],i.DIRECTION_VERTICAL,i.POSITION_TOP,t,!1,undefined,!0),h(e)}function d(e,t,n){return t.insertBefore("#status-bar"),t.hide(),f(),new p(t,n)}function v(e){l(e),f()}function m(e,t){s=e,o=t}var r=e("utils/AppInit"),i=e("utils/Resizer"),s,o,u=!1;p.prototype.$panel=null,p.prototype.isVisible=function(){return this.$panel.is(":visible")},p.prototype.show=function(){i.show(this.$panel[0])},p.prototype.hide=function(){i.hide(this.$panel[0])},p.prototype.setVisible=function(e){e?i.show(this.$panel[0]):i.hide(this.$panel[0])},r.htmlReady(function(){s=$(".content"),o=$("#editor-holder"),h($("#sidebar"))}),$(i).on("deprecatedPanelAdded",function(e,t){h(t)}),window.addEventListener("resize",c,!0),t.createBottomPanel=d,t._notifyLayoutChange=v,t._setMockDOM=m}),define("utils/AnimationUtils",["require","exports","module","utils/Async"],function(e,t,n){function i(e,t,n){function o(t){t.target===e&&i.resolve()}function u(){s.removeClass(t).off("webkitTransitionEnd",o)}var i=new $.Deferred,s=$(e);return n=n||400,s.is(":hidden")?i.resolve():s.addClass(t).on("webkitTransitionEnd",o),r.withTimeout(i.promise(),n,!0).done(u)}var r=e("utils/Async");t.animateUsingClass=i}),define("widgets/PopUpManager",["require","exports","module","utils/AppInit","command/CommandManager","editor/EditorManager","utils/KeyEvent","command/Menus"],function(e,t,n){function f(e,t,n){n=n||!1,a.push(e[0]),e.data("PopUpManager-autoRemove",n),e.data("PopUpManager-removeHandler",t)}function l(e){if(e.find(":visible").length>0){var t=e.data("PopUpManager-removeHandler");t&&t()}var n=a.indexOf(e[0]);if(n>=0){var r=e.data("PopUpManager-autoRemove");r&&(e.remove(),a.splice(n,1))}}function c(e){var t,n,r=new $.Event("popUpClose");for(n=a.length-1;n>=0;n--){t=$(a[n]);if(t.find(":visible").length>0){t.trigger(r),r.isDefaultPrevented()||(e&&e.stopImmediatePropagation(),l(t));break}}}function h(e){if(e.keyCode!==o.DOM_VK_ESCAPE&&(e.keyCode!==o.DOM_VK_ALT||brackets.platform!=="win"))return;if(e.keyCode===o.DOM_VK_ALT&&e.ctrlKey)return;c(e)}function p(){c()}function d(e){$(e).on("beforeContextMenuOpen",p)}var r=e("utils/AppInit"),i=e("command/CommandManager"),s=e("editor/EditorManager"),o=e("utils/KeyEvent"),u=e("command/Menus"),a=[];r.htmlReady(function(){window.document.body.addEventListener("keydown",h,!0),$(t).on("beforeMenuPopup",p),$(i).on("beforeExecuteCommand",function(e,t){c()})}),t.addPopUp=f,t.removePopUp=l,t.listenToContextMenu=d}),define("utils/ViewUtils",["require","exports","module","thirdparty/lodash","file/FileUtils"],function(e,t,n){function u(e,t,n,r,i){var o=0,u=t.get(0),a=u.scrollTop,f=Math.min(a-s,0),l=e.width();n&&(n.css("background-position","0px "+f+"px"),i&&(o=e.offset().top,n.css("top",o)),i&&n.css("width",l));if(r){var c=u.clientHeight,h=e.outerHeight(),p=u.scrollHeight,d=h-c,v=s;p>c&&(v-=Math.min(s,p-(a+c))),r.css("background-position","0px "+v+"px"),r.css("top",o+h-s),r.css("width",l)}}function a(e,t,n){var r=e.find(".scroller-shadow."+t);return r.length===0&&(r=$(window.document.createElement("div")).addClass("scroller-shadow "+t),e.append(r)),n||(r.css("position","absolute"),r.css(t,"0")),r}function f(e,t,n){var r=!1;t||(t=e,r=!0);var i=$(e),s=$(t),o=a(i,"top",r),f=n?a(i,"bottom",r):null,l=function(){u(i,s,o,f,r)};s.on("scroll.scroller-shadow",l),i.on("contentChanged.scroller-shadow",l),l()}function l(e,t){t||(t=e);var n=$(e),r=$(t);n.find(".scroller-shadow.top").remove(),n.find(".scroller-shadow.bottom").remove(),r.off("scroll.scroller-shadow"),n.off("contentChanged.scroller-shadow")}function c(e,t,n){n?e.addClass(t):e.removeClass(t)}function h(e,t,n){var r=e.find("ul"),i,s,u=$("#sidebar"),a=!0;i=$(window.document.createElement("div")).addClass("sidebar-selection"),e.prepend(i),e.css("overflow","auto"),e.css("position","relative"),s=$(window.document.createElement("div")).addClass("sidebar-selection-triangle"),e.append(s),t="."+(t||"selected");var f=function(){var t=i.height(),n=i.offset(),r=e.offset(),o=s.outerHeight(),f=r.top,l=f+e.outerHeight(),h=r.left,p=n.top;s.css("top",p),s.css("left",u.width()-s.outerWidth()),c(s,"triangle-visible",a);var d=Math.floor((t-o)/2),v=p+o+d;p<f||v>l?s.css("clip","rect("+Math.max(f-p-d,0)+"px, auto, "+(o-Math.max(v-l,0))+"px, auto)"):s.css("clip","")},l=function(o,u){var l=r.find(t).closest("li");n&&(a=l.hasClass(n)),s.hide(),i.hide();if(l.length===1){var c=l.offset().top-e.offset().top+e.get(0).scrollTop;i.width(e.get(0).scrollWidth),i.css("top",c),i.show(),f(),s.show();var h=e.get(0),p=h.clientHeight,d=i.height(),v=c+d,m=h.scrollTop+p;u&&(c>=m?l.get(0).scrollIntoView(!1):v<=h.scrollTop&&l.get(0).scrollIntoView(!0))}};r.on("selectionChanged",l),e.on("scroll",f),e.on("selectionRedraw",f),l(),o.push(f)}function p(){o.forEach(function(e){e.apply()})}function d(e,t){var n,r={top:0,right:0,bottom:0,left:0},i=e.offset()||{top:0,left:0},s=e.get(0);return n=t.top+t.height-(i.top+e.height()),n>0&&(r.bottom=n),n=i.top-t.top,n>0&&(r.top=n),n=i.left-t.left,n>0&&(r.left=n),n=t.left+t.width-(i.left+e.width()),n>0&&(r.right=n),r}function v(e,t,n){var r=e.offset(),i=e.get(0),s=t.get(0),o=t.offset(),u={top:o.top,left:o.left,height:t.height(),width:t.width()},a=d(e,u);a.bottom>0?e.scrollTop(e.scrollTop()+a.bottom):a.top>0&&e.scrollTop(e.scrollTop()-a.top),n&&(a.left>0?e.scrollLeft(e.scrollLeft()-a.left):a.right>0&&e.scrollLeft(e.scrollLeft()+a.right))}function m(e){var t=e.name,n=i.getSmartFileExtension(t),s=t.lastIndexOf("."+n);return s>0?t=r.escape(t.substring(0,s))+"<span class='extension'>"+r.escape(t.substring(s))+"</span>":t=r.escape(t),t}function g(e){if(e.length<=1)return[];var t={},n=[],i=[];e.forEach(function(e,r){var s=e.fullPath.split("/");s.pop(),i[r]=s.pop(),n[r]=s,t[i[r]]?t[i[r]].push(r):t[i[r]]=[r]});var s=function(e){var t=!1;return r.forEach(e,function(r,s){r.length>1&&r.forEach(function(r){n[r].length!==0&&(i[r]=n[r].pop()+"/"+i[r],t=!0,e[i[r]]?e[i[r]].push(r):e[i[r]]=[r])}),delete e[s]}),t},o;do o=s(t);while(o);return i}var r=e("thirdparty/lodash"),i=e("file/FileUtils"),s=5,o=[];$(window).resize(p),t.SCROLL_SHADOW_HEIGHT=s,t.addScrollerShadow=f,t.removeScrollerShadow=l,t.sidebarList=h,t.scrollElementIntoView=v,t.getElementClipSize=d,t.getFileEntryDisplay=m,t.toggleClass=c,t.getDirNamesForDuplicateFiles=g}),define("command/Menus",["require","exports","module","thirdparty/lodash","utils/Global","command/Commands","command/KeyBindingManager","utils/StringUtils","command/CommandManager","widgets/PopUpManager","utils/ViewUtils","utils/DeprecationWarning"],function(e,t,n){function A(e){return C[e]}function O(){return C}function M(e){return k[e]}function _(e){return!!M(e)}function D(e){return!brackets.nativeMenus||_(e)}function P(e){return L[e]}function H(e){return $("#"+u.jQueryIdEscape(e)).get(0)}function B(e){return $("#"+u.jQueryIdEscape(e)).get(0)}function j(e,t,n){var r=e.find(".menu-shortcut");r.length===0&&(r=$("<span class='menu-shortcut' />"),e.append(r)),r.data("key",t),r.text(o.formatKeyDescriptor(n))}function F(e){var t=o.getKeyBindings(e.getCommand().getID()),n=null;return t.length>0&&(n=t[t.length-1],j($(B(e.id)),n.key,n.displayKey)),n}function q(){return"brackets-menuDivider-"+I++}function R(e,t,n,r){var i=!1;n&&(n===b?n=v:n===w&&(n=m),n===g?(e.prepend(t),i=!0):r&&r.length>0&&(n===m?(r.after(t),i=!0):n===v&&(r.before(t),i=!0))),i||e.append(t)}function U(e,t){this.id=e,this.isDivider=t===E,this.isNative=!1,this.isDivider||(this._enabledChanged=this._enabledChanged.bind(this),this._checkedChanged=this._checkedChanged.bind(this),this._nameChanged=this._nameChanged.bind(this),this._keyBindingAdded=this._keyBindingAdded.bind(this),this._keyBindingRemoved=this._keyBindingRemoved.bind(this),this._command=t,$(this._command).on("enabledStateChange",this._enabledChanged).on("checkedStateChange",this._checkedChanged).on("nameChange",this._nameChanged).on("keyBindingAdded",this._keyBindingAdded).on("keyBindingRemoved",this._keyBindingRemoved))}function z(e){this.id=e}function W(){$(".dropdown").removeClass("open")}function X(e,t,n,i){e=r.escape(e);var s=$("#titlebar .nav"),o;if(!e||!t)return console.error("call to addMenu() is missing required parameters"),null;if(C[t])return console.log("Menu added with same name and id of existing Menu: "+t),null;o=new z(t),C[t]=o;if(!D(t))return brackets.app.addMenu(e,t,n,i,function(n){switch(n){case S:brackets.app.setMenuTitle(t,e,function(e){e&&console.error("setMenuTitle() -- error: "+e)});break;case x:console.error("addMenu(): Unknown Error when adding the menu "+t);break;case T:console.error("addMenu(): Invalid Parameters when adding the menu "+t);break;case N:console.error("addMenu(): Menu with command "+i+" could not be found when adding the menu "+t);break;default:console.error("addMenu(): Unknown Error ("+n+") when adding the menu "+t)}}),o;var u=$("<a href='#' class='dropdown-toggle' data-toggle='dropdown'>"+e+"</a>"),a=$("<ul class='dropdown-menu'></ul>"),l=$("<li class='dropdown' id='"+t+"'></li>").append(u).append(a),c=i&&$(H(i));return R(s,l,n,c),f.addPopUp(a,W,!1),o}function V(e){var t,n="";if(!e){console.error("removeMenu(): missing required parameter: id");return}if(!C[e]){console.error("removeMenu(): menu id not found: %s",e);return}t=A(e),r.forEach(L,function(r,i){i.substring(0,e.length)===e&&(r.isDivider?t.removeMenuDivider(i):(n=r.getCommand(),t.removeMenuItem(n)))}),D(e)?$(H(e)).remove():brackets.app.removeMenu(e,function(t){t&&console.error("removeMenu() -- id not found: "+e+" (error: "+t+")")}),delete C[e]}function J(e){z.apply(this,arguments);var t=$("<li class='dropdown context-menu' id='"+u.jQueryIdEscape(e)+"'></li>"),n=$("<ul class='dropdown-menu'></ul>"),r=$("<a href='#' class='dropdown-toggle' data-toggle='dropdown'></a>").hide();t.append(r).append(n),$("#context-menu-bar > ul").append(t);var i=this;f.addPopUp(n,function(){i.close()},!1),f.listenToContextMenu(this)}function K(e){if(!e)return console.error("call to registerContextMenu() is missing required parameters"),null;if(k[e])return console.log("Context Menu added with same name and id of existing Context Menu: "+e),null;var t=new J(e);return k[e]=t,t}var r=e("thirdparty/lodash"),i=e("utils/Global"),s=e("command/Commands"),o=e("command/KeyBindingManager"),u=e("utils/StringUtils"),a=e("command/CommandManager"),f=e("widgets/PopUpManager"),l=e("utils/ViewUtils"),c=e("utils/DeprecationWarning"),h={FILE_MENU:"file-menu",EDIT_MENU:"edit-menu",FIND_MENU:"find-menu",VIEW_MENU:"view-menu",NAVIGATE_MENU:"navigate-menu",HELP_MENU:"help-menu"},p={EDITOR_MENU:"editor-context-menu",INLINE_EDITOR_MENU:"inline-editor-context-menu",PROJECT_MENU:"project-context-menu",WORKING_SET_MENU:"working-set-context-menu",WORKING_SET_SETTINGS_MENU:"working-set-settings-context-menu"},d={FILE_OPEN_CLOSE_COMMANDS:{sectionMarker:s.FILE_NEW},FILE_SAVE_COMMANDS:{sectionMarker:s.FILE_SAVE},FILE_LIVE:{sectionMarker:s.FILE_LIVE_FILE_PREVIEW},FILE_EXTENSION_MANAGER:{sectionMarker:s.FILE_EXTENSION_MANAGER},EDIT_UNDO_REDO_COMMANDS:{sectionMarker:s.EDIT_UNDO},EDIT_TEXT_COMMANDS:{sectionMarker:s.EDIT_CUT},EDIT_SELECTION_COMMANDS:{sectionMarker:s.EDIT_SELECT_ALL},EDIT_MODIFY_SELECTION:{sectionMarker:s.EDIT_INDENT},EDIT_COMMENT_SELECTION:{sectionMarker:s.EDIT_LINE_COMMENT},EDIT_CODE_HINTS_COMMANDS:{sectionMarker:s.SHOW_CODE_HINTS},EDIT_TOGGLE_OPTIONS:{sectionMarker:s.TOGGLE_CLOSE_BRACKETS},EDIT_FIND_COMMANDS:{sectionMarker:s.TOGGLE_CLOSE_BRACKETS},EDIT_REPLACE_COMMANDS:{sectionMarker:s.TOGGLE_CLOSE_BRACKETS},FIND_FIND_COMMANDS:{sectionMarker:s.CMD_FIND},FIND_FIND_IN_COMMANDS:{sectionMarker:s.CMD_FIND_IN_FILES},FIND_REPLACE_COMMANDS:{sectionMarker:s.CMD_REPLACE},VIEW_HIDESHOW_COMMANDS:{sectionMarker:s.VIEW_HIDE_SIDEBAR},VIEW_FONTSIZE_COMMANDS:{sectionMarker:s.VIEW_INCREASE_FONT_SIZE},VIEW_TOGGLE_OPTIONS:{sectionMarker:s.TOGGLE_ACTIVE_LINE},NAVIGATE_GOTO_COMMANDS:{sectionMarker:s.NAVIGATE_QUICK_OPEN},NAVIGATE_DOCUMENTS_COMMANDS:{sectionMarker:s.NAVIGATE_NEXT_DOC},NAVIGATE_OS_COMMANDS:{sectionMarker:s.NAVIGATE_SHOW_IN_FILE_TREE},NAVIGATE_QUICK_EDIT_COMMANDS:{sectionMarker:s.TOGGLE_QUICK_EDIT},NAVIGATE_QUICK_DOCS_COMMANDS:{sectionMarker:s.TOGGLE_QUICK_DOCS}},v="before",m="after",g="first",y="last",b="firstInSection",w="lastInSection",E="---",S=0,x=1,T=2,N=3,C={},k={},L={},I=1;z.prototype._getMenuItemId=function(e){return this.id+"-"+e},z.prototype._getMenuItemForCommand=function(e){if(!e)return null;var t=L[this._getMenuItemId(e.getID())];return t?$(B(t.id)).closest("li"):null},z.prototype._getRelativeMenuItem=function(e,t){var n;if(e){if(t===b||t===w){if(!e.hasOwnProperty("sectionMarker"))return console.error("Bad Parameter in _getRelativeMenuItem(): relativeID must be a MenuSection when position refers to a menu section"),null;var r=this._getMenuItemForCommand(a.get(e.sectionMarker));if(!r)return console.error("_getRelativeMenuItem(): MenuSection "+e.sectionMarker+" not found in Menu "+this.id),null;var i=r;n=i;for(;;){i=t===b?i.prev():i.next();if(i.length===0)break;if(i.find(".divider").length>0)break;n=i}}else{if(e.hasOwnProperty("sectionMarker"))return console.error("Bad Parameter in _getRelativeMenuItem(): if relativeID is a MenuSection, position must be FIRST_IN_SECTION or LAST_IN_SECTION"),null;var s=a.get(e);s&&(n=this._getMenuItemForCommand(s));if(!n)return console.error("_getRelativeMenuItem(): MenuItem with Command id "+e+" not found in Menu "+this.id),null}return n}return t&&t!==g&&t!==y?(console.error("Bad Parameter in _getRelativeMenuItem(): relative position specified with no relativeID"),null):n},z.prototype.removeMenuItem=function(e){var t,n;if(!e){console.error("removeMenuItem(): missing required parameters: command");return}if(typeof e=="string"){var r=a.get(e);if(!r){console.error("removeMenuItem(): command not found: "+e);return}n=e}else n=e.getID();t=this._getMenuItemId(n),D(this.id)?$(B(t)).parent().remove():brackets.app.removeMenuItem(n,function(e){e&&console.error("removeMenuItem() -- command not found: "+n+" (error: "+e+")")}),delete L[t]},z.prototype.removeMenuDivider=function(e){var t,n;if(!e){console.error("removeMenuDivider(): missing required parameters: menuItemID");return}t=P(e);if(!t){console.error("removeMenuDivider(): parameter menuItemID: %s is not a valid menu item id",e);return}if(!t.isDivider){console.error("removeMenuDivider(): parameter menuItemID: %s is not a menu divider",e);return}if(D(this.id)){n=$(B(e)).parent();if(!n){console.error("removeMenuDivider(): HTML menu divider not found: %s",e);return}n.remove()}else brackets.app.removeMenuItem(t.dividerId,function(t){t&&console.error("removeMenuDivider() -- divider not found: %s (error: %s)",e,t)});if(!L[e]){console.error("removeMenuDivider(): menu divider not found in menuItemMap: %s",e);return}delete L[e]},z.prototype.addMenuItem=function(e,t,n,r){var i=this.id,s,f,l,h,p,v;r===d.EDIT_FIND_COMMANDS?(c.deprecationWarning("Add "+e+" Command to the Find Menu instead of the Edit Menu.",!0),c.deprecationWarning("Use MenuSection.FIND_FIND_COMMANDS instead of MenuSection.EDIT_FIND_COMMANDS.",!0)):r===d.EDIT_REPLACE_COMMANDS&&(c.deprecationWarning("Add "+e+" Command to the Find Menu instead of the Edit Menu.",!0),c.deprecationWarning("Use MenuSection.FIND_REPLACE_COMMANDS instead of MenuSection.EDIT_REPLACE_COMMANDS.",!0));if(!e)return console.error("addMenuItem(): missing required parameters: command"),null;if(typeof e=="string")if(e===E)p=E,v=q();else{v=e,e=a.get(v);if(!e)return console.error("addMenuItem(): commandID not found: "+v),null;p=e.getName()}else v=e.getID(),p=e.getName();s=this._getMenuItemId(v);if(L[s])return console.log("MenuItem added with same id of existing MenuItem: "+s),null;h=new U(s,e),L[s]=h;if(D(this.id)){p===E?f=$("<li><hr class='divider' id='"+s+"' /></li>"):(f=$("<li><a href='#' id='"+s+"'> <span class='menu-name'></span></a></li>"),f.on("click",function(){h._command.execute()}));var m=this._getRelativeMenuItem(r,n);R($("li#"+u.jQueryIdEscape(this.id)+" > ul.dropdown-menu"),f,n,m)}else{var g=o.getKeyBindings(v),y,x="",C="";g&&g.length>0&&(y=g[g.length-1],x=y.displayKey||y.key),x.length>0&&(C=o.formatKeyDescriptor(x));if(n===b||n===w){if(!r.hasOwnProperty("sectionMarker"))return console.error("Bad Parameter in _getRelativeMenuItem(): relativeID must be a MenuSection when position refers to a menu section"),null;r=r.sectionMarker}brackets.app.addMenuItem(this.id,p,v,x,C,n,r,function(e){switch(e){case S:break;case T:console.error("addMenuItem(): Invalid Parameters when adding the command "+v);break;case N:console.error("_getRelativeMenuItem(): MenuItem with Command id "+r+" not found in the Menu "+i);break;default:console.error("addMenuItem(); Unknown Error ("+e+") when adding the command "+v)}}),h.isNative=!0}return h.isDivider?h.dividerId=v:(t&&(Array.isArray(t)||(t=[t])),o.addBinding(v,t),F(h,v),h._checkedChanged(),h._enabledChanged(),h._nameChanged()),h},z.prototype.addMenuDivider=function(e,t){return this.addMenuItem(E,"",e,t)},U.prototype.getCommand=function(){return this._command},U.prototype.getParentMenu=function(){var e=$(B(this.id)).parents(".dropdown").get(0);return e?A(e.id):null},U.prototype._checkedChanged=function(){var e=!!this._command.getChecked();if(this.isNative){var t=!!this._command.getEnabled();brackets.app.setMenuItemState(this._command.getID(),t,e,function(e){e&&console.log("Error setting menu item state: "+e)})}else l.toggleClass($(B(this.id)),"checked",e)},U.prototype._enabledChanged=function(){if(this.isNative){var e=!!this._command.getEnabled(),t=!!this._command.getChecked();brackets.app.setMenuItemState(this._command.getID(),e,t,function(e){e&&console.log("Error setting menu item state: "+e)})}else l.toggleClass($(B(this.id)),"disabled",!this._command.getEnabled())},U.prototype._nameChanged=function(){this.isNative?brackets.app.setMenuTitle(this._command.getID(),this._command.getName(),function(e){e&&console.log("Error setting menu title: "+e)}):$(B(this.id)).find(".menu-name").text(this._command.getName())},U.prototype._keyBindingAdded=function(e,t){if(this.isNative){var n=t.displayKey||t.key;brackets.app.setMenuItemShortcut(this._command.getID(),n,o.formatKeyDescriptor(n),function(e){e&&console.error("Error setting menu item shortcut: "+e)})}else j($(B(this.id)),t.key,t.displayKey)},U.prototype._keyBindingRemoved=function(e,t){if(this.isNative)brackets.app.setMenuItemShortcut(this._command.getID(),"","",function(e){e&&console.error("Error setting menu item shortcut: "+e)});else{var n=$(B(this.id)).find(".menu-shortcut");n.length>0&&n.data("key")===t.key&&F(this)===null&&n.empty()}},J.prototype=Object.create(z.prototype),J.prototype.constructor=J,J.prototype.parentClass=z.prototype,J.prototype.open=function(e){if(!e||!e.hasOwnProperty("pageX")||!e.hasOwnProperty("pageY")){console.error("ContextMenu open(): missing required parameter");return}var t=$(window),n=u.jQueryIdEscape(this.id),r=$("#"+n),i=$("#"+n+" > ul"),s=e.pageY,o=e.pageX;if(i.children().length<=0)return;$(this).triggerHandler("beforeContextMenuOpen"),W();var a={top:s,left:o,height:i.height()+25,width:i.width()},f=l.getElementClipSize(t,a);f.bottom>0&&(s=Math.max(0,s-f.bottom)),s-=30,o+=5,f.right>0&&(o=Math.max(0,o-f.right)),r.addClass("open").css({left:o,top:s})},J.prototype.close=function(){$("#"+u.jQueryIdEscape(this.id)).removeClass("open")},J.prototype.isOpen=function(){return $("#"+u.jQueryIdEscape(this.id)).hasClass("open")},J.assignContextMenuToSelector=function(e,t){$(e).on("click",function(e){var n,r;e.stopPropagation(),t.isOpen()?t.close():(n=$(this).offset(),r=$(this).outerHeight(),t.open({pageX:n.left,pageY:n.top+r}))})},t.AppMenuBar=h,t.ContextMenuIds=p,t.MenuSection=d,t.BEFORE=v,t.AFTER=m,t.LAST=y,t.FIRST=g,t.FIRST_IN_SECTION=b,t.LAST_IN_SECTION=w,t.DIVIDER=E,t.getMenu=A,t.getAllMenus=O,t.getMenuItem=P,t.getContextMenu=M,t.addMenu=X,t.removeMenu=V,t.registerContextMenu=K,t.closeAll=W,t.Menu=z,t.MenuItem=U,t.ContextMenu=J}),define("document/TextRange",["require","exports","module"],function(e,t,n){function r(e,t,n){this.startLine=t,this.endLine=n,this.document=e,e.addRef(),this._handleDocumentChange=this._handleDocumentChange.bind(this),this._handleDocumentDeleted=this._handleDocumentDeleted.bind(this),$(e).on("change",this._handleDocumentChange),$(e).on("deleted",this._handleDocumentDeleted)}r.prototype.dispose=function(e,t){this.document.releaseRef(),$(this.document).off("change",this._handleDocumentChange),$(this.document).off("deleted",this._handleDocumentDeleted)},r.prototype.document=null,r.prototype.startLine=null,r.prototype.endLine=null,r.prototype._applySingleChangeToRange=function(e){if(!e.from||!e.to)return this.startLine=null,this.endLine=null,{hasChanged:!0,hasContentChanged:!0};if(e.from.line<this.startLine&&e.to.line>=this.startLine||e.from.line<=this.endLine&&e.to.line>this.endLine)return this.startLine=null,this.endLine=null,{hasChanged:!0,hasContentChanged:!0};var t=e.text.length-(e.to.line-e.from.line+1),n={hasChanged:!1,hasContentChanged:!1};return t!==0&&(e.to.line<this.startLine&&(this.startLine+=t,n.hasChanged=!0),e.to.line<=this.endLine&&(this.endLine+=t,n.hasChanged=!0)),e.from.line>=this.startLine&&e.from.line<=this.endLine&&(n.hasContentChanged=!0),n},r.prototype._applyChangesToRange=function(e){var t=!1,n=!1,r;for(r=0;r<e.length;r++){var i=this._applySingleChangeToRange(e[r]);t=t||i.hasChanged,n=n||i.hasContentChanged;if(this.startLine===null||this.endLine===null){$(this).triggerHandler("lostSync");break}}t&&$(this).triggerHandler("change"),n&&$(this).triggerHandler("contentChange")},r.prototype._handleDocumentChange=function(e,t,n){this._applyChangesToRange(n)},r.prototype._handleDocumentDeleted=function(e){$(this).triggerHandler("lostSync")},r.prototype.toString=function(){return"[TextRange "+this.startLine+"-"+this.endLine+" in "+this.document+"]"},t.TextRange=r}),define("utils/TokenUtils",["require","exports","module","thirdparty/CodeMirror2/lib/codemirror"],function(e,t,n){function i(e,t){return{editor:e,pos:t,token:e.getTokenAt(t,!0)}}function s(e,t){t===undefined&&(t=!0);if(e.pos.ch<=0||e.token.start<=0){if(e.pos.line<=0)return!1;e.pos.line--,e.pos.ch=e.editor.getLine(e.pos.line).length}else e.pos.ch=e.token.start;return e.token=e.editor.getTokenAt(e.pos,t),!0}function o(e,t){var n=e.editor.getLine(e.pos.line).length;t===undefined&&(t=!0);if(e.pos.ch>=n||e.token.end>=n){if(e.pos.line>=e.editor.lineCount()-1)return!1;e.pos.line++,e.pos.ch=0}else e.pos.ch=e.token.end+1;return e.token=e.editor.getTokenAt(e.pos,t),!0}function u(e,t){if(!e(t))return!1;while(!t.token.type&&!/\S/.test(t.token.string))if(!e(t))return!1;return!0}function a(e){var t=e.pos.ch-e.token.start;return t<0&&console.log("CodeHintUtils: _offsetInToken - Invalid context: pos not in the current token!"),t}function f(e,t){var n=e.getMode(),i=r.innerMode(n,e.getTokenAt(t,!0).state),s;return s=i.mode.name==="xml"?i.mode.configuration:i.mode.name,{mode:i.mode,name:s}}var r=e("thirdparty/CodeMirror2/lib/codemirror");t.movePrevToken=s,t.moveNextToken=o,t.moveSkippingWhitespace=u,t.getInitialContext=i,t.offsetInToken=a,t.getModeAt=f}),define("utils/ValidationUtils",["require","exports","module"],function(e,t,n){function r(e){return typeof e!="number"||isNaN(parseInt(e,10))?!1:e>0&&Math.floor(e)!==e?!1:e<0&&Math.ceil(e)!==e?!1:!0}function i(e,t,n){if(!r(e))return!1;var i=typeof t=="number",s=typeof n=="number";return(!i||e>=t)&&(!s||e<=n)}t.isInteger=r,t.isIntegerInRange=i}),define("editor/Editor",["require","exports","module","utils/AnimationUtils","utils/Async","thirdparty/CodeMirror2/lib/codemirror","command/Menus","utils/PerfUtils","widgets/PopUpManager","preferences/PreferencesManager","strings","document/TextRange","utils/TokenUtils","utils/ValidationUtils","utils/ViewUtils","thirdparty/lodash"],function(e,t,n){function I(e){return new s.Pos(e.line,e.ch)}function q(e){return e!==F}function R(e){return!0}function z(e,t,n,r){var i=this;U.push(this),this.document=e,e.addRef(),r&&(this._visibleRange=new c(e,r.startLine,r.endLine)),this._handleDocumentChange=this._handleDocumentChange.bind(this),this._handleDocumentDeleted=this._handleDocumentDeleted.bind(this),this._handleDocumentLanguageChanged=this._handleDocumentLanguageChanged.bind(this),$(e).on("change",this._handleDocumentChange),$(e).on("deleted",this._handleDocumentDeleted),$(e).on("languageChanged",this._handleDocumentLanguageChanged);var o=this._getModeFromDocument();this._inlineWidgets=[],this._inlineWidgetQueues={},this._hideMarks=[],this._$messagePopover=null;var u={Tab:function(){i._handleTabKey()},"Shift-Tab":"indentLess",Left:function(e){i._handleSoftTabNavigation(-1,"moveH")},Right:function(e){i._handleSoftTabNavigation(1,"moveH")},Backspace:function(e){i._handleSoftTabNavigation(-1,"deleteH")},Delete:function(e){i._handleSoftTabNavigation(1,"deleteH")},Esc:function(e){i.getSelections().length>1?s.commands.singleSelection(e):i.removeAllInlineWidgets()},"Cmd-Left":"goLineStartSmart"},a=this._currentOptions=v.zipObject(H,v.map(H,function(e){return i._getOption(e)}));this._codeMirror=new s(n,{autoCloseBrackets:a[m],autoCloseTags:a[g],coverGutterNextToScrollbar:!0,cursorScrollMargin:3,dragDrop:!1,electricChars:!1,extraKeys:u,highlightSelectionMatches:a[y],indentUnit:a[k]?a[N]:a[x],indentWithTabs:a[k],lineNumbers:a[w],lineWrapping:a[C],matchBrackets:{maxScanLineLength:5e4,maxScanLines:1e3},matchTags:{bothTags:!0},scrollPastEnd:!r&&a[b],smartIndent:a[E],styleActiveLine:a[T],tabSize:a[N]}),this._focused=!1,this._installEditorListeners(),$(this).on("cursorActivity",function(e,t){i._handleCursorActivity(e)}),$(this).on("keypress",function(e,t,n){i._handleKeypressEvents(n)}),$(this).on("change",function(e,t,n){i._handleEditorChange(n)}),this._codeMirror.setOption("mode",o),this._duringSync=!0,this._resetText(e.getText()),this._duringSync=!1,r&&(this._updateHiddenLines(),this.setCursorPos(r.startLine,0)),t&&e._makeEditable(this),Object.defineProperty(this,"scrollTop",{get:function(){return this._codeMirror.getScrollInfo().top}})}function X(e,t){return t.line<e.line||t.line===e.line&&t.ch<e.ch?{start:I(t),end:I(e),reversed:!0}:{start:I(e),end:I(t),reversed:!1}}function V(){var e={};H.forEach(function(t){e[t]="user"}),f.convertPreferences(n,e)}var r=e("utils/AnimationUtils"),i=e("utils/Async"),s=e("thirdparty/CodeMirror2/lib/codemirror"),o=e("command/Menus"),u=e("utils/PerfUtils"),a=e("widgets/PopUpManager"),f=e("preferences/PreferencesManager"),l=e("strings"),c=e("document/TextRange").TextRange,h=e("utils/TokenUtils"),p=e("utils/ValidationUtils"),d=e("utils/ViewUtils"),v=e("thirdparty/lodash"),m="closeBrackets",g="closeTags",y="highlightMatches",b="scrollPastEnd",w="showLineNumbers",E="smartIndent",S="softTabs",x="spaceUnits",T="styleActiveLine",N="tabSize",C="wordWrap",k="useTabChar",L={},A=0,O=1,M=4,_=4,D=10,P=10;L[m]="autoCloseBrackets",L[g]="autoCloseTags",L[y]="highlightSelectionMatches",L[b]="scrollPastEnd",L[w]="lineNumbers",L[E]="smartIndent",L[x]="indentUnit",L[T]="styleActiveLine",L[N]="tabSize",L[k]="indentWithTabs",L[C]="lineWrapping",f.definePreference(m,"boolean",!1),f.definePreference(g,"Object",{whenOpening:!0,whenClosing:!0,indentTags:[]}),f.definePreference(y,"boolean",!1),f.definePreference(b,"boolean",!1),f.definePreference(w,"boolean",!0),f.definePreference(E,"boolean",!0),f.definePreference(S,"boolean",!0),f.definePreference(x,"number",M,{validator:v.partialRight(p.isIntegerInRange,A,D)}),f.definePreference(T,"boolean",!1),f.definePreference(N,"number",_,{validator:v.partialRight(p.isIntegerInRange,O,P)}),f.definePreference(k,"boolean",!1),f.definePreference(C,"boolean",!0);var H=Object.keys(L),B=!1,j=0,F=1,U=[];z.prototype.destroy=function(){$(this.getRootElement()).remove(),U.splice(U.indexOf(this),1),this.document.releaseRef(),$(this.document).off("change",this._handleDocumentChange),$(this.document).off("deleted",this._handleDocumentDeleted),$(this.document).off("languageChanged",this._handleDocumentLanguageChanged),this._visibleRange&&this._visibleRange.dispose(),this.document._masterEditor===this&&this.document._makeNonEditable();var e=this;this._inlineWidgets.forEach(function(t){e._removeInlineWidgetInternal(t)})},z.prototype._checkElectricChars=function(e){var t=this._codeMirror,n=String.fromCharCode(e.which||e.keyCode);if(/[\]\{\}\)]/.test(n)){var r=this.getCursorPos(),i=t.getLine(r.line),s=i.search(/\S/);if(s===-1||s>=r.ch)s===-1&&this.setCursorPos(r.line,this.document.getLine(r.line).length),window.setTimeout(function(){t.indentLine(r.line)},75)}},z.prototype._handleCursorActivity=function(e){this._updateStyleActiveLine()},z.prototype._handleKeypressEvents=function(e){this._checkElectricChars(e)},z.prototype._addIndentAtEachSelection=function(e){var t=this._codeMirror,n=t.getOption("indentWithTabs"),r=t.getOption("indentUnit"),i=[];v.each(e,function(e){var t="",s,o;if(n)t="	";else{o=r-e.start.ch%r;for(s=0;s<o;s++)t+=" "}i.push({edit:{text:t,start:e.start}})}),this.document.doMultipleEdits(i)},z.prototype._autoIndentEachSelection=function(e){var t=this._codeMirror,n={};v.each(e,function(e){n[e.start.line]=t.getLine(e.start.line).length}),s.commands.indentAuto(t);var r=!1,i=this.getSelections();i.length===e.length?v.each(e,function(e,o){var u=i[o];if(s.cmpPos(e.start,u.start)!==0||s.cmpPos(e.end,u.end)!==0||t.getLine(e.start.line).length!==n[e.start.line])return r=!0,!1}):r=!0,r||s.commands.indentMore(t)},z.prototype._handleTabKey=function(){var e=this._codeMirror,t="indentAuto",n=this.getSelections();v.each(n,function(n){if(n.start.line!==n.end.line)return t="indentAtBeginning",!1;n.end.ch>0&&n.end.ch>=e.getLine(n.end.line).search(/\S/)&&(t="indentAtSelection")});switch(t){case"indentAtBeginning":s.commands.indentMore(e);break;case"indentAtSelection":this._addIndentAtEachSelection(n);break;case"indentAuto":this._autoIndentEachSelection(n)}},z.prototype._handleSoftTabNavigation=function(e,t){var n=this._codeMirror,r=null;if(!n.getOption("indentWithTabs")&&f.get(S)){var i=n.getOption("indentUnit");v.each(this.getSelections(),function(t){if(s.cmpPos(t.start,t.end)!==0)return;var o=t.start,u=o.ch%i,a=n.getLine(o.line);if(a.substr(0,o.ch).search(/\S/)!==-1)u=null;else if(e===1){u=i-u;if(o.ch+u>a.length||a.substr(o.ch,u).search(/\S/)!==-1)u=null}else u===0&&(u=i),o.ch-u<0?u=null:u=-u;if(u===null||r!==null&&r!==u)return r=null,!1;r=u})}r===null&&(r=e),n[t](r,"char")},z.prototype._getModeFromDocument=function(){return this.document.getLanguage().getMode()||"text/plain"},z.prototype.selectAllNoScroll=function(){var e=this._codeMirror,t=this._codeMirror.getScrollInfo();e.operation(function(){e.scrollTo(t.left,t.top),e.execCommand("selectAll")})},z.prototype.isTextSubset=function(){return Boolean(this._visibleRange)},z.prototype._updateHiddenLines=function(){if(this._visibleRange){var e=this._codeMirror,t=this;e.operation(function(){t._hideMarks.forEach(function(e){e&&e.clear()}),t._hideMarks=[],t._hideMarks.push(t._hideLines(0,t._visibleRange.startLine)),t._hideMarks.push(t._hideLines(t._visibleRange.endLine+1,t.lineCount()))})}},z.prototype._applyChanges=function(e){if(this._visibleRange)if(this._visibleRange.startLine===null||this._visibleRange.endLine===null){$(this).triggerHandler("lostContent");return}var t=this._codeMirror;t.operation(function(){var n,r,i;for(i=0;i<e.length;i++)n=e[i],r=n.text.join("\n"),!n.from||!n.to?((n.from||n.to)&&console.error("Change record received with only one end undefined--replacing entire text"),t.setValue(r)):t.replaceRange(r,n.from,n.to,n.origin)}),this._updateHiddenLines()},z.prototype._handleEditorChange=function(e){if(this._duringSync)return;this.document._ensureMasterEditor(),this.document._masterEditor!==this&&(this._duringSync=!0,this.document._masterEditor._applyChanges(e),this._duringSync=!1,this._updateHiddenLines()),$(this).triggerHandler("editorChange",[this,e])},z.prototype._handleDocumentChange=function(e,t,n){var r;if(this._duringSync)return;this.document._masterEditor!==this&&(this._duringSync=!0,this._applyChanges(n),this._duringSync=!1)},z.prototype._handleDocumentDeleted=function(e){$(this).triggerHandler("lostContent",[e])},z.prototype._handleDocumentLanguageChanged=function(e){this._codeMirror.setOption("mode",this._getModeFromDocument())},z.prototype._installEditorListeners=function(){function t(t,n){return $(e).triggerHandler("keyEvent",[e,n]),$(e).triggerHandler(n.type,[e,n]),n.defaultPrevented}var e=this;this._codeMirror.on("keydown",t),this._codeMirror.on("keypress",t),this._codeMirror.on("keyup",t),this._codeMirror.on("changes",function(t,n){$(e).triggerHandler("change",[e,n])}),this._codeMirror.on("beforeChange",function(t,n){$(e).triggerHandler("beforeChange",[e,n])}),this._codeMirror.on("cursorActivity",function(t){$(e).triggerHandler("cursorActivity",[e])}),this._codeMirror.on("scroll",function(t){e.isFullyVisible()&&o.closeAll(),$(e).triggerHandler("scroll",[e])}),this._codeMirror.on("focus",function(){e._focused=!0,$(e).triggerHandler("focus",[e])}),this._codeMirror.on("blur",function(){e._focused=!1,$(e).triggerHandler("blur",[e])}),this._codeMirror.on("update",function(t){$(e).triggerHandler("update",[e])}),this._codeMirror.on("overwriteToggle",function(t,n){$(e).triggerHandler("overwriteToggle",[e,n])})},z.prototype._resetText=function(e){var t=u.markStart("Editor._resetText()	"+(!this.document||this.document.file.fullPath)),n=this.getCursorPos(),r=this.getScrollPos();this._codeMirror.setValue(e),this._codeMirror.clearHistory(),this._codeMirror.markClean(),this.setCursorPos(n),this.setScrollPos(r.x,r.y),u.addMeasurement(t)},z.prototype.getCursorPos=function(e,t){t==="start"?t="from":t==="end"&&(t="to");var n=I(this._codeMirror.getCursor(t));return e&&(n.ch=this.getColOffset(n)),n},z.prototype.getColOffset=function(e){var t=this._codeMirror.getRange({line:e.line,ch:0},e),n=null,r=0,i;for(i=0;i<t.length;i++)t[i]==="	"?(n===null&&(n=z.getTabSize()),n>0&&(r+=n-r%n)):r++;return r},z.prototype.getCharIndexForColumn=function(e,t){var n=this._codeMirror.getLine(e),r=null,i=0,s;for(s=0;i<t;s++)n[s]==="	"?(r===null&&(r=z.getTabSize()),r>0&&(i+=r-i%r)):i++;return s},z.prototype.setCursorPos=function(e,t,n,r){r&&(t=this.getColOffset({line:e,ch:t})),this._codeMirror.setCursor(e,t),n&&this.centerOnCursor()},z.prototype.setSize=function(e,t){this._codeMirror.setSize(e,t)};var W=.15;z.prototype.centerOnCursor=function(e){var t=$(this.getScrollerElement()),n=t.height(),r=t.outerHeight()-n,i=t.offset().top,s=this._codeMirror.cursorCoords(null,"local").bottom,o=this._codeMirror.cursorCoords(null,"page").bottom-i;if(q(e)&&o<n*W||R(e)&&o>n*(1-W)){var u=s-n/2+r,a=this._codeMirror.getScrollInfo();u=Math.min(Math.max(u,0),a.height-a.clientHeight),this.setScrollPos(null,u)}},z.prototype.indexFromPos=function(e){return this._codeMirror.indexFromPos(e)},z.prototype.posWithinRange=function(e,t,n,r){return t.line<=e.line&&n.line>=e.line?r?(t.line<e.line||t.ch<=e.ch)&&(n.line>e.line||n.ch>=e.ch):(t.line<e.line||t.ch<=e.ch)&&(n.line>e.line||n.ch>e.ch):!1},z.prototype.hasSelection=function(){return this._codeMirror.somethingSelected()},z.prototype.getSelection=function(){return X(this.getCursorPos(!1,"anchor"),this.getCursorPos(!1,"head"))},z.prototype.getSelections=function(){var e=this.getSelection();return v.map(this._codeMirror.listSelections(),function(t){var n=X(t.anchor,t.head);return n.start.line===e.start.line&&n.start.ch===e.start.ch&&n.end.line===e.end.line&&n.end.ch===e.end.ch?n.primary=!0:n.primary=!1,n})},z.prototype.convertToLineSelections=function(e,t){var n=this;t=t||{},v.defaults(t,{expandEndAtStartOfLine:!1,mergeAdjacent:!0});var r=[],i;return v.each(e,function(e){var s=v.cloneDeep(e);s.start.ch=0;var o=s.start.line!==s.end.line||s.start.ch!==s.end.ch;if(t.expandEndAtStartOfLine||!o||s.end.ch!==0)s.end={line:s.end.line+1,ch:0};i&&n.posWithinRange(s.start,i.selectionForEdit.start,i.selectionForEdit.end,t.mergeAdjacent)?(i.selectionForEdit.end.line=s.end.line,i.selectionsToTrack.push(e)):(i={selectionForEdit:s,selectionsToTrack:[e]},r.push(i))}),r},z.prototype.getSelectedText=function(e){if(e)return this._codeMirror.getSelection();var t=this.getSelection();return this.document.getRange(t.start,t.end)},z.prototype.setSelection=function(e,t,n,r,i){this.setSelections([{start:e,end:t||e}],n,r,i)},z.prototype.setSelections=function(e,t,n,r){var i=e.length-1,s;r&&(s={origin:r}),this._codeMirror.setSelections(v.map(e,function(e,t){return e.primary&&(i=t),{anchor:e.reversed?e.end:e.start,head:e.reversed?e.start:e.end}}),i,s),t&&this.centerOnCursor(n)},z.prototype.toggleOverwrite=function(e){this._codeMirror.toggleOverwrite(e)},z.prototype.selectWordAt=function(e){function i(e){return/\w/.test(e)||e.toUpperCase()!==e.toLowerCase()}var t=this.document.getLine(e.line),n=e.ch,r=e.ch;while(n>0&&i(t.charAt(n-1)))--n;while(r<t.length&&i(t.charAt(r)))++r;this.setSelection({line:e.line,ch:n},{line:e.line,ch:r})},z.prototype.lineCount=function(){return this._codeMirror.lineCount()},z.prototype.isLineVisible=function(e){var t=this._codeMirror.charCoords({line:e,ch:0},"local"),n=this._codeMirror.getScrollInfo(),r=n.top,i=n.top+n.clientHeight;return t.top>=r&&t.bottom<=i},z.prototype.getFirstVisibleLine=function(){return this._visibleRange?this._visibleRange.startLine:0},z.prototype.getLastVisibleLine=function(){return this._visibleRange?this._visibleRange.endLine:this.lineCount()-1},z.prototype._hideLines=function(e,t){if(t<=e)return;var n=this._codeMirror.markText({line:e,ch:0},{line:t-1,ch:this._codeMirror.getLine(t-1).length},{collapsed:!0,inclusiveLeft:!0,inclusiveRight:!0,clearWhenEmpty:!1});return n},z.prototype.totalHeight=function(){return this.getScrollerElement().scrollHeight},z.prototype.getScrollerElement=function(){return this._codeMirror.getScrollerElement()},z.prototype.getRootElement=function(){return this._codeMirror.getWrapperElement()},z.prototype._getLineSpaceElement=function(){return $(".CodeMirror-lines",this.getScrollerElement()).children().get(0)},z.prototype.getScrollPos=function(){var e=this._codeMirror.getScrollInfo();return{x:e.left,y:e.top}},z.prototype.setScrollPos=function(e,t){this._codeMirror.scrollTo(e,t)},z.prototype.getTextHeight=function(){return this._codeMirror.defaultTextHeight()},z.prototype.addInlineWidget=function(e,t,n){var r=this,s=this._inlineWidgetQueues[e.line],o=new $.Deferred;return s||(s=new i.PromiseQueue,this._inlineWidgetQueues[e.line]=s),s.add(function(){return r._addInlineWidgetInternal(e,t,n,o),o.promise()}),o.promise()},z.prototype._addInlineWidgetInternal=function(e,t,n,i){var o=this;this.removeAllInlineWidgetsForLine(e.line).done(function(){n===undefined&&(n=!0),n&&o._codeMirror.scrollIntoView(e),t.info=o._codeMirror.addLineWidget(e.line,t.htmlContent,{coverGutter:!0,noHScroll:!0}),s.on(t.info.line,"delete",function(){o._removeInlineWidgetInternal(t)}),o._inlineWidgets.push(t),t.$htmlContent.height(0),r.animateUsingClass(t.htmlContent,"animating").done(function(){i.resolve()}),t.onAdded()})},z.prototype.removeAllInlineWidgets=function(){var e=[].concat(this.getInlineWidgets());return i.doInParallel(e,this.removeInlineWidget.bind(this))},z.prototype.removeInlineWidget=function(e){function i(){n._codeMirror.removeLineWidget(e.info),n._removeInlineWidgetInternal(e),t.resolve()}var t=new $.Deferred,n=this;if(!e.closePromise){var s=this._getInlineWidgetLineNumber(e);n._removeInlineWidgetFromList(e),n.isFullyVisible()?(r.animateUsingClass(e.htmlContent,"animating").done(i),e.$htmlContent.height(0)):i(),e.closePromise=t.promise()}return e.closePromise},z.prototype.removeAllInlineWidgetsForLine=function(e){var t=this._codeMirror.lineInfo(e),n=t&&t.widgets?[].concat(t.widgets):null,r=this;if(n&&n.length){var s,o=this._inlineWidgets.map(function(e){return e.info});return i.doInParallel(n,function(e){return s=r._inlineWidgets[o.indexOf(e)],s?r.removeInlineWidget(s):(new $.Deferred).resolve().promise()})}return(new $.Deferred).resolve().promise()},z.prototype._removeInlineWidgetFromList=function(e){var t=this._inlineWidgets.length,n;for(n=0;n<t;n++)if(this._inlineWidgets[n]===e){this._inlineWidgets.splice(n,1);break}},z.prototype._removeInlineWidgetInternal=function(e){e.isClosed||(this._removeInlineWidgetFromList(e),e.onClosed(),e.isClosed=!0)},z.prototype.getInlineWidgets=function(){return this._inlineWidgets},z.prototype.displayErrorMessageAtCursor=function(e){function y(){$(h).off(".msgbox")}function b(){h._$messagePopover&&h._$messagePopover.length>0&&(h._$messagePopover=null),y()}function w(){h._$messagePopover&&a.removePopUp(h._$messagePopover)}function E(){$(h).on("blur.msgbox",w).on("change.msgbox",w).on("cursorActivity.msgbox",w).on("update.msgbox",w)}var t,n,i,s,o,u,f,l,c,h=this,p=$("#editor-holder"),v=10,m=10,g=m+3;this._$messagePopover&&w(),n=this.getCursorPos(),this._codeMirror.scrollIntoView(n),i=this._codeMirror.charCoords(n),t=i.top>100,this._$messagePopover=$("<div/>").addClass("popover-message").appendTo($("body")),t||$("<div/>").addClass("arrowAbove").appendTo(this._$messagePopover),$("<div/>").addClass("text").appendTo(this._$messagePopover).html(e),t&&$("<div/>").addClass("arrowBelow").appendTo(this._$messagePopover),o=t?i.top-this._$messagePopover.height()-v:i.bottom+v,u=i.left-this._$messagePopover.width()/2,s={top:o,left:u,height:this._$messagePopover.height(),width:this._$messagePopover.width()},f=d.getElementClipSize(p,s),f.left>0?u+=f.left:f.right>0&&(u-=f.right),this._$messagePopover.css({top:o,left:u}),l=i.left-u,l=Math.min(s.width-g,Math.max(l,g)),c=l-m,t?this._$messagePopover.find(".arrowBelow").css({"margin-left":c}):this._$messagePopover.find(".arrowAbove").css({"margin-left":c}),a.addPopUp(this._$messagePopover,b,!0),E(),r.animateUsingClass(this._$messagePopover[0],"animateOpen").done(function(){h._$messagePopover&&h._$messagePopover.length>0&&(h._$messagePopover.addClass("open"),$(h).on("scroll.msgbox",w),r.animateUsingClass(h._$messagePopover[0],"animateClose",6e3).done(w))})},z.prototype.getVirtualScrollAreaTop=function(){var e=this._getLineSpaceElement().offsetTop,t=this.getScrollerElement();return $(t).offset().top-t.scrollTop+e},z.prototype.setInlineWidgetHeight=function(e,t,n){function a(){u&&e.info.changed()}function f(){function e(t){t.target===i&&(a(),$(i).off("webkitTransitionEnd",e))}$(i).height(t),$(i).hasClass("animating")?$(i).on("webkitTransitionEnd",e):a()}var r=this,i=e.htmlContent,s=i&&$(i).height()||0,o=s!==t,u=e.info!==undefined;if(o||!i.style.height)$(i).hasClass("animating")?window.setTimeout(f,0):f();if(n&&u){var l=$(i).offset(),c=$(i).position(),h=r.getVirtualScrollAreaTop();r._codeMirror.scrollIntoView({left:c.left,top:l.top-h,right:c.left,bottom:l.top+t-h})}},z.prototype._getInlineWidgetLineNumber=function(e){return this._codeMirror.getLineNumber(e.info.line)},z.prototype.focus=function(){if(B)return;B=!0;try{this._codeMirror.focus()}finally{B=!1}},z.prototype.hasFocus=function(){return this._focused},z.prototype.refresh=function(e){var t=window.document.activeElement,n=$.contains(this._codeMirror.getScrollerElement(),t);this._codeMirror.refresh(),n&&t.focus()},z.prototype.refreshAll=function(e){this.refresh(e),this.getInlineWidgets().forEach(function(e){e.refresh()})},z.prototype.undo=function(){this._codeMirror.undo()},z.prototype.redo=function(){this._codeMirror.redo()},z.prototype.setVisible=function(e,t){$(this.getRootElement()).css("display",e?"":"none"),e&&(t||t===undefined)&&this.refresh(),e&&this._inlineWidgets.forEach(function(e){e.onParentShown()})},z.prototype.isFullyVisible=function(){return $(this.getRootElement()).is(":visible")},z.prototype.getModeForRange=function(e,t,n){var r=this._codeMirror.getMode(),i=h.getModeAt(this._codeMirror,e),s=h.getModeAt(this._codeMirror,t);return!n&&r.name===i.name?this._codeMirror.getOption("mode"):!i||!s||i.name!==s.name?null:i},z.prototype.getModeForSelection=function(){var e=this,t=this.getSelections(),n=this.getSelection(),r=this._codeMirror.getMode(),i=h.getModeAt(this._codeMirror,n.start),s=r.name!==i.name;if(s){if(n.start.line!==n.end.line||n.start.ch!==n.end.ch){var o=h.getModeAt(this._codeMirror,n.end);if(i.name!==o.name)return null}var u=v.some(t,function(r){if(t===n)return!1;var s=e.getModeForRange(r.start,r.end,!0);return!s||s.name!==i.name});return u?null:i.name}return this._codeMirror.getOption("mode")},z.prototype.getLanguageForSelection=function(){return this.document.getLanguage().getLanguageForMode(this.getModeForSelection())},z.prototype.getModeForDocument=function(){return this._codeMirror.getOption("mode")},z.prototype.document=null,z.prototype._duringSync=!1,z.prototype._codeMirror=null,z.prototype._inlineWidgets=null,z.prototype._visibleRange=null,z.prototype._inlineWidgetQueues=null,z.prototype._hideMarks=null,z.prototype._getOption=function(e){return f.get(e,this.document.file.fullPath)},z.prototype._updateOption=function(e){var t=this._currentOptions[e],n=this._getOption(e);if(t!==n){this._currentOptions[e]=n;if(e===k)this._codeMirror.setOption(L[e],n),this._codeMirror.setOption("indentUnit",n===!0?this._currentOptions[N]:this._currentOptions[x]);else if(e===T)this._updateStyleActiveLine();else{if(e===b&&this._visibleRange)return;e===w?(z._toggleLinePadding(!n),this._codeMirror.setOption(L[w],n),this.refreshAll()):this._codeMirror.setOption(L[e],n)}$(this).triggerHandler("optionChange",[e,n])}},z.prototype._updateStyleActiveLine=function(){this.hasSelection()?this._codeMirror.getOption("styleActiveLine")&&this._codeMirror.setOption("styleActiveLine",!1):this._codeMirror.setOption("styleActiveLine",this._currentOptions[T])},z.setUseTabChar=function(e,t){var n=t&&{context:t};return f.set(k,e,n)},z.getUseTabChar=function(e){return f.get(k,e)},z.setTabSize=function(e,t){var n=t&&{context:t};return f.set(N,e,n)},z.getTabSize=function(e){return f.get(N,e)},z.setSpaceUnits=function(e,t){var n=t&&{context:t};return f.set(x,e,n)},z.getSpaceUnits=function(e){return f.get(x,e)},z.setCloseBrackets=function(e,t){var n=t&&{context:t};return f.set(m,e,n)},z.getCloseBrackets=function(e){return f.get(m,e)},z.setShowLineNumbers=function(e,t){var n=t&&{context:t};return f.set(w,e,n)},z.getShowLineNumbers=function(e){return f.get(w,e)},z.setShowActiveLine=function(e,t){return f.set(T,e)},z.getShowActiveLine=function(e){return f.get(T,e)},z.setWordWrap=function(e,t){var n=t&&{context:t};return f.set(C,e,n)},z.getWordWrap=function(e){return f.get(C,e)},z._toggleLinePadding=function(e){$("#editor-holder").toggleClass("show-line-padding",e)},H.forEach(function(e){f.on("change",e,function(){U.forEach(function(t){t._updateOption(e)})})}),V(),t.Editor=z,t.BOUNDARY_CHECK_NORMAL=j,t.BOUNDARY_IGNORE_TOP=F}),define("editor/InlineWidget",["require","exports","module","editor/EditorManager","utils/KeyEvent"],function(e,t,n){function s(){var e=this;this.htmlContent=window.document.createElement("div"),this.$htmlContent=$(this.htmlContent).addClass("inline-widget").attr("tabindex","-1"),this.$htmlContent.append("<div class='shadow top' />").append("<div class='shadow bottom' />").append("<a href='#' class='close no-focus'>&times;</a>"),this.$closeBtn=this.$htmlContent.find(".close"),this.$closeBtn.click(function(t){e.close(),t.stopImmediatePropagation()}),this.$htmlContent.on("keydown",function(t){t.keyCode===i.DOM_VK_ESCAPE&&(e.close(),t.stopImmediatePropagation())})}var r=e("editor/EditorManager"),i=e("utils/KeyEvent");s.prototype.htmlContent=null,s.prototype.$htmlContent=null,s.prototype.id=null,s.prototype.hostEditor=null,s.prototype.height=0,s.prototype.close=function(){return r.closeInlineWidget(this.hostEditor,this)},s.prototype.hasFocus=function(){var e=window.document.activeElement,t=this.$htmlContent[0];return $.contains(t,e)||t===e},s.prototype.onClosed=function(){$(this).triggerHandler("close")},s.prototype.onAdded=function(){$(this).triggerHandler("add")},s.prototype.load=function(e){this.hostEditor=e},s.prototype.onParentShown=function(){},s.prototype.refresh=function(){},t.InlineWidget=s}),define("editor/InlineTextEditor",["require","exports","module","thirdparty/CodeMirror2/lib/codemirror","document/DocumentManager","editor/EditorManager","command/CommandManager","command/Commands","editor/InlineWidget","utils/KeyEvent"],function(e,t,n){function l(){return $("#editor-holder").width()}function c(e,t){e.css("width",t?16:0)}function h(e,t){var n=$(".inline-text-editor .dirty-indicator"),r;n.each(function(e,n){r=$(this),r.data("fullPath")===t.file.fullPath&&c(r,t.isDirty)})}function p(){a.call(this),this.editor=null,this.handleKeyDown=this.handleKeyDown.bind(this),this.htmlContent.addEventListener("keydown",this.handleKeyDown,!0)}function d(e){var t=s.getInlineEditors(e);t.push(e);var n=0;t.forEach(function(e){var t=$(e._codeMirror.getGutterElement()).find(".CodeMirror-linenumbers");t.css("min-width","");var r=t.width();r>n&&(n=r)});if(t.length===1){t[0]._codeMirror.setOption("gutters",t[0]._codeMirror.getOption("gutters"));return}n+="px",t.forEach(function(e){$(e._codeMirror.getGutterElement()).find(".CodeMirror-linenumbers").css("min-width",n),e._codeMirror.setOption("gutters",e._codeMirror.getOption("gutters"))})}var r=e("thirdparty/CodeMirror2/lib/codemirror"),i=e("document/DocumentManager"),s=e("editor/EditorManager"),o=e("command/CommandManager"),u=e("command/Commands"),a=e("editor/InlineWidget").InlineWidget,f=e("utils/KeyEvent");p.prototype=Object.create(a.prototype),p.prototype.constructor=p,p.prototype.parentClass=a.prototype,p.prototype.$wrapper=null,p.prototype.editor=null,p.prototype.$editorHolder=null,p.prototype.$header=null,p.prototype.$filename=null,p.prototype.onClosed=function(){p.prototype.parentClass.onClosed.apply(this,arguments),d(this.hostEditor),this.setInlineContent(null),this.htmlContent.removeEventListener("keydown",this.handleKeyDown,!0)},p.prototype.sizeInlineWidgetToContents=function(e){},p.prototype.onAdded=function(){var e=this;p.prototype.parentClass.onAdded.apply(this,arguments),this.editor&&this.editor.refresh(),r.on(this.info,"redraw",function(){window.setTimeout(function(){e.editor&&e.editor.refresh()},0)}),d(this.hostEditor),this.editor&&this.editor.focus()},p.prototype.getFocusedEditor=function(){return this.editor&&this.editor.hasFocus()?this.editor:null},p.prototype.handleKeyDown=function(e){e.keyCode===f.DOM_VK_ESCAPE&&this.editor&&this.editor.getSelections().length>1&&(r.commands.singleSelection(this.editor._codeMirror),e.stopImmediatePropagation())},p.prototype.setInlineContent=function(e,t,n){var r=this;this.editor&&($(this.editor).off(".InlineTextEditor"),this.editor.destroy(),this.editor=null,this.$filename.off(".InlineTextEditor").removeAttr("title"),this.$filename.html(""));if(!e)return;var i={startLine:t,endLine:n},a=$("<div/>").addClass("dirty-indicator").html("&bull;").width(0);a.data("fullPath",e.file.fullPath),this.$lineNumber=$("<span class='line-number'/>"),this.$filename.append(a).append(e.file.name+" : ").append(this.$lineNumber).attr("title",e.file.fullPath),this.$filename.on("click.InlineTextEditor",function(){o.execute(u.FILE_OPEN,{fullPath:e.file.fullPath}).done(function(){s.getCurrentFullEditor().setCursorPos(t,0,!0)})});var f=s.createInlineEditorForDocument(e,i,this.$editorHolder.get(0));this.editor=f.editor,this._updateLineRange(f.editor),$(this.editor).on("update.InlineTextEditor",function(e,t){r.sizeInlineWidgetToContents(!0)}),$(this.editor).on("change.InlineTextEditor",function(e,t){r.hostEditor.isFullyVisible()&&(r.sizeInlineWidgetToContents(!0),r._updateLineRange(t))}),$(this.editor).on("lostContent.InlineTextEditor",function(){r._onLostContent.apply(r,arguments)}),c(a,e.isDirty)},p.prototype._updateLineRange=function(e){var t=this._startLine,n=this._endLine,r=this._lineCount;this._startLine=e.getFirstVisibleLine(),this._endLine=e.getLastVisibleLine(),this._lineCount=this._endLine-this._startLine,this.$lineNumber.text(this._startLine+1)},p.prototype.load=function(e){p.prototype.parentClass.load.apply(this,arguments),this.$wrapper=$("<div/>").addClass("inline-text-editor").appendTo(this.$htmlContent),this.$header=$("<div/>").addClass("inline-editor-header").appendTo(this.$wrapper),this.$filename=$("<a/>").addClass("filename").appendTo(this.$header),this.$editorHolder=$("<div/>").addClass("inline-editor-holder").appendTo(this.$wrapper)},p.prototype.onParentShown=function(){p.prototype.parentClass.onParentShown.apply(this,arguments),this.editor&&(this._updateLineRange(this.editor),this.editor.refresh()),this.sizeInlineWidgetToContents(!0)},p.prototype._onLostContent=function(){this.close()},$(i).on("dirtyFlagChange",h),t.InlineTextEditor=p}),define("editor/EditorManager",["require","exports","module","command/Commands","view/PanelManager","preferences/PreferencesManager","command/CommandManager","document/DocumentManager","utils/PerfUtils","editor/Editor","editor/InlineTextEditor","strings","language/LanguageManager"],function(e,t,n){function C(e){if(w===e)return;var n=w;w=e,$(t).triggerHandler("activeEditorChange",[e,n])}function k(e,t,n,r){var i=new f(e,t,n,r);return $(i).on("focus",function(){C(this)}),i}function L(e,t,n){a.markStart(a.INLINE_WIDGET_OPEN);var r=e.getCursorPos(),i,s,o=new $.Deferred,u,f;for(s=0;s<t.length&&!i;s++){var l=t[s].provider;f=l(e,r),f&&(f.hasOwnProperty("done")?i=f:!u&&typeof f=="string"&&(u=f))}return u=u||n,i?i.done(function(t){e.addInlineWidget(r,t).done(function(){a.addMeasurement(a.INLINE_WIDGET_OPEN),o.resolve()})}).fail(function(){a.finalizeMeasurement(a.INLINE_WIDGET_OPEN),e.displayErrorMessageAtCursor(u),o.reject()}):(a.finalizeMeasurement(a.INLINE_WIDGET_OPEN),e.displayErrorMessageAtCursor(u),o.reject()),o.promise()}function A(e,t,n){var r,i={priority:n,provider:t};for(r=0;r<e.length;r++)if(e[r].priority<n)break;e.splice(r,0,i)}function O(e,t){if(t.hasFocus()){var n=e._codeMirror.getLineNumber(t.info.line),r=e.getCursorPos().line;r!==n&&e.setCursorPos({line:n,pos:0}),e.focus()}return e.removeInlineWidget(t)}function M(e,t){t===undefined&&(t=0),A(x,e,t)}function _(e,t){t===undefined&&(t=0),A(T,e,t)}function D(e){N.push(e)}function P(e){var t=[];return e&&e.getInlineWidgets().forEach(function(e){e instanceof l&&e.editor&&t.push(e.editor)}),t}function H(e){var t=p.get(0),n=k(e,!0,t);n.setVisible(!1)}function B(){return d}function j(e,t,n){$(n).hide();var r=k(e,!1,n,t);return $(n).show(),{content:n,editor:r}}function F(e){var t=e._masterEditor;if(!t){if(e instanceof u.Document)return;throw new Error("_destroyEditorIfUnneeded() should be passed a Document")}var n=u.getCurrentDocument()===e,r=u.findInWorkingSet(e.file.fullPath)!==-1;!n&&!r&&(t.destroy(),d===t&&(v=null,d=null))}function I(){w&&w.focus()}function U(){if(!p)return;i._notifyLayoutChange()}function z(e,t,n){if(d){var r=d.getRootElement(),i=$(r).width();!r.style.height||$(r).height()!==t?(d.setSize(null,t),n===undefined&&(n=q)):i!==S&&n===undefined&&(n=q),S=i,n===q&&d.refreshAll(!0)}}function W(e){E[e.document.file.fullPath]={selections:e.getSelections(),scrollPos:e.getScrollPos()}}function X(e){var t=E[e.document.file.fullPath];t&&(t.selection&&e.setSelection(t.selection.start,t.selection.end),t.selections&&e.setSelections(t.selections),t.scrollPos&&e.setScrollPos(t.scrollPos.x,t.scrollPos.y))}function V(e){return v&&v.file.fullPath===e&&W(d),E[e]}function J(e){E=e}function K(e){v=e,d=e._masterEditor,d.setVisible(!0,!1),d.focus(),i._notifyLayoutChange(q)}function Q(e){d?(W(d),d.setVisible(!1),F(v)):$("#not-editor").css("display","none");var t=!1;e._masterEditor||(t=!0,window.getSelection&&window.getSelection().empty&&window.getSelection().empty(),H(e)),K(e),t&&X(e._masterEditor)}function G(){d&&(W(d),d._codeMirror.getInputField().blur(),d.setVisible(!1),F(v),v=null,d=null,m=null,C(null))}function Y(){$("#not-editor").css("display",""),G()}function Z(){return m}function et(){m=null,$(t).triggerHandler("currentlyViewedFileChange")}function tt(e){m=e,$(t).triggerHandler("currentlyViewedFileChange")}function nt(){g&&(g.remove(),y.onRemove&&y.onRemove()),g=null,y=null}function rt(){nt(),tt(),Y()}function it(e,t){if(m===t&&y===e)return;u._clearCurrentDocument(),nt(),$("#not-editor").css("display","none"),G(),y=e,g=e.render(t,$("#editor-holder")),tt(t)}function st(e){return y&&m===e}function ot(e,t){b[e]?console.error('There already is a custom viewer registered for language id  "'+e+'"'):b[e]=t}function ut(e,t,n){m===t&&tt(n)}function at(e){var t=h.getLanguageForPath(e);return b[t.getId()]}function ft(e){function t(){var e=u.getNextPrevFile(1);e?o.execute(r.FILE_OPEN,{fullPath:e.fullPath}):(nt(),Y(),tt())}(!e||m===e)&&t()}function lt(){var e=u.getCurrentDocument(),t=p.get(0),n=a.markStart("EditorManager._onCurrentDocumentChange():	"+(!e||e.file.fullPath));nt(),e?(Q(e),tt(e.file.fullPath)):(et(),Y()),a.addMeasurement(n)}function ct(e,t){var n=u.getOpenDocumentForPath(t.fullPath);n&&F(n)}function ht(e,t){t.forEach(function(t){ct(e,t)})}function pt(e){if(d){console.error("Cannot change editor area after an editor has already been created!");return}p=e,U()}function dt(){var e=null;return d&&d.getInlineWidgets().forEach(function(t){t.hasFocus()&&(e=t)}),e}function vt(){var e=dt();return e instanceof l?e.getFocusedEditor():null}function mt(){if(d){var e=vt();if(e)return e;if(d.hasFocus())return d}return null}function gt(){return w}function yt(e,t){var n=new $.Deferred;if(d){var r=dt();r?(a.markStart(a.INLINE_WIDGET_CLOSE),r.close().done(function(){a.addMeasurement(a.INLINE_WIDGET_CLOSE),n.resolve(!1)})):L(d,e,t).done(function(){n.resolve(!0)}).fail(function(){n.reject()})}else n.reject();return n.promise()}function bt(){var e=N,t,n,r=new $.Deferred,i=gt();if(i){var s=i.getCursorPos();a.markStart(a.JUMP_TO_DEFINITION);for(n=0;n<e.length&&!t;n++){var o=e[n];t=o(i,s)}t?t.done(function(){a.addMeasurement(a.JUMP_TO_DEFINITION),r.resolve()}).fail(function(){a.finalizeMeasurement(a.JUMP_TO_DEFINITION),r.reject()}):(a.finalizeMeasurement(a.JUMP_TO_DEFINITION),r.reject())}else r.reject();return r.promise()}var r=e("command/Commands"),i=e("view/PanelManager"),s=e("preferences/PreferencesManager"),o=e("command/CommandManager"),u=e("document/DocumentManager"),a=e("utils/PerfUtils"),f=e("editor/Editor").Editor,l=e("editor/InlineTextEditor").InlineTextEditor,c=e("strings"),h=e("language/LanguageManager"),p=null,d=null,v=null,m=null,g=null,y=null,b={},w=null,E={},S=null,x=[],T=[],N=[],q="force",R="skip";$(t).on("activeEditorChange",function(e,t){t&&t.document&&t.document.file&&s._setCurrentEditingFile(t.document.file.fullPath)}),o.register(c.CMD_TOGGLE_QUICK_EDIT,r.TOGGLE_QUICK_EDIT,function(){return yt(x,c.ERROR_QUICK_EDIT_PROVIDER_NOT_FOUND)}),o.register(c.CMD_TOGGLE_QUICK_DOCS,r.TOGGLE_QUICK_DOCS,function(){return yt(T,c.ERROR_QUICK_DOCS_PROVIDER_NOT_FOUND)}),o.register(c.CMD_JUMPTO_DEFINITION,r.NAVIGATE_JUMPTO_DEFINITION,bt),a.createPerfMeasurement("JUMP_TO_DEFINITION","Jump-To-Definiiton"),$(u).on("currentDocumentChange",lt),$(u).on("workingSetRemove",ct),$(u).on("workingSetRemoveList",ht),$(u).on("fileNameChange",ut),$(i).on("editorAreaResize",z),t._openInlineWidget=L,t._createFullEditorForDocument=H,t._destroyEditorIfUnneeded=F,t._getViewState=V,t._resetViewStates=J,t._doShow=K,t._notifyActiveEditorChanged=C,t._showCustomViewer=it,t._closeCustomViewer=rt,t.REFRESH_FORCE=q,t.REFRESH_SKIP=R,t.setEditorHolder=pt,t.getCurrentFullEditor=B,t.createInlineEditorForDocument=j,t.focusEditor=I,t.getFocusedEditor=mt,t.getActiveEditor=gt,t.getCurrentlyViewedPath=Z,t.getFocusedInlineWidget=dt,t.resizeEditor=U,t.registerInlineEditProvider=M,t.registerInlineDocsProvider=_,t.registerJumpToDefProvider=D,t.getInlineEditors=P,t.closeInlineWidget=O,t.registerCustomViewer=ot,t.getCustomViewerForPath=at,t.notifyPathDeleted=ft,t.showingCustomViewerForPath=st}),define("document/InMemoryFile",["require","exports","module","filesystem/File","filesystem/FileSystemError"],function(e,t,n){function s(e,t){r.call(this,e,t)}var r=e("filesystem/File"),i=e("filesystem/FileSystemError");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.parentClass=r.prototype,s.prototype.read=function(e,t){typeof e=="function"&&(t=e),t(i.NOT_FOUND)},s.prototype.write=function(e,t,n){typeof t=="function"&&(n=t),n(i.NOT_FOUND)},s.prototype.exists=function(e){e(null,!1)},s.prototype.stat=function(e){e(i.NOT_FOUND)},s.prototype.unlink=function(e){e(i.NOT_FOUND)},s.prototype.rename=function(e,t){t(i.NOT_FOUND)},s.prototype.moveToTrash=function(e){e(i.NOT_FOUND)},n.exports=s}),define("document/Document",["require","exports","module","editor/EditorManager","file/FileUtils","document/InMemoryFile","utils/PerfUtils","language/LanguageManager","thirdparty/CodeMirror2/lib/codemirror","thirdparty/lodash"],function(e,t,n){function l(e,t,n){if(!(this instanceof l))throw new Error("Document constructor must be called with 'new'");this.file=e,this._updateLanguage(),this.refreshText(n,t,!0)}function c(e,t){Array.isArray(e)?f.each(e,t):t(e,0)}var r=e("editor/EditorManager"),i=e("file/FileUtils"),s=e("document/InMemoryFile"),o=e("utils/PerfUtils"),u=e("language/LanguageManager"),a=e("thirdparty/CodeMirror2/lib/codemirror"),f=e("thirdparty/lodash");l.prototype._refCount=0,l.prototype.file=null,l.prototype.language=null,l.prototype.isDirty=!1,l.prototype.isSaving=!1,l.prototype.diskTimestamp=null,l.prototype.keepChangesTime=null,l.prototype._refreshInProgress=!1,l.prototype._text=null,l.prototype._masterEditor=null,l.prototype._lineEndings=null,l.prototype.addRef=function(){if(this._refCount===0&&$(t).triggerHandler("_afterDocumentCreate",this))return;this._refCount++},l.prototype.releaseRef=function(){this._refCount--;if(this._refCount<0){console.error("Document ref count has fallen below zero!");return}if(this._refCount===0&&$(t).triggerHandler("_beforeDocumentDelete",this))return},l.prototype._makeEditable=function(e){this._masterEditor?console.error("Document is already editable"):(this._text=null,this._masterEditor=e,$(e).on("change",this._handleEditorChange.bind(this)))},l.prototype._makeNonEditable=function(){this._masterEditor?(this._text=this.getText(!0),this._masterEditor=null):console.error("Document is already non-editable")},l.prototype._ensureMasterEditor=function(){this._masterEditor||r._createFullEditorForDocument(this)},l.prototype.getText=function(e){if(this._masterEditor){var t=this._masterEditor._codeMirror.getValue();return e&&this._lineEndings===i.LINE_ENDINGS_CRLF?t.replace(/\n/g,"\r\n"):t}return e?this._text:l.normalizeText(this._text)},l.normalizeText=function(e){return e.replace(/\r\n/g,"\n")},l.prototype.setText=function(e){this._ensureMasterEditor(),this._masterEditor._codeMirror.setValue(e)},l.prototype._notifyDocumentChange=function(e){$(this).triggerHandler("change",[this,e]),$(t).triggerHandler("documentChange",[this,e])},l.prototype.refreshText=function(e,n,r){var s=o.markStart("refreshText:	"+(!this.file||this.file.fullPath));this._refreshInProgress=!0,this._masterEditor?this._masterEditor._resetText(e):(this._text=e,r||this._notifyDocumentChange([{text:e.split(/\r?\n/)}])),this._updateTimestamp(n),this.isDirty&&this._markClean(),this._refreshInProgress=!1,this._lineEndings=i.sniffLineEndings(e),this._lineEndings||(this._lineEndings=i.getPlatformLineEndings()),$(t).triggerHandler("_documentRefreshed",this),o.addMeasurement(s)},l.prototype.replaceRange=function(e,t,n,r){this._ensureMasterEditor(),this._masterEditor._codeMirror.replaceRange(e,t,n,r)},l.prototype.getRange=function(e,t){return this._ensureMasterEditor(),this._masterEditor._codeMirror.getRange(e,t)},l.prototype.getLine=function(e){return this._ensureMasterEditor(),this._masterEditor._codeMirror.getLine(e)},l.prototype.batchOperation=function(e){this._ensureMasterEditor();var t=this;t._masterEditor._codeMirror.operation(e)},l.prototype._handleEditorChange=function(e,n,r){if(!this._refreshInProgress){var i=this.isDirty;this.isDirty=!n._codeMirror.isClean(),i!==this.isDirty&&$(t).triggerHandler("_dirtyFlagChange",[this])}this._notifyDocumentChange(r)},l.prototype._markClean=function(){this.isDirty=!1,this._masterEditor&&this._masterEditor._codeMirror.markClean(),$(t).triggerHandler("_dirtyFlagChange",this)},l.prototype._updateTimestamp=function(e){this.diskTimestamp=e,this.keepChangesTime=null},l.prototype.notifySaved=function(){this._masterEditor||console.log("### Warning: saving a Document that is not modifiable!"),this._markClean();var e=this;this.file.stat(function(n,r){n?console.log("Error updating timestamp after saving file: "+e.file.fullPath):e._updateTimestamp(r.mtime),$(t).triggerHandler("_documentSaved",e)})},l.prototype.adjustPosForChange=function(e,t,n,r){var i={text:t,from:n,to:r};if(a.cmpPos(e,n)<0)return e;if(a.cmpPos(e,r)<=0)return a.changeEnd(i);var s=e.line+i.text.length-(i.to.line-i.from.line)-1,o=e.ch;return e.line===i.to.line&&(o+=a.changeEnd(i).ch-i.to.ch),{line:s,ch:o}},l.prototype.doMultipleEdits=function(e,t){var n=this;e.sort(function(e,t){var n=Array.isArray(e.edit)?e.edit[0]:e.edit,r=Array.isArray(t.edit)?t.edit[0]:t.edit;return n?r?a.cmpPos(r.start,n.start):1:-1});var r=f.cloneDeep(f.pluck(e,"selection"));return f.each(e,function(t,n){c(t.edit,function(t){if(t){t.end||(t.end=t.start);if(n>0){var r=e[n-1].edit;c(r,function(e){if(a.cmpPos(t.end,e.start)>0)throw new Error("Document.doMultipleEdits(): Overlapping edits specified")})}}})}),this.batchOperation(function(){f.each(e,function(e,i){c(e.edit,function(e){if(e){n.replaceRange(e.text,e.start,e.end,t);var s=e.text.split("\n");f.each(r,function(t,r){t&&c(t,function(t){if(t.isBeforeEdit||r!==i)t.start=n.adjustPosForChange(t.start,s,e.start,e.end),t.end=n.adjustPosForChange(t.end,s,e.start,e.end)})})}})})}),r=f.chain(r).filter(function(e){return e!==undefined}).flatten().sort(function(e,t){return a.cmpPos(e.start,t.start)}).value(),f.each(r,function(e){delete e.isBeforeEdit}),r},l.prototype.toString=function(){var e=this.isDirty?" (dirty!)":" (clean)",t=this._masterEditor?" (Editable)":" (Non-editable)",n=" refs:"+this._refCount;return"[Document "+this.file.fullPath+e+t+n+"]"},l.prototype.getLanguage=function(){return this.language},l.prototype.setLanguageOverride=function(e){u._setLanguageOverrideForPath(this.file.fullPath,e),this._updateLanguage()},l.prototype._updateLanguage=function(){var e=this.language;this.language=u.getLanguageForPath(this.file.fullPath),e&&e!==this.language&&$(this).triggerHandler("languageChanged",[e,this.language])},l.prototype._notifyFilePathChanged=function(){this._updateLanguage()},l.prototype.isUntitled=function(){return this.file instanceof s},t.Document=l}),define("project/FileSyncManager",["require","exports","module","project/ProjectManager","document/DocumentManager","editor/EditorManager","command/Commands","command/CommandManager","utils/Async","widgets/Dialogs","widgets/DefaultDialogs","strings","utils/StringUtils","file/FileUtils","filesystem/FileSystemError"],function(e,t,n){function E(e){function t(e){var t=new $.Deferred;return e.isUntitled()?t.resolve():e.file.stat(function(n,r){if(!n){var i=r.mtime.getTime();i!==e.diskTimestamp.getTime()&&e.keepChangesTime!==i&&(e.isDirty?b.push({doc:e,fileTime:i}):g.push(e)),t.resolve()}else n===d.NOT_FOUND?(e.keepChangesTime!==-1&&(e.isDirty?w.push({doc:e,fileTime:-1}):y.push(e)),t.resolve()):(console.log("Error checking modification status of "+e.file.fullPath,n),t.reject())}),t.promise()}return g=[],y=[],b=[],w=[],a.doInParallel(e,t,!0)}function S(){function t(e){var t=new $.Deferred;return e.stat(function(n,r){n?n===d.NOT_FOUND?(i.notifyFileDeleted(e),t.resolve()):(console.log("Error checking for deletion of "+e.fullPath,n),t.reject()):t.resolve()}),t.promise()}var e=i.getWorkingSet().filter(function(e){return!i.getOpenDocumentForPath(e.fullPath)});return a.doInParallel(e,t,!1)}function x(e){var t=p.readAsText(e.file);return t.done(function(t,n){e.refreshText(t,n)}),t.fail(function(t){console.log("Error reloading contents of "+e.file.fullPath,t)}),t}function T(){return a.doInParallel(g,x,!1)}function N(e,t){return f.showModalDialog(l.DIALOG_ID_ERROR,c.ERROR_RELOADING_FILE_TITLE,h.format(c.ERROR_RELOADING_FILE,h.breakableUrl(t.file.fullPath),p.getFileErrorString(e)))}function C(){y.forEach(function(e){i.notifyFileDeleted(e.file)})}function k(e){function n(t,n){var s=new $.Deferred,o=s.promise(),u=t.doc,a=t.fileTime;if(m)return s.resolve(),o;var p,d,v,g;return n<b.length?(p=!1,d=l.DIALOG_ID_EXT_CHANGED,v=h.format(c.EXT_MODIFIED_MESSAGE,h.breakableUrl(r.makeProjectRelativeIfPossible(u.file.fullPath))),g=[{className:f.DIALOG_BTN_CLASS_LEFT,id:f.DIALOG_BTN_DONTSAVE,text:c.RELOAD_FROM_DISK},{className:f.DIALOG_BTN_CLASS_PRIMARY,id:f.DIALOG_BTN_CANCEL,text:c.KEEP_CHANGES_IN_EDITOR}]):(p=!0,d=l.DIALOG_ID_EXT_DELETED,v=h.format(c.EXT_DELETED_MESSAGE,h.breakableUrl(r.makeProjectRelativeIfPossible(u.file.fullPath))),g=[{className:f.DIALOG_BTN_CLASS_LEFT,id:f.DIALOG_BTN_DONTSAVE,text:c.CLOSE_DONT_SAVE},{className:f.DIALOG_BTN_CLASS_PRIMARY,id:f.DIALOG_BTN_CANCEL,text:c.KEEP_CHANGES_IN_EDITOR}]),f.showModalDialog(d,e,v,g).done(function(e){e===f.DIALOG_BTN_DONTSAVE?p?(i.notifyFileDeleted(u.file),s.resolve()):x(u).done(function(){s.resolve()}).fail(function(e){N(e,u).done(function(){s.reject()})}):(m||(u.keepChangesTime=a),s.resolve())}),o}var t=b.concat(w);return a.doSequentially(t,n,!1)}function L(e){e=e||c.EXT_MODIFIED_TITLE;if(v){m=!0,f.cancelModalDialogIfOpen(l.DIALOG_ID_EXT_CHANGED),f.cancelModalDialogIfOpen(l.DIALOG_ID_EXT_DELETED);return}v=!0;var t=i.getAllOpenDocuments();E(t).done(function(){S().always(function(){T().always(function(){C(),k(e).always(function(){m?(m=!1,v=!1,L()):(v=!1,(b.length>0||w.length>0)&&s.focusEditor())})})})}).fail(function(){v=!1})}var r=e("project/ProjectManager"),i=e("document/DocumentManager"),s=e("editor/EditorManager"),o=e("command/Commands"),u=e("command/CommandManager"),a=e("utils/Async"),f=e("widgets/Dialogs"),l=e("widgets/DefaultDialogs"),c=e("strings"),h=e("utils/StringUtils"),p=e("file/FileUtils"),d=e("filesystem/FileSystemError"),v=!1,m=!1,g,y,b,w;t.syncOpenDocuments=L}),define("document/DocumentManager",["require","exports","module","thirdparty/lodash","document/Document","project/ProjectManager","editor/EditorManager","project/FileSyncManager","filesystem/FileSystem","preferences/PreferencesManager","file/FileUtils","document/InMemoryFile","command/CommandManager","utils/Async","utils/PerfUtils","command/Commands","language/LanguageManager","strings"],function(e,t,n){function b(){return y}function C(){return r.clone(E)}function k(e,t){return t=t||E,r.findIndex(t,function(t,n){return t.fullPath===e})}function L(e){return k(e,x)}function A(){var e=[],t;for(t in N)N.hasOwnProperty(t)&&e.push(N[t]);return e}function O(e,n,r){var i=n!==undefined&&n!==null&&n!==-1;if(o.getCustomViewerForPath(e.fullPath))return;var s=k(e.fullPath);if(s!==-1){if(r||i&&s!==n){var u=E.splice(s,1)[0];E.splice(n,0,u),$(t).triggerHandler("workingSetSort")}return}i?E.splice(n,0,e):E.push(e),y&&y.file.fullPath===e.fullPath?S.unshift(e):S.push(e),x.unshift(e),i||(n=E.length-1),$(t).triggerHandler("workingSetAdd",[e,n])}function M(e){var n=[];e.forEach(function(e,t){!o.getCustomViewerForPath(e.fullPath)&&k(e.fullPath)===-1&&(n.push(e),E.push(e),y&&y.file.fullPath===e.fullPath?S.unshift(e):S.push(e),x.splice(t,1,e))}),$(t).triggerHandler("workingSetAddList",[n])}function _(e,n){var r=k(e.fullPath);if(r===-1)return;E.splice(r,1),S.splice(k(e.fullPath,S),1),x.splice(k(e.fullPath,x),1),$(t).triggerHandler("workingSetRemove",[e,n])}function D(){var e=E;E=[],S=[],x=[],$(t).triggerHandler("workingSetRemoveList",[e])}function P(e){var t=k(e.file.fullPath,S);t!==-1&&(S.splice(t,1),S.unshift(e.file))}function H(e,n){var r=E.length-1,i;e>=0&&n<=r&&e>=0&&n<=r&&(i=E[e],E[e]=E[n],E[n]=i,$(t).triggerHandler("workingSetSort"),$(t).triggerHandler("workingSetDisableAutoSorting"))}function B(e){E.sort(e),$(t).triggerHandler("workingSetSort")}function j(){T=!0}function F(){T&&(T=!1,P(y))}function I(e){if(e!==-1&&e!==1)return console.error("Illegal argument: inc = "+e),null;if(o.getCurrentlyViewedPath()){var t=k(o.getCurrentlyViewedPath(),S);if(t!==-1){var n=t+e;return n>=S.length?n=0:n<0&&(n=S.length-1),S[n]}if(S.length>0)return S[0]}return null}function q(e){if(y===e)return;var n=d.markStart("setCurrentDocument:	"+e.file.fullPath);y&&$(y).off("languageChanged.DocumentManager"),(e.isUntitled()||!s.isWithinProject(e.file.fullPath))&&O(e.file),T||P(e);var r=y;y=e,$(y).on("languageChanged.DocumentManager",function(e){$(t).trigger("currentDocumentLanguageChanged",e)}),$(t).triggerHandler("currentDocumentChange",[y,r]),d.addMeasurement(n)}function R(){if(!y)return;var e=y;y=null,$(t).triggerHandler("currentDocumentChange",[y,e])}function U(e,t){if(y&&y.file.fullPath===e.fullPath){var n=I(1);n&&n.fullPath===y.file.fullPath&&(n=null),n&&!t?h.execute(v.FILE_OPEN,{fullPath:n.fullPath}).done(function(){console.assert(!y||y.file.fullPath!==e.fullPath)}).fail(function(){U(e)}):R()}_(e)}function z(){R(),D()}function W(e,n){var r=[],i;if(!e)return;n&&R(),e.forEach(function(e){i=k(e.fullPath),i!==-1&&(r.push(E[i]),E.splice(i,1),S.splice(k(e.fullPath,S),1),x.splice(k(e.fullPath,x),1))}),$(t).triggerHandler("workingSetRemoveList",[r])}function X(){A().forEach(function(e){e._refCount===1&&e._masterEditor&&o._destroyEditorIfUnneeded(e)})}function V(e){var t;for(t in N)if(N.hasOwnProperty(t)&&N[t].file.fullPath===e)return N[t];return null}function J(e){var t=V(e);if(t)return(new $.Deferred).resolve(t).promise();if(e.indexOf(w)===0)return console.error("getDocumentForPath called for non-open untitled document: "+e),(new $.Deferred).reject().promise();var n=a.getFileForPath(e),r=J._pendingDocumentPromises[n.id];if(r)return r;var s=new $.Deferred,o=s.promise();J._pendingDocumentPromises[n.id]=o;var u=d.markStart("getDocumentForPath:	"+e);return s.done(function(){d.addMeasurement(u)}).fail(function(){d.finalizeMeasurement(u)}),l.readAsText(n).always(function(){delete J._pendingDocumentPromises[n.id]}).done(function(e,r){t=new i.Document(n,r,e),X(),s.resolve(t)}).fail(function(e){s.reject(e)}),o}function K(e,t){var n=new $.Deferred,r=V(e.fullPath);return r?n.resolve(r.getText(),r.diskTimestamp,t?r._lineEndings:null):e.read(function(e,r,s){if(e)n.reject(e);else{var o=t?l.sniffLineEndings(r):null;r=i.Document.normalizeText(r),n.resolve(r,s.mtime,o)}}),n.promise()}function Q(e,t){var n=g.UNTITLED+"-"+e+t,r=w+"/"+n,s=new Date,o=new c(r,a);return new i.Document(o,s,"")}function G(e,t){U(e,t);var n=V(e.fullPath);n&&$(n).triggerHandler("deleted"),n&&n._refCount>0&&console.log("WARNING: deleted Document still has "+n._refCount+" references. Did someone addRef() without listening for 'deleted'?")}function Y(){var e=[],t=!1,n=C(),r=b(),i=s.getProjectRoot(),u={location:{scope:"user",layer:"project",layerID:i.fullPath}};if(!i)return;n.forEach(function(n,i){if(!(n instanceof c)){t=r&&n.fullPath===r.file.fullPath;var s=o._getViewState(n.fullPath);e.push({file:n.fullPath,active:t,viewState:s})}}),f.setViewState("project.files",e,u)}function Z(e){var t=s.getProjectRoot(),n=[],r={location:{scope:"user",layer:"project"}};n=f.getViewState("project.files",r),console.assert(Object.keys(N).length===0);if(!n)return;var i=[],u={},l;n.forEach(function(e,t){i.push(a.getFileForPath(e.file)),e.active&&(l=e.file),e.viewState&&(u[e.file]=e.viewState)}),M(i),o._resetViewStates(u),!l&&E.length>0&&(l=E[0].fullPath);if(l){var c=h.execute(v.FILE_OPEN,{fullPath:l});e.promises.push(c)}}function et(e,n,i){r.forEach(N,function(e,t){e._notifyFilePathChanged()}),$(t).triggerHandler("fileNameChange",[e,n])}function tt(e){u.syncOpenDocuments(g.FILE_DELETED_TITLE),$(t).triggerHandler("pathDeleted",e)}function nt(e,t){r.forEach(N,function(e,t){e.getLanguage().isFallbackLanguage()&&e._updateLanguage()})}function rt(e,t){r.forEach(N,function(e,n){var r=e.getLanguage();(r===t||r.isFallbackLanguage())&&e._updateLanguage()})}function it(e){var t="files_";if(e.indexOf(t)===0){var n=e.substr(t.length);return"user project.files "+n}return null}var r=e("thirdparty/lodash"),i=e("document/Document"),s=e("project/ProjectManager"),o=e("editor/EditorManager"),u=e("project/FileSyncManager"),a=e("filesystem/FileSystem"),f=e("preferences/PreferencesManager"),l=e("file/FileUtils"),c=e("document/InMemoryFile"),h=e("command/CommandManager"),p=e("utils/Async"),d=e("utils/PerfUtils"),v=e("command/Commands"),m=e("language/LanguageManager"),g=e("strings"),y=null,w="/_brackets_"+r.random(1e7,99999999),E=[],S=[],x=[],T=!1,N={};J._pendingDocumentPromises={},$(i).on("_afterDocumentCreate",function(e,n){if(N[n.file.id])return console.error("Document for this path already in _openDocuments!"),!0;N[n.file.id]=n,$(t).triggerHandler("afterDocumentCreate",n)}).on("_beforeDocumentDelete",function(e,n){if(!N[n.file.id])return console.error("Document with references was not in _openDocuments!"),!0;$(t).triggerHandler("beforeDocumentDelete",n),delete N[n.file.id]}).on("_documentRefreshed",function(e,n){$(t).triggerHandler("documentRefreshed",n)}).on("_dirtyFlagChange",function(e,n){$(t).triggerHandler("dirtyFlagChange",n),n.isDirty&&O(n.file)}).on("_documentSaved",function(e,n){$(t).triggerHandler("documentSaved",n)}),f.convertPreferences(n,{files_:"user"},!0,it),$(t).on("documentSaved",function(e,t){f.fileChanged(t.file.fullPath)}),t._clearCurrentDocument=R,t.Document=i.Document,t.getCurrentDocument=b,t._clearCurrentDocument=R,t.getDocumentForPath=J,t.getOpenDocumentForPath=V,t.getDocumentText=K,t.createUntitledDocument=Q,t.getWorkingSet=C,t.findInWorkingSet=k,t.findInWorkingSetAddedOrder=L,t.getAllOpenDocuments=A,t.setCurrentDocument=q,t.addToWorkingSet=O,t.addListToWorkingSet=M,t.removeFromWorkingSet=_,t.removeListFromWorkingSet=W,t.getNextPrevFile=I,t.swapWorkingSetIndexes=H,t.sortWorkingSet=B,t.beginDocumentNavigation=j,t.finalizeDocumentNavigation=F,t.closeFullEditor=U,t.closeAll=z,t.notifyFileDeleted=G,t.notifyPathNameChanged=et,t.notifyPathDeleted=tt,d.createPerfMeasurement("DOCUMENT_MANAGER_GET_DOCUMENT_FOR_PATH","DocumentManager.getDocumentForPath()");var st=$(s);st.on("projectOpen",Z),st.on("beforeProjectClose beforeAppClose",Y),$(m).on("languageAdded",nt),$(m).on("languageModified",rt)}),define("project/FileViewController",["require","exports","module","document/DocumentManager","command/CommandManager","editor/EditorManager","utils/PerfUtils","command/Commands"],function(e,t,n){function h(){$(t).triggerHandler("documentSelectionFocusChange"),s.focusEditor()}function p(e){if(e!==l&&e!==f){console.error("Bad parameter passed to FileViewController.setFileViewFocus");return}c=e,$(t).triggerHandler("fileViewFocusChange")}function d(e,t){var n;if(t!==l&&t!==f){console.error("Bad parameter passed to FileViewController.openAndSelectDocument");return}a=!0,c=t;var o=r.getCurrentDocument();return o&&o.file.fullPath===e&&!s.getCustomViewerForPath(e)?(h(),n=(new $.Deferred).resolve().promise()):n=i.execute(u.FILE_OPEN,{fullPath:e}),n.always(function(){a=!1}),n}function v(e,t,n){var r=new $.Deferred,s=i.execute(u.FILE_ADD_TO_WORKING_SET,{fullPath:e,index:n});return s.done(function(e){e&&(c=t||f),h(),r.resolve(e)}).fail(function(e){r.reject(e)}),r.promise()}function m(){return c}var r=e("document/DocumentManager"),i=e("command/CommandManager"),s=e("editor/EditorManager"),o=e("utils/PerfUtils"),u=e("command/Commands"),a=!1,f="WorkingSetView",l="ProjectManager",c=l;$(r).on("workingSetAdd",function(e,n){c=f,$(t).triggerHandler("documentSelectionFocusChange")}),$(s).on("currentlyViewedFileChange",function(e){var n;if(!a){var i=r.getCurrentDocument();n=o.markStart("FileViewController._onCurrentDocumentChange():	"+(!i||i.file.fullPath)),i&&r.findInWorkingSet(i.file.fullPath)!==-1?c=f:c=l}$(t).triggerHandler("documentSelectionFocusChange"),a||o.addMeasurement(n)}),t.getFileSelectionFocus=m,t.openAndSelectDocument=d,t.addToWorkingSetAndSelect=v,t.setFileViewFocus=p,t.WORKING_SET_VIEW=f,t.PROJECT_MANAGER=l}),define("project/ProjectManager",["require","exports","module","utils/Global","thirdparty/jstree_pre1.0_fix_1/jquery.jstree","thirdparty/lodash","utils/AppInit","preferences/PreferencesDialogs","preferences/PreferencesManager","document/DocumentManager","document/InMemoryFile","command/CommandManager","command/Commands","widgets/Dialogs","widgets/DefaultDialogs","utils/DeprecationWarning","language/LanguageManager","command/Menus","utils/StringUtils","strings","filesystem/FileSystem","project/FileViewController","utils/PerfUtils","utils/ViewUtils","file/FileUtils","filesystem/FileSystemError","i18n!nls/urls","utils/KeyEvent","utils/Async","project/FileSyncManager","editor/EditorManager"],function(e,t,n){function st(){var e=rt;return rt=o.get("sortDirectoriesFirst"),M=rt?"a":"",_=rt?"b":"",e!==rt}function ot(){return b.getFileSelectionFocus()===b.PROJECT_MANAGER}function ut(e,t){t=t===undefined?!0:t,K&&(e&&!J&&K.triggerHandler("selectionChanged",t),W.triggerHandler("selectionRedraw"),X.triggerHandler("contentChanged"))}function at(){var e=X.jstree("get_selected");return e?e.data("entry"):null}function ft(){var e=at();if(!e){var t=u.getCurrentDocument();e=t&&t.file}return e}function lt(){ut(!0)}function ct(){var e=L.getCurrentlyViewedPath();if(e&&ot()){var t=$("#project-files-container li").is(function(t){var n=$(this),r=n.data("entry");return r&&r.fullPath===e?(X.jstree("is_selected",n)||(n.parents(".jstree-closed").length?(X.jstree("deselect_all"),V=n):(X.jstree("deselect_all"),X.jstree("select_node",n,!1))),!0):!1});t||(X.jstree("deselect_all"),V=null)}else X!==null&&(X.jstree("deselect_all"),V=null);ut(!0)}function ht(){return Q}function pt(){return G}function dt(e){var t={location:{scope:"user",layer:"project",layerID:Q.fullPath}};G=e,G.length>0&&G[G.length-1]!=="/"&&(G+="/"),o.setViewState("project.baseUrl",G,t)}function vt(e){var t=e.fullPath||e;return Q&&t.indexOf(Q.fullPath)===0}function mt(e){return vt(e)?e.slice(Q.fullPath.length):e}function gt(){o.setViewState("projectPath",Q.fullPath);var e=[],t=Q.fullPath.length,n,r,i,s,u={location:{scope:"user",layer:"project",layerID:Q.fullPath}};$(".jstree-open:visible").each(function(o){n=$(this).data("entry"),n.fullPath&&(r=n.fullPath,i=r.slice(t,-1),s=i.split("/").length-1,e[s]===undefined&&(e[s]=[]),e[s].push(r))}),o.setViewState("project.treeState",e,u)}function yt(e,t){var n=W.get(0).scrollTop;J=!0,e&&X.jstree("deselect_node",e),X.jstree("select_node",t,!1),J=!1,W.get(0).scrollTop=n,ut(!0,!1)}function bt(e){return $(e).closest("li").find("input").length>0}function wt(e,t){if(e.length===0)t.resolve();else{var n=e.shift(),r=[],i=null;n.forEach(function(e,t){i=Y.fullPathToIdMap[e],i&&r.push(i)}),C.doInParallel(r,function(e){var t=new $.Deferred;return X.jstree("open_node","#"+e,function(){t.resolve()},!0),t.promise()},!1).always(function(){wt(e,t)})}}function St(e){var t=new $.Deferred;return W.scrollTop(0),W.hide().addClass("no-focus"),X=W.jstree({plugins:["ui","themes","json_data","crrm","sort"],ui:{select_limit:1,select_multiple_modifier:"",select_range_modifier:""},json_data:{data:e,correct_state:!1},core:{html_titles:!0,animation:0,strings:{loading:g.PROJECT_LOADING,new_node:"New node"}},themes:{theme:"brackets",url:"styles/jsTreeTheme.css",dots:!1,icons:!1},sort:Et}).bind("before.jstree",function(e,t){t.func==="toggle_node"&&(tt=X.jstree("is_open",t.args[0]))}).bind("select_node.jstree",function(e,t){var n=t.rslt.obj.data("entry");if(n)if(n.isFile){var r=b.openAndSelectDocument(n.fullPath,b.PROJECT_MANAGER);r.done(function(){ut(!0),V=t.rslt.obj}).fail(function(){V?yt(t.rslt.obj,V):(X.jstree("deselect_all"),V=null)})}else b.setFileViewFocus(b.PROJECT_MANAGER),ut(!0),tt||X.jstree("toggle_node",t.rslt.obj);tt=!1}).bind("reopen.jstree",function(e,n){Y.previous&&(wt(Y.previous,t),Y.previous=null)}).bind("scroll.jstree",function(e){v.closeAll()}).bind("loaded.jstree open_node.jstree close_node.jstree",function(e,t){if(e.type==="open_node"){var n=u.getCurrentDocument();if(ot()&&n&&t){var r=t.rslt.obj.data("entry");r&&n.file.fullPath.indexOf(r.fullPath)===0?yt(t.rslt.obj,V):ut(!0,!1)}}else e.type==="close_node"?ut(!0,!1):ut(!1);gt()}).bind("mousedown.jstree",function(e){if(e.which===3||e.ctrlKey&&e.which===1&&brackets.platform==="mac"){var t=$(e.target).closest("li");if(t){var n=tt;tt=!0,X.jstree("deselect_all"),X.jstree("select_node",t,!1),tt=n}}}).bind("mouseup.jstree",function(e){if(e.button!==0)return;var t=$(e.target).closest("li"),n=t.data("entry");if(bt(t))return;n&&n.isFile&&t.is($(X.jstree("get_selected")))&&(it=window.setTimeout(function(){it!==null&&f.execute(l.FILE_RENAME)},500))}),X.bind("init.jstree",function(){E.addScrollerShadow(X.get(0));var e=function(e,t,n){var i=$._data(X[0],"events"),s=i?i[e]:null,o=s?r.find(s,function(e){return e.namespace===t&&e.selector===n}):null,u=o?o.handler:null;return u||console.error(e+"."+t+" "+n+" handler not found!"),u},t=function(e){return function(t){var n=$(t.target).parent("li"),r;if(t.ctrlKey||t.metaKey){if(t.altKey){r=n.is(".jstree-open")?"close_all":"open_node",X.jstree(r,n);return}r=n.is(".jstree-open")?"close_node":"open_node",n.parent().children("li").each(function(){X.jstree(r,$(this))});return}e.apply(this,arguments)}},n=e("click","jstree","a"),i=e("click","jstree","li > ins");X.off("click.jstree","a").on("click.jstree","a",t(n)).off("click.jstree","li > ins").on("click.jstree","li > ins",t(i)).unbind("dblclick.jstree").bind("dblclick.jstree",function(e){var t=$(e.target).closest("li").data("entry");t&&t.isFile&&!bt(e.target)&&b.addToWorkingSetAndSelect(t.fullPath),it!==null&&(window.clearTimeout(it),it=null)}),K=W.find("ul"),E.sidebarList(W,"jstree-clicked","jstree-leaf"),W.show()}),C.withTimeout(t.promise(),1e3)}function xt(e,t,n,r){var i=t?g.DIRECTORY_TITLE:g.FILE_TITLE,s=t?g.DIRECTORY:g.FILE,o,u;r=m.breakableUrl(r);switch(e){case H:o=m.format(g.ERROR_CREATING_FILE_TITLE,i),u=m.format(g.ERROR_CREATING_FILE,s,r,n);break;case B:o=m.format(g.INVALID_FILENAME_TITLE,i),u=m.format(g.ENTRY_WITH_SAME_NAME_EXISTS,r);break;case j:o=m.format(g.ERROR_RENAMING_FILE_TITLE,i),u=m.format(g.ERROR_RENAMING_FILE,r,n,s);break;case F:o=m.format(g.ERROR_DELETING_FILE_TITLE,i),u=m.format(g.ERROR_DELETING_FILE,r,n,s);break;case I:o=g.ERROR_LOADING_PROJECT,u=m.format(g.READ_DIRECTORY_ENTRIES_ERROR,r,n);break;case q:o=g.ERROR_LOADING_PROJECT,u=m.format(g.REQUEST_NATIVE_FILE_SYSTEM_ERROR,r,n);break;case R:o=g.ERROR_MAX_FILES_TITLE,u=g.ERROR_MAX_FILES;break;case U:o=g.ERROR_LOADING_PROJECT,u=m.format(g.OPEN_DIALOG_ERROR,n);break;case z:o=m.format(g.INVALID_FILENAME_TITLE,t?g.DIRECTORY_NAME:g.FILENAME),u=m.format(g.INVALID_FILENAME_MESSAGE,t?g.DIRECTORY_NAMES_LEDE:g.FILENAMES_LEDE,n)}return o&&u?c.showModalDialog(h.DIALOG_ID_ERROR,o,u):null}function Tt(e){return!e.match(D)}function Nt(e){return Tt(e.name)}function Ct(e){return p.deprecationWarning("ProjectManager.isBinaryFile() called for "+e+". Use LanguageManager.getLanguageForPath(fileName).isBinary() instead."),d.getLanguageForPath(e).isBinary()}function kt(e,t){return(t?M:_)+e}function Lt(e,t){var n=e.fullPath||e;Y.fullPathToIdMap[n]=t}function At(e){var t=e.fullPath||e;delete Y.fullPathToIdMap[t]}function Ot(e){if(!Nt(e))return null;var t={data:e.name,attr:{id:"node"+Y.id++},metadata:{entry:e,compareString:kt(e.name,e.isDirectory)}};return e.isDirectory?(t.children=[],t.state="closed",t.data=r.escape(t.data)):t.data=E.getFileEntryDisplay(e),Lt(e,t.attr.id),t}function Mt(e){var t=[],n,r,i;for(r=0;r<e.length;r++)t.push(Ot(e[r]));return t}function _t(e,t){function s(n){var s=Mt(n),o=!1,u=s.length===0;u&&(r?s.push({}):o=e.hasClass("jstree-open")),t(s);if(!r&&u){var a=o?"jstree-closed":"jstree-open";e.removeClass("jstree-leaf jstree-closed jstree-open").addClass(a),o||e.trigger("open_node.jstree")}i.resolve()}var n,r=!1,i=new $.Deferred;e===-1?(n=Q,r=!0):n=e.data("entry"),n.getContents(function(e,t,r,o){e?(xt(I,null,e,n.fullPath),i.reject()):(o&&console.warn("Error reading a subset of folder "+n),s(t))})}function Dt(){$(".jstree-rename-input").blur()}function Pt(e){return e[e.length-1]!=="/"?e+"/":e}function Ht(){var e=S.getNativeBracketsDirectoryPath(),t=T.GETTING_STARTED;return t&&(e=e.substr(0,e.lastIndexOf("/"))+"/samples/"+t),Pt(e)}function Bt(e){if(e===Ht())return!0;var t=S.stripTrailingSlash(e),n=o.getViewState("welcomeProjects")||[];return n.indexOf(t)!==-1}function jt(e){var t=S.stripTrailingSlash(e),n=o.getViewState("welcomeProjects")||[];n.indexOf(t)===-1&&(n.push(t),o.setViewState("welcomeProjects",n))}function Ft(e){return Bt(e)?Ht():e}function It(){return Ft(o.getViewState("projectPath"))}function qt(e){y.on("change",A),y.on("rename",O),y.watch(y.getDirectoryForPath(e),Tt,function(t){t===x.TOO_MANY_ENTRIES?xt(R):t&&console.error("Error watching project root: ",e,t)}),nt=null}function Rt(){var e=new $.Deferred;return Q?(y.off("change",A),y.off("rename",O),y.unwatch(Q,function(t){t?(console.error("Error unwatching project root: ",Q.fullPath,t),e.reject()):e.resolve()}),nt=null):e.reject(),e.promise()}function Ut(){var e=ht();e?o._setProjectSettingsFile(e.fullPath+P):o._setProjectSettingsFile()}function zt(e,n){var r=new $.Deferred,i=new $.Deferred,s;Dt(),e=Pt(e);if(n)i.resolve();else{if(Q&&Q.fullPath===e)return(new $.Deferred).resolve().promise();Q&&$(t).triggerHandler("beforeProjectClose",Q),u.closeAll(),Rt().always(function(){Q&&(o._reloadUserPrefs(Q),$(t).triggerHandler("projectClose",Q)),i.resolve()})}return i.done(function(){var i={location:{scope:"user",layer:"project"}};Y={previous:[],id:0,fullPathToIdMap:{}},n||o._stateProjectLayer.setProjectPath(e),Y.previous=o.getViewState("project.treeState",i)||[];if(!brackets.inBrowser){n||qt(e);var u=y.getDirectoryForPath(e);u.exists(function(n,a){if(a){var f=!Q||!u||Q.fullPath!==u.fullPath,l=w.markStart("Load Project: "+e);Q=u,f&&(Ut(),o._setCurrentEditingFile(e)),G=o.getViewState("project.baseUrl",i)||"",nt=null,e===Ht()&&jt(e),s=St(_t),s.always(function(){if(f){var e=[];$(t).triggerHandler({type:"projectOpen",promises:e},[Q]),$.when.apply($,e).then(r.resolve,r.reject)}else $(t).triggerHandler("projectRefresh",Q),r.resolve()}),s.fail(function(){w.finalizeMeasurement(l),r.reject()}),s.always(function(){w.addMeasurement(l)})}else xt(q,null,e,n||x.NOT_FOUND).done(function(){Q=null,zt(Ht()).always(function(){r.reject()})})})}}),r.promise()}function Wt(e){if(e===ht())return K;var t=e.fullPath||e,n=Y.fullPathToIdMap[t],r=null;return n&&(r=$("#"+n)),r}function Xt(e){function u(e,n){var i=o[n],a=r.findIndex(e,function(e,t){var n=$(e).data("entry"),r=n?n.name:null;return r===i});if(a===-1)t.reject();else{var f=e.eq(a);if(n===o.length-1)t.resolve(f);else{var l=s._get_children(f);l.length>0?u(l,n+1):s.load_node(f,function(e){l=s._get_children(f),u(l,n+1)},function(e){t.reject()})}}}var t=new $.Deferred,n=Wt(e);if(n)return t.resolve(n).promise();var i=mt(e.fullPath);if(i===e.fullPath)return t.reject().promise();if(e===ht())return t.resolve(K).promise();var s=$.jstree._reference(X),o=i.split("/");e.isDirectory&&o.pop();var a=s._get_children(-1);return u(a,0),t.promise()}function Vt(){var e,t=new $.Deferred;return V&&(e=V.data("entry")),V=null,zt(ht().fullPath,!0).then(function(){e?Xt(e).done(function(e){yt(null,e)}).always(t.resolve):t.resolve()},t.reject),t.promise()}function Qt(){if(!$t){var e=Vt(),t=new $.Deferred;$t=t.promise(),$t.always(function(){$t=null,Jt&&(Jt=!1,Qt())}),window.setTimeout(function(){e.then(t.resolve,t.reject)},Kt)}else Jt=!0;return $t}function Gt(e){return Xt(e).done(function(e){X.jstree("select_node",e,!1)})}function Yt(e){var t=new $.Deferred;return f.execute(l.FILE_CLOSE_ALL,{promptOnly:!0}).done(function(){e?zt(e,!1).then(t.resolve,t.reject):y.showOpenDialog(!1,!0,g.CHOOSE_FOLDER,Q.fullPath,null,function(e,n){e?(xt(U,null,e),t.reject()):n.length>0?zt(n[0]).then(t.resolve,t.reject):t.reject()})}).fail(function(){t.reject()}),t.promise()}function Zt(){return s.showProjectPreferencesDialog(pt()).getPromise()}function en(e,t){return e.search(new RegExp("["+Z+"]+"))!==-1||e.match(et)?(xt(z,t,Z),!1):!0}function tn(e,t,n,r,i){typeof n=="string"?n=[{data:n}]:Array.isArray(n)||(n=[n]),t=t||0,n.forEach(function(n){typeof n=="string"&&(n={data:n,metadata:{compareString:_+n}}),n&&X.jstree("create",e,t,n,null,r)}),i||ut(!0)}function nn(e,t,n,r){var i=typeof e=="string"?y.getDirectoryForPath(e):e,s=vt(i)?i:ht(),o=e&&Wt(s)||null,u="inside",a=!1,f=new $.Deferred,l=o===K,c=l||o&&o.hasClass("jstree-open")||!1,h={};if(!o)return f.reject().promise();h.data=t,h.metadata={compareString:kt(t,r)},X.on("create.jstree",function(e,t){function n(){var e=t.inst._get_parent(t.rslt.obj);X.jstree("remove",t.rslt.obj);if(e&&e!==-1){var n=c?"open_node":"close_node",r=c?"jstree-open":"jstree-closed";X.jstree(n,e),e.removeClass("jstree-leaf jstree-closed jstree-open").addClass(r)}ut(!0),f.reject()}$(e.target).off("create.jstree");if(!a){if(!en(t.rslt.name,r)){n();return}var i=function(e){X.jstree("remove",t.rslt.obj),X.one("create.jstree",function(t,n){X.jstree("select_node",n.rslt.obj,!0),f.resolve(e)}),tn(o,null,Ot(e),!0,!0)},u=function(e){if(e===x.ALREADY_EXISTS)xt(B,r,null,t.rslt.name);else{var i=e===x.NOT_WRITABLE?g.NO_MODIFICATION_ALLOWED_ERR:m.format(g.GENERIC_ERROR,e);xt(H,r,i,t.rslt.name)}n()},l=s.fullPath+t.rslt.name;y.resolve(l,function(e){if(!e)u(x.ALREADY_EXISTS);else if(r){var t=y.getDirectoryForPath(l);t.create(function(e){e?u(e):i(t)})}else{var n=y.getFileForPath(l);n.write("",function(e){e?u(e):i(n)})}})}else n()});if(c){tn(o,u,h,n);if(!n){var p=X.find(".jstree-rename-input");p.on("keydown",function(e){e.keyCode===N.DOM_VK_ESCAPE&&(a=!0)}),E.scrollElementIntoView(X,p,!0)}}else X.one("open_node.jstree",function(){tn(o,u,h,n)}),X.jstree("open_node",o);return f.promise()}function rn(e,t,n){var r=new $.Deferred;if(e===t)return r.resolve(),r.promise();var i=n?y.getDirectoryForPath(e):y.getFileForPath(e);return i.rename(t,function(e){if(!e)L.getCurrentlyViewedPath()&&b.openAndSelectDocument(L.getCurrentlyViewedPath(),b.getFileSelectionFocus()),ut(!0),r.resolve();else{var i=e===x.ALREADY_EXISTS?g.FILE_EXISTS_ERR:S.getFileErrorString(e);xt(j,n,i,t),r.reject(e)}}),r.promise()}function sn(e){Gt(e).done(function(t){if(bt(t))return;var n=t.hasClass("jstree-open")||t.hasClass("jstree-closed");X.one("rename.jstree",function(i,s){var o=r.unescape(s.rslt.old_name),u=r.unescape(s.rslt.new_name),a=o!==u,f=function(){X.jstree("set_text",t,E.getFileEntryDisplay(e))};if(!a||!en(u,n)){f();return}var l=t.data("entry").fullPath,c=n?"(?=/$)":"$",h=new RegExp(m.regexEscape(o)+c),p=l.replace(h,u);rn(l,p,n).done(function(){X.jstree("set_text",t,E.getFileEntryDisplay(e)),t.data("compareString",kt(e.name,n)),At(l),Lt(e,t.attr("id"));if(n){var r=tt;tt=!0,X.jstree("select_node",t,!0),tt=r}}).fail(function(e){f()}).always(function(){X.jstree("sort",t.parent()),ut(!0)})});var i=r.escape(e.name);X.jstree("set_text",t,i),X.jstree("rename");var s=S.getSmartFileExtension(e.name);if(s){var o=i.length-s.length-1;o>0&&t.children(".jstree-rename-input")[0].setSelectionRange(0,o)}})}function on(e,t){var n=Array.isArray(e)?e:[e],r=tt,i=$.jstree._reference(X);tt=!0,n.forEach(function(e){var t=Wt(e),n,r,s,o=!1;e.parentPath&&(n=y.getDirectoryForPath(e.parentPath),r=n!==ht()&&Wt(n),r&&(o=r.hasClass("jstree-open"))),t&&(X.jstree("delete_node",t),At(e),r&&(s=i._get_children(r),s.length===0&&r.hasClass("jstree-leaf")&&(r.removeClass("jstree-leaf jstree-open jstree-closed"),o?r.addClass("jstree-open"):r.addClass("jstree-closed"))))}),tt=r,t||ut(!0),n.forEach(function(e){u.getCurrentDocument()?u.notifyPathDeleted(e.fullPath):L.notifyPathDeleted(e.fullPath)})}function un(e){var t=new $.Deferred;return e.moveToTrash(function(n){n?(xt(F,e.isDirectory,S.getFileErrorString(n),e.fullPath),t.reject(n)):(on(e),t.resolve())}),t.promise()}function an(){if(!nt){var e=new $.Deferred,t=[],n=function(e){return Nt(e)?(e.isFile&&t.push(e),!0):!1};nt=e.promise(),ht().visit(n,function(n){n?(e.reject(),nt=null):e.resolve(t)})}return nt}function fn(e,t){t===undefined&&typeof e!="function"&&(t=e,e=null);var n=new $.Deferred;return an().done(function(r){t&&u.getWorkingSet().forEach(function(e){r.indexOf(e)===-1&&!(e instanceof a)&&r.push(e)}),e&&(r=r.filter(e));try{n.resolve(r)}catch(i){console.warn("Unhandled exception in getAllFiles handler: ",i)}}),n.promise()}function ln(e){return function(n){return d.getLanguageForPath(n.fullPath).getId()===e}}function cn(e){var t="projectTreeState_",n;return e.indexOf(t)===0?(n=e.substr(t.length),"user project.treeState "+n):(t="projectBaseUrl_",e.indexOf(t)===0?(n=e.substr(e.indexOf(" ")+1),n=n.substr(0,n.length-1),"user project.baseUrl "+n):null)}e("utils/Global"),e("thirdparty/jstree_pre1.0_fix_1/jquery.jstree");var r=e("thirdparty/lodash"),i=e("utils/AppInit"),s=e("preferences/PreferencesDialogs"),o=e("preferences/PreferencesManager"),u=e("document/DocumentManager"),a=e("document/InMemoryFile"),f=e("command/CommandManager"),l=e("command/Commands"),c=e("widgets/Dialogs"),h=e("widgets/DefaultDialogs"),p=e("utils/DeprecationWarning"),d=e("language/LanguageManager"),v=e("command/Menus"),m=e("utils/StringUtils"),g=e("strings"),y=e("filesystem/FileSystem"),b=e("project/FileViewController"),w=e("utils/PerfUtils"),E=e("utils/ViewUtils"),S=e("file/FileUtils"),x=e("filesystem/FileSystemError"),T=e("i18n!nls/urls"),N=e("utils/KeyEvent"),C=e("utils/Async"),k=e("project/FileSyncManager"),L=e("editor/EditorManager");o.definePreference("sortDirectoriesFirst","boolean",brackets.platform!=="mac");var A,O,M,_,D=/\.pyc$|^\.git$|^\.gitmodules$|^\.svn$|^\.DS_Store$|^Thumbs\.db$|^\.hg$|^CVS$|^\.hgtags$|^\.idea$|^\.c9revisions$|^\.sass-cache$|^\.SyncArchive$|^\.SyncID$|^\.SyncIgnore$|\~$/,P="."+o.SETTINGS_FILENAME,H=1,B=2,j=3,F=4,I=5,q=6,R=7,U=8,z=9,W,X=null,V=null,J=!1,K,Q=null,G="",Y=null,Z,et=/^(\.+|com[1-9]|lpt[1-9]|nul|con|prn|aux|)$|\.+$/i,tt=!1,nt=null,rt,it=null,Et=r.memoize(function(e,t){var n=$(e).data("compareString"),r=$(t).data("compareString");return S.compareFilenames(n,r,!1)},function(e,t){return $(e).data("compareString")+":"+$(t).data("compareString")}),$t=null,Jt=!1,Kt=1e3;A=function(e,t,n,r){k.syncOpenDocuments(),nt=null;if(!t){Qt();return}var i=Wt(t);if(!t.isDirectory||!i||!vt(t.fullPath))return;if(!n||!r){Qt();return}var s=i.hasClass("jstree-open"),o=!1;r.length>0&&(on(r,!0),o=!0);var u=n.filter(function(e){return!Wt(e)});u=u.map(Ot);if(u.length>0){var a=i.hasClass("jstree-closed");if(s&&a)X.one("open_node.jstree",function(){ut(!0)}),X.jstree("open_node",i);else{var f=$.jstree._reference(X),l=t===ht()?-1:i,c=f._get_children(l).length>0;c?tn(i,null,u,!0,!0):a||X.jstree("load_node",i,function(){},function(){console.error("Error loading project tree for changed path: "+t.fullPath)}),o=!0}}o&&ut(!0)},O=function(e,t,n){u.notifyPathNameChanged(t,n)},i.htmlReady(function(){W=$("#project-files-container"),$("#open-files-container").on("contentChanged",function(){ut(!1)}),$(".main-view").click(function(e){e.target.className!=="jstree-rename-input"&&Dt()}),W.on("contextmenu",function(){Dt()})}),o.stateManager.definePreference("projectPath","string",Ht()),o.convertPreferences(n,{projectPath:"user",projectTreeState_:"user",welcomeProjects:"user",projectBaseUrl_:"user"},!0,cn),st(),o.on("change","sortDirectoriesFirst",function(){st()&&Qt()}),$(b).on("documentSelectionFocusChange",ct),$(b).on("fileViewFocusChange",lt),$(t).on("beforeAppClose",Rt),f.register(g.CMD_OPEN_FOLDER,l.FILE_OPEN_FOLDER,Yt),f.register(g.CMD_PROJECT_SETTINGS,l.FILE_PROJECT_SETTINGS,Zt),f.register(g.CMD_FILE_REFRESH,l.FILE_REFRESH,Qt),brackets.platform==="mac"?Z="?*|:":brackets.platform==="linux"?Z="?*|/":Z='/?*:<>\\|"',t.getProjectRoot=ht,t.getBaseUrl=pt,t.setBaseUrl=dt,t.isWithinProject=vt,t.makeProjectRelativeIfPossible=mt,t.shouldShow=Nt,t.isBinaryFile=Ct,t.openProject=Yt,t.getSelectedItem=ft,t.getInitialProjectPath=It,t.isWelcomeProjectPath=Bt,t.updateWelcomeProjectPath=Ft,t.createNewItem=nn,t.renameItemInline=sn,t.deleteItem=un,t.forceFinishRename=Dt,t.showInTree=Gt,t.refreshFileTree=Qt,t.getAllFiles=fn,t.getLanguageFilter=ln}),define("language/HTMLUtils",["require","exports","module","thirdparty/CodeMirror2/lib/codemirror","utils/TokenUtils"],function(e,t,n){function l(e){var t=e.token.string,n=t.charAt(0),r=t.charAt(t.length-1),s=i.offsetInToken(e),o=!1;if(t.length>1&&(n==="'"||n==='"')&&r===n){o=t.match(/\=\s*['"]$/)!==null;if(!o)return t=t.substring(1,t.length-1),s=s-1>t.length?t.length:s-1,{val:t,offset:s,quoteChar:n,hasEndQuote:!0}}if(o){var u=t.indexOf(" "),a=t.indexOf(">"),f=u!==-1&&u<a?u:a;t=t.substring(0,f>s?f:s)}else s>0&&(n==="'"||n==='"')&&(t=t.substring(0,s));return n=t.charAt(0),n==="'"||n==='"'?(t=t.substring(1),s--):(n="",r===">"&&(t="",s=0)),{val:t,offset:s,quoteChar:n,hasEndQuote:!1}}function c(e){var t=e.editor.getMode(),n=r.innerMode(t,e.token.state);return e.token.type==="tag bracket"?n.state.tagName:n.state.tagName||e.token.string}function h(e,t){var n=[],r=i.getInitialContext(e._codeMirror,t),s=$.extend({},r);if(e.getModeForSelection()==="html"&&r.token&&!f.test(r.token.type)){while(i.movePrevToken(r)&&!f.test(r.token.type)){if(r.token.type==="error"&&r.token.string.indexOf("<")===0)break;r.token.type==="attribute"&&n.push(r.token.string)}while(i.moveNextToken(s)&&!f.test(s.token.type))if(s.token.type==="attribute"){if(s.token.string.indexOf("<")===0)break;n.push(s.token.string)}else if(s.token.type==="error"){if(s.token.string.indexOf("<")===0||s.token.string.indexOf(">")===0)break;/\S/.test(s.token.string)&&s.token.string.indexOf('"')===-1&&s.token.string.indexOf("'")===-1&&s.token.string.indexOf("=")===-1&&n.push(s.token.string)}}return n}function p(e,t,n,r,i,s,o,u){return{tagName:n||"",attr:{name:r||"",value:i||"",valueAssigned:s||!1,quoteChar:o||"",hasEndQuote:u||!1},position:{tokenType:e||"",offset:t||0}}}function d(e){var t=l(e),n=t.val,r=t.offset,s=t.quoteChar,o=t.hasEndQuote,u=e.token.string.length;if((e.token.type==="string"||e.token.type==="error")&&e.pos.ch===e.token.end&&u>1){var f=e.token.string[0],h=e.token.string[u-1];if(f===h&&(f==="'"||f==='"'))return p()}if(!i.moveSkippingWhitespace(i.movePrevToken,e)||e.token.string!=="=")return p();if(!i.moveSkippingWhitespace(i.movePrevToken,e)||e.token.type!=="attribute")return p();var d=e.token.string,v=c(e);return p(a,r,v,d,n,!0,s,o)}function v(e,t){if(t===!1&&e.token.type!=="attribute")return p();var n=c(e),r=e.token.string,s=i.offsetInToken(e);if(!i.moveSkippingWhitespace(i.moveNextToken,e)||e.token.string!=="=")return t&&(!e.token.type||e.token.type&&e.token.type!=="attribute"&&e.token.type.indexOf("error")===-1&&e.token.string.indexOf("<")!==-1)?p():p(u,s,n,r);if(!i.moveSkippingWhitespace(i.moveNextToken,e))return p(u,s,n,r);var o=l(e),a=o.val,f=o.quoteChar,h=o.hasEndQuote;return p(u,s,n,r,a,!0,f,h)}function m(e,t){var n=$.extend({},t),r=i.getInitialContext(e._codeMirror,n),l=null,h=i.offsetInToken(r),m,g;if(e.getModeForSelection()!=="html")return p();if(r.token.string.length>0&&!/\S/.test(r.token.string)){var y={ch:r.pos.ch+1,line:r.pos.line},b=e._codeMirror.getTokenAt(y,!0);if(b.string.length>0&&/\S/.test(b.string)&&b.string.charAt(0)!==">"){r.token=b;if(f.test(r.token.type)){if(r.token.string.charAt(0)==="<")return p()}else{if(r.token.type==="attribute")return v(r,!1);if(r.token.string==="=")return p()}}else{if(!i.movePrevToken(r))return p();if(r.token.type==="comment")return p();if(!f.test(r.token.type)&&r.token.string!=="=")return m=d(r),r.token.type==="comment"||f.test(r.token.type)&&(r.token.string===">"||r.token.string==="/>"||r.token.string==="</")?p():(m.tagName||(m=v(r,!0)),m.tagName?p(u,0,m.tagName):p());g=u,h=0}}if(f.test(r.token.type)){if(r.token.type!=="tag bracket"){if(i.movePrevToken(r)&&!/\S/.test(r.token.string))return p();r.token.type==="tag bracket"&&r.token.string==="</"&&(g=o),i.moveNextToken(r)}if(r.token.string===">"||r.token.string==="/>")return p();if(r.token.string!=="="&&r.token.string.match(/^["']/)===null)return g||(g=s,r.token.type==="tag bracket"&&(r.token.string==="</"?(g=o,h-=2):h=0,h===0&&i.moveNextToken(r))),p(g,h,c(r))}if(r.token.string==="="){if(!i.moveSkippingWhitespace(i.movePrevToken,r)||r.token.type!=="attribute")return p();g=a,h=0}return r.token.type==="attribute"?(m=v(r,!1),m.attr.quoteChar?h=t.ch-r.pos.ch:g===a&&t.ch+1<r.pos.ch&&(m.attr.value="")):m=d(r),g&&m.tagName&&(m.position.tokenType=g,m.position.offset=h),m}function g(e,t){var n=i.getInitialContext(e._codeMirror,{line:0,ch:0}),s=[],o=null,u=!1,a=e._codeMirror.getMode(),f,l;while(i.moveNextToken(n,!1))f=r.innerMode(a,n.token.state).mode.name,u?(o.end||(o.end=o.start),f===l?(o.text=e.document.getRange(o.start,o.end),u=!1):o.end={line:n.pos.line,ch:n.pos.ch}):f===t?(o={start:{line:n.pos.line,ch:n.pos.ch}},s.push(o),u=!0):l=f;return s}function y(e){return g(e,"css")}var r=e("thirdparty/CodeMirror2/lib/codemirror"),i=e("utils/TokenUtils"),s="tagName",o="closingTag",u="attr.name",a="attr.value",f=/^tag/;t.TAG_NAME=s,t.CLOSING_TAG=o,t.ATTR_NAME=u,t.ATTR_VALUE=a,t.getTagInfo=m,t.getTagAttributes=h,t.createTagInfo=p,t.findStyleBlocks=y,t.findBlocks=g}),define("language/CSSUtils",["require","exports","module","thirdparty/CodeMirror2/lib/codemirror","utils/Async","document/DocumentManager","editor/EditorManager","language/HTMLUtils","project/ProjectManager","utils/TokenUtils","thirdparty/lodash"],function(e,t,n){function y(e){var t,n;return!e||!e.token||!e.token.state||e.token.type==="comment"?!1:(t=e.token.state.localState||e.token.state,t.context?(n=t.context.type,n==="{"||n==="rule"||n==="block"):!1)}function b(e){function t(e){return e.type!=="parens"||!e.prev?!1:e.prev.type==="prop"?!0:t(e.prev)}var n;return!e||!e.token||!e.token.state||e.token.type==="comment"?!1:(n=e.token.state.localState||e.token.state,!n.context||!n.context.prev?!1:n.context.type==="prop"&&(n.context.prev.type==="rule"||n.context.prev.type==="block")||t(n.context))}function w(e){var t;return!e||!e.token||!e.token.state?!1:(t=e.token.state.localState||e.token.state,t.context?t.context.type==="at":!1)}function E(e,t,n,r,i,s,o){var u={context:e||"",offset:t||0,name:n||"",index:-1,values:[],isNewItem:s===!0,range:o};if(e===p||e===c||e===d)u.index=r,u.values=i;return u}function S(e){var t="",n=f.offsetInToken(e),r=e.token.string,i=[";","{","}"];if(e.token.type==="property"||e.token.type==="property error"||e.token.type==="tag")t=r,f.movePrevToken(e)&&/\S/.test(e.token.string)&&i.indexOf(e.token.string)===-1&&(t=e.token.string+r,n+=e.token.string.length);else if(e.token.type==="meta"||r==="-")t=r,f.moveNextToken(e)&&(e.token.type==="property"||e.token.type==="property error"||e.token.type==="tag")&&(t+=e.token.string);else{if(/\S/.test(r)&&i.indexOf(r)===-1)return E();var s={ch:e.pos.ch+1,line:e.pos.line},o=e.editor.getTokenAt(s,!0);if(o.type==="property"||o.type==="property error"||o.type==="tag")t=o.string,n=0}return t===""&&(n=0),E(h,n,t)}function x(e){var t=$.extend({},e),n="";do if(t.token.string!==":"&&!b(t))return"";while(t.token.string!==":"&&f.moveSkippingWhitespace(f.movePrevToken,t));return t.token.string===":"&&f.moveSkippingWhitespace(f.movePrevToken,t)&&(t.token.type==="property"||t.token.type==="property error")&&(n=t.token.string,f.movePrevToken(t)&&t.token.type==="meta"&&(n=t.token.string+n)),n}function T(e){var t="",n,r=[];while(e.token.string!==":"&&f.movePrevToken(e)){if(e.token.string===":"||!b(e))break;n=e.token.string,t!==""&&(n+=t),e.token.string.length>0&&!e.token.string.match(/\S/)||e.token.string===","?t=n:(t="",r.length===0||n.match(/,\s*$/)?r.push(n):r[r.length-1]=n+r[r.length-1])}return r.length>0&&r.reverse(),r}function N(e,t){var n=t,r,i=[];while(e.token.string!==";"&&e.token.string!=="}"&&f.moveNextToken(e)){if(e.token.string===";"||e.token.string==="}")break;if(!b(e)){n="";break}n===""?n=e.token.string.trim():n.length>0&&(e.token.string.length>0&&!e.token.string.match(/\S/)?(n+=e.token.string,i.push(n),n=""):e.token.string===","?n+=e.token.string:n&&n.match(/,$/)?(i.push(n),e.token.string.length>0?n=e.token.string:n=""):n+=e.token.string)}return n.length>0&&i.push(n),i}function C(e,t){var n={start:{},end:{}};while(f.moveNextToken(e))if(/\S/.test(e.token.string))break;while(t.token.string===";"||t.token.string==="}"||!/\S/.test(t.token.string))f.movePrevToken(t);return n.start=l.clone(e.pos),n.start.ch=e.token.start,n.end=l.clone(t.pos),n.end.ch=t.token.end,n}function k(e,t){var n=$.extend({},e.pos),r=$.extend({},e.pos),i=$.extend({},e.pos),s=f.getInitialContext(t._codeMirror,n),o,u,a="",c=[],h=-1,d=f.offsetInToken(e),v=!1,m={ch:e.pos.ch+1,line:e.pos.line},g=t._codeMirror.getTokenAt(m,!0),y,b;return y=x(s),y?(o=f.getInitialContext(t._codeMirror,r),c=T(o),a="",e.token.string===":"?(h=0,v=!0):(h=c.length-1,e.token.string===","?(c[h]+=e.token.string,h++,v=!0):(h=h<0?0:h+1,e.token.string.match(/\S/)?a=e.token.string:(v=!0,h>0&&(c[h-1]+=e.token.string.substr(0,d))))),v&&(d=0,t.document.getLine(e.pos.line).length>e.pos.ch&&(g.string.length===0||g.string.match(/\S/))&&(v=!1)),u=f.getInitialContext(t._codeMirror,i),c=c.concat(N(u,a)),c.length?b=C(o,u):b={start:l.clone(e.pos),end:l.clone(e.pos)},h===c.length&&(v=!0),E(p,d,y,h,c,v,b)):E()}function L(e,t){var n=$.extend({},e.pos),r=$.extend({},e.pos),i=$.extend({},e.pos),s,o,u=0,a=[],l=f.offsetInToken(e),c={ch:e.pos.ch+1,line:e.pos.line},h=t._codeMirror.getTokenAt(c,!0);if(e.token.type&&e.token.type!=="string")return E();s=f.getInitialContext(t._codeMirror,r),a[0]=s.token.string;while(f.movePrevToken(s)){if(s.token.type==="def"&&s.token.string==="@import")break;if(s.token.type&&s.token.type!=="tag"&&s.token.string!=="url")break;a[0]=s.token.string+a[0],l+=s.token.string.length}if(s.token.type!=="def"||s.token.string!=="@import")return E();o=f.getInitialContext(t._codeMirror,i);do{if(!f.moveNextToken(o)){if(o.token.string==="(")break;return E()}a[0]+=o.token.string}while(o.token.string!==")"&&o.token.string!=="");return E(d,l,"",u,a,!1)}function A(e,t){var n=$.extend({},t),r=f.getInitialContext(e._codeMirror,n),i=f.offsetInToken(r),s="",o=e.getModeForSelection();return o!=="css"&&o!=="text/x-scss"&&o!=="text/x-less"?E():y(r)?S(r,e):b(r)?k(r,e):w(r)?L(r,e):E()}function O(e){function S(){while(f.eol()){l++;if(l>=o)return!1;c.match(/\S/)&&(c+=" "),f=new r.StringStream(s[l])}return!0}function x(){return i=r.startState(n),s=r.splitLines(e),o=s.length,o===0?!1:(l=0,f=new r.StringStream(s[l]),S()?(a=n.token(f,i),u=f.current(),!0):!1)}function T(){return f.start=f.pos,S()?(a=n.token(f,i),u=f.current(),!0):!1}function N(){if(!x())return!1;while(!u.match(/\S/))if(!T())return!1;return!0}function C(){if(!T())return!1;while(!u.match(/\S/))if(!T())return!1;return!0}function k(){return u.match(/^\/\*/)}function L(){while(!u.match(/\*\/$/))if(!T())break}function A(){if(!T())return!1;while(k()){L();if(!T())return!1}return!0}function O(e){c="",d=e,v=l;while(u!==","&&u!=="{"){c+=u;if(!A())return!1}/\\/.test(c)&&(c=c.replace(w,function(e){return e.replace(E,function(e){return e=e.substr(1),e.length===1?e:parseInt(e,16)<1114111?String.fromCharCode(parseInt(e,16)):String.fromCharCode(65533)})})),c=c.trim();var n=m===-1?d:d+1,r=f.string.indexOf(c,d)!==-1?f.string.indexOf(c,d-c.length):n;return c!==""&&(t.push({selector:c,ruleStartLine:p,ruleStartChar:h,selectorStartLine:v,selectorStartChar:r,declListEndLine:-1,selectorEndLine:l,selectorEndChar:r+c.length,selectorGroupStartLine:m,selectorGroupStartChar:g}),c=""),d=-1,!0}function M(){m=f.string.indexOf(",")!==-1?l:-1,g=f.start;if(!O(f.start))return!1;while(u===","){if(!A())return!1;if(!O(f.start))return!1}return!0}function _(){var e;y=Math.min(l,o-1),b=f.start;var n,r;if(m!==-1){n="";for(r=m;r<=y;r++){var i=0,a=s[r].length;r===m?i=g:n+=" ",r===y&&(a=b),n+=s[r].substring(i,a)}n=n.trim()}m=-1,g=-1,p=-1,h=-1;while(u!=="}")if(!A())break;for(e=t.length-1;e>=0;e--){if(t[e].declListEndLine!==-1)break;t[e].declListStartLine=y,t[e].declListStartChar=b,t[e].declListEndLine=l,t[e].declListEndChar=f.pos-1,n&&(t[e].selectorGroup=n)}}function D(){return h!==-1?!1:f.start>0&&s[l].substr(0,f.start).indexOf("}")!==-1?!1:!0}function P(){return u.match(/^@/)}function H(){p=-1,h=-1,v=-1,d=-1,m=-1,g=-1;if(u.match(/@media/i)){while(u!=="{")if(!A())return;if(!C())return;j("}")}else if(u.match(/@(charset|import|namespace)/i)){while(u!==";")if(!A())return}else while(u!=="}")if(!A())return}function B(){if(!M())return!1;_()}function j(e){while(!e||u!==e){P()?H():k()?(D()&&(h=f.start,p=l),L()):(h===-1&&(h=f.start,p=l),B());if(!C())break}}var t=[],n=r.getMode({indentUnit:2},"css"),i,s,o,u,a,f,l,c="",h=-1,p=-1,d=-1,v=-1,m=-1,g=-1,y=-1,b=-1,w=new RegExp("\\\\[^\\\\]+","g"),E=new RegExp("\\\\([a-f0-9]{6}|[a-f0-9]{4}(\\s|\\\\|$)|[a-f0-9]{2}(\\s|\\\\|$)|.)","i");return N()&&j(),t}function M(e,t){var n=O(e),r=[],i,s=t[0]==="."||t[0]==="#",o="";t[0]==="."&&(t="\\"+t),s||(t="(^|[\\s>+~])"+t);var u=new RegExp(t+"(\\[[^\\]]*\\]|:{1,2}[\\w-()]+|\\.[\\w-]+|#[\\w-]+)*\\s*$",s?"":"i");return n.forEach(function(e){e.selector.search(u)!==-1?r.push(e):s||/\*\s*$/.test(e.selector)&&r.push(e)}),r}function _(e,t,n,r){t.forEach(function(t){e.push({name:t.selector,document:n,lineStart:t.ruleStartLine+r,lineEnd:t.declListEndLine+r,selectorGroup:t.selectorGroup})})}function D(e,t){function r(e,n){var r=new $.Deferred;return s.getDocumentForPath(e).done(function(e){var i=M(e.getText(),n);_(t,i,e,0),r.resolve()}).fail(function(e){r.reject(e)}),r.promise()}var n=new $.Deferred;return a.getAllFiles(a.getLanguageFilter("css")).done(function(t){i.doInParallel(t,function(t,n){return r(t.fullPath,e)}).then(n.resolve,n.reject)}),n.promise()}function P(e,t,n){var r=o.getCurrentFullEditor();if(r.document!==e){console.error("Cannot search for <style> blocks in HTML file other than current editor");return}var i=u.findStyleBlocks(r);i.forEach(function(r){var i=M(r.text,t);_(n,i,e,r.start.line)})}function H(e,t){var n=new $.Deferred,r=[];return t&&P(t,e,r),D(e,r).done(function(){n.resolve(r)}).fail(function(e){n.reject(e)}),n.promise()}function B(e,t){function u(e){return e=e.trim(),e.indexOf("@")===0?"":e}function a(e){var t="";f.movePrevToken(e);for(;;){if(e.token.type!=="comment"){if(/[\{\}\;]/.test(e.token.string))break;if(e.token.string==="style"&&e.token.type==="tag"){var n=t.indexOf(">");n!==-1&&(t=t.substring(n+1));break}t=e.token.string+t}if(!f.movePrevToken(e))break}return t}var n=e._codeMirror,r=f.getInitialContext(n,$.extend({},t)),i="",s=!1,o=!1;for(;;){if(r.token.type!=="comment"){if(r.token.string==="}")break;if(r.token.string==="{"){i=a(r);break}/\S/.test(r.token.string)&&(o=!0)}if(!f.movePrevToken(r))break}i=u(i),r=f.getInitialContext(n,$.extend({},t)),!i&&!o&&f.moveNextToken(r)&&r.token.type!=="comment"&&/\S/.test(r.token.string)&&(o=!0,r=f.getInitialContext(n,$.extend({},t)));if(!i&&o)for(;;){if(r.token.type!=="comment"){if(r.token.string==="{"){i=a(r);break}if(r.token.string==="}"||r.token.string===";")break}if(!f.moveNextToken(r))break}return u(i)}function j(e){return e.replace(/\/\*(?:(?!\*\/)[\s\S])*\*\//g,"")}function F(e){return e.replace(/[^\\]\"(.*)[^\\]\"|[^\\]\'(.*)[^\\]\'+/g,"")}function I(e){return F(j(e))}function q(e){var t=/(?:flow\-(into|from)\:\s*)([\w\-]+)(?:\s*;)/gi,n=[],r={},i;e=I(e),i=t.exec(e);while(i){var s=i[2];g.indexOf(s)===-1&&!r.hasOwnProperty(s)&&(r[s]=n.push(s)),i=t.exec(e)}return n}function R(e,t,n,r){var i="\n"+t+" {\n",s;if(n)i+="	",s=1;else{var o;for(o=0;o<r;o++)i+=" ";s=r}i+="\n}\n";var u=e.getText().split("\n"),a=u.length-1,f=u[u.length-1].length;return e.replaceRange(i,{line:a,ch:f}),{range:{from:{line:a+1,ch:0},to:{line:a+3,ch:1}},pos:{line:a+2,ch:s}}}function U(e){var t=[],n;return e.forEach(function(e){e.selectorGroup&&(e.name=e.selectorGroup),(!n||e.document!==n.document||e.lineStart!==n.lineStart||e.lineEnd!==n.lineEnd||e.selectorGroup!==n.selectorGroup)&&t.push(e),n=e}),t}function z(e){var t,n=0,r,i=e.document.getText();for(t=0;t<e.startLine;t++)n=i.indexOf("\n",n)+1;r=n;for(t=e.startLine+1;t<=e.endLine+1;t++)r=i.indexOf("\n",r)+1;var s=O(i.substring(n,r));return s.length?s[0].selectorGroup||s[0].selector:""}var r=e("thirdparty/CodeMirror2/lib/codemirror"),i=e("utils/Async"),s=e("document/DocumentManager"),o=e("editor/EditorManager"),u=e("language/HTMLUtils"),a=e("project/ProjectManager"),f=e("utils/TokenUtils"),l=e("thirdparty/lodash"),c="selector",h="prop.name",p="prop.value",d="import.url",v=["content","element"],m=["none","inherit","default","auto","initial"],g=v.concat(m);t._findAllMatchingSelectorsInText=M,t.findMatchingRules=H,t.extractAllSelectors=O,t.extractAllNamedFlows=q,t.findSelectorAtDocumentPos=B,t.reduceStyleSheetForRegExParsing=I,t.addRuleToDocument=R,t.consolidateRules=U,t.getRangeSelectors=z,t.SELECTOR=c,t.PROP_NAME=h,t.PROP_VALUE=p,t.IMPORT_URL=d,t.getInfoAtPos=A,t.createInfo=E}),define("utils/DropdownEventHandler",["require","exports","module","command/KeyBindingManager","utils/KeyEvent","widgets/PopUpManager","utils/ViewUtils"],function(e,t,n){function u(e,t,n){this.$list=e,this.$items=e.find("li"),this.selectionCallback=t,this.closeCallback=n,this.scrolling=!1,this._selectedIndex=-1}var r=e("command/KeyBindingManager"),i=e("utils/KeyEvent"),s=e("widgets/PopUpManager"),o=e("utils/ViewUtils");u.prototype.open=function(){function t(t){var n;if(t.type==="keydown"){n=t.keyCode;if(n===i.DOM_VK_UP)e._rotateSelection(-1);else if(n===i.DOM_VK_DOWN)e._rotateSelection(1);else if(n===i.DOM_VK_PAGE_UP)e._rotateSelection(-e._itemsPerPage());else if(n===i.DOM_VK_PAGE_DOWN)e._rotateSelection(e._itemsPerPage());else{if(e._selectedIndex===-1||n!==i.DOM_VK_RETURN)return!1;e._selectionHandler()}return t.stopImmediatePropagation(),t.preventDefault(),!0}return!1}function n(){r.removeGlobalKeydownHook(t),e._cleanup()}var e=this;r.addGlobalKeydownHook(t),this.$list&&(this._registerMouseEvents(),s.addPopUp(this.$list,n,!0))},u.prototype.close=function(){this.$list&&s.removePopUp(this.$list)},u.prototype._cleanup=function(){this.$list&&this.$list.off(".dropdownEventHandler"),this.closeCallback&&this.closeCallback()},u.prototype._rotateSelection=function(e){var t=this.$items.length,n;this._selectedIndex<0?n=e>0?e-1:t-1:(n=this._selectedIndex,e>0?n===t-1?n=0:n=Math.min(n+e,t-1):n===0?n=t-1:n=Math.max(n+e,0)),$(this.$items[n]).hasClass("divider")?this._rotateSelection(e>0?e+1:e-1):this._setSelectedIndex(n,!0)},u.prototype._itemsPerPage=function(){var e=1,t;return this.$items.length!==0&&(t=$(this.$items[0]).height(),t&&(e=Math.floor(this.$list.height()/t),e=Math.max(1,Math.min(e,this.$items.length)))),e},u.prototype._selectionHandler=function(){if(this._selectedIndex===-1)return;var e=this.$items.eq(this._selectedIndex).find("a");this._clickHandler(e)},u.prototype._clickHandler=function(e){if(!this.selectionCallback||!this.$list||!e)return;this.selectionCallback(e),s.removePopUp(this.$list)},u.prototype._setSelectedIndex=function(e,t){e=Math.max(-1,Math.min(e,this.$items.length-1)),this._selectedIndex!==-1&&this.$items.eq(this._selectedIndex).find("a").removeClass("selected"),this._selectedIndex=e;if(this._selectedIndex!==-1){var n=this.$items.eq(this._selectedIndex);n.find("a").addClass("selected"),t&&(this.scrolling=!0,o.scrollElementIntoView(this.$list,n,!1))}},u.prototype._registerMouseEvents=function(){var e=this;this.$list.on("click.dropdownEventHandler","a",function(){e._clickHandler($(this))}).on("mouseover.dropdownEventHandler","a",function(t){if(e.scrolling){e.scrolling=!1;return}var n=$(t.currentTarget),r=n.closest("li"),i=e.$list.offset(),s=r.offset();s.top<i.top+e.$list.height()&&i.top<=s.top&&e._setSelectedIndex(e.$items.index(r),!1)})},u.prototype.reRegisterMouseHandlers=function(e){this.$list&&(this.$list.off(".dropdownEventHandler"),this.$list=e,this.$items=e.find("li"),this._registerMouseEvents())},t.DropdownEventHandler=u}),define("widgets/DropdownButton",["require","exports","module","utils/DropdownEventHandler","view/PanelManager","command/Menus","utils/ViewUtils","thirdparty/lodash"],function(e,t,n){function a(e,t,n){this.items=t,this.itemRenderer=n||this.itemRenderer,this._onClick=this._onClick.bind(this),this.closeDropdown=this.closeDropdown.bind(this),this._onClickOutside=this._onClickOutside.bind(this),this.$button=$("<button class='btn btn-dropdown'/>").text(e).on("click",this._onClick)}var r=e("utils/DropdownEventHandler").DropdownEventHandler,i=e("view/PanelManager"),s=e("command/Menus"),o=e("utils/ViewUtils"),u=e("thirdparty/lodash");a.prototype.items=null,a.prototype.$button=null,a.prototype.$dropdown=null,a.prototype.dropdownExtraClasses=null,a.prototype._lastFocus=null,a.prototype._dropdownEventHandler=null,a.prototype._onClick=function(e){this.$button.hasClass("disabled")||this.toggleDropdown(),e.stopPropagation()},a.prototype.setButtonLabel=function(e){if(!this.$button)return;$(this.$button).text(e)},a.prototype.itemRenderer=function(e,t){return u.escape(String(e))},a.prototype._renderList=function(e){if(!e)return null;var t="";return this.items.forEach(function(e,n){e==="---"?t+="<li class='divider'></li>":(t+="<li><a class='stylesheet-link' data-index='"+n+"'>",t+=this.itemRenderer(e,n),t+="</a></li>")}.bind(this)),e.append(t),$(this).triggerHandler("listRendered",[e]),this._dropdownEventHandler&&this._dropdownEventHandler.reRegisterMouseHandlers(e),e},a.prototype.refresh=function(){if(!this.$dropdown)return;$("li",this.$dropdown).remove(),this._renderList(this.$dropdown)},a.prototype.setChecked=function(e,t){if(!this.$dropdown)return;var n=$("li",this.$dropdown),r=n.length;e>-1&&e<r&&$("a",n[e]).toggleClass("checked",t)},a.prototype.showDropdown=function(){if(!this.items.length)return;if(this.$dropdown)return;s.closeAll();var e=$("<ul class='dropdown-menu dropdownbutton-popup' tabindex='-1'>").addClass(this.dropdownExtraClasses).css("min-width",this.$button.outerWidth());this.$dropdown=e,this._renderList(this.$dropdown).appendTo($("body")).data("attached-to",this.$button[0]);var t=this.$button.offset(),n=t.left,u=t.top+this.$button.outerHeight(),a={top:u,left:n,height:e.height(),width:e.width()},f=o.getElementClipSize($(window),a);f.bottom>0&&(u=Math.max(0,t.top-e.height()-4)),f.right>0&&(n=Math.max(0,n-f.right)),e.css({left:n,top:u}),this._dropdownEventHandler=new r(e,this._onSelect.bind(this),this._onDropdownClose.bind(this)),this._dropdownEventHandler.open(),window.document.body.addEventListener("mousedown",this._onClickOutside,!0),$(i).on("editorAreaResize",this.closeDropdown),this._lastFocus=window.document.activeElement,e.focus()},a.prototype._onDropdownClose=function(){window.document.body.removeEventListener("mousedown",this._onClickOutside,!0),$(i).off("editorAreaResize",this.closeDropdown),window.document.activeElement===this.$dropdown[0]&&this._lastFocus.focus(),this._dropdownEventHandler=null,this.$dropdown=null},a.prototype.closeDropdown=function(){this._dropdownEventHandler&&this._dropdownEventHandler.close()},a.prototype._onClickOutside=function(e){var t=$(e.target).closest(".dropdownbutton-popup");!$(e.target).is(this.$button)&&(t.length===0||t[0]!==this.$dropdown[0])&&(this.closeDropdown(),e.stopPropagation(),e.preventDefault())},a.prototype.toggleDropdown=function(){this.$dropdown?this.closeDropdown():this.showDropdown()},a.prototype._onSelect=function(e){var t=Number(e.data("index"));$(this).triggerHandler("select",[this.items[t],t])},t.DropdownButton=a}),define("editor/MultiRangeInlineEditor",["require","exports","module","thirdparty/lodash","document/TextRange","editor/InlineTextEditor","editor/EditorManager","command/Commands","strings","command/CommandManager","utils/PerfUtils"],function(e,t,n){function p(e,t){return parseInt(e.css(t),10)}function d(e){this.name=e.name,this.textRange=new i(e.document,e.lineStart,e.lineEnd)}function v(e,t,n){n&&(t.name=n(t.textRange));var i=r.escape(t.name)+" <span class='related-file'>— "+r.escape(t.textRange.document.file.name)+" : "+(t.textRange.startLine+1)+"</span>";e.html(i),e.attr("title",e.text())}function m(e,t,n){s.call(this),this._ranges=e.map(function(e){return new d(e)}),this._messageCB=t,this._labelCB=n,this._selectedRangeIndex=-1}function g(){var e=o.getFocusedInlineWidget();return e instanceof m?e:null}function y(){var e=g();e&&e._selectPreviousRange()}function b(){var e=g();e&&e._selectNextRange()}var r=e("thirdparty/lodash"),i=e("document/TextRange").TextRange,s=e("editor/InlineTextEditor").InlineTextEditor,o=e("editor/EditorManager"),u=e("command/Commands"),a=e("strings"),f=e("command/CommandManager"),l=e("utils/PerfUtils"),c,h;d.prototype.name=null,d.prototype.textRange=null,d.prototype.$listItem=null,m.prototype=Object.create(s.prototype),m.prototype.constructor=m,m.prototype.parentClass=s.prototype,m.prototype.$messageDiv=null,m.prototype.$relatedContainer=null,m.prototype.$related=null,m.prototype.$selectedMarker=null,m.prototype.$rangeList=null,m.prototype._ranges=null,m.prototype._selectedRangeIndex=null,m.prototype._messageCB=null,m.prototype._labelCB=null,m.prototype._createListItem=function(e,t){var n=this,r=$("<li/>"),i=this.$rangeList.children();t===undefined||t===i.length?r.appendTo(this.$rangeList):r.insertBefore(i.get(t)),v(r,e),r.mousedown(function(){n.setSelectedIndex(n._ranges.indexOf(e))}),e.$listItem=r,$(e.textRange).on("change",function(){v(r,e)}).on("contentChange",function(){v(r,e,n._labelCB)}),$(e.textRange).on("lostSync",function(){n._removeRange(e)})},m.prototype.load=function(e){m.prototype.parentClass.load.apply(this,arguments),this.$messageDiv=$("<div/>").addClass("inline-editor-message"),this.$editorHolder.on("mousewheel.MultiRangeInlineEditor",function(e){e.stopPropagation()}),this.$relatedContainer=$("<div/>").addClass("related-container"),this.$selectedMarker=$("<div/>").appendTo(this.$relatedContainer).addClass("selection"),this.$related=$("<div/>").appendTo(this.$relatedContainer).addClass("related"),this.$rangeList=$("<ul/>").appendTo(this.$related);var t;this._ranges.forEach(this._createListItem,this),this._ranges.length>1&&this.$wrapper.before(this.$relatedContainer),this._ranges.length?this.setSelectedIndex(0):this.setSelectedIndex(-1);var n=this._onClick.bind(this);this.$htmlContent.on("click.MultiRangeInlineEditor",n),this.$htmlContent.on("mouseup.MultiRangeInlineEditor",n),this.$htmlContent.on("focusin.MultiRangeInlineEditor",this._updateCommands.bind(this)).on("focusout.MultiRangeInlineEditor",this._updateCommands.bind(this))},m.prototype._updateCommands=function(){var e=this.hasFocus()&&this._ranges.length>1;c.setEnabled(e&&this._selectedRangeIndex>0),h.setEnabled(e&&this._selectedRangeIndex!==-1&&this._selectedRangeIndex<this._ranges.length-1)},m.prototype.onAdded=function(){var e=this;this.$relatedContainer.height(this.$related.height()),this._updateSelectedMarker(!1),m.prototype.parentClass.onAdded.apply(this,arguments),this._updateEditorMinHeight(),this.sizeInlineWidgetToContents(!0,!1),this._updateCommands()},m.prototype.setSelectedIndex=function(e,t){var n=Math.min(Math.max(-1,e),this._ranges.length-1),r=this;if(!t&&n!==-1&&n===this._selectedRangeIndex)return;var i=this._selectedRangeIndex>=0?this._ranges[this._selectedRangeIndex].$listItem:null;i&&i.removeClass("selected"),this.editor&&$(this.editor).off(".MultiRangeInlineEditor"),this._selectedRangeIndex=n;if(n===-1)this.setInlineContent(null),this._messageCB?this._messageCB().done(function(e){r.$messageDiv.html(e)}):this.$messageDiv.text(a.INLINE_EDITOR_NO_MATCHES),this.$htmlContent.append(this.$messageDiv),this.sizeInlineWidgetToContents(!0,!1);else{this.$messageDiv.remove();var s=this._getSelectedRange();s.$listItem.addClass("selected"),this.setInlineContent(s.textRange.document,s.textRange.startLine,s.textRange.endLine),this.editor.focus(),this._updateEditorMinHeight(),this.editor.refresh(),$(this.editor).on("cursorActivity.MultiRangeInlineEditor",this._ensureCursorVisible.bind(this)),this.sizeInlineWidgetToContents(!0,!1),this._updateSelectedMarker(!0)}this._updateCommands()},m.prototype._updateEditorMinHeight=function(){if(!this.editor)return;var e=this.$related.outerHeight(),t=$(".inline-editor-header",this.$htmlContent).outerHeight();if(!e||!t)return;$(this.editor.getScrollerElement()).css("min-height",e-t+"px")},m.prototype._removeRange=function(e){if(this._ranges.length<=1){this.close();return}var t=this._ranges.indexOf(e);t===this._selectedRangeIndex&&(t+1<this._ranges.length?this.setSelectedIndex(t+1):this.setSelectedIndex(t-1)),e.$listItem.remove(),e.textRange.dispose(),this._ranges.splice(t,1),t<this._selectedRangeIndex&&(this._selectedRangeIndex--,this._updateSelectedMarker(!0)),this._ranges.length===1&&(this.$relatedContainer.remove(),this.editor&&this.editor.refresh()),this._updateCommands()},m.prototype.addAndSelectRange=function(e,t,n,r){var i=new d({name:e,document:t,lineStart:n,lineEnd:r}),s;for(s=this._ranges.length-1;s>=0;s--)if(this._ranges[s].textRange.document===t)break;s===-1?s=this._ranges.length:s++,this._ranges.splice(s,0,i),this._createListItem(i,s),this.setSelectedIndex(s,!0),this._ranges.length>1&&!this.$relatedContainer.parent().length&&this.$wrapper.before(this.$relatedContainer),this._updateCommands()},m.prototype._updateSelectedMarker=function(e){if(this._selectedRangeIndex<0)return(new $.Deferred).resolve().promise();var t=new $.Deferred,n=this._ranges[this._selectedRangeIndex].$listItem,r=this;return window.setTimeout(function(){var i=r.$relatedContainer.height(),s=n.position().top,o=r.$relatedContainer.scrollTop();r.$selectedMarker.toggleClass("animate",e).css("top",s).height(n.outerHeight());if(i<=0)return;var u=p(n.parent(),"paddingTop");if(s-u<o)r.$relatedContainer.scrollTop(s-u);else{var a=s+n.height()+p(n.parent(),"paddingBottom");a>o+i&&r.$relatedContainer.scrollTop(a-i)}t.resolve()},0),t.promise()},m.prototype.onClosed=function(){m.prototype.parentClass.onClosed.apply(this,arguments),this._ranges.forEach(function(e){e.textRange.dispose()}),this.$htmlContent.off(".MultiRangeInlineEditor"),this.$editorHolder.off(".MultiRangeInlineEditor")},m.prototype._onClick=function(e){function i(t){return t.find(e.target)>0||t[0]===e.target}if(!this.editor)return;var t=this.editor,n=t.getRootElement(),r=$(n).offset();if(!i($(n))&&!i($(".filename",this.$htmlContent))){t.focus();if(!i(this.$relatedContainer))if(e.pageY<r.top)t.setCursorPos(0,0);else if(e.pageY>r.top+$(n).height()){var s=t.getLastVisibleLine();t.setCursorPos(s,t.document.getLine(s).length)}}},m.prototype._ensureCursorVisible=function(){if(!this.editor)return;if($.contains(this.editor.getRootElement(),window.document.activeElement)){var e=this.hostEditor.getScrollPos(),t=this.editor._codeMirror.cursorCoords(),n=this.hostEditor.getVirtualScrollAreaTop();this.hostEditor._codeMirror.scrollIntoView({left:e.x,top:t.top-n,right:e.x,bottom:t.bottom-n})}},m.prototype._onLostContent=function(e,t){if(t&&t.type==="deleted")return;return m.prototype.parentClass._onLostContent.apply(this,arguments)},m.prototype._getRanges=function(){return this._ranges},m.prototype._getSelectedRange=function(){return this._selectedRangeIndex>=0?this._ranges[this._selectedRangeIndex]:null},m.prototype._selectNextRange=function(){this._selectedRangeIndex<this._ranges.length-1&&this.setSelectedIndex(this._selectedRangeIndex+1)},m.prototype._selectPreviousRange=function(){this._selectedRangeIndex>0&&this.setSelectedIndex(this._selectedRangeIndex-1)},m.prototype.sizeInlineWidgetToContents=function(e,t){m.prototype.parentClass.sizeInlineWidgetToContents.call(this,e);var n=Math.max(this.$related.height(),this.$header.outerHeight()+(this._selectedRangeIndex===-1?this.$messageDiv.outerHeight():this.$editorHolder.height()));n&&this.hostEditor.setInlineWidgetHeight(this,n,t)},m.prototype.onParentShown=function(){m.prototype.parentClass.onParentShown.apply(this,arguments),this._updateSelectedMarker(!1)},m.prototype.refresh=function(){m.prototype.parentClass.refresh.apply(this,arguments),this.sizeInlineWidgetToContents(!0),this.editor&&this.editor.refresh()},c=f.register(a.CMD_QUICK_EDIT_PREV_MATCH,u.QUICK_EDIT_PREV_MATCH,y),c.setEnabled(!1),h=f.register(a.CMD_QUICK_EDIT_NEXT_MATCH,u.QUICK_EDIT_NEXT_MATCH,b),h.setEnabled(!1),t.MultiRangeInlineEditor=m,t.getFocusedMultiRangeInlineEditor=g}),define("editor/CSSInlineEditor",["require","exports","module","language/CSSUtils","widgets/DropdownButton","command/CommandManager","command/Commands","document/DocumentManager","editor/EditorManager","editor/Editor","project/ProjectManager","language/HTMLUtils","editor/MultiRangeInlineEditor","strings","utils/ViewUtils","thirdparty/lodash"],function(e,t,n){function y(){return l.getAllFiles(l.getLanguageFilter("css"))}function b(e,t){var n=c.getTagInfo(e,t),r="",i;if(n.position.tokenType===c.TAG_NAME||n.position.tokenType===c.CLOSING_TAG)r=n.tagName;else if(n.position.tokenType===c.ATTR_NAME||n.position.tokenType===c.ATTR_VALUE)if(n.attr.name==="class"){var s=n.attr.value;if(/\S/.test(s)){var o=s.substr(0,n.position.offset).lastIndexOf(" "),u=s.indexOf(" ",n.position.offset);r="."+s.substring(o===-1?0:o+1,u===-1?s.length:u),r==="."&&(r="",i=p.ERROR_CSSQUICKEDIT_BETWEENCLASSES)}else i=p.ERROR_CSSQUICKEDIT_CLASSNOTFOUND}else if(n.attr.name==="id"){var a=n.attr.value.trim();a?r="#"+a:i=p.ERROR_CSSQUICKEDIT_IDNOTFOUND}else i=p.ERROR_CSSQUICKEDIT_UNSUPPORTEDATTR;return{selectorName:r,reason:i}}function w(e,t,n){u.getDocumentForPath(n).done(function(i){var s=r.addRuleToDocument(i,e,f.getUseTabChar(n),f.getSpaceUnits(n));t.addAndSelectRange(e,i,s.range.from.line,s.range.to.line),t.editor.setCursorPos(s.pos.line,s.pos.ch)})}function E(){var e=h.getFocusedMultiRangeInlineEditor();if(e){var t=v.find(g,function(t){return t.inlineEditor===e});t&&t.handler()}}function S(e){var t="<span class='stylesheet-name'>"+v.escape(e.name);return e.subDirStr.length&&(t+="<span class='stylesheet-dir'> — "+v.escape(e.subDirStr)+"</span>"),t+="</span>",t}function x(e,t){function c(e,t){w(o,a,t.fullPath)}function v(){var e=new $.Deferred;return y().done(function(t){e.resolve(t.length?p.CSS_QUICK_EDIT_NO_MATCHES:p.CSS_QUICK_EDIT_NO_STYLESHEETS)}),e}function E(){m.setEnabled(a.hasFocus()&&!l.$button.hasClass("disabled"))}function x(e){l.$button.hasClass("disabled")||(f.length===1?w(o,a,f[0].fullPath):l.toggleDropdown())}function T(e,t){var n=e.name.localeCompare(t.name);return n!==0?n:e.subDirStr.localeCompare(t.subDirStr)}function N(e){var t,n,r,i=[],s=[];e.forEach(function(e){e.subDirStr=""}),e.sort(T);for(t=1;t<e.length;t++)if(T(e[t-1],e[t])===0){r=t-1,s.push(e[t-1]),s.push(e[t]);while(++t<e.length&&T(s[0],e[t])===0)s.push(e[t]);i=d.getDirNamesForDuplicateFiles(s);for(n=0;n<i.length;n++)e[r+n].subDirStr=i[n];s=[]}return e.sort(T),e}function C(){l.closeDropdown()}if(e.getLanguageForSelection().getId()!=="html")return null;var n=e.getSelection();if(n.start.line!==n.end.line)return null;var s=b(e,n.start);if(s.selectorName==="")return s.reason||null;var o=s.selectorName,u=new $.Deferred,a,f=[],l;return r.findMatchingRules(o,e.document).done(function(t){var n=new $.Deferred;a=new h.MultiRangeInlineEditor(r.consolidateRules(t),v,r.getRangeSelectors),a.load(e),a.$htmlContent.on("focusin",E).on("focusout",E),$(a).on("add",function(){n.resolve()}),$(a).on("close",function(){l.closeDropdown(),$(e).off("scroll",C)});var s=$(".inline-editor-header",a.$htmlContent);l=new i(p.BUTTON_NEW_RULE,[],S),l.$button.addClass("disabled"),l.$button.addClass("btn-mini stylesheet-button"),s.append(l.$button),g.push({inlineEditor:a,handler:x}),$(e).on("scroll",C),u.resolve(a);var o=y();$.when(o,n.promise()).done(function(e){f=N(e),f.length>0&&(l.$button.removeClass("disabled"),t.length||l.$button.focus(),f.length===1?(l.$button.removeClass("btn-dropdown"),l.$button.on("click",x)):(l.items=f,$(l).on("select",c))),E()})}).fail(function(){console.log("Error in findMatchingRules()"),u.reject()}),u.promise()}var r=e("language/CSSUtils"),i=e("widgets/DropdownButton").DropdownButton,s=e("command/CommandManager"),o=e("command/Commands"),u=e("document/DocumentManager"),a=e("editor/EditorManager"),f=e("editor/Editor").Editor,l=e("project/ProjectManager"),c=e("language/HTMLUtils"),h=e("editor/MultiRangeInlineEditor"),p=e("strings"),d=e("utils/ViewUtils"),v=e("thirdparty/lodash"),m,g=[];a.registerInlineEditProvider(x),m=s.register(p.CMD_CSS_QUICK_EDIT_NEW_RULE,o.CSS_QUICK_EDIT_NEW_RULE,E),m.setEnabled(!1)}),define("document/ChangedDocumentTracker",["require","exports","module","document/DocumentManager","project/ProjectManager"],function(e,t,n){function s(){var e=this;this._changedPaths={},this._windowFocus=!0,this._addListener=this._addListener.bind(this),this._removeListener=this._removeListener.bind(this),this._onChange=this._onChange.bind(this),this._onWindowFocus=this._onWindowFocus.bind(this),$(r).on("afterDocumentCreate",function(t,n){i.isWithinProject(n.file.fullPath)&&e._addListener(n)}),$(r).on("beforeDocumentDelete",function(t,n){e._removeListener(n)}),$(window).focus(this._onWindowFocus)}var r=e("document/DocumentManager"),i=e("project/ProjectManager");s.prototype._addListener=function(e){$(e).on("change",this._onChange)},s.prototype._removeListener=function(e){$(e).off("change",this._onChange)},s.prototype._onWindowFocus=function(e,t){this._windowFocus=!0},s.prototype._onChange=function(e,t){this._changedPaths[t.file.fullPath]=!0},s.prototype.reset=function(){this._changedPaths={},this._windowFocus=!1},s.prototype.isPathChanged=function(e){return this._windowFocus||this._changedPaths[e]},s.prototype.getChangedPaths=function(){return $.makeArray(this._changedPaths)},n.exports=s}),define("language/JSUtils",["require","exports","module","thirdparty/lodash","thirdparty/CodeMirror2/lib/codemirror","utils/Async","document/DocumentManager","document/ChangedDocumentTracker","filesystem/FileSystem","file/FileUtils","utils/PerfUtils","project/ProjectManager","utils/StringUtils"],function(e,t,n){function v(e){var t={},n,r;l.markStart(l.JSUTILS_REGEXP);while((r=d.exec(e))!==null)n=(r[2]||r[5]).trim(),Array.isArray(t[n])||(t[n]=[]),t[n].push({offsetStart:r.index});return l.addMeasurement(l.JSUTILS_REGEXP),t}function m(e,t){function p(){if(s){a++;if(a>=f)return!1}c=a;var t=e.indexOf("\n",c);return t===-1&&(t=f),s=new i.StringStream(e.slice(a,t)),!0}function d(){if(a>=f)return!1;s&&(s.start=s.pos);while(!s||s.eol())if(!p())return!1;return o=n.token(s,r),u=s.current(),a=c+s.pos,!0}var n=i.getMode({},"javascript"),r=i.startState(n),s,o,u,a=t,f=e.length,l=0,c,h=!1;while(d()){o!=="comment"&&o!=="regexp"&&o!=="string"&&(u==="{"?(h=!0,l++):u==="}"&&l--);if(h&&l<=0)return a}return f}function g(e,t,n,r){var i=e.getText(),s=h.getLines(i);n.forEach(function(n){n.offsetEnd||(l.markStart(l.JSUTILS_END_OFFSET),n.offsetEnd=m(i,n.offsetStart),n.lineStart=h.offsetToLineNum(s,n.offsetStart),n.lineEnd=h.offsetToLineNum(s,n.offsetEnd),l.addMeasurement(l.JSUTILS_END_OFFSET)),r.push({document:e,name:t,lineStart:n.lineStart,lineEnd:n.lineEnd})})}function y(e,t){o.getDocumentForPath(e.fullPath).done(function(n){var r=v(n.getText());e.JSUtils={},e.JSUtils.functions=r,e.JSUtils.timestamp=n.diskTimestamp,t.resolve({doc:n,functions:r})}).fail(function(e){t.reject(e)})}function b(e){var t=new $.Deferred,n=p.isPathChanged(e.fullPath);if(n&&e.JSUtils){var r=o.getOpenDocumentForPath(e.fullPath);if(r&&r.isDirty)t.resolve(!1);else{var i=a.getFileForPath(e.fullPath);i.stat(function(n,r){n?t.reject(n):t.resolve(e.JSUtils.timestamp.getTime()===r.mtime.getTime())})}}else t.resolve(!n&&e.JSUtils);return t.promise()}function w(e,t){var n=new $.Deferred,i=[],u=[];return e.forEach(function(e){if(r.has(e.functions,t)){var n=e.functions[t];i.push({doc:e.doc,fileInfo:e.fileInfo,functions:n})}}),s.doInParallel(i,function(e){var n=e.doc,r=new $.Deferred;return n?(g(n,t,e.functions,u),r.resolve()):o.getDocumentForPath(e.fileInfo.fullPath).done(function(n){g(n,t,e.functions,u)}).always(function(){r.resolve()}),r.promise()}).done(function(){n.resolve(u)}),n.promise()}function E(e){var t=new $.Deferred;return b(e).done(function(n){n?t.resolve({fileInfo:e,functions:e.JSUtils.functions}):y(e,t)}).fail(function(e){t.reject(e)}),t.promise()}function S(e){var t=new $.Deferred,n=[];return l.markStart(l.JSUTILS_GET_ALL_FUNCTIONS),s.doInParallel(e,function(e){var t=new $.Deferred;return E(e).done(function(e){n.push(e)}).always(function(e){t.resolve()}),t.promise()}).always(function(){p.reset(),l.addMeasurement(l.JSUTILS_GET_ALL_FUNCTIONS),t.resolve(n)}),t.promise()}function x(e,t,n){var r=new $.Deferred,i=[],s=[];return n?i=t:i=t.filter(function(e){return f.getFileExtension(e.fullPath).toLowerCase()==="js"}),S(i).done(function(t){w(t,e).done(function(e){r.resolve(e)})}),r.promise()}function T(e,t){var n=v(e),i=[],s=e.split("\n");return r.forEach(n,function(n,r){(r===t||t==="*")&&n.forEach(function(t){var n=m(e,t.offsetStart);i.push({name:r,lineStart:h.offsetToLineNum(s,t.offsetStart),lineEnd:h.offsetToLineNum(s,n)})})}),i}var r=e("thirdparty/lodash"),i=e("thirdparty/CodeMirror2/lib/codemirror"),s=e("utils/Async"),o=e("document/DocumentManager"),u=e("document/ChangedDocumentTracker"),a=e("filesystem/FileSystem"),f=e("file/FileUtils"),l=e("utils/PerfUtils"),c=e("project/ProjectManager"),h=e("utils/StringUtils"),p=new u,d=/(function\s+([$_A-Za-z\u007F-\uFFFF][$_A-Za-z0-9\u007F-\uFFFF]*)\s*(\([^)]*\)))|(([$_A-Za-z\u007F-\uFFFF][$_A-Za-z0-9\u007F-\uFFFF]*)\s*[:=]\s*function\s*(\([^)]*\)))/g;l.createPerfMeasurement("JSUTILS_GET_ALL_FUNCTIONS","Parallel file search across project"),l.createPerfMeasurement("JSUTILS_REGEXP","RegExp search for all functions"),l.createPerfMeasurement("JSUTILS_END_OFFSET","Find end offset for a single matched function"),t.findAllMatchingFunctionsInText=T,t._getFunctionEndOffset=m,t.findMatchingFunctions=x}),define("project/WorkingSetView",["require","exports","module","thirdparty/lodash","document/DocumentManager","command/CommandManager","command/Commands","command/Menus","project/FileViewController","utils/ViewUtils"],function(e,t,n){function g(e){var t=null;if(e){var n=d.find("ul").children();n.each(function(){var n=$(this);if(n.data(h).fullPath===e.fullPath)return t=n,!1})}return t}function y(){if(a.getFileSelectionFocus()!==a.WORKING_SET_VIEW)return;var e=i.getCurrentDocument();if(!e)return;var t=g(e.file);if(!t)return;f.scrollElementIntoView(d,t,!1)}function b(){y(),v.trigger("selectionChanged"),d.triggerHandler("contentChanged")}function w(){d[0].scrollHeight>d[0].clientHeight?d.hasClass("vertical-scroll")||d.addClass("vertical-scroll"):d.removeClass("vertical-scroll")}function E(e){if(e.length<=1)return;var t=f.getDirNamesForDuplicateFiles(e);d.find("ul > li").each(function(){var n=$(this),r=e.indexOf(n.data(h));if(r!==-1){var i=t[r].split("/");i.length>3&&(t[r]=i[0]+"/…/"+i[i.length-1]);var s=$("<span class='directory'/>").html(" &mdash; "+t[r]);n.children("a").append(s)}})}function S(){var e={},t=i.getWorkingSet();d.find("ul > li > a > span.directory").remove(),t.forEach(function(t){var n=f.getFileEntryDisplay(t);e[n]||(e[n]=[]),e[n].push(t)}),r.forEach(e,function(e){e.length>1&&E(e)})}function x(){i.getWorkingSet().length===0?(d.hide(),p.hide()):(d.show(),p.show(),S()),w(),b()}function T(e,t,n){function P(e){var n=e.pageY-S;r.length&&n<0||p.length&&n>0?Math.abs(n)>E/2&&(n<0?(r.insertAfter(t),S-=E,n+=E,i.swapWorkingSetIndexes(w,--w)):(p.insertBefore(t),S+=E,n-=E,i.swapWorkingSetIndexes(w,++w)),!v&&(n>0&&g||n<0&&y)&&b(),r=t.prev(),p=t.next(),g=r.hasClass("selected"),y=p.hasClass("selected"),!M&&!O&&!p.length&&g&&(f.removeScrollerShadow(d[0],null),f.addScrollerShadow(d[0],null,!1),M=!0)):n=0,t.css("top",n+"px"),v&&b(),!D&&Math.abs(n)>3&&(u.closeAll(),D=!0,m=!0)}function H(){window.clearInterval(_),_=!1}function B(e){var t=0;e.pageY-x<N+7?t=-1:e.pageY+T>N+k-7&&(t=1),t&&!_?_=window.setInterval(function(){var n=d.scrollTop();t===-1&&n<=0||t===1&&n>=L?H():(d.scrollTop(n+7*t),S-=7*t,P(e))},100):!t&&_&&H()}function j(){window.onmousewheel=window.document.onmousewheel=null,t.removeAttr("style"),_&&window.clearInterval(_),D?(v&&(b(),f.scrollElementIntoView(d,t,!1)),M&&f.addScrollerShadow(d[0],null,!0),m=!1):n||e.which===c?s.execute(o.FILE_CLOSE,{file:t.data(h)}):a.openAndSelectDocument(t.data(h).fullPath,a.WORKING_SET_VIEW)}var r=t.prev(),p=t.next(),v=t.hasClass("selected"),g=r.hasClass("selected"),y=p.hasClass("selected"),w=i.findInWorkingSet(t.data(h).fullPath),E=t.height(),S=e.pageY,x=S-t.offset().top,T=t.offset().top+E-S,N=d.offset().top,C=d.get(0),k=C.clientHeight,L=C.scrollHeight-k,A=C.scrollHeight>k,O=C.scrollHeight>C.scrollTop+k,M=!1,_=!1,D=!1;if(e.which!==l||e.ctrlKey&&brackets.platform==="mac"){j();return}window.onmousewheel=window.document.onmousewheel=function(e){e.preventDefault()},t.css("position","relative").css("z-index",1),d.on("mousemove.workingSet",function(e){A&&B(e),P(e)}),d.on("mouseup.workingSet mouseleave.workingSet",function(e){d.off("mousemove.workingSet mouseup.workingSet mouseleave.workingSet"),j()})}function N(e,t,n){var r=e.find(".file-status-icon"),i=t||n;!i&&r.length!==0?(r.remove(),r=null):i&&r.length===0&&(r=$("<div class='file-status-icon'></div>").prependTo(e).mousedown(function(e){T(e,$(this).parent(),!0),e.stopPropagation()})),r&&(f.toggleClass(r,"dirty",t),f.toggleClass(r,"can-close",n))}function C(e,t){var n=t&&$(e).data(h).fullPath===t.file.fullPath;f.toggleClass($(e),"selected",n)}function k(e){var t=i.getOpenDocumentForPath(e.fullPath);return t&&t.isDirty}function L(e){var t=i.getCurrentDocument(),n=$("<a href='#'></a>").html(f.getFileEntryDisplay(e)),r=$("<li></li>").append(n).data(h,e);d.find("ul").append(r),N(r,k(e),!1),C(r,t),r.mousedown(function(e){T(e,$(this)),e.preventDefault()}),r.hover(function(){N($(this),k(e),!0)},function(){N($(this),k(e),!1)})}function A(e){d.find("ul").empty(),i.getWorkingSet().forEach(function(e){L(e)}),e&&x()}function O(){var e;a.getFileSelectionFocus()===a.WORKING_SET_VIEW?e=i.getCurrentDocument():e=null;var t=d.find("ul").children().each(function(){C(this,e)});y(),b()}function M(e,t){t===i.getWorkingSet().length-1?(L(e),x()):A(!0)}function _(e){e.forEach(function(e){L(e)}),x()}function D(e,t){if(!t){var n=g(e);if(n){var r=n.next();if(r&&r.length>0){var i=n.find(".can-close").length===1,s=k(r.data(h));N(r,s,i)}n.remove()}x()}}function P(e){e.forEach(function(e){var t=g(e);t&&t.remove()}),x()}function H(){m||A(!0)}function B(e){var t=g(e.file);if(t){var n=$(t).find(".can-close").length===1;N(t,e.isDirty,n)}}function j(e,t){A(!0)}function F(){x()}function I(e){d=e,p=$("#working-set-header"),v=d.find("ul"),$(i).on("workingSetAdd",function(e,t){M(t)}),$(i).on("workingSetAddList",function(e,t){_(t)}),$(i).on("workingSetRemove",function(e,t,n){D(t,n)}),$(i).on("workingSetRemoveList",function(e,t){P(t)}),$(i).on("workingSetSort",function(e){H()}),$(i).on("dirtyFlagChange",function(e,t){B(t)}),$(i).on("fileNameChange",function(e,t,n){j(t,n)}),$(a).on("documentSelectionFocusChange fileViewFocusChange",O),f.addScrollerShadow(d[0],null,!0),f.sidebarList(d),d.css("overflow-x","hidden"),x()}var r=e("thirdparty/lodash"),i=e("document/DocumentManager"),s=e("command/CommandManager"),o=e("command/Commands"),u=e("command/Menus"),a=e("project/FileViewController"),f=e("utils/ViewUtils"),l=1,c=2,h="file",p,d,v,m=!1;t.create=I,t.refresh=F}),define("project/WorkingSetSort",["require","exports","module","command/Commands","command/CommandManager","document/DocumentManager","preferences/PreferencesManager","file/FileUtils","utils/AppInit","strings"],function(e,t,n){function v(e){var t;if(!e){console.error("Attempting to get a Sort method with a missing required parameter: command");return}return typeof e=="string"?t=e:t=e.getID(),c[t]}function m(){return p}function g(){$(s).off(".sort")}function y(e){p=e,o.setViewState("automaticSort",e),i.get(r.SORT_WORKINGSET_AUTO).setChecked(e),h.setChecked(e),e?h.sort():g()}function b(){p&&h&&h.getEvents()&&$(s).on(h.getEvents(),function(){h.sort()}).on("workingSetDisableAutoSorting.sort",function(){y(!1)})}function w(e){var t;h!==e&&(h!==null&&h.setChecked(!1),p&&e.setChecked(!0),i.get(r.SORT_WORKINGSET_AUTO).setEnabled(!!e.getEvents()),o.setViewState("currentSort",e.getCommandID()),h=e)}function E(e,t,n,r){this._commandID=e,this._compareFn=t,this._events=n}function S(e,t,n){var r="";if(!e||!t){console.log("Attempting to register a Sort method with a missing required parameter: command or compare function");return}typeof e=="string"?r=e:r=e.getID();if(c[r]){console.log("Attempting to register an already-registered Sort method: "+e);return}n&&(n=n.split(" "),n.forEach(function(e,t){n[t]=n[t].trim()+".sort"}),n=n.join(" "));var i=new E(r,t,n);return c[r]=i,i}function x(){v(r.SORT_WORKINGSET_BY_ADDED).execute()}function T(){v(r.SORT_WORKINGSET_BY_NAME).execute()}function N(){v(r.SORT_WORKINGSET_BY_TYPE).execute()}function C(){y(!m())}var r=e("command/Commands"),i=e("command/CommandManager"),s=e("document/DocumentManager"),o=e("preferences/PreferencesManager"),u=e("file/FileUtils"),a=e("utils/AppInit"),f=e("strings"),l={currentSort:r.SORT_WORKINGSET_BY_ADDED,automaticSort:!1},c=[],h=null,p=!1,d=!1;E.prototype.getCommandID=function(){return this._commandID},E.prototype.getCompareFn=function(){return this._compareFn},E.prototype.getEvents=function(){return this._events},E.prototype.setChecked=function(e){var t=i.get(this._commandID);t&&t.setChecked(e)},E.prototype.execute=function(){w(this),this.sort()},E.prototype.sort=function(){h===this&&(g(),s.sortWorkingSet(this._compareFn),b())},S(r.SORT_WORKINGSET_BY_ADDED,function(e,t){var n=s.findInWorkingSetAddedOrder(e.fullPath),r=s.findInWorkingSetAddedOrder(t.fullPath);return n-r},"workingSetAdd workingSetAddList"),S(r.SORT_WORKINGSET_BY_NAME,function(e,t){return u.compareFilenames(e.name,t.name,!1)},"workingSetAdd workingSetAddList"),S(r.SORT_WORKINGSET_BY_TYPE,function(e,t){return u.compareFilenames(e.name,t.name,!0)},"workingSetAdd workingSetAddList"),i.register(f.CMD_SORT_WORKINGSET_BY_ADDED,r.SORT_WORKINGSET_BY_ADDED,x),i.register(f.CMD_SORT_WORKINGSET_BY_NAME,r.SORT_WORKINGSET_BY_NAME,T),i.register(f.CMD_SORT_WORKINGSET_BY_TYPE,r.SORT_WORKINGSET_BY_TYPE,N),i.register(f.CMD_SORT_WORKINGSET_AUTO,r.SORT_WORKINGSET_AUTO,C),o.stateManager.definePreference("currentSort","string",r.SORT_WORKINGSET_BY_ADDED),o.stateManager.definePreference("automaticSort","boolean",!1),o.convertPreferences(n,{currentSort:"user",automaticSort:"user"},!0),a.appReady(function(){var e=v(o.getViewState("currentSort")),t=o.getViewState("automaticSort");e&&w(e),t&&y(!0),e&&t&&e.sort()}),t.register=S,t.get=v,t.getAutomatic=m,t.setAutomatic=y}),define("utils/DragAndDrop",["require","exports","module","utils/Async","command/CommandManager","command/Commands","widgets/Dialogs","widgets/DefaultDialogs","document/DocumentManager","filesystem/FileSystem","editor/EditorManager","file/FileUtils","project/ProjectManager","strings","utils/StringUtils"],function(e,t,n){function v(e){var t=e.filter(function(e){return!l.getCustomViewerForPath(e)});return t.length===0&&e.length&&t.push(e[e.length-1]),t}function m(e){var t,n=e.length;for(t=0;t<n;t++)if(e[t].kind==="file"){var r=e[t].webkitGetAsEntry();if(r.isFile)return!0;if(n===1)return!0}return!1}function g(e){var t=[],n=v(e);return r.doInParallel(n,function(e,r){var o=new $.Deferred;return f.resolve(e,function(u,f){if(!u&&f.isFile){if(r<n.length-1&&a.findInWorkingSet(e)!==-1){o.resolve();return}i.execute(s.FILE_ADD_TO_WORKING_SET,{fullPath:e,silent:!0}).done(function(){o.resolve()}).fail(function(){t.push(e),o.reject()})}else!u&&f.isDirectory&&n.length===1?h.openProject(e).done(function(){o.resolve()}).fail(function(){o.reject()}):(t.push(e),o.reject())}),o.promise()},!1).fail(function(){if(t.length>0){var e=p.ERROR_OPENING_FILES;e+="<ul class='dialog-list'>",t.forEach(function(t){e+="<li><span class='dialog-filename'>"+d.breakableUrl(h.makeProjectRelativeIfPossible(t))+"</span></li>"}),e+="</ul>",o.showModalDialog(u.DIALOG_ID_ERROR,p.ERROR_OPENING_FILE_TITLE,e)}})}var r=e("utils/Async"),i=e("command/CommandManager"),s=e("command/Commands"),o=e("widgets/Dialogs"),u=e("widgets/DefaultDialogs"),a=e("document/DocumentManager"),f=e("filesystem/FileSystem"),l=e("editor/EditorManager"),c=e("file/FileUtils"),h=e("project/ProjectManager"),p=e("strings"),d=e("utils/StringUtils");i.register(p.CMD_OPEN_DROPPED_FILES,s.FILE_OPEN_DROPPED_FILES,g),t.isValidDrop=m,t.openDroppedFiles=g,t.filterFilesToOpen=v}),define("text!LiveDevelopment/Inspector/Inspector.json",[],function(){return'{\n    "version": { "major": "1", "minor": "0" },\n    "domains": [{\n        "domain": "Inspector",\n        "hidden": true,\n        "types": [],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables inspector domain notifications."\n            },\n            {\n                "name": "disable",\n                "description": "Disables inspector domain notifications."\n            }\n        ],\n        "events": [\n            {\n                "name": "evaluateForTestInFrontend",\n                "parameters": [\n                    { "name": "testCallId", "type": "integer" },\n                    { "name": "script", "type": "string" }\n                ]\n            },\n            {\n                "name": "inspect",\n                "parameters": [\n                    { "name": "object", "$ref": "Runtime.RemoteObject" },\n                    { "name": "hints", "type": "object" }\n                ]\n            },\n            {\n                "name": "detached",\n                "description": "Fired when remote debugging connection is about to be terminated. Contains detach reason.",\n                "parameters": [\n                    { "name": "reason", "type": "string", "description": "The reason why connection has been terminated." }\n                ]\n            }\n        ]\n    },\n    {\n        "domain": "Memory",\n        "hidden": true,\n        "types": [\n            {\n                "id": "NodeCount",\n                "type": "object",\n                "properties": [\n                    { "name": "nodeName", "type": "string" },\n                    { "name": "count", "type": "integer" }\n                ],\n                "description": "Number of nodes with given name."\n            },\n            {\n                "id": "ListenerCount",\n                "type": "object",\n                "properties": [\n                    { "name": "type", "type": "string" },\n                    { "name": "count", "type": "integer" }\n                ],\n                "description": "Number of JS event listeners by event type."\n            },\n            {\n                "id": "StringStatistics",\n                "type": "object",\n                "properties": [\n                    { "name": "dom", "type": "integer" },\n                    { "name": "js", "type": "integer" },\n                    { "name": "shared", "type": "integer" }\n                ],\n                "description": "Character data statistics for the page."\n            },\n            {\n                "id": "DOMGroup",\n                "type": "object",\n                "properties": [\n                    { "name": "size", "type": "integer" },\n                    { "name": "title", "type": "string" },\n                    { "name": "documentURI", "type": "string", "optional": true },\n                    { "name": "nodeCount", "type": "array", "items": { "$ref": "NodeCount" }},\n                    { "name": "listenerCount", "type": "array", "items": { "$ref": "ListenerCount" }}\n                ]\n            },\n            {\n                "id": "MemoryBlock",\n                "type": "object",\n                "properties": [\n                    { "name": "size", "type": "number", "optional": true, "description": "Size of the block in bytes if available" },\n                    { "name": "name", "type": "string", "description": "Unique name used to identify the component that allocated this block" },\n                    { "name": "children", "type": "array", "optional": true, "items": { "$ref": "MemoryBlock" }}\n                ]\n            },\n            {\n                "id": "HeapSnapshotChunk",\n                "type": "object",\n                "properties": [\n                    { "name": "strings", "type": "array", "items": { "type": "string" }, "description": "An array of strings that were found since last update." },\n                    { "name": "nodes", "type": "array", "items": { "type": "integer" }, "description": "An array of nodes that were found since last update." },\n                    { "name": "edges", "type": "array", "items": { "type": "integer" }, "description": "An array of edges that were found since last update." },\n                    { "name": "baseToRealNodeId", "type": "array", "items": { "type": "integer" }, "description": "An array of integers for nodeId remapping. Even nodeId has to be mapped to the following odd nodeId." }\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "getDOMNodeCount",\n                "returns": [\n                    { "name": "domGroups", "type": "array", "items": { "$ref": "DOMGroup" }},\n                    { "name": "strings", "$ref": "StringStatistics" }\n                ]\n            },\n            {\n                "name": "getDOMCounters",\n                "returns": [\n                    { "name": "documents", "type": "integer" },\n                    { "name": "nodes", "type": "integer" },\n                    { "name": "jsEventListeners", "type": "integer" }\n                ]\n            },\n            {\n                "name": "getProcessMemoryDistribution",\n                "parameters": [\n                    { "name": "reportGraph", "type": "boolean", "optional": true, "description": "Whether native memory graph should be reported in addition to aggregated statistics." }\n                ],\n                "returns": [\n                    { "name": "distribution", "$ref": "MemoryBlock", "description": "An object describing all memory allocated by the process"}\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "addNativeSnapshotChunk",\n                "parameters": [\n                    { "name": "chunk", "$ref": "HeapSnapshotChunk", "description": "A chunk of the serialized the snapshot." }\n                ]\n            }\n        ]\n    },\n    {\n        "domain": "Page",\n        "description": "Actions and events related to the inspected page belong to the page domain.",\n        "types": [\n            {\n                "id": "ResourceType",\n                "type": "string",\n                "enum": ["Document", "Stylesheet", "Image", "Font", "Script", "XHR", "WebSocket", "Other"],\n                "description": "Resource type as it was perceived by the rendering engine."\n            },\n            {\n                "id": "Frame",\n                "type": "object",\n                "description": "Information about the Frame on the page.",\n                "properties": [\n                    { "name": "id", "type": "string", "description": "Frame unique identifier." },\n                    { "name": "parentId", "type": "string", "optional": true, "description": "Parent frame identifier." },\n                    { "name": "loaderId", "$ref": "Network.LoaderId", "description": "Identifier of the loader associated with this frame." },\n                    { "name": "name", "type": "string", "optional": true, "description": "Frame\'s name as specified in the tag." },\n                    { "name": "url", "type": "string", "description": "Frame document\'s URL." },\n                    { "name": "securityOrigin", "type": "string", "optional": true, "description": "Frame document\'s security origin." },\n                    { "name": "mimeType", "type": "string", "description": "Frame document\'s mimeType as determined by the browser." }\n                ],\n                "hidden": true\n            },\n            {\n                "id": "FrameResourceTree",\n                "type": "object",\n                "description": "Information about the Frame hierarchy along with their cached resources.",\n                "properties": [\n                    { "name": "frame", "$ref": "Frame", "description": "Frame information for this tree item." },\n                    { "name": "childFrames", "type": "array", "optional": true, "items": { "$ref": "FrameResourceTree" }, "description": "Child frames." },\n                    { "name": "resources", "type": "array",\n                        "items": {\n                            "type": "object",\n                            "properties": [\n                                { "name": "url", "type": "string", "description": "Resource URL." },\n                                { "name": "type", "$ref": "ResourceType", "description": "Type of this resource." },\n                                { "name": "mimeType", "type": "string", "description": "Resource mimeType as determined by the browser." },\n                                { "name": "failed", "type": "boolean", "optional": true, "description": "True if the resource failed to load." },\n                                { "name": "canceled", "type": "boolean", "optional": true, "description": "True if the resource was canceled during loading." }\n                            ]\n                        },\n                        "description": "Information about frame resources."\n                    }\n                ],\n                "hidden": true\n            },\n            {\n                "id": "SearchMatch",\n                "type": "object",\n                "description": "Search match for resource.",\n                "properties": [\n                    { "name": "lineNumber", "type": "number", "description": "Line number in resource content." },\n                    { "name": "lineContent", "type": "string", "description": "Line with match content." }\n                ],\n                "hidden": true\n            },\n            {\n                "id": "SearchResult",\n                "type": "object",\n                "description": "Search result for resource.",\n                "properties": [\n                    { "name": "url", "type": "string", "description": "Resource URL." },\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Resource frame id." },\n                    { "name": "matchesCount", "type": "number", "description": "Number of matches in the resource content." }\n                ],\n                "hidden": true\n            },\n            {\n                "id": "Cookie",\n                "type": "object",\n                "description": "Cookie object",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Cookie name." },\n                    { "name": "value", "type": "string", "description": "Cookie value." },\n                    { "name": "domain", "type": "string", "description": "Cookie domain." },\n                    { "name": "path", "type": "string", "description": "Cookie path." },\n                    { "name": "expires", "type": "number", "description": "Cookie expires." },\n                    { "name": "size", "type": "integer", "description": "Cookie size." },\n                    { "name": "httpOnly", "type": "boolean", "description": "True if cookie is http-only." },\n                    { "name": "secure", "type": "boolean", "description": "True if cookie is secure." },\n                    { "name": "session", "type": "boolean", "description": "True in case of session cookie." }\n                ],\n                "hidden": true\n            },\n            {\n                "id": "ScriptIdentifier",\n                "type": "string",\n                "description": "Unique script identifier.",\n                "hidden": true\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables page domain notifications."\n            },\n            {\n                "name": "disable",\n                "description": "Disables page domain notifications."\n            },\n            {\n                "name": "addScriptToEvaluateOnLoad",\n                "parameters": [\n                    { "name": "scriptSource", "type": "string" }\n                ],\n                "returns": [\n                    { "name": "identifier", "$ref": "ScriptIdentifier", "description": "Identifier of the added script." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "removeScriptToEvaluateOnLoad",\n                "parameters": [\n                    { "name": "identifier", "$ref": "ScriptIdentifier" }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "reload",\n                "parameters": [\n                    { "name": "ignoreCache", "type": "boolean", "optional": true, "description": "If true, browser cache is ignored (as if the user pressed Shift+refresh)." },\n                    { "name": "scriptToEvaluateOnLoad", "type": "string", "optional": true, "description": "If set, the script will be injected into all frames of the inspected page after reload." },\n                    { "name": "scriptPreprocessor", "type": "string", "optional": true, "description": "Script body that should evaluate to function that will preprocess all the scripts before their compilation.", "hidden": true }\n                ],\n                "description": "Reloads given page optionally ignoring the cache."\n            },\n            {\n                "name": "navigate",\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "URL to navigate the page to." }\n                ],\n                "description": "Navigates current page to the given URL."\n            },\n            {\n                "name": "getCookies",\n                "returns": [\n                    { "name": "cookies", "type": "array", "items": { "$ref": "Cookie"}, "description": "Array of cookie objects." },\n                    { "name": "cookiesString", "type": "string", "description": "document.cookie string representation of the cookies." }\n                ],\n                "description": "Returns all browser cookies. Depending on the backend support, will either return detailed cookie information in the <code>cookie</code> field or string cookie representation using <code>cookieString</code>.",\n                "hidden": true\n            },\n            {\n                "name": "deleteCookie",\n                "parameters": [\n                    { "name": "cookieName", "type": "string", "description": "Name of the cookie to remove." },\n                    { "name": "url", "type": "string", "description": "URL to match cooke domain and path." }\n                ],\n                "description": "Deletes browser cookie with given name, domain and path.",\n                "hidden": true\n            },\n            {\n                "name": "getResourceTree",\n                "description": "Returns present frame / resource tree structure.",\n                "returns": [\n                    { "name": "frameTree", "$ref": "FrameResourceTree", "description": "Present frame / resource tree structure." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "getResourceContent",\n                "description": "Returns content of the given resource.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Frame id to get resource for." },\n                    { "name": "url", "type": "string", "description": "URL of the resource to get content for." }\n                ],\n                "returns": [\n                    { "name": "content", "type": "string", "description": "Resource content." },\n                    { "name": "base64Encoded", "type": "boolean", "description": "True, if content was served as base64." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "searchInResource",\n                "description": "Searches for given string in resource content.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Frame id for resource to search in." },\n                    { "name": "url", "type": "string", "description": "URL of the resource to search in." },\n                    { "name": "query", "type": "string", "description": "String to search for."  },\n                    { "name": "caseSensitive", "type": "boolean", "optional": true, "description": "If true, search is case sensitive." },\n                    { "name": "isRegex", "type": "boolean", "optional": true, "description": "If true, treats string parameter as regex." }\n                ],\n                "returns": [\n                    { "name": "result", "type": "array", "items": { "$ref": "SearchMatch" }, "description": "List of search matches." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "searchInResources",\n                "description": "Searches for given string in frame / resource tree structure.",\n                "parameters": [\n                    { "name": "text", "type": "string", "description": "String to search for."  },\n                    { "name": "caseSensitive", "type": "boolean", "optional": true, "description": "If true, search is case sensitive." },\n                    { "name": "isRegex", "type": "boolean", "optional": true, "description": "If true, treats string parameter as regex." }\n                ],\n                "returns": [\n                    { "name": "result", "type": "array", "items": { "$ref": "SearchResult" }, "description": "List of search results." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setDocumentContent",\n                "description": "Sets given markup as the document\'s HTML.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Frame id to set HTML for." },\n                    { "name": "html", "type": "string", "description": "HTML content to set."  }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "canOverrideDeviceMetrics",\n                "description": "Checks whether <code>setDeviceMetricsOverride</code> can be invoked.",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "If true, <code>setDeviceMetricsOverride</code> can safely be invoked on the agent." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setDeviceMetricsOverride",\n                "description": "Overrides the values of device screen dimensions (window.screen.width, window.screen.height, window.innerWidth, window.innerHeight, and \\"device-width\\"/\\"device-height\\"-related CSS media query results) and the font scale factor.",\n                "parameters": [\n                    { "name": "width", "type": "integer", "description": "Overriding width value in pixels (minimum 0, maximum 10000000). 0 disables the override." },\n                    { "name": "height", "type": "integer", "description": "Overriding height value in pixels (minimum 0, maximum 10000000). 0 disables the override." },\n                    { "name": "fontScaleFactor", "type": "number", "description": "Overriding font scale factor value (must be positive). 1 disables the override." },\n                    { "name": "fitWindow", "type": "boolean", "description": "Whether a view that exceeds the available browser window area should be scaled down to fit." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setShowPaintRects",\n                "description": "Requests that backend shows paint rectangles",\n                "parameters": [\n                    { "name": "result", "type": "boolean", "description": "True for showing paint rectangles" }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "canShowDebugBorders",\n                "description": "Tells if backend supports debug borders on layers",\n                "returns": [\n                    { "name": "show", "type": "boolean", "description": "True if the debug borders can be shown" }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setShowDebugBorders",\n                "description": "Requests that backend shows debug borders on layers",\n                "parameters": [\n                    { "name": "show", "type": "boolean", "description": "True for showing debug borders" }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "canShowFPSCounter",\n                "description": "Tells if backend supports a FPS counter display",\n                "returns": [\n                    { "name": "show", "type": "boolean", "description": "True if the FPS count can be shown" }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setShowFPSCounter",\n                "description": "Requests that backend shows the FPS counter",\n                "parameters": [\n                    { "name": "show", "type": "boolean", "description": "True for showing the FPS counter" }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "canContinuouslyPaint",\n                "description": "Tells if backend supports continuous painting",\n                "returns": [\n                    { "name": "value", "type": "boolean", "description": "True if continuous painting is available" }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setContinuousPaintingEnabled",\n                "description": "Requests that backend enables continuous painting",\n                "parameters": [\n                    { "name": "enabled", "type": "boolean", "description": "True for enabling cointinuous painting" }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "getScriptExecutionStatus",\n                "description": "Determines if scripts can be executed in the page.",\n                "returns": [\n                    { "name": "result", "type": "string", "enum": ["allowed", "disabled", "forbidden"], "description": "Script execution status: \\"allowed\\" if scripts can be executed, \\"disabled\\" if script execution has been disabled through page settings, \\"forbidden\\" if script execution for the given page is not possible for other reasons." }\n                ]\n            },\n            {\n                "name": "setScriptExecutionDisabled",\n                "description": "Switches script execution in the page.",\n                "parameters": [\n                    { "name": "value", "type": "boolean", "description": "Whether script execution should be disabled in the page." }\n                ]\n            },\n            {\n                "name": "setGeolocationOverride",\n                "description": "Overrides the Geolocation Position or Error.",\n                "parameters": [\n                    { "name": "latitude", "type": "number", "optional": true, "description": "Mock longitude"},\n                    { "name": "longitude", "type": "number", "optional": true, "description": "Mock latitude"},\n                    { "name": "accuracy", "type": "number", "optional": true, "description": "Mock accuracy"}\n                ],\n                "hidden": true\n            },\n            {\n                "name": "clearGeolocationOverride",\n                "description": "Clears the overriden Geolocation Position and Error.",\n                "hidden": true\n            },\n            {\n                "name": "canOverrideGeolocation",\n                "description": "Checks if Geolocation can be overridden.",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "True if browser can ovrride Geolocation." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setDeviceOrientationOverride",\n                "description": "Overrides the Device Orientation.",\n                "parameters": [\n                    { "name": "alpha", "type": "number", "description": "Mock alpha"},\n                    { "name": "beta", "type": "number", "description": "Mock beta"},\n                    { "name": "gamma", "type": "number", "description": "Mock gamma"}\n                ],\n                "hidden": true\n            },\n            {\n                "name": "clearDeviceOrientationOverride",\n                "description": "Clears the overridden Device Orientation.",\n                "hidden": true\n            },\n            {\n                "name": "canOverrideDeviceOrientation",\n                "description": "Check the backend if Web Inspector can override the device orientation.",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "If true, <code>setDeviceOrientationOverride</code> can safely be invoked on the agent." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setTouchEmulationEnabled",\n                "parameters": [\n                    { "name": "enabled", "type": "boolean", "description": "Whether the touch event emulation should be enabled." }\n                ],\n                "description": "Toggles mouse event-based touch event emulation.",\n                "hidden": true\n            },\n            {\n                "name": "setEmulatedMedia",\n                "parameters": [\n                    { "name": "media", "type": "string", "description": "Media type to emulate. Empty string disables the override." }\n                ],\n                "description": "Emulates the given media for CSS media queries.",\n                "hidden": true\n            },\n            {\n                "name": "getCompositingBordersVisible",\n                "description": "Indicates the visibility of compositing borders.",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "If true, compositing borders are visible." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setCompositingBordersVisible",\n                "description": "Controls the visibility of compositing borders.",\n                "parameters": [\n                    { "name": "visible", "type": "boolean", "description": "True for showing compositing borders." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "captureScreenshot",\n                "description": "Capture page screenshot.",\n                "returns": [\n                    { "name": "data", "type": "string", "description": "Base64-encoded image data (PNG)." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "handleJavaScriptDialog",\n                "description": "Accepts or dismisses a JavaScript initiated dialog (alert, confirm, prompt, or onbeforeunload).",\n                "parameters": [\n                    { "name": "accept", "type": "boolean", "description": "Whether to accept or dismiss the dialog." }\n                ],\n                "hidden": true\n            }\n        ],\n        "events": [\n            {\n                "name": "domContentEventFired",\n                "parameters": [\n                    { "name": "timestamp", "type": "number" }\n                ]\n            },\n            {\n                "name": "loadEventFired",\n                "parameters": [\n                    { "name": "timestamp", "type": "number" }\n                ]\n            },\n            {\n                "name": "frameNavigated",\n                "description": "Fired once navigation of the frame has completed. Frame is now associated with the new loader.",\n                "parameters": [\n                    { "name": "frame", "$ref": "Frame", "description": "Frame object." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "frameDetached",\n                "description": "Fired when frame has been detached from its parent.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Id of the frame that has been detached." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "frameStartedLoading",\n                "description": "Fired when frame has started loading.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Id of the frame that has started loading." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "frameStoppedLoading",\n                "description": "Fired when frame has stopped loading.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Id of the frame that has stopped loading." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "frameScheduledNavigation",\n                "description": "Fired when frame schedules a potential navigation.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Id of the frame that has scheduled a navigation." },\n                    { "name": "delay", "type": "number", "description": "Delay (in seconds) until the navigation is scheduled to begin. The navigation is not guaranteed to start." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "frameClearedScheduledNavigation",\n                "description": "Fired when frame no longer has a scheduled navigation.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Id of the frame that has cleared its scheduled navigation." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "javascriptDialogOpening",\n                "description": "Fired when a JavaScript initiated dialog (alert, confirm, prompt, or onbeforeunload) is about to open.",\n                "parameters": [\n                    { "name": "message", "type": "string", "description": "Message that will be displayed by the dialog." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "javascriptDialogClosed",\n                "description": "Fired when a JavaScript initiated dialog (alert, confirm, prompt, or onbeforeunload) has been closed.",\n                "hidden": true\n            }\n        ]\n    },\n    {\n        "domain": "Runtime",\n        "description": "Runtime domain exposes JavaScript runtime by means of remote evaluation and mirror objects. Evaluation results are returned as mirror object that expose object type, string representation and unique identifier that can be used for further object reference. Original objects are maintained in memory unless they are either explicitly released or are released along with the other objects in their object group.",\n        "types": [\n            {\n                "id": "RemoteObjectId",\n                "type": "string",\n                "description": "Unique object identifier."\n            },\n            {\n                "id": "RemoteObject",\n                "type": "object",\n                "description": "Mirror object referencing original JavaScript object.",\n                "properties": [\n                    { "name": "type", "type": "string", "enum": ["object", "function", "undefined", "string", "number", "boolean"], "description": "Object type." },\n                    { "name": "subtype", "type": "string", "optional": true, "enum": ["array", "null", "node", "regexp", "date"], "description": "Object subtype hint. Specified for <code>object</code> type values only." },\n                    { "name": "className", "type": "string", "optional": true, "description": "Object class (constructor) name. Specified for <code>object</code> type values only." },\n                    { "name": "value", "type": "any", "optional": true, "description": "Remote object value (in case of primitive values or JSON values if it was requested)." },\n                    { "name": "description", "type": "string", "optional": true, "description": "String representation of the object." },\n                    { "name": "objectId", "$ref": "RemoteObjectId", "optional": true, "description": "Unique object identifier (for non-primitive values)." },\n                    { "name": "preview", "$ref": "ObjectPreview", "optional": true, "description": "Preview containsing abbreviated property values.", "hidden": true }\n                ]\n            },\n            {\n                "id": "ObjectPreview",\n                "type": "object",\n                "hidden": true,\n                "description": "Object containing abbreviated remote object value.",\n                "properties": [\n                    { "name": "lossless", "type": "boolean", "description": "Determines whether preview is lossless (contains all information of the original object)." },\n                    { "name": "overflow", "type": "boolean", "description": "True iff some of the properties of the original did not fit." },\n                    { "name": "properties", "type": "array", "items": { "$ref": "PropertyPreview" }, "description": "List of the properties." }\n                ]\n            },\n            {\n                "id": "PropertyPreview",\n                "type": "object",\n                "hidden": true,\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Property name." },\n	                { "name": "type", "type": "string", "enum": ["object", "function", "undefined", "string", "number", "boolean"], "description": "Object type." },\n	                { "name": "value", "type": "string", "optional": true, "description": "User-friendly property value string." },\n	                { "name": "subtype", "type": "string", "optional": true, "enum": ["array", "null", "node", "regexp", "date"], "description": "Object subtype hint. Specified for <code>object</code> type values only." }\n                ]\n            },\n            {\n                "id": "PropertyDescriptor",\n                "type": "object",\n                "description": "Object property descriptor.",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Property name." },\n                    { "name": "value", "$ref": "RemoteObject", "optional": true, "description": "The value associated with the property." },\n                    { "name": "writable", "type": "boolean", "optional": true, "description": "True if the value associated with the property may be changed (data descriptors only)." },\n                    { "name": "get", "$ref": "RemoteObject", "optional": true, "description": "A function which serves as a getter for the property, or <code>undefined</code> if there is no getter (accessor descriptors only)." },\n                    { "name": "set", "$ref": "RemoteObject", "optional": true, "description": "A function which serves as a setter for the property, or <code>undefined</code> if there is no setter (accessor descriptors only)." },\n                    { "name": "configurable", "type": "boolean", "description": "True if the type of this property descriptor may be changed and if the property may be deleted from the corresponding object." },\n                    { "name": "enumerable", "type": "boolean", "description": "True if this property shows up during enumeration of the properties on the corresponding object." },\n                    { "name": "wasThrown", "type": "boolean", "optional": true, "description": "True if the result was thrown during the evaluation." },\n                    { "name": "isOwn", "optional": true, "type": "boolean", "description": "True if the property is owned for the object." }\n\n                ]\n            },\n            {\n                "id": "InternalPropertyDescriptor",\n                "type": "object",\n                "description": "Object internal property descriptor. This property isn\'t normally visible in JavaScript code.",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Conventional property name." },\n                    { "name": "value", "$ref": "RemoteObject", "optional": true, "description": "The value associated with the property." }\n                ]\n            },\n            {\n                "id": "CallArgument",\n                "type": "object",\n                "description": "Represents function call argument. Either remote object id <code>objectId</code> or primitive <code>value</code> or neither of (for undefined) them should be specified.",\n                "properties": [\n                    { "name": "value", "type": "any", "optional": true, "description": "Primitive value." },\n                    { "name": "objectId", "$ref": "RemoteObjectId", "optional": true, "description": "Remote object handle." }\n                ]\n            },\n            {\n                "id": "ExecutionContextId",\n                "type": "integer",\n                "description": "Id of an execution context.",\n                "hidden": true\n            },\n            {\n                "id": "ExecutionContextDescription",\n                "type": "object",\n                "description": "Description of an isolated world.",\n                "properties": [\n                    { "name": "id", "$ref": "ExecutionContextId", "description": "Unique id of the execution context. It can be used to specify in which execution context script evaluation should be performed." },\n                    { "name": "isPageContext", "type": "boolean", "description": "True if this is a context where inpspected web page scripts run. False if it is a content script isolated context." },\n                    { "name": "name", "type": "string", "description": "Human readable name describing given context." },\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Id of the owning frame." }\n                ],\n                "hidden": true\n            }\n\n        ],\n        "commands": [\n            {\n                "name": "evaluate",\n                "parameters": [\n                    { "name": "expression", "type": "string", "description": "Expression to evaluate." },\n                    { "name": "objectGroup", "type": "string", "optional": true, "description": "Symbolic group name that can be used to release multiple objects." },\n                    { "name": "includeCommandLineAPI", "type": "boolean", "optional": true, "description": "Determines whether Command Line API should be available during the evaluation.", "hidden": true },\n                    { "name": "doNotPauseOnExceptionsAndMuteConsole", "type": "boolean", "optional": true, "description": "Specifies whether evaluation should stop on exceptions and mute console. Overrides setPauseOnException state.", "hidden": true },\n                    { "name": "contextId", "$ref": "Runtime.ExecutionContextId", "optional": true, "description": "Specifies in which isolated context to perform evaluation. Each content script lives in an isolated context and this parameter may be used to specify one of those contexts. If the parameter is omitted or 0 the evaluation will be performed in the context of the inspected page.", "hidden": true },\n                    { "name": "returnByValue", "type": "boolean", "optional": true, "description": "Whether the result is expected to be a JSON object that should be sent by value." },\n                    { "name": "generatePreview", "type": "boolean", "optional": true, "hidden": true, "description": "Whether preview should be generated for the result." }\n                ],\n                "returns": [\n                    { "name": "result", "$ref": "RemoteObject", "description": "Evaluation result." },\n                    { "name": "wasThrown", "type": "boolean", "optional": true, "description": "True if the result was thrown during the evaluation." }\n                ],\n                "description": "Evaluates expression on global object."\n            },\n            {\n                "name": "callFunctionOn",\n                "parameters": [\n                    { "name": "objectId", "$ref": "RemoteObjectId", "description": "Identifier of the object to call function on." },\n                    { "name": "functionDeclaration", "type": "string", "description": "Declaration of the function to call." },\n                    { "name": "arguments", "type": "array", "items": { "$ref": "CallArgument", "description": "Call argument." }, "optional": true, "description": "Call arguments. All call arguments must belong to the same JavaScript world as the target object." },\n                    { "name": "doNotPauseOnExceptionsAndMuteConsole", "type": "boolean", "optional": true, "description": "Specifies whether function call should stop on exceptions and mute console. Overrides setPauseOnException state.", "hidden": true },\n                    { "name": "returnByValue", "type": "boolean", "optional": true, "description": "Whether the result is expected to be a JSON object which should be sent by value." },\n                    { "name": "generatePreview", "type": "boolean", "optional": true, "hidden": true, "description": "Whether preview should be generated for the result." }\n                ],\n                "returns": [\n                    { "name": "result", "$ref": "RemoteObject", "description": "Call result." },\n                    { "name": "wasThrown", "type": "boolean", "optional": true, "description": "True if the result was thrown during the evaluation." }\n                ],\n                "description": "Calls function with given declaration on the given object. Object group of the result is inherited from the target object."\n            },\n            {\n                "name": "getProperties",\n                "parameters": [\n                    { "name": "objectId", "$ref": "RemoteObjectId", "description": "Identifier of the object to return properties for." },\n                    { "name": "ownProperties", "optional": true, "type": "boolean", "description": "If true, returns properties belonging only to the element itself, not to its prototype chain." }\n                ],\n                "returns": [\n                    { "name": "result", "type": "array", "items": { "$ref": "PropertyDescriptor"}, "description": "Object properties." },\n                    { "name": "internalProperties", "optional": true, "type": "array", "items": { "$ref": "InternalPropertyDescriptor"}, "description": "Internal object properties." }\n                ],\n                "description": "Returns properties of a given object. Object group of the result is inherited from the target object."\n            },\n            {\n                "name": "releaseObject",\n                "parameters": [\n                    { "name": "objectId", "$ref": "RemoteObjectId", "description": "Identifier of the object to release." }\n                ],\n                "description": "Releases remote object with given id."\n            },\n            {\n                "name": "releaseObjectGroup",\n                "parameters": [\n                    { "name": "objectGroup", "type": "string", "description": "Symbolic object group name." }\n                ],\n                "description": "Releases all remote objects that belong to a given group."\n            },\n            {\n                "name": "run",\n                "hidden": true,\n                "description": "Tells inspected instance(worker or page) that it can run in case it was started paused."\n            },\n            {\n                "name": "enable",\n                "hidden": true,\n                "description": "Enables reporting of execution contexts creation by means of <code>executionContextCreated</code> event. When the reporting gets enabled the event will be sent immediately for each existing execution context."\n            },\n            {\n                "name": "disable",\n                "hidden": true,\n                "description": "Disables reporting of execution contexts creation."\n            }\n        ],\n        "events": [\n            {\n                "name": "executionContextCreated",\n                "parameters": [\n                    { "name": "context", "$ref": "ExecutionContextDescription", "description": "A newly created execution contex." }\n                ],\n                "hidden": true,\n                "description": "Issued when new execution context is created."\n            }\n        ]\n    },\n    {\n        "domain": "Console",\n        "description": "Console domain defines methods and events for interaction with the JavaScript console. Console collects messages created by means of the <a href=\'http://getfirebug.com/wiki/index.php/Console_API\'>JavaScript Console API</a>. One needs to enable this domain using <code>enable</code> command in order to start receiving the console messages. Browser collects messages issued while console domain is not enabled as well and reports them using <code>messageAdded</code> notification upon enabling.",\n        "types": [\n            {\n                "id": "ConsoleMessage",\n                "type": "object",\n                "description": "Console message.",\n                "properties": [\n                    { "name": "source", "type": "string", "enum": ["html", "wml", "xml", "javascript", "network", "console-api", "other"], "description": "Message source." },\n                    { "name": "level", "type": "string", "enum": ["tip", "log", "warning", "error", "debug"], "description": "Message severity." },\n                    { "name": "text", "type": "string", "description": "Message text." },\n                    { "name": "type", "type": "string", "optional": true, "enum": ["log", "dir", "dirxml", "trace", "clear", "startGroup", "startGroupCollapsed", "endGroup", "assert", "timing"], "description": "Console message type." },\n                    { "name": "url", "type": "string", "optional": true, "description": "URL of the message origin." },\n                    { "name": "line", "type": "integer", "optional": true, "description": "Line number in the resource that generated this message." },\n                    { "name": "repeatCount", "type": "integer", "optional": true, "description": "Repeat count for repeated messages." },\n                    { "name": "parameters", "type": "array", "items": { "$ref": "Runtime.RemoteObject" }, "optional": true, "description": "Message parameters in case of the formatted message." },\n                    { "name": "stackTrace", "$ref": "StackTrace", "optional": true, "description": "JavaScript stack trace for assertions and error messages." },\n                    { "name": "networkRequestId", "$ref": "Network.RequestId", "optional": true, "description": "Identifier of the network request associated with this message." }\n                ]\n            },\n            {\n                "id": "CallFrame",\n                "type": "object",\n                "description": "Stack entry for console errors and assertions.",\n                "properties": [\n                    { "name": "functionName", "type": "string", "description": "JavaScript function name." },\n                    { "name": "url", "type": "string", "description": "JavaScript script name or url." },\n                    { "name": "lineNumber", "type": "integer", "description": "JavaScript script line number." },\n                    { "name": "columnNumber", "type": "integer", "description": "JavaScript script column number." }\n                ]\n            },\n            {\n                "id": "StackTrace",\n                "type": "array",\n                "items": { "$ref": "CallFrame" },\n                "description": "Call frames for assertions or error messages."\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables console domain, sends the messages collected so far to the client by means of the <code>messageAdded</code> notification."\n            },\n            {\n                "name": "disable",\n                "description": "Disables console domain, prevents further console messages from being reported to the client."\n            },\n            {\n                "name": "clearMessages",\n                "description": "Clears console messages collected in the browser."\n            },\n            {\n                "name": "setMonitoringXHREnabled",\n                "parameters": [\n                    { "name": "enabled", "type": "boolean", "description": "Monitoring enabled state." }\n                ],\n                "description": "Toggles monitoring of XMLHttpRequest. If <code>true</code>, console will receive messages upon each XHR issued.",\n                "hidden": true\n            },\n            {\n                "name": "addInspectedNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId", "description": "DOM node id to be accessible by means of $x command line API." }\n                ],\n                "description": "Enables console to refer to the node with given id via $x (see Command Line API for more details $x functions).",\n                "hidden": true\n            },\n            {\n                "name": "addInspectedHeapObject",\n                "parameters": [\n                    { "name": "heapObjectId", "type": "integer" }\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "messageAdded",\n                "parameters": [\n                    { "name": "message", "$ref": "ConsoleMessage", "description": "Console message that has been added." }\n                ],\n                "description": "Issued when new console message is added."\n            },\n            {\n                "name": "messageRepeatCountUpdated",\n                "parameters": [\n                    { "name": "count", "type": "integer", "description": "New repeat count value." }\n                ],\n                "description": "Issued when subsequent message(s) are equal to the previous one(s)."\n            },\n            {\n                "name": "messagesCleared",\n                "description": "Issued when console is cleared. This happens either upon <code>clearMessages</code> command or after page navigation."\n            }\n        ]\n    },\n    {\n        "domain": "Network",\n        "description": "Network domain allows tracking network activities of the page. It exposes information about http, file, data and other requests and responses, their headers, bodies, timing, etc.",\n        "types": [\n            {\n                "id": "LoaderId",\n                "type": "string",\n                "description": "Unique loader identifier."\n            },\n            {\n                "id": "FrameId",\n                "type": "string",\n                "description": "Unique frame identifier.",\n                "hidden": true\n            },\n            {\n                "id": "RequestId",\n                "type": "string",\n                "description": "Unique request identifier."\n            },\n            {\n                "id": "Timestamp",\n                "type": "number",\n                "description": "Number of seconds since epoch."\n            },\n            {\n                "id": "Headers",\n                "type": "object",\n                "description": "Request / response headers as keys / values of JSON object."\n            },\n            {\n                "id": "ResourceTiming",\n                "type": "object",\n                "description": "Timing information for the request.",\n                "properties": [\n                    { "name": "requestTime", "type": "number", "description": "Timing\'s requestTime is a baseline in seconds, while the other numbers are ticks in milliseconds relatively to this requestTime." },\n                    { "name": "proxyStart", "type": "number", "description": "Started resolving proxy." },\n                    { "name": "proxyEnd", "type": "number", "description": "Finished resolving proxy." },\n                    { "name": "dnsStart", "type": "number", "description": "Started DNS address resolve." },\n                    { "name": "dnsEnd", "type": "number", "description": "Finished DNS address resolve." },\n                    { "name": "connectStart", "type": "number", "description": "Started connecting to the remote host." },\n                    { "name": "connectEnd", "type": "number", "description": "Connected to the remote host." },\n                    { "name": "sslStart", "type": "number", "description": "Started SSL handshake." },\n                    { "name": "sslEnd", "type": "number", "description": "Finished SSL handshake." },\n                    { "name": "sendStart", "type": "number", "description": "Started sending request." },\n                    { "name": "sendEnd", "type": "number", "description": "Finished sending request." },\n                    { "name": "receiveHeadersEnd", "type": "number", "description": "Finished receiving response headers." }\n                ]\n            },\n            {\n                "id": "Request",\n                "type": "object",\n                "description": "HTTP request data.",\n                "properties": [\n                    { "name": "url", "type": "string", "description": "Request URL." },\n                    { "name": "method", "type": "string", "description": "HTTP request method." },\n                    { "name": "headers", "$ref": "Headers", "description": "HTTP request headers." },\n                    { "name": "postData", "type": "string", "optional": true, "description": "HTTP POST request data." }\n                ]\n            },\n            {\n                "id": "Response",\n                "type": "object",\n                "description": "HTTP response data.",\n                "properties": [\n                    { "name": "url", "type": "string", "description": "Response URL. This URL can be different from CachedResource.url in case of redirect." },\n                    { "name": "status", "type": "number", "description": "HTTP response status code." },\n                    { "name": "statusText", "type": "string", "description": "HTTP response status text." },\n                    { "name": "headers", "$ref": "Headers", "description": "HTTP response headers." },\n                    { "name": "headersText", "type": "string", "optional": true, "description": "HTTP response headers text." },\n                    { "name": "mimeType", "type": "string", "description": "Resource mimeType as determined by the browser." },\n                    { "name": "requestHeaders", "$ref": "Headers", "optional": true, "description": "Refined HTTP request headers that were actually transmitted over the network." },\n                    { "name": "requestHeadersText", "type": "string", "optional": true, "description": "HTTP request headers text." },\n                    { "name": "connectionReused", "type": "boolean", "description": "Specifies whether physical connection was actually reused for this request." },\n                    { "name": "connectionId", "type": "number", "description": "Physical connection id that was actually used for this request." },\n                    { "name": "fromDiskCache", "type": "boolean", "optional": true, "description": "Specifies that the request was served from the disk cache." },\n                    { "name": "timing", "$ref": "ResourceTiming", "optional": true, "description": "Timing information for the given request." }\n                ]\n            },\n            {\n                "id": "WebSocketRequest",\n                "type": "object",\n                "description": "WebSocket request data.",\n                "hidden": true,\n                "properties": [\n                    { "name": "headers", "$ref": "Headers", "description": "HTTP response headers." }\n                ]\n            },\n            {\n                "id": "WebSocketResponse",\n                "type": "object",\n                "description": "WebSocket response data.",\n                "hidden": true,\n                "properties": [\n                    { "name": "status", "type": "number", "description": "HTTP response status code." },\n                    { "name": "statusText", "type": "string", "description": "HTTP response status text." },\n                    { "name": "headers", "$ref": "Headers", "description": "HTTP response headers." }\n                ]\n            },\n            {\n                "id": "WebSocketFrame",\n                "type": "object",\n                "description": "WebSocket frame data.",\n                "hidden": true,\n                "properties": [\n                    { "name": "opcode", "type": "number", "description": "WebSocket frame opcode." },\n                    { "name": "mask", "type": "boolean", "description": "WebSocke frame mask." },\n                    { "name": "payloadData", "type": "string", "description": "WebSocke frame payload data." }\n                ]\n            },\n            {\n                "id": "CachedResource",\n                "type": "object",\n                "description": "Information about the cached resource.",\n                "properties": [\n                    { "name": "url", "type": "string", "description": "Resource URL. This is the url of the original network request." },\n                    { "name": "type", "$ref": "Page.ResourceType", "description": "Type of this resource." },\n                    { "name": "response", "$ref": "Response", "optional": true, "description": "Cached response data." },\n                    { "name": "bodySize", "type": "number", "description": "Cached response body size." }\n                ]\n            },\n            {\n                "id": "Initiator",\n                "type": "object",\n                "description": "Information about the request initiator.",\n                "properties": [\n                    { "name": "type", "type": "string", "enum": ["parser", "script", "other"], "description": "Type of this initiator." },\n                    { "name": "stackTrace", "$ref": "Console.StackTrace", "optional": true, "description": "Initiator JavaScript stack trace, set for Script only." },\n                    { "name": "url", "type": "string", "optional": true, "description": "Initiator URL, set for Parser type only." },\n                    { "name": "lineNumber", "type": "number", "optional": true, "description": "Initiator line number, set for Parser type only." }\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables network tracking, network events will now be delivered to the client."\n            },\n            {\n                "name": "disable",\n                "description": "Disables network tracking, prevents network events from being sent to the client."\n            },\n            {\n                "name": "setUserAgentOverride",\n                "description": "Allows overriding user agent with the given string.",\n                "parameters": [\n                    { "name": "userAgent", "type": "string", "description": "User agent to use." }\n                ]\n            },\n            {\n                "name": "setExtraHTTPHeaders",\n                "description": "Specifies whether to always send extra HTTP headers with the requests from this page.",\n                "parameters": [\n                    { "name": "headers", "$ref": "Headers", "description": "Map with extra HTTP headers." }\n                ]\n            },\n            {\n                "name": "getResponseBody",\n                "description": "Returns content served for the given request.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Identifier of the network request to get content for." }\n                ],\n                "returns": [\n                    { "name": "body", "type": "string", "description": "Response body." },\n                    { "name": "base64Encoded", "type": "boolean", "description": "True, if content was sent as base64." }\n                ]\n            },\n            {\n                "name": "replayXHR",\n                "description": "This method sends a new XMLHttpRequest which is identical to the original one. The following parameters should be identical: method, url, async, request body, extra headers, withCredentials attribute, user, password.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Identifier of XHR to replay." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "canClearBrowserCache",\n                "description": "Tells whether clearing browser cache is supported.",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "True if browser cache can be cleared." }\n                ]\n            },\n            {\n                "name": "clearBrowserCache",\n                "description": "Clears browser cache."\n            },\n            {\n                "name": "canClearBrowserCookies",\n                "description": "Tells whether clearing browser cookies is supported.",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "True if browser cookies can be cleared." }\n                ]\n            },\n            {\n                "name": "clearBrowserCookies",\n                "description": "Clears browser cookies."\n            },\n            {\n                "name": "setCacheDisabled",\n                "parameters": [\n                    { "name": "cacheDisabled", "type": "boolean", "description": "Cache disabled state." }\n                ],\n                "description": "Toggles ignoring cache for each request. If <code>true</code>, cache will not be used."\n            }\n        ],\n        "events": [\n            {\n                "name": "requestWillBeSent",\n                "description": "Fired when page is about to send HTTP request.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "frameId", "$ref": "FrameId", "description": "Frame identifier.", "hidden": true },\n                    { "name": "loaderId", "$ref": "LoaderId", "description": "Loader identifier." },\n                    { "name": "documentURL", "type": "string", "description": "URL of the document this request is loaded for." },\n                    { "name": "request", "$ref": "Request", "description": "Request data." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "initiator", "$ref": "Initiator", "description": "Request initiator." },\n                    { "name": "redirectResponse", "optional": true, "$ref": "Response", "description": "Redirect response data." }\n                ]\n            },\n            {\n                "name": "requestServedFromCache",\n                "description": "Fired if request ended up loading from cache.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." }\n                ]\n            },\n            {\n                "name": "responseReceived",\n                "description": "Fired when HTTP response is available.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "frameId", "$ref": "FrameId", "description": "Frame identifier.", "hidden": true },\n                    { "name": "loaderId", "$ref": "LoaderId", "description": "Loader identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "type", "$ref": "Page.ResourceType", "description": "Resource type." },\n                    { "name": "response", "$ref": "Response", "description": "Response data." }\n                ]\n            },\n            {\n                "name": "dataReceived",\n                "description": "Fired when data chunk was received over the network.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "dataLength", "type": "integer", "description": "Data chunk length." },\n                    { "name": "encodedDataLength", "type": "integer", "description": "Actual bytes received (might be less than dataLength for compressed encodings)." }\n                ]\n            },\n            {\n                "name": "loadingFinished",\n                "description": "Fired when HTTP request has finished loading.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." }\n                ]\n            },\n            {\n                "name": "loadingFailed",\n                "description": "Fired when HTTP request has failed to load.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "errorText", "type": "string", "description": "User friendly error message." },\n                    { "name": "canceled", "type": "boolean", "optional": true, "description": "True if loading was canceled." }\n                ]\n            },\n            {\n                "name": "requestServedFromMemoryCache",\n                "description": "Fired when HTTP request has been served from memory cache.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "frameId", "$ref": "FrameId", "description": "Frame identifier.", "hidden": true },\n                    { "name": "loaderId", "$ref": "LoaderId", "description": "Loader identifier." },\n                    { "name": "documentURL", "type": "string", "description": "URL of the document this request is loaded for." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "initiator", "$ref": "Initiator", "description": "Request initiator." },\n                    { "name": "resource", "$ref": "CachedResource", "description": "Cached resource data." }\n                ]\n            },\n            {\n                "name": "webSocketWillSendHandshakeRequest",\n                "description": "Fired when WebSocket is about to initiate handshake.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "request", "$ref": "WebSocketRequest", "description": "WebSocket request data." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "webSocketHandshakeResponseReceived",\n                "description": "Fired when WebSocket handshake response becomes available.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "response", "$ref": "WebSocketResponse", "description": "WebSocket response data." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "webSocketCreated",\n                "description": "Fired upon WebSocket creation.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "url", "type": "string", "description": "WebSocket request URL." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "webSocketClosed",\n                "description": "Fired when WebSocket is closed.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "webSocketFrameReceived",\n                "description": "Fired when WebSocket frame is received.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "response", "$ref": "WebSocketFrame", "description": "WebSocket response data." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "webSocketFrameError",\n                "description": "Fired when WebSocket frame error occurs.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "errorMessage", "type": "string", "description": "WebSocket frame error message." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "webSocketFrameSent",\n                "description": "Fired when WebSocket frame is sent.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "response", "$ref": "WebSocketFrame", "description": "WebSocket response data." }\n                ],\n                "hidden": true\n            }\n        ]\n    },\n    {\n        "domain": "Database",\n        "hidden": true,\n        "types": [\n            {\n                "id": "DatabaseId",\n                "type": "string",\n                "description": "Unique identifier of Database object.",\n                "hidden": true\n            },\n            {\n                "id": "Database",\n                "type": "object",\n                "description": "Database object.",\n                "hidden": true,\n                "properties": [\n                    { "name": "id", "$ref": "DatabaseId", "description": "Database ID." },\n                    { "name": "domain", "type": "string", "description": "Database domain." },\n                    { "name": "name", "type": "string", "description": "Database name." },\n                    { "name": "version", "type": "string", "description": "Database version." }\n                ]\n            },\n            {\n                "id": "Error",\n                "type": "object",\n                "description": "Database error.",\n                "properties": [\n                    { "name": "message", "type": "string", "description": "Error message." },\n                    { "name": "code", "type": "integer", "description": "Error code." }\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables database tracking, database events will now be delivered to the client."\n            },\n            {\n                "name": "disable",\n                "description": "Disables database tracking, prevents database events from being sent to the client."\n            },\n            {\n                "name": "getDatabaseTableNames",\n                "parameters": [\n                    { "name": "databaseId", "$ref": "DatabaseId" }\n                ],\n                "returns": [\n                    { "name": "tableNames", "type": "array", "items": { "type": "string" } }\n                ]\n            },\n            {\n                "name": "executeSQL",\n                "async": true,\n                "parameters": [\n                    { "name": "databaseId", "$ref": "DatabaseId" },\n                    { "name": "query", "type": "string" }\n                ],\n                "returns": [\n                    { "name": "columnNames", "type": "array", "optional": true, "items": { "type": "string" } },\n                    { "name": "values", "type": "array", "optional": true, "items": { "type": "any" }},\n                    { "name": "sqlError", "$ref": "Error", "optional": true }\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "addDatabase",\n                "parameters": [\n                    { "name": "database", "$ref": "Database" }\n                ]\n            }\n        ]\n    },\n    {\n        "domain": "IndexedDB",\n        "hidden": true,\n        "types": [\n            {\n                "id": "SecurityOriginWithDatabaseNames",\n                "type": "object",\n                "description": "Security origin with database names.",\n                "properties": [\n                    { "name": "securityOrigin", "type": "string", "description": "Security origin." },\n                    { "name": "databaseNames", "type": "array", "items": { "type": "string" }, "description": "Database names for this origin." }\n                ]\n            },\n            {\n                "id": "DatabaseWithObjectStores",\n                "type": "object",\n                "description": "Database with an array of object stores.",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Database name." },\n                    { "name": "version", "type": "string", "description": "Deprecated string database version." },\n                    { "name": "intVersion", "type": "integer", "description": "Integer database version." },\n                    { "name": "objectStores", "type": "array", "items": { "$ref": "ObjectStore" }, "description": "Object stores in this database." }\n                ]\n            },\n            {\n                "id": "ObjectStore",\n                "type": "object",\n                "description": "Object store.",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Object store name." },\n                    { "name": "keyPath", "$ref": "KeyPath", "description": "Object store key path." },\n                    { "name": "autoIncrement", "type": "boolean", "description": "If true, object store has auto increment flag set." },\n                    { "name": "indexes", "type": "array", "items": { "$ref": "ObjectStoreIndex" }, "description": "Indexes in this object store." }\n                ]\n            },\n            {\n                "id": "ObjectStoreIndex",\n                "type": "object",\n                "description": "Object store index.",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Index name." },\n                    { "name": "keyPath", "$ref": "KeyPath", "description": "Index key path." },\n                    { "name": "unique", "type": "boolean", "description": "If true, index is unique." },\n                    { "name": "multiEntry", "type": "boolean", "description": "If true, index allows multiple entries for a key." }\n                ]\n            },\n            {\n                "id": "Key",\n                "type": "object",\n                "description": "Key.",\n                "properties": [\n                    { "name": "type", "type": "string", "enum": ["number", "string", "date", "array"], "description": "Key type." },\n                    { "name": "number", "type": "number", "optional": true, "description": "Number value." },\n                    { "name": "string", "type": "string", "optional": true, "description": "String value." },\n                    { "name": "date", "type": "number", "optional": true, "description": "Date value." },\n                    { "name": "array", "type": "array", "optional": true, "items": { "$ref": "Key" }, "description": "Array value." }\n                ]\n            },\n            {\n                "id": "KeyRange",\n                "type": "object",\n                "description": "Key range.",\n                "properties": [\n                    { "name": "lower", "$ref": "Key", "optional": true, "description": "Lower bound." },\n                    { "name": "upper", "$ref": "Key", "optional": true, "description": "Upper bound." },\n                    { "name": "lowerOpen", "type": "boolean", "description": "If true lower bound is open." },\n                    { "name": "upperOpen", "type": "boolean", "description": "If true upper bound is open." }\n                ]\n            },\n            {\n                "id": "DataEntry",\n                "type": "object",\n                "description": "Data entry.",\n                "properties": [\n                    { "name": "key", "$ref": "Runtime.RemoteObject", "description": "Key." },\n                    { "name": "primaryKey", "$ref": "Runtime.RemoteObject", "description": "Primary key." },\n                    { "name": "value", "$ref": "Runtime.RemoteObject", "description": "Value." }\n                ]\n            },\n            {\n                "id": "KeyPath",\n                "type": "object",\n                "description": "Key path.",\n                "properties": [\n                    { "name": "type", "type": "string", "enum": ["null", "string", "array"], "description": "Key path type." },\n                    { "name": "string", "type": "string", "optional": true, "description": "String value." },\n                    { "name": "array", "type": "array", "optional": true, "items": { "type": "string" }, "description": "Array value." }\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables events from backend."\n            },\n            {\n                "name": "disable",\n                "description": "Disables events from backend."\n            },\n            {\n                "name": "requestDatabaseNamesForFrame",\n                "async": true,\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Frame id." }\n                ],\n                "returns": [\n                    { "name": "securityOriginWithDatabaseNames", "$ref": "SecurityOriginWithDatabaseNames", "description": "Frame with database names." }\n                ],\n                "description": "Requests database names for given frame\'s security origin."\n            },\n            {\n                "name": "requestDatabase",\n                "async": true,\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Frame id." },\n                    { "name": "databaseName", "type": "string", "description": "Database name." }\n                ],\n                "returns": [\n                    { "name": "databaseWithObjectStores", "$ref": "DatabaseWithObjectStores", "description": "Database with an array of object stores." }\n                ],\n                "description": "Requests database with given name in given frame."\n            },\n            {\n                "name": "requestData",\n                "async": true,\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Frame id." },\n                    { "name": "databaseName", "type": "string", "description": "Database name." },\n                    { "name": "objectStoreName", "type": "string", "description": "Object store name." },\n                    { "name": "indexName", "type": "string", "description": "Index name, empty string for object store data requests." },\n                    { "name": "skipCount", "type": "integer", "description": "Number of records to skip." },\n                    { "name": "pageSize", "type": "integer", "description": "Number of records to fetch." },\n                    { "name": "keyRange", "$ref": "KeyRange", "optional": true, "description": "Key range." }\n                ],\n                "returns": [\n                    { "name": "objectStoreDataEntries", "type": "array", "items": { "$ref": "DataEntry" }, "description": "Array of object store data entries." },\n                    { "name": "hasMore", "type": "boolean", "description": "If true, there are more entries to fetch in the given range." }\n                ],\n                "description": "Requests data from object store or index."\n            }\n        ]\n    },\n    {\n        "domain": "DOMStorage",\n        "hidden": true,\n        "types": [\n            {\n                "id": "StorageId",\n                "type": "string",\n                "description": "Unique identifier of DOM storage entry.",\n                "hidden": true\n            },\n            {\n                "id": "Entry",\n                "type": "object",\n                "description": "DOM Storage entry.",\n                "hidden": true,\n                "properties": [\n                    { "name": "origin", "type": "string", "description": "Document origin." },\n                    { "name": "isLocalStorage", "type": "boolean", "description": "True for local storage." },\n                    { "name": "id", "$ref": "StorageId", "description": "Entry id for further reference." }\n                ]\n            },\n            {\n                "id": "Item",\n                "type": "array",\n                "description": "DOM Storage item.",\n                "hidden": true,\n                "items": { "type": "string" }\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables storage tracking, storage events will now be delivered to the client."\n            },\n            {\n                "name": "disable",\n                "description": "Disables storage tracking, prevents storage events from being sent to the client."\n            },\n            {\n                "name": "getDOMStorageEntries",\n                "parameters": [\n                    { "name": "storageId", "$ref": "StorageId" }\n                ],\n                "returns": [\n                    { "name": "entries", "type": "array", "items": { "$ref": "Item" } }\n                ]\n            },\n            {\n                "name": "setDOMStorageItem",\n                "parameters": [\n                    { "name": "storageId", "$ref": "StorageId" },\n                    { "name": "key", "type": "string" },\n                    { "name": "value", "type": "string" }\n                ],\n                "returns": [\n                    { "name": "success", "type": "boolean" }\n                ]\n            },\n            {\n                "name": "removeDOMStorageItem",\n                "parameters": [\n                    { "name": "storageId", "$ref": "StorageId" },\n                    { "name": "key", "type": "string" }\n                ],\n                "returns": [\n                    { "name": "success", "type": "boolean" }\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "addDOMStorage",\n                "parameters": [\n                    { "name": "storage", "$ref": "Entry" }\n                ]\n            },\n            {\n                "name": "domStorageItemsCleared",\n                "parameters": [\n                    { "name": "storageId",  "$ref": "StorageId" }\n                ]\n            },\n            {\n                "name": "domStorageItemRemoved",\n                "parameters": [\n                    { "name": "storageId",  "$ref": "StorageId" },\n                    { "name": "key", "type": "string" }\n                ]\n            },\n            {\n                "name": "domStorageItemAdded",\n                "parameters": [\n                    { "name": "storageId",  "$ref": "StorageId" },\n                    { "name": "key", "type": "string" },\n                    { "name": "newValue", "type": "string" }\n                ]\n            },\n            {\n                "name": "domStorageItemUpdated",\n                "parameters": [\n                    { "name": "storageId",  "$ref": "StorageId" },\n                    { "name": "key", "type": "string" },\n                    { "name": "oldValue", "type": "string" },\n                    { "name": "newValue", "type": "string" }\n                ]\n            }\n        ]\n    },\n    {\n        "domain": "ApplicationCache",\n        "hidden": true,\n        "types": [\n            {\n                "id": "ApplicationCacheResource",\n                "type": "object",\n                "description": "Detailed application cache resource information.",\n                "properties": [\n                    { "name": "url", "type": "string", "description": "Resource url." },\n                    { "name": "size", "type": "integer", "description": "Resource size." },\n                    { "name": "type", "type": "string", "description": "Resource type." }\n                ]\n            },\n            {\n                "id": "ApplicationCache",\n                "type": "object",\n                "description": "Detailed application cache information.",\n                "properties": [\n                    { "name": "manifestURL", "type": "string", "description": "Manifest URL." },\n                    { "name": "size", "type": "number", "description": "Application cache size." },\n                    { "name": "creationTime", "type": "number", "description": "Application cache creation time." },\n                    { "name": "updateTime", "type": "number", "description": "Application cache update time." },\n                    { "name": "resources", "type": "array", "items": { "$ref": "ApplicationCacheResource" }, "description": "Application cache resources." }\n                ]\n            },\n            {\n                "id": "FrameWithManifest",\n                "type": "object",\n                "description": "Frame identifier - manifest URL pair.",\n                "properties": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Frame identifier." },\n                    { "name": "manifestURL", "type": "string", "description": "Manifest URL." },\n                    { "name": "status", "type": "integer", "description": "Application cache status." }\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "getFramesWithManifests",\n                "returns": [\n                    { "name": "frameIds", "type": "array", "items": { "$ref": "FrameWithManifest" }, "description": "Array of frame identifiers with manifest urls for each frame containing a document associated with some application cache." }\n                ],\n                "description": "Returns array of frame identifiers with manifest urls for each frame containing a document associated with some application cache."\n            },\n            {\n                "name": "enable",\n                "description": "Enables application cache domain notifications."\n            },\n            {\n                "name": "getManifestForFrame",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Identifier of the frame containing document whose manifest is retrieved." }\n                ],\n                "returns": [\n                    { "name": "manifestURL", "type": "string", "description": "Manifest URL for document in the given frame." }\n                ],\n                "description": "Returns manifest URL for document in the given frame."\n            },\n            {\n                "name": "getApplicationCacheForFrame",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Identifier of the frame containing document whose application cache is retrieved." }\n                ],\n                "returns": [\n                    { "name": "applicationCache", "$ref": "ApplicationCache", "description": "Relevant application cache data for the document in given frame." }\n                ],\n                "description": "Returns relevant application cache data for the document in given frame."\n            }\n        ],\n        "events": [\n            {\n                "name": "applicationCacheStatusUpdated",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Identifier of the frame containing document whose application cache updated status." },\n                    { "name": "manifestURL", "type": "string", "description": "Manifest URL." },\n                    { "name": "status", "type": "integer", "description": "Updated application cache status." }\n                ]\n            },\n            {\n                "name": "networkStateUpdated",\n                "parameters": [\n                    { "name": "isNowOnline", "type": "boolean" }\n                ]\n            }\n        ]\n    },\n    {\n        "domain": "FileSystem",\n        "hidden": true,\n        "types": [\n            {\n                "id": "Entry",\n                "type": "object",\n                "properties": [\n                    { "name": "url", "type": "string", "description": "filesystem: URL for the entry." },\n                    { "name": "name", "type": "string", "description": "The name of the file or directory." },\n                    { "name": "isDirectory", "type": "boolean", "description": "True if the entry is a directory." },\n                    { "name": "mimeType", "type": "string", "optional": true, "description": "MIME type of the entry, available for a file only." },\n                    { "name": "resourceType", "$ref": "Page.ResourceType", "optional": true, "description": "ResourceType of the entry, available for a file only." },\n                    { "name": "isTextFile", "type": "boolean", "optional": true, "description": "True if the entry is a text file." }\n                ],\n                "description": "Represents a browser side file or directory."\n            },\n            {\n                "id": "Metadata",\n                "type": "object",\n                "properties": [\n                    { "name": "modificationTime", "type": "number", "description": "Modification time." },\n                    { "name": "size", "type": "number", "description": "File size. This field is always zero for directories." }\n                ],\n                "description": "Represents metadata of a file or entry."\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables events from backend."\n            },\n            {\n                "name": "disable",\n                "description": "Disables events from backend."\n            },\n            {\n                "name": "requestFileSystemRoot",\n                "async": true,\n                "parameters": [\n                    { "name": "origin", "type": "string", "description": "Security origin of requesting FileSystem. One of frames in current page needs to have this security origin." },\n                    { "name": "type", "type": "string", "enum": ["temporary", "persistent"], "description": "FileSystem type of requesting FileSystem." }\n                ],\n                "returns": [\n                    { "name": "errorCode", "type": "integer", "description": "0, if no error. Otherwise, errorCode is set to FileError::ErrorCode value." },\n                    { "name": "root", "$ref": "Entry", "optional": true, "description": "Contains root of the requested FileSystem if the command completed successfully." }\n                ],\n                "description": "Returns root directory of the FileSystem, if exists."\n            },\n            {\n                "name": "requestDirectoryContent",\n                "async": true,\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "URL of the directory that the frontend is requesting to read from." }\n                ],\n                "returns": [\n                    { "name": "errorCode", "type": "integer", "description": "0, if no error. Otherwise, errorCode is set to FileError::ErrorCode value." },\n                    { "name": "entries", "type": "array", "items": { "$ref": "Entry" }, "optional": true, "description": "Contains all entries on directory if the command completed successfully." }\n                ],\n                "description": "Returns content of the directory."\n            },\n            {\n                "name": "requestMetadata",\n                "async": true,\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "URL of the entry that the frontend is requesting to get metadata from." }\n                ],\n                "returns": [\n                    { "name": "errorCode", "type": "integer", "description": "0, if no error. Otherwise, errorCode is set to FileError::ErrorCode value." },\n                    { "name": "metadata", "$ref": "Metadata", "optional": true, "description": "Contains metadata of the entry if the command completed successfully." }\n                ],\n                "description": "Returns metadata of the entry."\n            },\n            {\n                "name": "requestFileContent",\n                "async": true,\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "URL of the file that the frontend is requesting to read from." },\n                    { "name": "readAsText", "type": "boolean", "description": "True if the content should be read as text, otherwise the result will be returned as base64 encoded text." },\n                    { "name": "start", "type": "integer", "optional": true, "description": "Specifies the start of range to read." },\n                    { "name": "end", "type": "integer", "optional": true, "description": "Specifies the end of range to read exclusively." },\n                    { "name": "charset", "type": "string", "optional": true, "description": "Overrides charset of the content when content is served as text." }\n                ],\n                "returns": [\n                    { "name": "errorCode", "type": "integer", "description": "0, if no error. Otherwise, errorCode is set to FileError::ErrorCode value." },\n                    { "name": "content", "type": "string", "optional": true, "description": "Content of the file." },\n                    { "name": "charset", "type": "string", "optional": true, "description": "Charset of the content if it is served as text." }\n                ],\n                "description": "Returns content of the file. Result should be sliced into [start, end)."\n            },\n            {\n                "name": "deleteEntry",\n                "async": true,\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "URL of the entry to delete." }\n                ],\n                "returns": [\n                    { "name": "errorCode", "type": "integer", "description": "0, if no error. Otherwise errorCode is set to FileError::ErrorCode value." }\n                ],\n                "description": "Deletes specified entry. If the entry is a directory, the agent deletes children recursively."\n            }\n        ]\n    },\n    {\n        "domain": "DOM",\n        "description": "This domain exposes DOM read/write operations. Each DOM Node is represented with its mirror object that has an <code>id</code>. This <code>id</code> can be used to get additional information on the Node, resolve it into the JavaScript object wrapper, etc. It is important that client receives DOM events only for the nodes that are known to the client. Backend keeps track of the nodes that were sent to the client and never sends the same node twice. It is client\'s responsibility to collect information about the nodes that were sent to the client.<p>Note that <code>iframe</code> owner elements will return corresponding document elements as their child nodes.</p>",\n        "types": [\n            {\n                "id": "NodeId",\n                "type": "integer",\n                "description": "Unique DOM node identifier."\n            },\n            {\n                "id": "Node",\n                "type": "object",\n                "properties": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Node identifier that is passed into the rest of the DOM messages as the <code>nodeId</code>. Backend will only push node with given <code>id</code> once. It is aware of all requested nodes and will only fire DOM events for nodes known to the client." },\n                    { "name": "nodeType", "type": "integer", "description": "<code>Node</code>\'s nodeType." },\n                    { "name": "nodeName", "type": "string", "description": "<code>Node</code>\'s nodeName." },\n                    { "name": "localName", "type": "string", "description": "<code>Node</code>\'s localName." },\n                    { "name": "nodeValue", "type": "string", "description": "<code>Node</code>\'s nodeValue." },\n                    { "name": "childNodeCount", "type": "integer", "optional": true, "description": "Child count for <code>Container</code> nodes." },\n                    { "name": "children", "type": "array", "optional": true, "items": { "$ref": "Node" }, "description": "Child nodes of this node when requested with children." },\n                    { "name": "attributes", "type": "array", "optional": true, "items": { "type": "string" }, "description": "Attributes of the <code>Element</code> node in the form of flat array <code>[name1, value1, name2, value2]</code>." },\n                    { "name": "documentURL", "type": "string", "optional": true, "description": "Document URL that <code>Document</code> or <code>FrameOwner</code> node points to." },\n                    { "name": "baseURL", "type": "string", "optional": true, "description": "Base URL that <code>Document</code> or <code>FrameOwner</code> node uses for URL completion." },\n                    { "name": "publicId", "type": "string", "optional": true, "description": "<code>DocumentType</code>\'s publicId." },\n                    { "name": "systemId", "type": "string", "optional": true, "description": "<code>DocumentType</code>\'s systemId." },\n                    { "name": "internalSubset", "type": "string", "optional": true, "description": "<code>DocumentType</code>\'s internalSubset." },\n                    { "name": "xmlVersion", "type": "string", "optional": true, "description": "<code>Document</code>\'s XML version in case of XML documents." },\n                    { "name": "name", "type": "string", "optional": true, "description": "<code>Attr</code>\'s name." },\n                    { "name": "value", "type": "string", "optional": true, "description": "<code>Attr</code>\'s value." },\n                    { "name": "frameId", "$ref": "Network.FrameId", "optional": true, "description": "Frame ID for frame owner elements." },\n                    { "name": "contentDocument", "$ref": "Node", "optional": true, "description": "Content document for frame owner elements." },\n                    { "name": "shadowRoots", "type": "array", "optional": true, "items": { "$ref": "Node" }, "description": "Shadow root list for given element host." },\n                    { "name": "templateContent", "$ref": "Node", "optional": true, "description": "Content document fragment for template elements" }\n                ],\n                "description": "DOM interaction is implemented in terms of mirror objects that represent the actual DOM nodes. DOMNode is a base node mirror type."\n            },\n            {\n                "id": "EventListener",\n                "type": "object",\n                "hidden": true,\n                "properties": [\n                    { "name": "type", "type": "string", "description": "<code>EventListener</code>\'s type." },\n                    { "name": "useCapture", "type": "boolean", "description": "<code>EventListener</code>\'s useCapture." },\n                    { "name": "isAttribute", "type": "boolean", "description": "<code>EventListener</code>\'s isAttribute." },\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Target <code>DOMNode</code> id." },\n                    { "name": "handlerBody", "type": "string", "description": "Event handler function body." },\n                    { "name": "location", "$ref": "Debugger.Location", "optional": true, "description": "Handler code location." },\n                    { "name": "sourceName", "type": "string", "optional": true, "description": "Source script URL." }\n                ],\n                "description": "DOM interaction is implemented in terms of mirror objects that represent the actual DOM nodes. DOMNode is a base node mirror type."\n            },\n            {\n                "id": "RGBA",\n                "type": "object",\n                "properties": [\n                    { "name": "r", "type": "integer", "description": "The red component, in the [0-255] range." },\n                    { "name": "g", "type": "integer", "description": "The green component, in the [0-255] range." },\n                    { "name": "b", "type": "integer", "description": "The blue component, in the [0-255] range." },\n                    { "name": "a", "type": "number", "optional": true, "description": "The alpha component, in the [0-1] range (default: 1)." }\n                ],\n                "description": "A structure holding an RGBA color."\n            },\n            {\n                "id": "HighlightConfig",\n                "type": "object",\n                "properties": [\n                    { "name": "showInfo", "type": "boolean", "optional": true, "description": "Whether the node info tooltip should be shown (default: false)." },\n                    { "name": "contentColor", "$ref": "RGBA", "optional": true, "description": "The content box highlight fill color (default: transparent)." },\n                    { "name": "paddingColor", "$ref": "RGBA", "optional": true, "description": "The padding highlight fill color (default: transparent)." },\n                    { "name": "borderColor", "$ref": "RGBA", "optional": true, "description": "The border highlight fill color (default: transparent)." },\n                    { "name": "marginColor", "$ref": "RGBA", "optional": true, "description": "The margin highlight fill color (default: transparent)." }\n                ],\n                "description": "Configuration data for the highlighting of page elements."\n            }\n        ],\n        "commands": [\n            {\n                "name": "getDocument",\n                "returns": [\n                    { "name": "root", "$ref": "Node", "description": "Resulting node." }\n                ],\n                "description": "Returns the root DOM node to the caller."\n            },\n            {\n                "name": "requestChildNodes",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to get children for." },\n                    { "name": "depth", "type": "integer", "optional": true, "description": "The maximum depth at which children should be retrieved, defaults to 1. Use -1 for the entire subtree or provide an integer larger than 0." }\n                ],\n                "description": "Requests that children of the node with given id are returned to the caller in form of <code>setChildNodes</code> events where not only immediate children are retrieved, but all children down to the specified depth."\n            },\n            {\n                "name": "querySelector",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to query upon." },\n                    { "name": "selector", "type": "string", "description": "Selector string." }\n                ],\n                "returns": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Query selector result." }\n                ],\n                "description": "Executes <code>querySelector</code> on a given node."\n            },\n            {\n                "name": "querySelectorAll",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to query upon." },\n                    { "name": "selector", "type": "string", "description": "Selector string." }\n                ],\n                "returns": [\n                    { "name": "nodeIds", "type": "array", "items": { "$ref": "NodeId" }, "description": "Query selector result." }\n                ],\n                "description": "Executes <code>querySelectorAll</code> on a given node."\n            },\n            {\n                "name": "setNodeName",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to set name for." },\n                    { "name": "name", "type": "string", "description": "New node\'s name." }\n                ],\n                "returns": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "New node\'s id." }\n                ],\n                "description": "Sets node name for a node with given id."\n            },\n            {\n                "name": "setNodeValue",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to set value for." },\n                    { "name": "value", "type": "string", "description": "New node\'s value." }\n                ],\n                "description": "Sets node value for a node with given id."\n            },\n            {\n                "name": "removeNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to remove." }\n                ],\n                "description": "Removes node with given id."\n            },\n            {\n                "name": "setAttributeValue",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the element to set attribute for." },\n                    { "name": "name", "type": "string", "description": "Attribute name." },\n                    { "name": "value", "type": "string", "description": "Attribute value." }\n                ],\n                "description": "Sets attribute for an element with given id."\n            },\n            {\n                "name": "setAttributesAsText",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the element to set attributes for." },\n                    { "name": "text", "type": "string", "description": "Text with a number of attributes. Will parse this text using HTML parser." },\n                    { "name": "name", "type": "string", "optional": true, "description": "Attribute name to replace with new attributes derived from text in case text parsed successfully." }\n                ],\n                "description": "Sets attributes on element with given id. This method is useful when user edits some existing attribute value and types in several attribute name/value pairs."\n            },\n            {\n                "name": "removeAttribute",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the element to remove attribute from." },\n                    { "name": "name", "type": "string", "description": "Name of the attribute to remove." }\n                ],\n                "description": "Removes attribute with given name from an element with given id."\n            },\n            {\n                "name": "getEventListenersForNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to get listeners for." }\n                ],\n                "returns": [\n                    { "name": "listeners", "type": "array", "items": { "$ref": "EventListener"}, "description": "Array of relevant listeners." }\n                ],\n                "description": "Returns event listeners relevant to the node.",\n                "hidden": true\n            },\n            {\n                "name": "getOuterHTML",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to get markup for." }\n                ],\n                "returns": [\n                    { "name": "outerHTML", "type": "string", "description": "Outer HTML markup." }\n                ],\n                "description": "Returns node\'s HTML markup."\n            },\n            {\n                "name": "setOuterHTML",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to set markup for." },\n                    { "name": "outerHTML", "type": "string", "description": "Outer HTML markup to set." }\n                ],\n                "description": "Sets node HTML markup, returns new node id."\n            },\n            {\n                "name": "performSearch",\n                "parameters": [\n                    { "name": "query", "type": "string", "description": "Plain text or query selector or XPath search query." }\n                ],\n                "returns": [\n                    { "name": "searchId", "type": "string", "description": "Unique search session identifier." },\n                    { "name": "resultCount", "type": "integer", "description": "Number of search results." }\n                ],\n                "description": "Searches for a given string in the DOM tree. Use <code>getSearchResults</code> to access search results or <code>cancelSearch</code> to end this search session.",\n                "hidden": true\n            },\n            {\n                "name": "getSearchResults",\n                "parameters": [\n                    { "name": "searchId", "type": "string", "description": "Unique search session identifier." },\n                    { "name": "fromIndex", "type": "integer", "description": "Start index of the search result to be returned." },\n                    { "name": "toIndex", "type": "integer", "description": "End index of the search result to be returned." }\n                ],\n                "returns": [\n                    { "name": "nodeIds", "type": "array", "items": { "$ref": "NodeId" }, "description": "Ids of the search result nodes." }\n                ],\n                "description": "Returns search results from given <code>fromIndex</code> to given <code>toIndex</code> from the sarch with the given identifier.",\n                "hidden": true\n            },\n            {\n                "name": "discardSearchResults",\n                "parameters": [\n                    { "name": "searchId", "type": "string", "description": "Unique search session identifier." }\n                ],\n                "description": "Discards search results from the session with the given id. <code>getSearchResults</code> should no longer be called for that search.",\n                "hidden": true\n            },\n            {\n                "name": "requestNode",\n                "parameters": [\n                    { "name": "objectId", "$ref": "Runtime.RemoteObjectId", "description": "JavaScript object id to convert into node." }\n                ],\n                "returns": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Node id for given object." }\n                ],\n                "description": "Requests that the node is sent to the caller given the JavaScript node object reference. All nodes that form the path from the node to the root are also sent to the client as a series of <code>setChildNodes</code> notifications."\n            },\n            {\n                "name": "setInspectModeEnabled",\n                "hidden": true,\n                "parameters": [\n                    { "name": "enabled", "type": "boolean", "description": "True to enable inspection mode, false to disable it." },\n                    { "name": "highlightConfig", "$ref": "HighlightConfig", "optional": true, "description": "A descriptor for the highlight appearance of hovered-over nodes. May be omitted if <code>enabled == false</code>." }\n                ],\n                "description": "Enters the \'inspect\' mode. In this mode, elements that user is hovering over are highlighted. Backend then generates \'inspect\' command upon element selection."\n            },\n            {\n                "name": "highlightRect",\n                "parameters": [\n                    { "name": "x", "type": "integer", "description": "X coordinate" },\n                    { "name": "y", "type": "integer", "description": "Y coordinate" },\n                    { "name": "width", "type": "integer", "description": "Rectangle width" },\n                    { "name": "height", "type": "integer", "description": "Rectangle height" },\n                    { "name": "color", "$ref": "RGBA", "optional": true, "description": "The highlight fill color (default: transparent)." },\n                    { "name": "outlineColor", "$ref": "RGBA", "optional": true, "description": "The highlight outline color (default: transparent)." }\n                ],\n                "description": "Highlights given rectangle. Coordinates are absolute with respect to the main frame viewport."\n            },\n            {\n                "name": "highlightNode",\n                "parameters": [\n                    { "name": "highlightConfig", "$ref": "HighlightConfig",  "description": "A descriptor for the highlight appearance." },\n                    { "name": "nodeId", "$ref": "NodeId", "optional": true, "description": "Identifier of the node to highlight." },\n                    { "name": "objectId", "$ref": "Runtime.RemoteObjectId", "optional": true, "description": "JavaScript object id of the node to be highlighted." }\n                ],\n                "description": "Highlights DOM node with given id or with the given JavaScript object wrapper. Either nodeId or objectId must be specified."\n            },\n            {\n                "name": "hideHighlight",\n                "description": "Hides DOM node highlight."\n            },\n            {\n                "name": "highlightFrame",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Identifier of the frame to highlight." },\n                    { "name": "contentColor", "$ref": "RGBA", "optional": true, "description": "The content box highlight fill color (default: transparent)." },\n                    { "name": "contentOutlineColor", "$ref": "RGBA", "optional": true, "description": "The content box highlight outline color (default: transparent)." }\n                ],\n                "description": "Highlights owner element of the frame with given id.",\n                "hidden": true\n            },\n            {\n                "name": "pushNodeByPathToFrontend",\n                "parameters": [\n                    { "name": "path", "type": "string", "description": "Path to node in the proprietary format." }\n                ],\n                "returns": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node for given path." }\n                ],\n                "description": "Requests that the node is sent to the caller given its path. // FIXME, use XPath",\n                "hidden": true\n            },\n            {\n                "name": "resolveNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to resolve." },\n                    { "name": "objectGroup", "type": "string", "optional": true, "description": "Symbolic group name that can be used to release multiple objects." }\n                ],\n                "returns": [\n                    { "name": "object", "$ref": "Runtime.RemoteObject", "description": "JavaScript object wrapper for given node." }\n                ],\n                "description": "Resolves JavaScript node object for given node id."\n            },\n            {\n                "name": "getAttributes",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to retrieve attibutes for." }\n                ],\n                "returns": [\n                    { "name": "attributes", "type": "array", "items": { "type": "string" }, "description": "An interleaved array of node attribute names and values." }\n                ],\n                "description": "Returns attributes for the specified node."\n            },\n            {\n                "name": "moveTo",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to drop." },\n                    { "name": "targetNodeId", "$ref": "NodeId", "description": "Id of the element to drop into." },\n                    { "name": "insertBeforeNodeId", "$ref": "NodeId", "optional": true, "description": "Drop node before given one." }\n                ],\n                "returns": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "New id of the moved node." }\n                ],\n                "description": "Moves node into the new container, places it before the given anchor."\n            },\n            {\n                "name": "undo",\n                "description": "Undoes the last performed action.",\n                "hidden": true\n            },\n            {\n                "name": "redo",\n                "description": "Re-does the last undone action.",\n                "hidden": true\n            },\n            {\n                "name": "markUndoableState",\n                "description": "Marks last undoable state.",\n                "hidden": true\n            },\n            {\n                "name": "focus",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId", "description": "Id of the node to focus." }\n                ],\n                "description": "Focuses the given element.",\n                "hidden": true\n            }\n        ],\n        "events": [\n            {\n                "name": "documentUpdated",\n                "description": "Fired when <code>Document</code> has been totally updated. Node ids are no longer valid."\n            },\n            {\n                "name": "setChildNodes",\n                "parameters": [\n                    { "name": "parentId", "$ref": "NodeId", "description": "Parent node id to populate with children." },\n                    { "name": "nodes", "type": "array", "items": { "$ref": "Node"}, "description": "Child nodes array." }\n                ],\n                "description": "Fired when backend wants to provide client with the missing DOM structure. This happens upon most of the calls requesting node ids."\n            },\n            {\n                "name": "attributeModified",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node that has changed." },\n                    { "name": "name", "type": "string", "description": "Attribute name." },\n                    { "name": "value", "type": "string", "description": "Attribute value." }\n                ],\n                "description": "Fired when <code>Element</code>\'s attribute is modified."\n            },\n            {\n                "name": "attributeRemoved",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node that has changed." },\n                    { "name": "name", "type": "string", "description": "A ttribute name." }\n                ],\n                "description": "Fired when <code>Element</code>\'s attribute is removed."\n            },\n            {\n                "name": "inlineStyleInvalidated",\n                "parameters": [\n                    { "name": "nodeIds", "type": "array", "items": { "$ref": "NodeId" }, "description": "Ids of the nodes for which the inline styles have been invalidated." }\n                ],\n                "description": "Fired when <code>Element</code>\'s inline style is modified via a CSS property modification.",\n                "hidden": true\n            },\n            {\n                "name": "characterDataModified",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node that has changed." },\n                    { "name": "characterData", "type": "string", "description": "New text value." }\n                ],\n                "description": "Mirrors <code>DOMCharacterDataModified</code> event."\n            },\n            {\n                "name": "childNodeCountUpdated",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node that has changed." },\n                    { "name": "childNodeCount", "type": "integer", "description": "New node count." }\n                ],\n                "description": "Fired when <code>Container</code>\'s child node count has changed."\n            },\n            {\n                "name": "childNodeInserted",\n                "parameters": [\n                    { "name": "parentNodeId", "$ref": "NodeId", "description": "Id of the node that has changed." },\n                    { "name": "previousNodeId", "$ref": "NodeId", "description": "If of the previous siblint." },\n                    { "name": "node", "$ref": "Node", "description": "Inserted node data." }\n                ],\n                "description": "Mirrors <code>DOMNodeInserted</code> event."\n            },\n            {\n                "name": "childNodeRemoved",\n                "parameters": [\n                    { "name": "parentNodeId", "$ref": "NodeId", "description": "Parent id." },\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node that has been removed." }\n                ],\n                "description": "Mirrors <code>DOMNodeRemoved</code> event."\n            },\n            {\n                "name": "shadowRootPushed",\n                "parameters": [\n                    { "name": "hostId", "$ref": "NodeId", "description": "Host element id." },\n                    { "name": "root", "$ref": "Node", "description": "Shadow root." }\n                ],\n                "description": "Called when shadow root is pushed into the element.",\n                "hidden": true\n            },\n            {\n                "name": "shadowRootPopped",\n                "parameters": [\n                    { "name": "hostId", "$ref": "NodeId", "description": "Host element id." },\n                    { "name": "rootId", "$ref": "NodeId", "description": "Shadow root id." }\n                ],\n                "description": "Called when shadow root is popped from the element.",\n                "hidden": true\n            }\n        ]\n    },\n    {\n        "domain": "CSS",\n        "hidden": true,\n        "description": "This domain exposes CSS read/write operations. All CSS objects, like stylesheets, rules, and styles, have an associated <code>id</code> used in subsequent operations on the related object. Each object type has a specific <code>id</code> structure, and those are not interchangeable between objects of different kinds. CSS objects can be loaded using the <code>get*ForNode()</code> calls (which accept a DOM node id). Alternatively, a client can discover all the existing stylesheets with the <code>getAllStyleSheets()</code> method and subsequently load the required stylesheet contents using the <code>getStyleSheet[Text]()</code> methods.",\n        "types": [\n            {\n                "id": "StyleSheetId",\n                "type": "string"\n            },\n            {\n                "id": "CSSStyleId",\n                "type": "object",\n                "properties": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId", "description": "Enclosing stylesheet identifier." },\n                    { "name": "ordinal", "type": "integer", "description": "The style ordinal within the stylesheet." }\n                ],\n                "description": "This object identifies a CSS style in a unique way."\n            },\n            {\n                "id": "StyleSheetOrigin",\n                "type": "string",\n                "enum": ["user", "user-agent", "inspector", "regular"],\n                "description": "Stylesheet type: \\"user\\" for user stylesheets, \\"user-agent\\" for user-agent stylesheets, \\"inspector\\" for stylesheets created by the inspector (i.e. those holding the \\"via inspector\\" rules), \\"regular\\" for regular stylesheets."\n            },\n            {\n                "id": "CSSRuleId",\n                "type": "object",\n                "properties": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId", "description": "Enclosing stylesheet identifier." },\n                    { "name": "ordinal", "type": "integer", "description": "The rule ordinal within the stylesheet." }\n                ],\n                "description": "This object identifies a CSS rule in a unique way."\n            },\n            {\n                "id": "PseudoIdMatches",\n                "type": "object",\n                "properties": [\n                    { "name": "pseudoId", "type": "integer", "description": "Pseudo style identifier (see <code>enum PseudoId</code> in <code>RenderStyleConstants.h</code>)."},\n                    { "name": "matches", "type": "array", "items": { "$ref": "RuleMatch" }, "description": "Matches of CSS rules applicable to the pseudo style."}\n                ],\n                "description": "CSS rule collection for a single pseudo style."\n            },\n            {\n                "id": "InheritedStyleEntry",\n                "type": "object",\n                "properties": [\n                    { "name": "inlineStyle", "$ref": "CSSStyle", "optional": true, "description": "The ancestor node\'s inline style, if any, in the style inheritance chain." },\n                    { "name": "matchedCSSRules", "type": "array", "items": { "$ref": "RuleMatch" }, "description": "Matches of CSS rules matching the ancestor node in the style inheritance chain." }\n                ],\n                "description": "CSS rule collection for a single pseudo style."\n            },\n            {\n                "id": "RuleMatch",\n                "type": "object",\n                "properties": [\n                    { "name": "rule", "$ref": "CSSRule", "description": "CSS rule in the match." },\n                    { "name": "matchingSelectors", "type": "array", "items": { "type": "integer" }, "description": "Matching selector indices in the rule\'s selectorList selectors (0-based)." }\n                ],\n                "description": "Match data for a CSS rule."\n            },\n            {\n                "id": "SelectorList",\n                "type": "object",\n                "properties": [\n                    { "name": "selectors", "type": "array", "items": { "type": "string" }, "description": "Selectors in the list." },\n                    { "name": "text", "type": "string", "description": "Rule selector text." },\n                    { "name": "range", "$ref": "SourceRange", "optional": true, "description": "Rule selector range in the underlying resource (if available)." }\n                ],\n                "description": "Selector list data."\n            },\n            {\n                "id": "CSSStyleAttribute",\n                "type": "object",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "DOM attribute name (e.g. \\"width\\")."},\n                    { "name": "style", "$ref": "CSSStyle", "description": "CSS style generated by the respective DOM attribute."}\n                ],\n                "description": "CSS style information for a DOM style attribute."\n            },\n            {\n                "id": "CSSStyleSheetHeader",\n                "type": "object",\n                "properties": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId", "description": "The stylesheet identifier."},\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Owner frame identifier."},\n                    { "name": "sourceURL", "type": "string", "description": "Stylesheet resource URL."},\n                    { "name": "origin", "$ref": "StyleSheetOrigin", "description": "Stylesheet origin."},\n                    { "name": "title", "type": "string", "description": "Stylesheet title."},\n                    { "name": "disabled", "type": "boolean", "description": "Denotes whether the stylesheet is disabled."}\n                ],\n                "description": "CSS stylesheet metainformation."\n            },\n            {\n                "id": "CSSStyleSheetBody",\n                "type": "object",\n                "properties": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId", "description": "The stylesheet identifier."},\n                    { "name": "rules", "type": "array", "items": { "$ref": "CSSRule" }, "description": "Stylesheet resource URL."},\n                    { "name": "text", "type": "string", "optional": true, "description": "Stylesheet resource contents (if available)."}\n                ],\n                "description": "CSS stylesheet contents."\n            },\n            {\n                "id": "CSSRule",\n                "type": "object",\n                "properties": [\n                    { "name": "ruleId", "$ref": "CSSRuleId", "optional": true, "description": "The CSS rule identifier (absent for user agent stylesheet and user-specified stylesheet rules)."},\n                    { "name": "selectorList", "$ref": "SelectorList", "description": "Rule selector data." },\n                    { "name": "sourceURL", "type": "string", "optional": true, "description": "Parent stylesheet resource URL (for regular rules)."},\n                    { "name": "sourceLine", "type": "integer", "description": "Line ordinal of the rule selector start character in the resource."},\n                    { "name": "origin", "$ref": "StyleSheetOrigin", "description": "Parent stylesheet\'s origin."},\n                    { "name": "style", "$ref": "CSSStyle", "description": "Associated style declaration." },\n                    { "name": "media", "type": "array", "items": { "$ref": "CSSMedia" }, "optional": true, "description": "Media list array (for rules involving media queries). The array enumerates media queries starting with the innermost one, going outwards." }\n                ],\n                "description": "CSS rule representation."\n            },\n            {\n                "id": "SourceRange",\n                "type": "object",\n                "properties": [\n                    { "name": "start", "type": "integer", "description": "Start of range (inclusive)."},\n                    { "name": "end", "type": "integer", "description": "End of range (exclusive)."}\n                ],\n                "description": "Text range within a resource."\n            },\n            {\n                "id": "ShorthandEntry",\n                "type": "object",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Shorthand name." },\n                    { "name": "value", "type": "string", "description": "Shorthand value." }\n                ]\n            },\n            {\n                "id": "CSSPropertyInfo",\n                "type": "object",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Property name." },\n                    { "name": "longhands", "type": "array", "optional": true, "items": { "type": "string" }, "description": "Longhand property names." }\n                ]\n            },\n            {\n                "id": "CSSComputedStyleProperty",\n                "type": "object",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Computed style property name." },\n                    { "name": "value", "type": "string", "description": "Computed style property value." }\n                ]\n            },\n            {\n                "id": "CSSStyle",\n                "type": "object",\n                "properties": [\n                    { "name": "styleId", "$ref": "CSSStyleId", "optional": true, "description": "The CSS style identifier (absent for attribute styles)." },\n                    { "name": "cssProperties", "type": "array", "items": { "$ref": "CSSProperty" }, "description": "CSS properties in the style." },\n                    { "name": "shorthandEntries", "type": "array", "items": { "$ref": "ShorthandEntry" }, "description": "Computed values for all shorthands found in the style." },\n                    { "name": "cssText", "type": "string", "optional": true, "description": "Style declaration text (if available)." },\n                    { "name": "range", "$ref": "SourceRange", "optional": true, "description": "Style declaration range in the enclosing stylesheet (if available)." },\n                    { "name": "width", "type": "string", "optional": true, "description": "The effective \\"width\\" property value from this style." },\n                    { "name": "height", "type": "string", "optional": true, "description": "The effective \\"height\\" property value from this style." }\n                ],\n                "description": "CSS style representation."\n            },\n            {\n                "id": "CSSProperty",\n                "type": "object",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "The property name." },\n                    { "name": "value", "type": "string", "description": "The property value." },\n                    { "name": "priority", "type": "string", "optional": true, "description": "The property priority (implies \\"\\" if absent)." },\n                    { "name": "implicit", "type": "boolean", "optional": true, "description": "Whether the property is implicit (implies <code>false</code> if absent)." },\n                    { "name": "text", "type": "string", "optional": true, "description": "The full property text as specified in the style." },\n                    { "name": "parsedOk", "type": "boolean", "optional": true, "description": "Whether the property is understood by the browser (implies <code>true</code> if absent)." },\n                    { "name": "status", "type": "string", "enum": ["active", "inactive", "disabled", "style"], "optional": true, "description": "The property status: \\"active\\" (implied if absent) if the property is effective in the style, \\"inactive\\" if the property is overridden by a same-named property in this style later on, \\"disabled\\" if the property is disabled by the user, \\"style\\" if the property is reported by the browser rather than by the CSS source parser." },\n                    { "name": "range", "$ref": "SourceRange", "optional": true, "description": "The entire property range in the enclosing style declaration (if available)." }\n                ],\n                "description": "CSS style effective visual dimensions and source offsets."\n            },\n            {\n                "id": "CSSMedia",\n                "type": "object",\n                "properties": [\n                    { "name": "text", "type": "string", "description": "Media query text." },\n                    { "name": "source", "type": "string", "enum": ["mediaRule", "importRule", "linkedSheet", "inlineSheet"], "description": "Source of the media query: \\"mediaRule\\" if specified by a @media rule, \\"importRule\\" if specified by an @import rule, \\"linkedSheet\\" if specified by a \\"media\\" attribute in a linked stylesheet\'s LINK tag, \\"inlineSheet\\" if specified by a \\"media\\" attribute in an inline stylesheet\'s STYLE tag." },\n                    { "name": "sourceURL", "type": "string", "optional": true, "description": "URL of the document containing the media query description." },\n                    { "name": "sourceLine", "type": "integer", "optional": true, "description": "Line in the document containing the media query (not defined for the \\"stylesheet\\" source)." }\n                ],\n                "description": "CSS media query descriptor."\n            },\n            {\n                "id": "SelectorProfileEntry",\n                "type": "object",\n                "properties": [\n                    { "name": "selector", "type": "string", "description": "CSS selector of the corresponding rule." },\n                    { "name": "url", "type": "string", "description": "URL of the resource containing the corresponding rule." },\n                    { "name": "lineNumber", "type": "integer", "description": "Selector line number in the resource for the corresponding rule." },\n                    { "name": "time", "type": "number", "description": "Total time this rule handling contributed to the browser running time during profiling (in milliseconds.)" },\n                    { "name": "hitCount", "type": "integer", "description": "Number of times this rule was considered a candidate for matching against DOM elements." },\n                    { "name": "matchCount", "type": "integer", "description": "Number of times this rule actually matched a DOM element." }\n                ],\n                "description": "CSS selector profile entry."\n            },\n            {\n                "id": "SelectorProfile",\n                "type": "object",\n                "properties": [\n                    { "name": "totalTime", "type": "number", "description": "Total processing time for all selectors in the profile (in milliseconds.)" },\n                    { "name": "data", "type": "array", "items": { "$ref": "SelectorProfileEntry" }, "description": "CSS selector profile entries." }\n                ]\n            },\n            {\n                "id": "Region",\n                "type": "object",\n                "properties": [\n                    { "name": "regionOverset", "type": "string", "enum": ["overset", "fit", "empty"], "description": "The \\"overset\\" attribute of a Named Flow." },\n                    { "name": "nodeId", "$ref": "DOM.NodeId", "description": "The corresponding DOM node id." }\n                ],\n                "description": "This object represents a region that flows from a Named Flow.",\n                "hidden": true\n            },\n            {\n                "id": "NamedFlow",\n                "type": "object",\n                "properties": [\n                    { "name": "documentNodeId", "$ref": "DOM.NodeId", "description": "The document node id." },\n                    { "name": "name", "type": "string", "description": "Named Flow identifier." },\n                    { "name": "overset", "type": "boolean", "description": "The \\"overset\\" attribute of a Named Flow." },\n                    { "name": "content", "type": "array", "items": { "$ref": "DOM.NodeId" }, "description": "An array of nodes that flow into the Named Flow." },\n                    { "name": "regions", "type": "array", "items": { "$ref": "Region" }, "description": "An array of regions associated with the Named Flow." }\n                ],\n                "description": "This object represents a Named Flow.",\n                "hidden": true\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables the CSS agent for the given page. Clients should not assume that the CSS agent has been enabled until the result of this command is received."\n            },\n            {\n                "name": "disable",\n                "description": "Disables the CSS agent for the given page."\n            },\n            {\n                "name": "getMatchedStylesForNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId" },\n                    { "name": "includePseudo", "type": "boolean", "optional": true, "description": "Whether to include pseudo styles (default: true)." },\n                    { "name": "includeInherited", "type": "boolean", "optional": true, "description": "Whether to include inherited styles (default: true)." }\n                ],\n                "returns": [\n                    { "name": "matchedCSSRules", "type": "array", "items": { "$ref": "RuleMatch" }, "optional": true, "description": "CSS rules matching this node, from all applicable stylesheets." },\n                    { "name": "pseudoElements", "type": "array", "items": { "$ref": "PseudoIdMatches" }, "optional": true, "description": "Pseudo style matches for this node." },\n                    { "name": "inherited", "type": "array", "items": { "$ref": "InheritedStyleEntry" }, "optional": true, "description": "A chain of inherited styles (from the immediate node parent up to the DOM tree root)." }\n                ],\n                "description": "Returns requested styles for a DOM node identified by <code>nodeId</code>."\n            },\n            {\n                "name": "getInlineStylesForNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId" }\n                ],\n                "returns": [\n                    { "name": "inlineStyle", "$ref": "CSSStyle", "optional": true, "description": "Inline style for the specified DOM node." },\n                    { "name": "attributesStyle", "$ref": "CSSStyle", "optional": true, "description": "Attribute-defined element style (e.g. resulting from \\"width=20 height=100%\\")."}\n                ],\n                "description": "Returns the styles defined inline (explicitly in the \\"style\\" attribute and implicitly, using DOM attributes) for a DOM node identified by <code>nodeId</code>."\n            },\n            {\n                "name": "getComputedStyleForNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId" }\n                ],\n                "returns": [\n                    { "name": "computedStyle", "type": "array", "items": { "$ref": "CSSComputedStyleProperty" }, "description": "Computed style for the specified DOM node." }\n                ],\n                "description": "Returns the computed style for a DOM node identified by <code>nodeId</code>."\n            },\n            {\n                "name": "getAllStyleSheets",\n                "returns": [\n                    { "name": "headers", "type": "array", "items": { "$ref": "CSSStyleSheetHeader" }, "description": "Descriptor entries for all available stylesheets." }\n                ],\n                "description": "Returns metainfo entries for all known stylesheets."\n            },\n            {\n                "name": "getStyleSheet",\n                "parameters": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId" }\n                ],\n                "returns": [\n                    { "name": "styleSheet", "$ref": "CSSStyleSheetBody", "description": "Stylesheet contents for the specified <code>styleSheetId</code>." }\n                ],\n                "description": "Returns stylesheet data for the specified <code>styleSheetId</code>."\n            },\n            {\n                "name": "getStyleSheetText",\n                "parameters": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId" }\n                ],\n                "returns": [\n                    { "name": "text", "type": "string", "description": "The stylesheet text." }\n                ],\n                "description": "Returns the current textual content and the URL for a stylesheet."\n            },\n            {\n                "name": "setStyleSheetText",\n                "parameters": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId" },\n                    { "name": "text", "type": "string" }\n                ],\n                "description": "Sets the new stylesheet text, thereby invalidating all existing <code>CSSStyleId</code>\'s and <code>CSSRuleId</code>\'s contained by this stylesheet."\n            },\n            {\n                "name": "setPropertyText",\n                "parameters": [\n                    { "name": "styleId", "$ref": "CSSStyleId" },\n                    { "name": "propertyIndex", "type": "integer" },\n                    { "name": "text", "type": "string" },\n                    { "name": "overwrite", "type": "boolean" }\n                ],\n                "returns": [\n                    { "name": "style", "$ref": "CSSStyle", "description": "The resulting style after the property text modification." }\n                ],\n                "description": "Sets the new <code>text</code> for a property in the respective style, at offset <code>propertyIndex</code>. If <code>overwrite</code> is <code>true</code>, a property at the given offset is overwritten, otherwise inserted. <code>text</code> entirely replaces the property <code>name: value</code>."\n            },\n            {\n                "name": "toggleProperty",\n                "parameters": [\n                    { "name": "styleId", "$ref": "CSSStyleId" },\n                    { "name": "propertyIndex", "type": "integer" },\n                    { "name": "disable", "type": "boolean" }\n                ],\n                "returns": [\n                    { "name": "style", "$ref": "CSSStyle", "description": "The resulting style after the property toggling." }\n                ],\n                "description": "Toggles the property in the respective style, at offset <code>propertyIndex</code>. The <code>disable</code> parameter denotes whether the property should be disabled (i.e. removed from the style declaration). If <code>disable == false</code>, the property gets put back into its original place in the style declaration."\n            },\n            {\n                "name": "setRuleSelector",\n                "parameters": [\n                    { "name": "ruleId", "$ref": "CSSRuleId" },\n                    { "name": "selector", "type": "string" }\n                ],\n                "returns": [\n                    { "name": "rule", "$ref": "CSSRule", "description": "The resulting rule after the selector modification." }\n                ],\n                "description": "Modifies the rule selector."\n            },\n            {\n                "name": "addRule",\n                "parameters": [\n                    { "name": "contextNodeId", "$ref": "DOM.NodeId" },\n                    { "name": "selector", "type": "string" }\n                ],\n                "returns": [\n                    { "name": "rule", "$ref": "CSSRule", "description": "The newly created rule." }\n                ],\n                "description": "Creates a new empty rule with the given <code>selector</code> in a special \\"inspector\\" stylesheet in the owner document of the context node."\n            },\n            {\n                "name": "getSupportedCSSProperties",\n                "returns": [\n                    { "name": "cssProperties", "type": "array", "items": { "$ref": "CSSPropertyInfo" }, "description": "Supported property metainfo." }\n                ],\n                "description": "Returns all supported CSS property names."\n            },\n            {\n                "name": "forcePseudoState",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId", "description": "The element id for which to force the pseudo state." },\n                    { "name": "forcedPseudoClasses", "type": "array", "items": { "type": "string", "enum": ["active", "focus", "hover", "visited"] }, "description": "Element pseudo classes to force when computing the element\'s style." }\n                ],\n                "description": "Ensures that the given node will have specified pseudo-classes whenever its style is computed by the browser."\n            },\n            {\n                "name": "startSelectorProfiler"\n            },\n            {\n                "name": "stopSelectorProfiler",\n                "returns": [\n                    { "name": "profile", "$ref": "SelectorProfile" }\n                ]\n            },\n            {\n                "name": "getNamedFlowCollection",\n                "parameters": [\n                    { "name": "documentNodeId", "$ref": "DOM.NodeId", "description": "The document node id for which to get the Named Flow Collection." }\n                ],\n                "returns": [\n                    { "name": "namedFlows", "type": "array", "items": { "$ref": "NamedFlow" }, "description": "An array containing the Named Flows in the document." }\n                ],\n                "description": "Returns the Named Flows from the document.",\n                "hidden": true\n            }\n        ],\n        "events": [\n            {\n                "name": "mediaQueryResultChanged",\n                "description": "Fires whenever a MediaQuery result changes (for example, after a browser window has been resized.) The current implementation considers only viewport-dependent media features."\n            },\n            {\n                "name": "styleSheetChanged",\n                "parameters": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId" }\n                ],\n                "description": "Fired whenever a stylesheet is changed as a result of the client operation."\n            },\n            {\n                "name": "namedFlowCreated",\n                "parameters": [\n                    { "name": "namedFlow", "$ref": "NamedFlow", "description": "The new Named Flow." }\n                ],\n                "description": "Fires when a Named Flow is created.",\n                "hidden": true\n            },\n            {\n                "name": "namedFlowRemoved",\n                "parameters": [\n                    { "name": "documentNodeId", "$ref": "DOM.NodeId", "description": "The document node id." },\n                    { "name": "flowName", "type": "string", "description": "Identifier of the removed Named Flow." }\n                ],\n                "description": "Fires when a Named Flow is removed: has no associated content nodes and regions.",\n                "hidden": true\n            },\n            {\n                "name": "regionLayoutUpdated",\n                "parameters": [\n                    { "name": "namedFlow", "$ref": "NamedFlow", "description": "The Named Flow whose layout may have changed." }\n                ],\n                "description": "Fires when a Named Flow\'s layout may have changed.",\n                "hidden": true\n            }\n        ]\n    },\n    {\n        "domain": "Timeline",\n        "description": "Timeline provides its clients with instrumentation records that are generated during the page runtime. Timeline instrumentation can be started and stopped using corresponding commands. While timeline is started, it is generating timeline event records.",\n        "types": [\n            {\n                "id": "TimelineEvent",\n                "type": "object",\n                "properties": [\n                    { "name": "type", "type": "string", "description": "Event type." },\n                    { "name": "data", "type": "object", "description": "Event data." },\n                    { "name": "children", "type": "array", "optional": true, "items": { "$ref": "TimelineEvent" }, "description": "Nested records." }\n                ],\n                "description": "Timeline record contains information about the recorded activity."\n            }\n        ],\n        "commands": [\n            {\n                "name": "start",\n                "parameters": [\n                    { "name": "maxCallStackDepth", "optional": true, "type": "integer", "description": "Samples JavaScript stack traces up to <code>maxCallStackDepth</code>, defaults to 5." }\n                ],\n                "description": "Starts capturing instrumentation events."\n            },\n            {\n                "name": "stop",\n                "description": "Stops capturing instrumentation events."\n            },\n            {\n                "name": "setIncludeMemoryDetails",\n                "parameters": [\n                    { "name": "enabled", "type": "boolean", "description": "True to start collecting DOM counters." }\n                ],\n                "hidden": true,\n                "description": "Starts calculating various DOM statistics and sending them as part of timeline events."\n            },\n            {\n                "name": "supportsFrameInstrumentation",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "True if timeline supports frame instrumentation." }\n                ],\n                "hidden": true,\n                "description": "Tells whether timeline agent supports frame instrumentation."\n            },\n            {\n                "name": "canMonitorMainThread",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "True if timeline supports main thread CPU utilization instrumentation." }\n                ],\n                "hidden": true,\n                "description": "Tells whether timeline agent supports main thread CPU utilization instrumentation."\n            }\n        ],\n        "events": [\n            {\n                "name": "eventRecorded",\n                "parameters": [\n                    { "name": "record", "$ref": "TimelineEvent", "description": "Timeline event record data." }\n                ],\n                "description": "Fired for every instrumentation event while timeline is started."\n            }\n        ]\n    },\n    {\n        "domain": "Debugger",\n        "description": "Debugger domain exposes JavaScript debugging capabilities. It allows setting and removing breakpoints, stepping through execution, exploring stack traces, etc.",\n        "types": [\n            {\n                "id": "BreakpointId",\n                "type": "string",\n                "description": "Breakpoint identifier."\n            },\n            {\n                "id": "ScriptId",\n                "type": "string",\n                "description": "Unique script identifier."\n            },\n            {\n                "id": "CallFrameId",\n                "type": "string",\n                "description": "Call frame identifier."\n            },\n            {\n                "id": "Location",\n                "type": "object",\n                "properties": [\n                    { "name": "scriptId", "$ref": "ScriptId", "description": "Script identifier as reported in the <code>Debugger.scriptParsed</code>." },\n                    { "name": "lineNumber", "type": "integer", "description": "Line number in the script." },\n                    { "name": "columnNumber", "type": "integer", "optional": true, "description": "Column number in the script." }\n                ],\n                "description": "Location in the source code."\n            },\n            {\n                "id": "FunctionDetails",\n                "hidden": true,\n                "type": "object",\n                "properties": [\n                    { "name": "location", "$ref": "Location", "description": "Location of the function." },\n                    { "name": "name", "type": "string", "optional": true, "description": "Name of the function. Not present for anonymous functions." },\n                    { "name": "displayName", "type": "string", "optional": true, "description": "Display name of the function(specified in \'displayName\' property on the function object)." },\n                    { "name": "inferredName", "type": "string", "optional": true, "description": "Name of the function inferred from its initial assignment." },\n                    { "name": "scopeChain", "type": "array", "optional": true, "items": { "$ref": "Scope" }, "description": "Scope chain for this closure." }\n                ],\n                "description": "Information about the function."\n            },\n            {\n                "id": "CallFrame",\n                "type": "object",\n                "properties": [\n                    { "name": "callFrameId", "$ref": "CallFrameId", "description": "Call frame identifier. This identifier is only valid while the virtual machine is paused." },\n                    { "name": "functionName", "type": "string", "description": "Name of the JavaScript function called on this call frame." },\n                    { "name": "location", "$ref": "Location", "description": "Location in the source code." },\n                    { "name": "scopeChain", "type": "array", "items": { "$ref": "Scope" }, "description": "Scope chain for this call frame." },\n                    { "name": "this", "$ref": "Runtime.RemoteObject", "description": "<code>this</code> object for this call frame." }\n                ],\n                "description": "JavaScript call frame. Array of call frames form the call stack."\n            },\n            {\n                "id": "Scope",\n                "type": "object",\n                "properties": [\n                    { "name": "type", "type": "string", "enum": ["global", "local", "with", "closure", "catch"], "description": "Scope type." },\n                    { "name": "object", "$ref": "Runtime.RemoteObject", "description": "Object representing the scope. For <code>global</code> and <code>with</code> scopes it represents the actual object; for the rest of the scopes, it is artificial transient object enumerating scope variables as its properties." }\n                ],\n                "description": "Scope description."\n            }\n        ],\n        "commands": [\n            {\n                "name": "causesRecompilation",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "True if enabling debugger causes scripts recompilation." }\n                ],\n                "hidden": true,\n                "description": "Tells whether enabling debugger causes scripts recompilation."\n            },\n            {\n                "name": "supportsSeparateScriptCompilationAndExecution",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "True if debugger supports separate script compilation and execution." }\n                ],\n                "hidden": true,\n                "description": "Tells whether debugger supports separate script compilation and execution."\n            },\n            {\n                "name": "enable",\n                "description": "Enables debugger for the given page. Clients should not assume that the debugging has been enabled until the result for this command is received."\n            },\n            {\n                "name": "disable",\n                "description": "Disables debugger for given page."\n            },\n            {\n                "name": "setBreakpointsActive",\n                "parameters": [\n                    { "name": "active", "type": "boolean", "description": "New value for breakpoints active state." }\n                ],\n                "description": "Activates / deactivates all breakpoints on the page."\n            },\n            {\n                "name": "setBreakpointByUrl",\n                "parameters": [\n                    { "name": "lineNumber", "type": "integer", "description": "Line number to set breakpoint at." },\n                    { "name": "url", "type": "string", "optional": true, "description": "URL of the resources to set breakpoint on." },\n                    { "name": "urlRegex", "type": "string", "optional": true, "description": "Regex pattern for the URLs of the resources to set breakpoints on. Either <code>url</code> or <code>urlRegex</code> must be specified." },\n                    { "name": "columnNumber", "type": "integer", "optional": true, "description": "Offset in the line to set breakpoint at." },\n                    { "name": "condition", "type": "string", "optional": true, "description": "Expression to use as a breakpoint condition. When specified, debugger will only stop on the breakpoint if this expression evaluates to true." }\n                ],\n                "returns": [\n                    { "name": "breakpointId", "$ref": "BreakpointId", "description": "Id of the created breakpoint for further reference." },\n                    { "name": "locations", "type": "array", "items": { "$ref": "Location"}, "description": "List of the locations this breakpoint resolved into upon addition." }\n                ],\n                "description": "Sets JavaScript breakpoint at given location specified either by URL or URL regex. Once this command is issued, all existing parsed scripts will have breakpoints resolved and returned in <code>locations</code> property. Further matching script parsing will result in subsequent <code>breakpointResolved</code> events issued. This logical breakpoint will survive page reloads."\n            },\n            {\n                "name": "setBreakpoint",\n                "parameters": [\n                    { "name": "location", "$ref": "Location", "description": "Location to set breakpoint in." },\n                    { "name": "condition", "type": "string", "optional": true, "description": "Expression to use as a breakpoint condition. When specified, debugger will only stop on the breakpoint if this expression evaluates to true." }\n                ],\n                "returns": [\n                    { "name": "breakpointId", "$ref": "BreakpointId", "description": "Id of the created breakpoint for further reference." },\n                    { "name": "actualLocation", "$ref": "Location", "description": "Location this breakpoint resolved into." }\n                ],\n                "description": "Sets JavaScript breakpoint at a given location."\n            },\n            {\n                "name": "removeBreakpoint",\n                "parameters": [\n                    { "name": "breakpointId", "$ref": "BreakpointId" }\n                ],\n                "description": "Removes JavaScript breakpoint."\n            },\n            {\n                "name": "continueToLocation",\n                "parameters": [\n                    { "name": "location", "$ref": "Location", "description": "Location to continue to." }\n                ],\n                "description": "Continues execution until specific location is reached."\n            },\n            {\n                "name": "stepOver",\n                "description": "Steps over the statement."\n            },\n            {\n                "name": "stepInto",\n                "description": "Steps into the function call."\n            },\n            {\n                "name": "stepOut",\n                "description": "Steps out of the function call."\n            },\n            {\n                "name": "pause",\n                "description": "Stops on the next JavaScript statement."\n            },\n            {\n                "name": "resume",\n                "description": "Resumes JavaScript execution."\n            },\n            {\n                "name": "searchInContent",\n                "parameters": [\n                    { "name": "scriptId", "$ref": "ScriptId", "description": "Id of the script to search in." },\n                    { "name": "query", "type": "string", "description": "String to search for."  },\n                    { "name": "caseSensitive", "type": "boolean", "optional": true, "description": "If true, search is case sensitive." },\n                    { "name": "isRegex", "type": "boolean", "optional": true, "description": "If true, treats string parameter as regex." }\n                ],\n                "returns": [\n                    { "name": "result", "type": "array", "items": { "$ref": "Page.SearchMatch" }, "description": "List of search matches." }\n                ],\n                "description": "Searches for given string in script content."\n            },\n            {\n                "name": "canSetScriptSource",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "True if <code>setScriptSource</code> is supported." }\n                ],\n                "description": "Tells whether <code>setScriptSource</code> is supported."\n            },\n            {\n                "name": "setScriptSource",\n                "parameters": [\n                    { "name": "scriptId", "$ref": "ScriptId", "description": "Id of the script to edit." },\n                    { "name": "scriptSource", "type": "string", "description": "New content of the script." },\n                    { "name": "preview", "type": "boolean", "optional": true, "description": " If true the change will not actually be applied. Preview mode may be used to get result description without actually modifying the code.", "hidden": true }\n                ],\n                "returns": [\n                    { "name": "callFrames", "type": "array", "optional": true, "items": { "$ref": "CallFrame"}, "description": "New stack trace in case editing has happened while VM was stopped." },\n                    { "name": "result", "type": "object", "optional": true, "description": "VM-specific description of the changes applied.", "hidden": true }\n                ],\n                "description": "Edits JavaScript source live."\n            },\n            {\n                "name": "restartFrame",\n                "parameters": [\n                    { "name": "callFrameId", "$ref": "CallFrameId", "description": "Call frame identifier to evaluate on." }\n                ],\n                "returns": [\n                    { "name": "callFrames", "type": "array", "items": { "$ref": "CallFrame"}, "description": "New stack trace." },\n                    { "name": "result", "type": "object", "description": "VM-specific description.", "hidden": true }\n                ],\n                "hidden": true,\n                "description": "Restarts particular call frame from the beginning."\n            },\n            {\n                "name": "getScriptSource",\n                "parameters": [\n                    { "name": "scriptId", "$ref": "ScriptId", "description": "Id of the script to get source for." }\n                ],\n                "returns": [\n                    { "name": "scriptSource", "type": "string", "description": "Script source." }\n                ],\n                "description": "Returns source for the script with given id."\n            },\n            {\n                "name": "getFunctionDetails",\n                "hidden": true,\n                "parameters": [\n                    { "name": "functionId", "$ref": "Runtime.RemoteObjectId", "description": "Id of the function to get location for." }\n                ],\n                "returns": [\n                    { "name": "details", "$ref": "FunctionDetails", "description": "Information about the function." }\n                ],\n                "description": "Returns detailed informtation on given function."\n            },\n            {\n                "name": "setPauseOnExceptions",\n                "parameters": [\n                    { "name": "state", "type": "string", "enum": ["none", "uncaught", "all"], "description": "Pause on exceptions mode." }\n                ],\n                "description": "Defines pause on exceptions state. Can be set to stop on all exceptions, uncaught exceptions or no exceptions. Initial pause on exceptions state is <code>none</code>."\n            },\n            {\n                "name": "evaluateOnCallFrame",\n                "parameters": [\n                    { "name": "callFrameId", "$ref": "CallFrameId", "description": "Call frame identifier to evaluate on." },\n                    { "name": "expression", "type": "string", "description": "Expression to evaluate." },\n                    { "name": "objectGroup", "type": "string", "optional": true, "description": "String object group name to put result into (allows rapid releasing resulting object handles using <code>releaseObjectGroup</code>)." },\n                    { "name": "includeCommandLineAPI", "type": "boolean", "optional": true, "description": "Specifies whether command line API should be available to the evaluated expression, defaults to false.", "hidden": true },\n                    { "name": "doNotPauseOnExceptionsAndMuteConsole", "type": "boolean", "optional": true, "description": "Specifies whether evaluation should stop on exceptions and mute console. Overrides setPauseOnException state.", "hidden": true },\n                    { "name": "returnByValue", "type": "boolean", "optional": true, "description": "Whether the result is expected to be a JSON object that should be sent by value." },\n                    { "name": "generatePreview", "type": "boolean", "optional": true, "hidden": true, "description": "Whether preview should be generated for the result." }\n                ],\n                "returns": [\n                    { "name": "result", "$ref": "Runtime.RemoteObject", "description": "Object wrapper for the evaluation result." },\n                    { "name": "wasThrown", "type": "boolean", "optional": true, "description": "True if the result was thrown during the evaluation." }\n                ],\n                "description": "Evaluates expression on a given call frame."\n            },\n            {\n                "name": "compileScript",\n                "hidden": true,\n                "parameters": [\n                    { "name": "expression", "type": "string", "description": "Expression to compile." },\n                    { "name": "sourceURL", "type": "string", "description": "Source url to be set for the script." }\n                ],\n                "returns": [\n                    { "name": "scriptId", "$ref": "ScriptId", "optional": true, "description": "Id of the script." },\n                    { "name": "syntaxErrorMessage", "type": "string", "optional": true, "description": "Syntax error message if compilation failed." }\n                ],\n                "description": "Compiles expression."\n            },\n            {\n                "name": "runScript",\n                "hidden": true,\n                "parameters": [\n                    { "name": "scriptId", "$ref": "ScriptId", "description": "Id of the script to run." },\n                    { "name": "contextId", "$ref": "Runtime.ExecutionContextId", "optional": true, "description": "Specifies in which isolated context to perform script run. Each content script lives in an isolated context and this parameter may be used to specify one of those contexts. If the parameter is omitted or 0 the evaluation will be performed in the context of the inspected page." },\n                    { "name": "objectGroup", "type": "string", "optional": true, "description": "Symbolic group name that can be used to release multiple objects." },\n                    { "name": "doNotPauseOnExceptionsAndMuteConsole", "type": "boolean", "optional": true, "description": "Specifies whether script run should stop on exceptions and mute console. Overrides setPauseOnException state." }\n                ],\n                "returns": [\n                    { "name": "result", "$ref": "Runtime.RemoteObject", "description": "Run result." },\n                    { "name": "wasThrown", "type": "boolean", "optional": true, "description": "True if the result was thrown during the script run." }\n                ],\n                "description": "Runs script with given id in a given context."\n            },\n            {\n                "name": "setOverlayMessage",\n                "parameters": [\n                    { "name": "message", "type": "string", "optional": true, "description": "Overlay message to display when paused in debugger." }\n                ],\n                "hidden": true,\n                "description": "Sets overlay message."\n            },\n            {\n                "name": "setVariableValue",\n                "parameters": [\n                    { "name": "callFrameId", "$ref": "CallFrameId", "optional": true, "description": "Id of callframe that holds variable." },\n                    { "name": "functionObjectId", "$ref": "Runtime.RemoteObjectId", "optional": true, "description": "Object id of closure (function) that holds variable." },\n                    { "name": "scopeNumber", "type": "integer", "description": "0-based number of scope as was listed in scope chain. Only \'local\', \'closure\' and \'catch\' scope types are allowed. Other scopes could be manipulated manually." },\n                    { "name": "variableName", "type": "string", "description": "Variable name." },\n                    { "name": "newValue", "$ref": "Runtime.CallArgument", "description": "New variable value." }\n                ],\n                "hidden": true,\n                "description": "Changes value of variable in a callframe or a closure. Either callframe or function must be specified. Object-based scopes are not supported and must be mutated manually."\n            }\n        ],\n        "events": [\n            {\n                "name": "globalObjectCleared",\n                "description": "Called when global has been cleared and debugger client should reset its state. Happens upon navigation or reload."\n            },\n            {\n                "name": "scriptParsed",\n                "parameters": [\n                    { "name": "scriptId", "$ref": "ScriptId", "description": "Identifier of the script parsed." },\n                    { "name": "url", "type": "string", "description": "URL or name of the script parsed (if any)." },\n                    { "name": "startLine", "type": "integer", "description": "Line offset of the script within the resource with given URL (for script tags)." },\n                    { "name": "startColumn", "type": "integer", "description": "Column offset of the script within the resource with given URL." },\n                    { "name": "endLine", "type": "integer", "description": "Last line of the script." },\n                    { "name": "endColumn", "type": "integer", "description": "Length of the last line of the script." },\n                    { "name": "isContentScript", "type": "boolean", "optional": true, "description": "Determines whether this script is a user extension script." },\n                    { "name": "sourceMapURL", "type": "string", "optional": true, "description": "URL of source map associated with script (if any)." },\n                    { "name": "hasSourceURL", "type": "boolean", "optional": true, "description": "True, if this script has sourceURL." }\n                ],\n                "description": "Fired when virtual machine parses script. This event is also fired for all known and uncollected scripts upon enabling debugger."\n            },\n            {\n                "name": "scriptFailedToParse",\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "URL of the script that failed to parse." },\n                    { "name": "scriptSource", "type": "string", "description": "Source text of the script that failed to parse." },\n                    { "name": "startLine", "type": "integer", "description": "Line offset of the script within the resource." },\n                    { "name": "errorLine", "type": "integer", "description": "Line with error." },\n                    { "name": "errorMessage", "type": "string", "description": "Parse error message." }\n                ],\n                "description": "Fired when virtual machine fails to parse the script."\n            },\n            {\n                "name": "breakpointResolved",\n                "parameters": [\n                    { "name": "breakpointId", "$ref": "BreakpointId", "description": "Breakpoint unique identifier." },\n                    { "name": "location", "$ref": "Location", "description": "Actual breakpoint location." }\n                ],\n                "description": "Fired when breakpoint is resolved to an actual script and location."\n            },\n            {\n                "name": "paused",\n                "parameters": [\n                    { "name": "callFrames", "type": "array", "items": { "$ref": "CallFrame" }, "description": "Call stack the virtual machine stopped on." },\n                    { "name": "reason", "type": "string", "enum": [ "XHR", "DOM", "EventListener", "exception", "assert", "CSPViolation", "other" ], "description": "Pause reason." },\n                    { "name": "data", "type": "object", "optional": true, "description": "Object containing break-specific auxiliary properties." }\n                ],\n                "description": "Fired when the virtual machine stopped on breakpoint or exception or any other stop criteria."\n            },\n            {\n                "name": "resumed",\n                "description": "Fired when the virtual machine resumed execution."\n            }\n        ]\n    },\n    {\n        "domain": "DOMDebugger",\n        "description": "DOM debugging allows setting breakpoints on particular DOM operations and events. JavaScript execution will stop on these operations as if there was a regular breakpoint set.",\n        "types": [\n            {\n                "id": "DOMBreakpointType",\n                "type": "string",\n                "enum": ["subtree-modified", "attribute-modified", "node-removed"],\n                "description": "DOM breakpoint type."\n            }\n        ],\n        "commands": [\n            {\n                "name": "setDOMBreakpoint",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId", "description": "Identifier of the node to set breakpoint on." },\n                    { "name": "type", "$ref": "DOMBreakpointType", "description": "Type of the operation to stop upon." }\n                ],\n                "description": "Sets breakpoint on particular operation with DOM."\n            },\n            {\n                "name": "removeDOMBreakpoint",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId", "description": "Identifier of the node to remove breakpoint from." },\n                    { "name": "type", "$ref": "DOMBreakpointType", "description": "Type of the breakpoint to remove." }\n                ],\n                "description": "Removes DOM breakpoint that was set using <code>setDOMBreakpoint</code>."\n            },\n            {\n                "name": "setEventListenerBreakpoint",\n                "parameters": [\n                    { "name": "eventName", "type": "string", "description": "DOM Event name to stop on (any DOM event will do)." }\n                ],\n                "description": "Sets breakpoint on particular DOM event."\n            },\n            {\n                "name": "removeEventListenerBreakpoint",\n                "parameters": [\n                    { "name": "eventName", "type": "string", "description": "Event name." }\n                ],\n                "description": "Removes breakpoint on particular DOM event."\n            },\n            {\n                "name": "setInstrumentationBreakpoint",\n                "parameters": [\n                    { "name": "eventName", "type": "string", "description": "Instrumentation name to stop on." }\n                ],\n                "description": "Sets breakpoint on particular native event.",\n                "hidden": true\n            },\n            {\n                "name": "removeInstrumentationBreakpoint",\n                "parameters": [\n                    { "name": "eventName", "type": "string", "description": "Instrumentation name to stop on." }\n                ],\n                "description": "Sets breakpoint on particular native event.",\n                "hidden": true\n            },\n            {\n                "name": "setXHRBreakpoint",\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "Resource URL substring. All XHRs having this substring in the URL will get stopped upon." }\n                ],\n                "description": "Sets breakpoint on XMLHttpRequest."\n            },\n            {\n                "name": "removeXHRBreakpoint",\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "Resource URL substring." }\n                ],\n                "description": "Removes breakpoint from XMLHttpRequest."\n            }\n        ]\n    },\n    {\n        "domain": "Profiler",\n        "hidden": true,\n        "types": [\n            {\n                "id": "ProfileHeader",\n                "type": "object",\n                "description": "Profile header.",\n                "properties": [\n                    { "name": "typeId", "type": "string", "enum": ["CPU", "CSS", "HEAP"], "description": "Profile type name." },\n                    { "name": "title", "type": "string", "description": "Profile title." },\n                    { "name": "uid", "type": "integer", "description": "Unique identifier of the profile." },\n                    { "name": "maxJSObjectId", "type": "integer", "optional": true, "description": "Last seen JS object Id." }\n                ]\n            },\n            {\n                "id": "CPUProfileNode",\n                "type": "object",\n                "description": "CPU Profile node. Holds callsite information, execution statistics and child nodes.",\n                "properties": [\n                    { "name": "functionName", "type": "string", "description": "Function name." },\n                    { "name": "url", "type": "string", "description": "URL." },\n                    { "name": "lineNumber", "type": "integer", "description": "Line number." },\n                    { "name": "totalTime", "type": "number", "description": "Total execution time." },\n                    { "name": "selfTime", "type": "number", "description": "Self time." },\n                    { "name": "numberOfCalls", "type": "integer", "description": "Number of calls." },\n                    { "name": "visible", "type": "boolean", "description": "Visibility." },\n                    { "name": "callUID", "type": "number", "description": "Call UID." },\n                    { "name": "children", "type": "array", "items": { "$ref": "CPUProfileNode" }, "description": "Child nodes." }\n                ]\n            },\n            {\n                "id": "CPUProfile",\n                "type": "object",\n                "description": "Profile.",\n                "properties": [\n                    { "name": "head", "$ref": "CPUProfileNode", "optional": true },\n                    { "name": "bottomUpHead", "$ref": "CPUProfileNode", "optional": true },\n                    { "name": "idleTime", "type": "number", "optional": true }\n                ]\n            },\n            {\n                "id": "HeapSnapshotObjectId",\n                "type": "string",\n                "description": "Heap snashot object id."\n            }\n        ],\n        "commands": [\n            {\n                "name": "causesRecompilation",\n                "returns": [\n                    { "name": "result", "type": "boolean" }\n                ]\n            },\n            {\n                "name": "isSampling",\n                "returns": [\n                    { "name": "result", "type": "boolean" }\n                ]\n            },\n            {\n                "name": "hasHeapProfiler",\n                "returns": [\n                    { "name": "result", "type": "boolean" }\n                ]\n            },\n            {\n                "name": "enable"\n            },\n            {\n                "name": "disable"\n            },\n            {\n                "name": "start"\n            },\n            {\n                "name": "stop"\n            },\n            {\n                "name": "getProfileHeaders",\n                "returns": [\n                    { "name": "headers", "type": "array", "items": { "$ref": "ProfileHeader"} }\n                ]\n            },\n            {\n                "name": "getCPUProfile",\n                "parameters": [\n                    { "name": "uid", "type": "integer" }\n                ],\n                "returns": [\n                    { "name": "profile", "$ref": "CPUProfile" }\n                ]\n            },\n            {\n                "name": "getHeapSnapshot",\n                "parameters": [\n                    { "name": "uid", "type": "integer" }\n                ]\n            },\n            {\n                "name": "removeProfile",\n                "parameters": [\n                    { "name": "type", "type": "string" },\n                    { "name": "uid", "type": "integer" }\n                ]\n            },\n            {\n                "name": "clearProfiles"\n            },\n            {\n                "name": "takeHeapSnapshot",\n                "parameters": [\n                    { "name": "reportProgress", "type": "boolean", "optional": true, "description": "If true \'reportHeapSnapshotProgress\' events will be generated while snapshot is being taken." }\n                ]\n            },\n            {\n                "name": "collectGarbage"\n            },\n            {\n                "name": "getObjectByHeapObjectId",\n                "parameters": [\n                    { "name": "objectId", "$ref": "HeapSnapshotObjectId" },\n                    { "name": "objectGroup", "type": "string", "optional": true, "description": "Symbolic group name that can be used to release multiple objects." }\n                ],\n                "returns": [\n                    { "name": "result", "$ref": "Runtime.RemoteObject", "description": "Evaluation result." }\n                ]\n            },\n            {\n                "name": "getHeapObjectId",\n                "parameters": [\n                    { "name": "objectId", "$ref": "Runtime.RemoteObjectId", "description": "Identifier of the object to get heap object id for." }\n                ],\n                "returns": [\n                    { "name": "heapSnapshotObjectId", "$ref": "HeapSnapshotObjectId", "description": "Id of the heap snapshot object corresponding to the passed remote object id." }\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "addProfileHeader",\n                "parameters": [\n                    { "name": "header", "$ref": "ProfileHeader" }\n                ]\n            },\n            {\n                "name": "addHeapSnapshotChunk",\n                "parameters": [\n                    { "name": "uid", "type": "integer" },\n                    { "name": "chunk", "type": "string" }\n                ]\n            },\n            {\n                "name": "finishHeapSnapshot",\n                "parameters": [\n                    { "name": "uid", "type": "integer" }\n                ]\n            },\n            {\n                "name": "setRecordingProfile",\n                "parameters": [\n                    { "name": "isProfiling", "type": "boolean" }\n                ]\n            },\n            {\n                "name": "resetProfiles"\n            },\n            {\n                "name": "reportHeapSnapshotProgress",\n                "parameters": [\n                    { "name": "done", "type": "integer" },\n                    { "name": "total", "type": "integer" }\n                ]\n            }\n        ]\n    },\n    {\n        "domain": "Worker",\n        "hidden": true,\n        "types": [],\n        "commands": [\n            {\n                "name": "enable"\n            },\n            {\n                "name": "disable"\n            },\n            {\n                "name": "sendMessageToWorker",\n                "parameters": [\n                    { "name": "workerId", "type": "integer" },\n                    { "name": "message", "type": "object" }\n                ]\n            },\n            {\n                "name": "connectToWorker",\n                "parameters": [\n                    { "name": "workerId", "type": "integer" }\n                ]\n            },\n            {\n                "name": "disconnectFromWorker",\n                "parameters": [\n                    { "name": "workerId", "type": "integer" }\n                ]\n            },\n            {\n                "name": "setAutoconnectToWorkers",\n                "parameters": [\n                    { "name": "value", "type": "boolean" }\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "workerCreated",\n                "parameters": [\n                    { "name": "workerId", "type": "integer" },\n                    { "name": "url", "type": "string" },\n                    { "name": "inspectorConnected", "type": "boolean" }\n                ]\n            },\n            {\n                "name": "workerTerminated",\n                "parameters": [\n                    { "name": "workerId", "type": "integer" }\n                ]\n            },\n            {\n                "name": "dispatchMessageFromWorker",\n                "parameters": [\n                    { "name": "workerId", "type": "integer" },\n                    { "name": "message", "type": "object" }\n                ]\n            },\n            {\n                "name": "disconnectedFromWorker"\n            }\n        ]\n    },\n    {\n        "domain": "Canvas",\n        "hidden": true,\n        "types": [\n            {\n                "id": "ResourceId",\n                "type": "string",\n                "description": "Unique resource identifier."\n            },\n            {\n                "id": "ResourceInfo",\n                "type": "object",\n                "properties": [\n                    { "name": "id", "$ref": "ResourceId" },\n                    { "name": "description", "type": "string" }\n                ]\n            },\n            {\n                "id": "ResourceState",\n                "type": "object",\n                "properties": [\n                    { "name": "id", "$ref": "ResourceId" },\n                    { "name": "traceLogId", "$ref": "TraceLogId" },\n                    { "name": "imageURL", "type": "string", "optional": true, "description": "Screenshot image data URL." }\n                ]\n            },\n            {\n                "id": "CallArgument",\n                "type": "object",\n                "properties": [\n                    { "name": "description", "type": "string" }\n                ]\n            },\n            {\n                "id": "Call",\n                "type": "object",\n                "properties": [\n                    { "name": "contextId", "$ref": "ResourceId" },\n                    { "name": "functionName", "type": "string", "optional": true },\n                    { "name": "arguments", "type": "array", "items": { "$ref": "CallArgument" }, "optional": true },\n                    { "name": "result", "$ref": "CallArgument", "optional": true },\n                    { "name": "isDrawingCall", "type": "boolean", "optional": true },\n                    { "name": "property", "type": "string", "optional": true },\n                    { "name": "value", "$ref": "CallArgument", "optional": true },\n                    { "name": "sourceURL", "type": "string", "optional": true },\n                    { "name": "lineNumber", "type": "integer", "optional": true },\n                    { "name": "columnNumber", "type": "integer", "optional": true }\n                ]\n            },\n            {\n                "id": "TraceLogId",\n                "type": "string",\n                "description": "Unique trace log identifier."\n            },\n            {\n                "id": "TraceLog",\n                "type": "object",\n                "properties": [\n                    { "name": "id", "$ref": "TraceLogId" },\n                    { "name": "calls", "type": "array", "items": { "$ref": "Call" } },\n                    { "name": "startOffset", "type": "integer" },\n                    { "name": "alive", "type": "boolean" },\n                    { "name": "totalAvailableCalls", "type": "number" }\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables Canvas inspection."\n            },\n            {\n                "name": "disable",\n                "description": "Disables Canvas inspection."\n            },\n            {\n                "name": "dropTraceLog",\n                "parameters": [\n                    { "name": "traceLogId", "$ref": "TraceLogId" }\n                ]\n            },\n            {\n                "name": "hasUninstrumentedCanvases",\n                "returns": [\n                    { "name": "result", "type": "boolean" }\n                ],\n                "description": "Checks if there is any uninstrumented canvas in the inspected page."\n            },\n            {\n                "name": "captureFrame",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "optional": true, "description": "Identifier of the frame containing document whose canvases are to be captured. If omitted, main frame is assumed." }\n                ],\n                "returns": [\n                    { "name": "traceLogId", "$ref": "TraceLogId", "description": "Identifier of the trace log containing captured canvas calls." }\n                ],\n                "description": "Starts (or continues) a canvas frame capturing which will be stopped automatically after the next frame is prepared."\n            },\n            {\n                "name": "startCapturing",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "optional": true, "description": "Identifier of the frame containing document whose canvases are to be captured. If omitted, main frame is assumed." }\n                ],\n                "returns": [\n                    { "name": "traceLogId", "$ref": "TraceLogId", "description": "Identifier of the trace log containing captured canvas calls." }\n                ],\n                "description": "Starts (or continues) consecutive canvas frames capturing. The capturing is stopped by the corresponding stopCapturing command."\n            },\n            {\n                "name": "stopCapturing",\n                "parameters": [\n                    { "name": "traceLogId", "$ref": "TraceLogId" }\n                ]\n            },\n            {\n                "name": "getTraceLog",\n                "parameters": [\n                    { "name": "traceLogId", "$ref": "TraceLogId" },\n                    { "name": "startOffset", "type": "integer", "optional": true },\n                    { "name": "maxLength", "type": "integer", "optional": true }\n                ],\n                "returns": [\n                    { "name": "traceLog", "$ref": "TraceLog" }\n                ]\n            },\n            {\n                "name": "replayTraceLog",\n                "parameters": [\n                    { "name": "traceLogId", "$ref": "TraceLogId" },\n                    { "name": "stepNo", "type": "integer" }\n                ],\n                "returns": [\n                    { "name": "resourceState", "$ref": "ResourceState" }\n                ]\n            },\n            {\n                "name": "getResourceInfo",\n                "parameters": [\n                    { "name": "resourceId", "$ref": "ResourceId" }\n                ],\n                "returns": [\n                    { "name": "resourceInfo", "$ref": "ResourceInfo" }\n                ]\n            },\n            {\n                "name": "getResourceState",\n                "parameters": [\n                    { "name": "traceLogId", "$ref": "TraceLogId" },\n                    { "name": "resourceId", "$ref": "ResourceId" }\n                ],\n                "returns": [\n                    { "name": "resourceState", "$ref": "ResourceState" }\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "contextCreated",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "description": "Identifier of the frame containing a canvas with a context." }\n                ],\n                "description": "Fired when a canvas context has been created in the given frame. The context may not be instrumented (see hasUninstrumentedCanvases command)."\n            },\n            {\n                "name": "traceLogsRemoved",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Network.FrameId", "optional": true, "description": "If given, trace logs from the given frame were removed." },\n                    { "name": "traceLogId", "$ref": "TraceLogId", "optional": true, "description": "If given, trace log with the given ID was removed." }\n                ],\n                "description": "Fired when a set of trace logs were removed from the backend. If no parameters are given, all trace logs were removed."\n            }\n        ]\n    },\n    {\n        "domain": "Input",\n        "hidden": true,\n        "types": [],\n        "commands": [\n            {\n                "name": "dispatchKeyEvent",\n                "parameters": [\n                    { "name": "type", "type": "string", "enum": ["keyDown", "keyUp", "rawKeyDown", "char"], "description": "Type of the key event." },\n                    { "name": "modifiers", "type": "integer", "optional": true, "description": "Bit field representing pressed modifier keys. Alt=1, Ctrl=2, Meta/Command=4, Shift=8 (default: 0)." },\n                    { "name": "timestamp", "type": "number", "optional": true, "description": "Time at which the event occurred. Measured in UTC time in seconds since January 1, 1970 (default: current time)." },\n                    { "name": "text", "type": "string", "optional": true, "description": "Text as generated by processing a virtual key code with a keyboard layout. Not needed for for <code>keyUp</code> and <code>rawKeyDown</code> events (default: \\"\\")" },\n                    { "name": "unmodifiedText", "type": "string", "optional": true, "description": "Text that would have been generated by the keyboard if no modifiers were pressed (except for shift). Useful for shortcut (accelerator) key handling (default: \\"\\")." },\n                    { "name": "keyIdentifier", "type": "string", "optional": true, "description": "Unique key identifier (e.g., \'U+0041\') (default: \\"\\")." },\n                    { "name": "windowsVirtualKeyCode", "type": "integer", "optional": true, "description": "Windows virtual key code (default: 0)." },\n                    { "name": "nativeVirtualKeyCode", "type": "integer", "optional": true, "description": "Native virtual key code (default: 0)." },\n                    { "name": "macCharCode", "type": "integer", "optional": true, "description": "Mac character code (default: 0)." },\n                    { "name": "autoRepeat", "type": "boolean", "optional": true, "description": "Whether the event was generated from auto repeat (default: false)." },\n                    { "name": "isKeypad", "type": "boolean", "optional": true, "description": "Whether the event was generated from the keypad (default: false)." },\n                    { "name": "isSystemKey", "type": "boolean", "optional": true, "description": "Whether the event was a system key event (default: false)." }\n                ],\n                "description": "Dispatches a key event to the page."\n            },\n            {\n                "name": "dispatchMouseEvent",\n                "parameters": [\n                    { "name": "type", "type": "string", "enum": ["mousePressed", "mouseReleased", "mouseMoved"], "description": "Type of the mouse event." },\n                    { "name": "x", "type": "integer", "description": "X coordinate of the event relative to the main frame\'s viewport."},\n                    { "name": "y", "type": "integer", "description": "Y coordinate of the event relative to the main frame\'s viewport. 0 refers to the top of the viewport and Y increases as it proceeds towards the bottom of the viewport."},\n                    { "name": "modifiers", "type": "integer", "optional": true, "description": "Bit field representing pressed modifier keys. Alt=1, Ctrl=2, Meta/Command=4, Shift=8 (default: 0)." },\n                    { "name": "timestamp", "type": "number", "optional": true, "description": "Time at which the event occurred. Measured in UTC time in seconds since January 1, 1970 (default: current time)." },\n                    { "name": "button", "type": "string", "enum": ["none", "left", "middle", "right"], "optional": true, "description": "Mouse button (default: \\"none\\")." },\n                    { "name": "clickCount", "type": "integer", "optional": true, "description": "Number of times the mouse button was clicked (default: 0)." }\n                ],\n                "description": "Dispatches a mouse event to the page."\n            }\n        ],\n        "events": []\n    },\n    {\n        "domain": "LayerTree",\n        "hidden": true,\n        "types": [\n            {\n                "id": "LayerId",\n                "type": "string",\n                "description": "Unique RenderLayer identifier."\n            },\n            {\n                "id": "IntRect",\n                "type": "object",\n                "description": "A rectangle.",\n                "properties": [\n                    { "name": "x", "type": "integer", "description": "The x position." },\n                    { "name": "y", "type": "integer", "description": "The y position." },\n                    { "name": "width", "type": "integer", "description": "The width metric." },\n                    { "name": "height", "type": "integer", "description": "The height metric." }\n                ]\n            },\n            {\n                "id": "Layer",\n                "type": "object",\n                "description": "Information about a compositing layer.",\n                "properties": [\n                    { "name": "layerId", "$ref": "LayerId", "description": "The unique id for this layer." },\n                    { "name": "bounds", "$ref": "IntRect", "description": "Bounds of the layer." },\n                    { "name": "isComposited", "type": "boolean", "description": "Indicates whether this layer is composited." },\n                    { "name": "paintCount", "type": "integer", "optional": true, "description": "Indicates how many time this layer has painted." },\n                    { "name": "memory", "type": "integer", "optional": true, "description": "Estimated memory used by this layer." },\n                    { "name": "compositedBounds", "$ref": "IntRect", "optional": true, "description": "The bounds of the composited layer." },\n                    { "name": "childLayers", "type": "array", "optional": true, "items": { "$ref": "Layer" }, "description": "Child layers." }\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables compositing tree inspection."\n            },\n            {\n                "name": "disable",\n                "description": "Disables compositing tree inspection."\n            },\n            {\n                "name": "getLayerTree",\n                "description": "Returns the layer tree structure of the current page.",\n                "returns": [\n                    { "name": "layerTree", "$ref": "Layer", "description": "Layer tree structure of the current page." }\n                ]\n            },\n            {\n                "name": "nodeIdForLayerId",\n                "description": "Returns the node id for a given layer id.",\n                "parameters": [\n                    { "name": "layerId", "$ref": "LayerId" }\n                ],\n                "returns": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId", "description": "The node id for the given layer id." }\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "layerTreeDidChange"\n            }\n        ]\n    }]\n}\n'}),define("LiveDevelopment/Inspector/Inspector",["require","exports","module","utils/Async","text!LiveDevelopment/Inspector/Inspector.json"],function(t,n,r){function c(e,t){return t===undefined&&console.assert(e.optional===!0,"Missing argument: "+e.name),!0}function h(e,t,n){if(!a)return console.log("You must connect to the WebSocket before sending messages."),(new $.Deferred).reject().promise();var r,i,s,f,l={},h,p;s=Array.prototype.slice.call(arguments,2);if(typeof s[s.length-1]=="function")i=s.pop();else{var d=new $.Deferred;h=d.promise(),i=function(e,t){t?d.reject(t):d.resolve(e)}}r=u++;if(t)for(f in t)c(s[f],t[f])&&(l[t[f].name]=s[f]);return p={method:e,id:r,params:l},o[r]={callback:i,message:p},a.send(JSON.stringify(p)),h}function p(e,t,n){return h(e+"."+t,null,n)}function d(){a=undefined,s.triggerHandler("disconnect")}function v(e){f&&(f.reject(),f=null),s.triggerHandler("error",[e])}function m(){f&&(f.resolve(),f=null),s.triggerHandler("connect")}function g(e){var t=JSON.parse(e.data),r=o[t.id],i=r&&r.callback,u=r&&r.message||"No message";if(r)i(t.result,t.error),delete o[t.id];else if(t.method){var a=t.method.split("."),f=a[0],l=a[1];$(n[f]).triggerHandler(l,t.params)}s.triggerHandler("message",[t]),t.error&&s.triggerHandler("error",[t.error,u])}function y(e,t){e||(e="127.0.0.1"),t||(t=9222);var n=new $.Deferred,r=new XMLHttpRequest;return r.open("GET","http://"+e+":"+t+"/json"),r.onload=function(){var t=JSON.parse(r.response);n.resolve(t)},r.onerror=function(){n.reject(r.response)},r.send(null),n.promise()}function b(e,t){s.on(e,t)}function w(e,t){s.off(e,t)}function E(){var e=new $.Deferred,t=e.promise();return a&&a.readyState===WebSocket.OPEN?(a.onclose=function(){d(),e.resolve()},t=i.withTimeout(t,5e3),a.close()):(a&&(delete a.onmessage,delete a.onopen,delete a.onclose,delete a.onerror,a=undefined),e.resolve()),t}function S(e){E().done(function(){a=new WebSocket(e),a.onmessage=g,a.onopen=m,a.onclose=d,a.onerror=v})}function x(e){f&&f.reject("CANCEL");var t=new $.Deferred;f=t;var n=y();return n.done(function(r){var i,s;for(i in r){s=r[i];if(s.webSocketDebuggerUrl&&s.url.indexOf(e)===0){S(s.webSocketDebuggerUrl);return}}t.reject(FileError.ERR_NOT_FOUND)}),n.fail(function(n){t.reject(n)}),t.promise()}function T(){return a!==undefined&&a.readyState===WebSocket.OPEN}function N(){return l}function C(e){l=e}function k(e){n.config=e;var r=t("text!LiveDevelopment/Inspector/Inspector.json"),i=JSON.parse(r),s,o,u,a,f;for(s in i.domains){u=i.domains[s],n[u.domain]={};for(o in u.commands)f=u.commands[o],n[u.domain][f.name]=h.bind(undefined,u.domain+"."+f.name,f.parameters)}}var i=t("utils/Async"),s=$(n),o={},u=1,a,f,l="";n.connect=S,n.connected=T,n.connectToURL=x,n.disconnect=E,n.getDebuggableWindows=y,n.getUserAgent=N,n.init=k,n.off=w,n.on=b,n.send=p,n.setUserAgent=C}),define("text!widgets/StatusBar.html",[],function(){return'<div id="status-bar" class="statusbar no-focus">\n    <div id="status-info" class="info" >\n        <div id="status-cursor"></div>\n        <div id="status-file"></div>\n    </div>\n    <div id="status-indicators" class="indicators">\n        <div id="status-indent">\n            <div id="indent-type"></div>\n            <div id="indent-width-label"></div>\n            <input id="indent-width-input" type="number" min="1" max="10" maxlength="2" size="2" class="hidden">\n        </div>\n        <div id="status-language"></div>\n        <div id="status-overwrite">{{STATUSBAR_INSERT}}</div>\n        <div class="spinner"></div>\n    </div>\n</div>\n'}),define("widgets/StatusBar",["require","exports","module","utils/AppInit","text!widgets/StatusBar.html","editor/EditorManager","strings"],function(e,t,n){function d(e){if(!u){console.error("StatusBar API invoked before status bar created");return}e&&(a=!0,$("*").addClass("busyCursor")),p.addClass("spin")}function v(){if(!u){console.error("StatusBar API invoked before status bar created");return}a&&(a=!1,$("*").removeClass("busyCursor")),p.removeClass("spin")}function m(e,t,n,r,i,s){if(!u){console.error("StatusBar API invoked before status bar created");return}t=t||document.createElement("div"),i=i||"",r=r||"",e=e.replace(f,"-")||"";var o=$(t);o.attr("id",e),o.attr("title",i),o.addClass("indicator"),o.addClass(r),n||o.hide();if(s&&$("#"+s).length>0)o.insertAfter("#"+s);else{var a=$("#status-bar .spinner");o.insertBefore(a)}}function g(e,t,n,r){if(!u){console.error("StatusBar API invoked before status bar created");return}var i=$("#"+e.replace(f,"-"));i&&(t?i.show():i.hide(),n?(i.removeClass(),i.addClass(n)):(i.removeClass(),i.addClass("indicator")),r&&i.attr("title",r))}function y(){if(!u){console.error("StatusBar API invoked before status bar created");return}c.is(":visible")&&(c.hide(),s.resizeEditor())}function b(){if(!u){console.error("StatusBar API invoked before status bar created");return}c.is(":visible")||(c.show(),s.resizeEditor())}var r=e("utils/AppInit"),i=e("text!widgets/StatusBar.html"),s=e("editor/EditorManager"),o=e("strings"),u=!1,a=!1,f=new RegExp("[^a-zA-Z 0-9]+","g"),l,c,h,p;r.htmlReady(function(){var e=$(".main-view .content");e.append(Mustache.render(i,o)),c=$("#status-bar"),h=$("#status-indicators"),p=$("#status-bar .spinner"),u=!0,y()}),t.showBusyIndicator=d,t.hideBusyIndicator=v,t.addIndicator=m,t.updateIndicator=g,t.hide=y,t.show=b}),define("document/DocumentCommandHandlers",["require","exports","module","thirdparty/lodash","utils/AppInit","command/CommandManager","command/Commands","project/ProjectManager","document/DocumentManager","editor/EditorManager","filesystem/FileSystem","filesystem/FileSystemError","file/FileUtils","project/FileViewController","document/InMemoryFile","utils/StringUtils","utils/Async","widgets/Dialogs","widgets/DefaultDialogs","strings","widgets/PopUpManager","preferences/PreferencesManager","utils/DragAndDrop","utils/PerfUtils","utils/KeyEvent","language/LanguageManager","LiveDevelopment/Inspector/Inspector","command/Menus","utils/UrlParams","widgets/StatusBar"],function(e,t,n){function R(){var e=a.getCurrentDocument(),t=f.getCurrentlyViewedPath(),n=brackets.config.app_title;if(!brackets.nativeMenus){t?(O.text(D),O.attr("title",t),e?M.css("visibility",e.isDirty?"visible":"hidden"):M.css("visibility","hidden")):(O.text(""),O.attr("title",""),M.css("visibility","hidden")),_.css("width","");var r=O.width();_.css("width",r);var i=H.height();B!==i&&(B=i,f.resizeEditor())}t&&(n=v.format(P,D,n)),e?n=e.isDirty?"• "+n:n:M.css("visibility","hidden"),window.document.title=n}function U(e){var t=e.file.fullPath;return e.isUntitled()?t.substring(t.lastIndexOf("/")+1):u.makeProjectRelativeIfPossible(t)}function z(){var e=a.getCurrentDocument();if(e)D=U(e);else{var t=f.getCurrentlyViewedPath();t?D=u.makeProjectRelativeIfPossible(t):D=null}R()}function W(e,t){var n=a.getCurrentDocument();n&&t.file.fullPath===n.file.fullPath&&R()}function X(e,t){function r(e){!e||f.showingCustomViewerForPath(e)?f.notifyPathDeleted(e):(a.removeFromWorkingSet(l.getFileForPath(e)),f.focusEditor()),n.reject()}function i(e,n){t?r(n):h.showFileOpenError(e,n).done(function(){r(n)})}var n=new $.Deferred;if(f.getCurrentlyViewedPath()===e)return n.resolve(a.getCurrentDocument()),n.promise();if(!e)console.error("doOpen() called without fullPath"),n.reject();else{var s=x.markStart("Open File:	"+e);n.always(function(){x.addMeasurement(s)});var o=f.getCustomViewerForPath(e);if(o){var u=l.getFileForPath(e);u.exists(function(t,r){r?(f._showCustomViewer(o,e),n.resolve()):(t=t||c.NOT_FOUND,i(t))})}else a.getDocumentForPath(e).done(function(e){a.setCurrentDocument(e),n.resolve(e)}).fail(function(t){i(t,e)})}return n.promise()}function J(e,t){var n;return e?n=X(e,t):(n=new $.Deferred,V||(V=u.getProjectRoot().fullPath),l.showOpenDialog(!0,!1,b.OPEN_FILE,V,null,function(e,r){if(!e)if(r.length>0){var i=[],s=S.filterFilesToOpen(r);s.forEach(function(e){i.push(l.getFileForPath(e))}),a.addListToWorkingSet(i),X(s[s.length-1],t).done(function(e){e&&a.addToWorkingSet(e.file),V=h.getDirectoryPath(f.getCurrentlyViewedPath())}).then(n.resolve,n.reject)}else n.reject()})),n.promise()}function K(e){var t={path:e,line:null,column:null};if(e){var n=/(.+?):([0-9]+)(:([0-9]+))?$/.exec(e);n&&(t.path=n[1],n[2]&&(t.line=parseInt(n[2],10)),n[4]&&(t.column=parseInt(n[4],10)))}return t}function Q(e){var t=K(e?e.fullPath:null),n=e?e.silent:!1;return J(t.path,n).always(function(){if(t.line!==null){if(t.column===null||t.column<=0)t.column=1;f.getCurrentFullEditor().setCursorPos(t.line-1,t.column-1,!0)}f.focusEditor()})}function G(e){return Q(e).done(function(t){t&&a.addToWorkingSet(t.file,e.index,e.forceRedraw)})}function Y(e,t,n){var r=t+"-"+j++,i=$.Deferred();if(j>9999)i.reject();else{var s=e.fullPath+r,o=n?l.getDirectoryForPath(s):l.getFileForPath(s);o.exists(function(s,o){s||o?Y(e,t,n).then(i.resolve,i.reject):i.resolve(r)})}return i.promise()}function et(e){function r(n){return u.createNewItem(t,n,!1,e).always(function(){Z=!1})}if(Z){u.forceFinishRename();return}Z=!0;var t,n=u.getSelectedItem();if(!n||n instanceof d)n=u.getProjectRoot();return n.isFile&&(t=l.getDirectoryForPath(n.parentPath)),t=t||n,Y(t,b.UNTITLED,e).then(r,r.bind(undefined,b.UNTITLED))}function tt(){var e="",t=a.createUntitledDocument(j++,e);return a.setCurrentDocument(t),f.focusEditor(),(new $.Deferred).resolve(t).promise()}function nt(){et(!1)}function rt(){et(!0)}function it(e,t){return g.showModalDialog(y.DIALOG_ID_ERROR,b.ERROR_SAVING_FILE_TITLE,v.format(b.ERROR_SAVING_FILE,v.breakableUrl(t),h.getFileErrorString(e)))}function st(e,t){function i(e){it(e,r.fullPath).done(function(){n.reject(e)})}function s(){g.showModalDialog(y.DIALOG_ID_ERROR,b.EXT_MODIFIED_TITLE,v.format(b.EXT_MODIFIED_WARNING,v.breakableUrl(e.file.fullPath)),[{className:g.DIALOG_BTN_CLASS_LEFT,id:g.DIALOG_BTN_SAVE_AS,text:b.SAVE_AS},{className:g.DIALOG_BTN_CLASS_NORMAL,id:g.DIALOG_BTN_CANCEL,text:b.CANCEL},{className:g.DIALOG_BTN_CLASS_PRIMARY,id:g.DIALOG_BTN_OK,text:b.SAVE_AND_OVERWRITE}]).done(function(t){t===g.DIALOG_BTN_CANCEL?n.reject():t===g.DIALOG_BTN_OK?st(e,!0).then(n.resolve,n.reject):t===g.DIALOG_BTN_SAVE_AS&&q({doc:e}).then(n.resolve,n.reject)})}function o(){h.writeText(r,e.getText(!0),t).done(function(){e.notifySaved(),n.resolve(r)}).fail(function(e){e===c.CONTENTS_MODIFIED?s():i(e)})}var n=new $.Deferred,r=e.file;if(e.isDirty){var u=!1;e.keepChangesTime?e.file.stat(function(n,r){!n&&e.keepChangesTime===r.mtime.getTime()&&(t=!0),o()}):o()}else n.resolve(r);return n.always(function(){f.focusEditor()}),n.promise()}function ot(e,t){var n=new $.Deferred;return h.readAsText(e.file).done(function(t,r){e.refreshText(t,r),n.resolve()}).fail(function(r){t?n.resolve():h.showFileOpenError(r,e.file.fullPath).done(function(){n.reject(r)})}),n.promise()}function ut(e,t){function o(r){function o(){var e=f.getActiveEditor();e&&t&&(e.setSelections(t.selections),e.setScrollPos(t.scrollPos.x,t.scrollPos.y)),s.resolve(i)}function u(){var t;if(p.getFileSelectionFocus()===p.PROJECT_MANAGER)t=p.openAndSelectDocument(r,p.PROJECT_MANAGER);else{var n=a.findInWorkingSet(e.file.fullPath);a.removeFromWorkingSet(e.file,!0),t=G({fullPath:r,index:n,forceRedraw:!0})}t.always(function(){o()})}var i;if(r===n){st(e).then(s.resolve,s.reject);return}e.isSaving=!0,i=l.getFileForPath(r),h.writeText(i,e.getText(),!0).done(function(){e.isDirty&&!e.isUntitled()?ot(e).always(u):u()}).fail(function(e){it(e,r).done(function(){s.reject(e)})}).always(function(){e.isSaving=!1})}var n,r,i,s=new $.Deferred;return e?(n=e.file.fullPath,e.isUntitled()?(a.setCurrentDocument(e),r=u.getProjectRoot().fullPath):r=h.getDirectoryPath(n),i=h.getBaseName(n),l.showSaveDialog(b.SAVE_FILE_AS,r,i,function(e,t){e?s.reject(e):t?o(t):s.reject(I)})):s.reject(),s.promise()}function at(e){var t=f.getActiveEditor(),n=t&&t.document,r=e&&e.doc||n,i;return r&&!r.isSaving?r.isUntitled()?(r===n&&(i={selections:t.getSelections(),scrollPos:t.getScrollPos()}),ut(r,i)):st(r):$.Deferred().reject().promise()}function ft(e){var t=!1,n=[];return m.doSequentially(e,function(e){if(t)return(new $.Deferred).reject().promise();var r=a.getOpenDocumentForPath(e.fullPath);if(r){var i=at({doc:r});return i.done(function(e){n.push(e)}).fail(function(e){e===I&&(t=!0)}),i}return n.push(e),(new $.Deferred).resolve().promise()},!1).then(function(){return n})}function lt(){return ft(a.getWorkingSet())}function ct(){return lt()}function ht(e){function i(e){n||(a.closeFullEditor(e),f.focusEditor())}function u(){if(!n){var e=a.getNextPrevFile(1);e?X(e.fullPath).always(function(){f.focusEditor(),s.resolve()}):(f._closeCustomViewer(),s.resolve())}}var t,n,r;e&&(t=e.file,n=e.promptOnly,r=e._forceClose);var s=new $.Deferred,o=s.promise();if(!a.getCurrentDocument())if(f.getCurrentlyViewedPath()&&!t||t&&t.fullPath===f.getCurrentlyViewedPath())return u(),o;!t&&a.getCurrentDocument()&&(t=a.getCurrentDocument().file);if(!t)return s.resolve(),o;var l=a.getOpenDocumentForPath(t.fullPath);if(l&&l.isDirty&&!r){var c=h.getBaseName(l.file.fullPath);g.showModalDialog(y.DIALOG_ID_SAVE_CLOSE,b.SAVE_CLOSE_TITLE,v.format(b.SAVE_CLOSE_MESSAGE,v.breakableUrl(c)),[{className:g.DIALOG_BTN_CLASS_LEFT,id:g.DIALOG_BTN_DONTSAVE,text:b.DONT_SAVE},{className:g.DIALOG_BTN_CLASS_NORMAL,id:g.DIALOG_BTN_CANCEL,text:b.CANCEL},{className:g.DIALOG_BTN_CLASS_PRIMARY,id:g.DIALOG_BTN_OK,text:b.SAVE}]).done(function(e){if(e===g.DIALOG_BTN_CANCEL)s.reject();else if(e===g.DIALOG_BTN_OK)at({doc:l}).done(function(e){i(e),s.resolve()}).fail(function(){s.reject()});else{i(t);if(n)s.resolve();else{var r=!a.getOpenDocumentForPath(t.fullPath);ot(l,r).then(s.resolve,s.reject)}}}),s.always(function(){f.focusEditor()})}else i(t),f.focusEditor(),s.resolve();return o}function pt(e,t,n,i){var s=new $.Deferred,o=[];e.forEach(function(e){var t=a.getOpenDocumentForPath(e.fullPath);t&&t.isDirty&&o.push(t)});if(o.length===0||i)s.resolve();else if(o.length===1){var u={file:o[0].file,promptOnly:t};ht(u).done(function(){s.resolve()}).fail(function(){s.reject()})}else{var f=b.SAVE_CLOSE_MULTI_MESSAGE+h.makeDialogFileList(r.map(o,U));g.showModalDialog(y.DIALOG_ID_SAVE_CLOSE,b.SAVE_CLOSE_TITLE,f,[{className:g.DIALOG_BTN_CLASS_LEFT,id:g.DIALOG_BTN_DONTSAVE,text:b.DONT_SAVE},{className:g.DIALOG_BTN_CLASS_NORMAL,id:g.DIALOG_BTN_CANCEL,text:b.CANCEL},{className:g.DIALOG_BTN_CLASS_PRIMARY,id:g.DIALOG_BTN_OK,text:b.SAVE}]).done(function(t){t===g.DIALOG_BTN_CANCEL?s.reject():t===g.DIALOG_BTN_OK?ft(e).done(function(e){s.resolve(e)}).fail(function(){s.reject()}):s.resolve()})}return s.done(function(r){r=r||e,t||a.removeListFromWorkingSet(r,n)}),s.promise()}function dt(e){return pt(a.getWorkingSet(),e&&e.promptOnly,!0,e&&e._forceClose).done(function(){a.getCurrentDocument()||f._closeCustomViewer()})}function vt(e){return pt(e.fileList,!1,!1).done(function(){a.getCurrentDocument()||f._closeCustomViewer()})}function gt(e,t,n){return mt?(new $.Deferred).reject().promise():s.execute(o.FILE_CLOSE_ALL,{promptOnly:!0}).done(function(){mt=!0;try{$(u).triggerHandler("beforeAppClose")}catch(e){console.error(e)}E.savePreferences(),E.finalize().always(t)}).fail(function(){mt=!1,n&&n()})}function yt(){mt=!1}function bt(){$(w).triggerHandler("beforeMenuPopup")}function wt(e){return gt(e,function(){window.close()},function(){brackets.app.abortQuit()})}function Et(){var e=u.getSelectedItem();if(!e){var t=a.getCurrentDocument();e=t&&t.file}e&&u.renameItemInline(e)}function St(e){return gt(e,function(){brackets.app.quit()},function(){brackets.app.abortQuit()})}function Tt(e){e.keyCode===T.DOM_VK_CONTROL&&(a.finalizeDocumentNavigation(),xt=!1,$(window.document.body).off("keyup",Tt))}function Nt(e){var t=a.getNextPrevFile(e);t&&(a.beginDocumentNavigation(),s.execute(o.FILE_OPEN,{fullPath:t.fullPath}),xt||(xt=!0,$(window.document.body).keyup(Tt)))}function Ct(){Nt(1)}function kt(){Nt(-1)}function Lt(){u.showInTree(a.getCurrentDocument().file)}function At(){var e=u.getSelectedItem();e.isDirectory?g.showModalDialog(y.DIALOG_ID_EXT_DELETED,b.CONFIRM_FOLDER_DELETE_TITLE,v.format(b.CONFIRM_FOLDER_DELETE,v.breakableUrl(e.name)),[{className:g.DIALOG_BTN_CLASS_NORMAL,id:g.DIALOG_BTN_CANCEL,text:b.CANCEL},{className:g.DIALOG_BTN_CLASS_PRIMARY,id:g.DIALOG_BTN_OK,text:b.DELETE}]).done(function(t){t===g.DIALOG_BTN_OK&&u.deleteItem(e)}):u.deleteItem(e)}function Ot(){var e=u.getSelectedItem();e&&brackets.app.showOSFolder(e.fullPath,function(t){t&&console.error("Error showing '"+e.fullPath+"' in OS folder:",t)})}function Mt(){var e=new $.Deferred;if(brackets.inBrowser)e.resolve();else{var t=brackets.app.getRemoteDebuggingPort?brackets.app.getRemoteDebuggingPort():9234;C.getDebuggableWindows("127.0.0.1",t).fail(e.reject).done(function(t){var n=t[0];if(!n||!n.webSocketDebuggerUrl){e.reject();return}var r=new WebSocket(n.webSocketDebuggerUrl);r.onopen=function(){r.send(JSON.stringify({id:1,method:"Network.setCacheDisabled",params:{cacheDisabled:!0}}))},r.onmessage=function(n){r.close(),e.resolve()},r.onerror=e.reject})}return e.promise()}function _t(e){if(F)return;return F=!0,s.execute(o.FILE_CLOSE_ALL,{promptOnly:!0}).done(function(){try{$(u).triggerHandler("beforeAppClose")}catch(t){console.error(t)}Mt().always(function(){r.forEach(k.getAllMenus(),function(e,t){k.removeMenu(t)});var t=e.indexOf("#");t!==-1&&(e=e.substr(0,t)),window.location.href=e})}).fail(function(){F=!1})}function Dt(){var e=window.location.href,t=new L;t.parse(),t.get("reloadWithoutUserExts")&&t.remove("reloadWithoutUserExts"),e.indexOf("?")!==-1&&(e=e.substring(0,e.indexOf("?"))),t.isEmpty()||(e+="?"+t.toString()),window.setTimeout(function(){_t(e)},100)}function Pt(){var e=window.location.href,t=new L;t.parse(),t.get("reloadWithoutUserExts")||t.put("reloadWithoutUserExts",!0),e.indexOf("?")!==-1&&(e=e.substring(0,e.indexOf("?"))),e+="?"+t.toString(),window.setTimeout(function(){_t(e)},100)}var r=e("thirdparty/lodash"),i=e("utils/AppInit"),s=e("command/CommandManager"),o=e("command/Commands"),u=e("project/ProjectManager"),a=e("document/DocumentManager"),f=e("editor/EditorManager"),l=e("filesystem/FileSystem"),c=e("filesystem/FileSystemError"),h=e("file/FileUtils"),p=e("project/FileViewController"),d=e("document/InMemoryFile"),v=e("utils/StringUtils"),m=e("utils/Async"),g=e("widgets/Dialogs"),y=e("widgets/DefaultDialogs"),b=e("strings"),w=e("widgets/PopUpManager"),E=e("preferences/PreferencesManager"),S=e("utils/DragAndDrop"),x=e("utils/PerfUtils"),T=e("utils/KeyEvent"),N=e("language/LanguageManager"),C=e("LiveDevelopment/Inspector/Inspector"),k=e("command/Menus"),L=e("utils/UrlParams").UrlParams,A=e("widgets/StatusBar"),O=null,M=null,_=null,D=null,P=brackets.platform!=="mac"?"{0} - {1}":"{0} — {1}",H=null,B=null,j=1,F=!1,I={userCanceled:!0};E.definePreference("defaultExtension","string","");var q,V=null,Z=!1;q=function(e){var t=null,n;if(e)t=e.doc;else{var r=f.getActiveEditor();r&&(t=r.document,n={},n.selections=r.getSelections(),n.scrollPos=r.getScrollPos())}return ut(t,n)};var mt=!1,xt=!1;i.htmlReady(function(){var e=new L,t=$("#toolbar-extension-manager"),n=$("<div>"+b.STATUSBAR_USER_EXTENSIONS_DISABLED+"</div>");e.parse(),e.get("reloadWithoutUserExts")==="true"&&(s.get(o.FILE_EXTENSION_MANAGER).setEnabled(!1),t.css({display:"none"}),A.addIndicator("status-user-exts",n,!0),console.log("Brackets reloaded with extensions disabled")),H=$("#titlebar"),_=$(".title-wrapper",H),O=$(".title",_),M=$(".dirty-dot",_)}),t._parseDecoratedPath=K;var Ht=b.CMD_QUIT,Bt=b.CMD_SHOW_IN_OS;brackets.platform==="win"?(Ht=b.CMD_EXIT,Bt=b.CMD_SHOW_IN_EXPLORER):brackets.platform==="mac"&&(Bt=b.CMD_SHOW_IN_FINDER),s.register(b.CMD_FILE_OPEN,o.FILE_OPEN,Q),s.register(b.CMD_ADD_TO_WORKING_SET,o.FILE_ADD_TO_WORKING_SET,G),s.register(b.CMD_FILE_NEW_UNTITLED,o.FILE_NEW_UNTITLED,tt),s.register(b.CMD_FILE_NEW,o.FILE_NEW,nt),s.register(b.CMD_FILE_NEW_FOLDER,o.FILE_NEW_FOLDER,rt),s.register(b.CMD_FILE_SAVE,o.FILE_SAVE,at),s.register(b.CMD_FILE_SAVE_ALL,o.FILE_SAVE_ALL,ct),s.register(b.CMD_FILE_SAVE_AS,o.FILE_SAVE_AS,q),s.register(b.CMD_FILE_RENAME,o.FILE_RENAME,Et),s.register(b.CMD_FILE_DELETE,o.FILE_DELETE,At),s.register(b.CMD_FILE_CLOSE,o.FILE_CLOSE,ht),s.register(b.CMD_FILE_CLOSE_ALL,o.FILE_CLOSE_ALL,dt),s.register(b.CMD_FILE_CLOSE_LIST,o.FILE_CLOSE_LIST,vt),s.register(Ht,o.FILE_QUIT,St),s.register(b.CMD_NEXT_DOC,o.NAVIGATE_NEXT_DOC,Ct),s.register(b.CMD_PREV_DOC,o.NAVIGATE_PREV_DOC,kt),s.register(b.CMD_SHOW_IN_TREE,o.NAVIGATE_SHOW_IN_FILE_TREE,Lt),s.register(Bt,o.NAVIGATE_SHOW_IN_OS,Ot),s.registerInternal(o.APP_ABORT_QUIT,yt),s.registerInternal(o.APP_BEFORE_MENUPOPUP,bt),s.registerInternal(o.FILE_CLOSE_WINDOW,wt),s.registerInternal(o.APP_RELOAD,Dt),s.registerInternal(o.APP_RELOAD_WITHOUT_EXTS,Pt),$(a).on("dirtyFlagChange",W),$(a).on("fileNameChange",z),$(f).on("currentlyViewedFileChange",z),$(u).on("beforeProjectClose",function(){j=1})}),define("text!htmlContent/code-hint-list.html",[],function(){return'{{#hints}}\n    <li>\n        <a href="#">\n            <span class="codehint-item">{{{formattedHint}}}</span>\n        </a>\n    </li>\n{{/hints}}'}),define("editor/CodeHintList",["require","exports","module","command/Menus","utils/StringUtils","widgets/PopUpManager","utils/ViewUtils","command/KeyBindingManager","utils/KeyEvent","text!htmlContent/code-hint-list.html"],function(e,t,n){function l(e,t){this.hints=[],this.selectedIndex=-1,this.maxResults=999,this.opened=!1,this.editor=e,this.insertHintOnTab=t,this.pendingText="",this.handleSelect=null,this.handleClose=null,this.$hintMenu=$("<li class='dropdown codehint-menu'></li>").append($("<a href='#' class='dropdown-toggle' data-toggle='dropdown'></a>").hide()).append("<ul class='dropdown-menu'></ul>"),this._keydownHook=this._keydownHook.bind(this)}var r=e("command/Menus"),i=e("utils/StringUtils"),s=e("widgets/PopUpManager"),o=e("utils/ViewUtils"),u=e("command/KeyBindingManager"),a=e("utils/KeyEvent"),f=e("text!htmlContent/code-hint-list.html");l.prototype._setSelectedIndex=function(e){var t=this.$hintMenu.find("li");e=Math.max(-1,Math.min(e,t.length-1)),this.selectedIndex!==-1&&$(t[this.selectedIndex]).find("a").removeClass("highlight"),this.selectedIndex=e;if(this.selectedIndex!==-1){var n=$(t[this.selectedIndex]),r=this.$hintMenu.find("ul.dropdown-menu");n.find("a").addClass("highlight"),o.scrollElementIntoView(r,n,!1)}},l.prototype.addPendingText=function(e){this.pendingText+=e},l.prototype.removePendingText=function(e){this.pendingText.indexOf(e)===0&&(this.pendingText=this.pendingText.slice(e.length))},l.prototype._buildListView=function(e){var t=this,n=e.match,r=e.selectInitial,s={hints:[]},o;this.hints=e.hints,this.hints.handleWideResults=e.handleWideResults,n?o=function(e){var t=e.replace(new RegExp(i.regexEscape(n),"i"),"<strong>$&</strong>");s.hints.push({formattedHint:"<span>"+t+"</span>"})}:o=function(e){s.hints.push({formattedHint:e.jquery?"":e})},this.$hintMenu.find("li").remove();if(this.hints.length===0)this.handleClose&&this.handleClose();else{this.hints.some(function(e,n){if(n>t.maxResults)return!0;o(e)});var u=this.$hintMenu.find("ul.dropdown-menu"),a=u.parent();u.remove().append(Mustache.render(f,s)),u.children("li").each(function(e,n){var r=t.hints[e],i=$(n);i.data("hint",r),r.jquery&&i.find(".codehint-item").append(r)}),u.on("click","li",function(e){e.stopPropagation(),t.handleSelect&&t.handleSelect($(this).data("hint"))}),this.hints.handleWideResults&&u.find("li a").addClass("wide-result"),a.append(u),this._setSelectedIndex(r?0:-1)}},l.prototype._calcHintListLocation=function(){var e=this.editor._codeMirror.cursorCoords(),t=e.bottom,n=e.left,r=this.editor.getTextHeight(),i=$(window),s=this.$hintMenu.children("ul"),o=s.outerHeight(),u=t+o-i.height();u>0&&(t-=r+2+o),t-=30;var a=s.width(),f=a,l=n+a-i.width();return l>0?n=Math.max(0,n-l):this.hints.handleWideResults&&(f=a+Math.abs(l)),{left:n,top:t,width:f}},l.prototype.isHandlingKeyCode=function(e){return e===a.DOM_VK_UP||e===a.DOM_VK_DOWN||e===a.DOM_VK_PAGE_UP||e===a.DOM_VK_PAGE_DOWN||e===a.DOM_VK_RETURN||e===a.DOM_VK_TAB&&this.insertHintOnTab},l.prototype._keydownHook=function(e){function r(e){var t=Math.min(n.hints.length,n.maxResults),r;n.selectedIndex<0?r=e>0?e-1:t-1:(r=n.selectedIndex,e>0?r===t-1?r=0:r=Math.min(r+e,t-1):r===0?r=t-1:r=Math.max(r+e,0)),n._setSelectedIndex(r)}function i(){var e=1,t=n.$hintMenu.find("li"),r=n.$hintMenu.find("ul.dropdown-menu"),i;return t.length!==0&&(i=$(t[0]).height(),i&&(e=Math.floor(r.height()/i),e=Math.max(1,Math.min(e,t.length)))),e}var t,n=this;if(!this.isOpen())return this.handleClose(),!1;if(e.type==="keydown"&&this.isHandlingKeyCode(e.keyCode)){t=e.keyCode;if(!e.shiftKey||e.keyCode!==a.DOM_VK_UP&&e.keyCode!==a.DOM_VK_DOWN&&e.keyCode!==a.DOM_VK_PAGE_UP&&e.keyCode!==a.DOM_VK_PAGE_DOWN){if(t===a.DOM_VK_UP)r.call(this,-1);else if(t===a.DOM_VK_DOWN)r.call(this,1);else if(t===a.DOM_VK_PAGE_UP)r.call(this,-i());else if(t===a.DOM_VK_PAGE_DOWN)r.call(this,i());else{if(this.selectedIndex===-1||!(t===a.DOM_VK_RETURN||t===a.DOM_VK_TAB&&this.insertHintOnTab))return!1;if(this.pendingText)return!1;$(this.$hintMenu.find("li")[this.selectedIndex]).trigger("click")}return e.stopImmediatePropagation(),e.preventDefault(),!0}return this.handleClose(),!1}return!1},l.prototype.isOpen=function(){return this.opened&&!this.$hintMenu.hasClass("open")&&(this.opened=!1),this.opened},l.prototype.open=function(e){r.closeAll(),this._buildListView(e);if(this.hints.length){$("#codehint-menu-bar > ul").append(this.$hintMenu);var t=this._calcHintListLocation();this.$hintMenu.addClass("open").css({left:t.left,top:t.top,width:t.width+"px"}),this.opened=!0,s.addPopUp(this.$hintMenu,this.handleClose,!0),u.addGlobalKeydownHook(this._keydownHook)}},l.prototype.update=function(e){this.$hintMenu.addClass("apply-transition"),this._buildListView(e);if(this.hints.length){var t=this._calcHintListLocation();this.$hintMenu.css({left:t.left,top:t.top,width:t.width+"px"})}},l.prototype.close=function(){this.opened=!1,this.$hintMenu&&(this.$hintMenu.removeClass("open"),s.removePopUp(this.$hintMenu),this.$hintMenu.remove()),u.removeGlobalKeydownHook(this._keydownHook)},l.prototype.onSelect=function(e){this.handleSelect=e},l.prototype.onClose=function(e){this.handleClose=e},t.CodeHintList=l}),define("editor/CodeHintManager",["require","exports","module","command/Commands","command/CommandManager","editor/EditorManager","strings","utils/KeyEvent","editor/CodeHintList","preferences/PreferencesManager"],function(e,t,n){function y(e,t){return t.priority-e.priority}function b(e,t,n){var r={provider:e,priority:n||0};if(t.indexOf("all")!==-1){var i;for(i in l)l.hasOwnProperty(i)&&(l[i].push(r),l[i].sort(y))}else t.forEach(function(e){l[e]||(l[e]=Array.prototype.concat(l.all)),l[e].push(r),l[e].sort(y)})}function w(e,t){var n,r,i,s,o;Array.isArray(t)?o=t:t?o=[t]:o=Object.keys(l),o.forEach(function(t){s=l[t];for(i=0;i<s.length;i++)if(s[i].provider===e){s.splice(i,1);break}})}function E(e){var t=l[e]||l.all;return t.filter(function(e){var t="codehint."+e.provider.constructor.name;return f.get(t)!==!1})}function x(){if(!d)return;d.close(),d=null,m=null,h=null,p=null,v&&(v.reject(),v=null)}function T(e){if(p){if(p===e&&(d.isOpen()||v&&v.state()==="pending"))return!0;x()}return!1}function N(){v&&(v.reject(),v=null);var e=h.getHints(c);c=null;if(!e)x();else if(e===!0){var t=p;x(),S(t)}else e.hasOwnProperty("hints")?d.isOpen()?d.update(e):d.open(e):(v=e,e.done(function(e){if(!d)return;d.isOpen()?d.update(e):d.open(e)}))}function C(e){e||(e=s.getFocusedEditor()),e&&(c=null,T(e)&&x(),S(e))}function k(e,t,n){m=t,!(n.ctrlKey||n.altKey||n.metaKey)&&(n.keyCode===u.DOM_VK_ENTER||n.keyCode===u.DOM_VK_RETURN||n.keyCode===u.DOM_VK_TAB)&&(c=String.fromCharCode(n.keyCode))}function L(e,t,n){m=t,c=String.fromCharCode(n.charCode),d&&d.addPendingText(c)}function A(e,t,n){m=t,T(t)&&(n.keyCode===u.DOM_VK_HOME||n.keyCode===u.DOM_VK_END?x():(n.keyCode===u.DOM_VK_LEFT||n.keyCode===u.DOM_VK_RIGHT||n.keyCode===u.DOM_VK_BACK_SPACE)&&N())}function O(e,t){T(t)&&t.getSelections().length>1&&x()}function M(e,t,n){if(c&&t===m){m=null;if(T(t)){var r=c;N(),T(t)||(c=r,S(t))}else S(t);if(d&&n[0]&&n[0].text.length&&n[0].text[0].length){var i=t.getCursorPos().ch-n[0].from.ch,s=n[0].text[0];s.length>i&&(s=s.substr(0,i)),d.removePendingText(s)}}}function _(e,t){return e&&e===t}function D(){return d&&d.isOpen()}function P(){return d}function H(e,t,n){t&&($(t).on("editorChange",M),$(t).on("keydown",k),$(t).on("keypress",L),$(t).on("keyup",A),$(t).on("cursorActivity",O)),n&&($(n).off("editorChange",M),$(n).off("keydown",k),$(n).off("keypress",L),$(n).off("keyup",A),$(n).off("cursorActivity",O))}var r=e("command/Commands"),i=e("command/CommandManager"),s=e("editor/EditorManager"),o=e("strings"),u=e("utils/KeyEvent"),a=e("editor/CodeHintList").CodeHintList,f=e("preferences/PreferencesManager"),l={all:[]},c=null,h=null,p=null,d=null,v=null,m=null,g=!0;f.definePreference("showCodeHints","boolean",!0),f.definePreference("insertHintOnTab","boolean",!1),f.on("change","showCodeHints",function(){g=f.get("showCodeHints")});var S;S=function(e){if(!g)return;if(e.getSelections().length>1)return;var t=e.getLanguageForSelection(),n=E(t.getId());n.some(function(t,n){if(t.provider.hasHints(e,c))return h=t.provider,!0});if(h){var r;h.insertHintOnTab!==undefined?r=h.insertHintOnTab:r=f.get("insertHintOnTab"),p=e,d=new a(p,r),d.onSelect(function(e){var t=h.insertHint(e),n=p;x(),t&&S(n)}),d.onClose(x),N()}else c=null},H(null,s.getActiveEditor(),null),$(s).on("activeEditorChange",H),$(i).on("beforeExecuteCommand",x),i.register(o.CMD_SHOW_CODE_HINTS,r.SHOW_CODE_HINTS,C),t._getCodeHintList=P,t._removeHintProvider=w,t.isOpen=D,t.registerHintProvider=b,t.hasValidExclusion=_}),define("widgets/ModalBar",["require","exports","module","editor/EditorManager","utils/KeyEvent","utils/AnimationUtils"],function(e,t,n){function o(e,t,n){n===undefined&&(n=!0),this._handleKeydown=this._handleKeydown.bind(this),this._handleFocusChange=this._handleFocusChange.bind(this),this._$root=$("<div class='modal-bar'/>").html(e).insertBefore("#editor-holder"),n&&(this._$root.addClass("popout offscreen"),window.getComputedStyle(this._$root.get(0)).getPropertyValue("top"),this._$root.removeClass("popout offscreen")),r.getFocusedEditor()||r.focusEditor();if(t){this._autoClose=!0,this._$root.on("keydown",this._handleKeydown),window.document.body.addEventListener("focusin",this._handleFocusChange,!0);var i=$("input[type='text']",this._$root).first();i.length>0?i.focus():$("button",this._$root).first().focus()}var s=r.getCurrentFullEditor(),o;s&&(o=s.getScrollPos()),r.resizeEditor(),s&&s._codeMirror.scrollTo(o.x,o.y+this.height())}var r=e("editor/EditorManager"),i=e("utils/KeyEvent"),s=e("utils/AnimationUtils");o.prototype._$root=null,o.prototype._autoClose=!1,o.prototype.isLockedOpen=null,o.prototype.height=function(){return this._$root.outerHeight()},o.prototype.prepareClose=function(e){e===undefined&&(e=!0),this._$root.addClass("popout");if(!brackets.nativeMenus){var t=$("#titlebar").outerHeight();this._$root.css("top",t+"px")}var n=r.getCurrentFullEditor(),i,s;e&&n&&(i=this.height(),s=n.getScrollPos()),r.resizeEditor(),e&&n&&n._codeMirror.scrollTo(s.x,s.y-i)},o.prototype.close=function(e,t){function o(){i._$root.remove(),n.resolve()}var n=new $.Deferred,i=this;return e===undefined&&(e=!0),t===undefined&&(t=!0),this._$root.hasClass("popout")||this.prepareClose(e),this._autoClose&&window.document.body.removeEventListener("focusin",this._handleFocusChange,!0),$(this).triggerHandler("close"),t?s.animateUsingClass(this._$root.get(0),"offscreen").done(o):o(),r.focusEditor(),n.promise()},o.prototype._handleKeydown=function(e){e.keyCode===i.DOM_VK_ESCAPE&&(e.stopPropagation(),e.preventDefault(),this.close())},o.prototype._handleFocusChange=function(e){if(this.isLockedOpen&&this.isLockedOpen())return;var t=$(e.target).data("attached-to")||e.target;$.contains(this._$root.get(0),t)||this.close()},o.prototype.getRoot=function(){return this._$root},t.ModalBar=o}),define("utils/StringMatch",["require","exports","module","thirdparty/lodash"],function(e,t,n){function i(e){this.label=e}function s(e){var t,n,r=[0],i=0,s=!1;for(t=0;t<e.length;t++)n=e[t],n==="/"?(r.push(t++),r.push(t),i=r.length-1,s=!1):n==="."||n==="-"||n==="_"?(r.push(t++),r.push(t),s=!1):n.toUpperCase()===n?(s&&r.push(t),s=!1):s=!0;return{specials:r,lastSegmentSpecialsIndex:i}}function f(e){a=e}function g(e){this.index=e}function y(e){this.index=e}function b(e,t,n,r){function h(){var r;for(r=s;r<n.length;r++){if(n[r]>=l[f])break;if(n[r]<a)s=r;else if(e[f]===t[n[r]])return s=r,f++,a=n[r],i.push(new g(a++)),!0}return!1}function p(){while(i.length>0){var e=i.pop();if(!e)return!1;f--;if(e instanceof g){s--;if(e.index<l[f])return l[f]=e.index-1,c=u,e=i[i.length-1],e?(a=e.index+1,!0):(a=n[r]+1,!0)}}return!1}var i=[],s=r,a=n[r],f,l=[];for(f=0;f<e.length;f++)l[f]=Infinity;f=0;var c=o;for(;;){while(f<e.length&&a<t.length&&a<=l[f])c===o&&(h()||(c=u)),c===u&&(e[f]===t[a]?(f++,i.push(new y(a++)),c=o):a++);if(f>=e.length||f<e.length&&!p())break}return f<e.length||i.length===0?null:i}function w(e,t,n,r,i){var s,o,u="",a=n[r]+e.length-t.length;a>0&&(u=e.substring(0,a),e=e.substring(a));for(s=0;s<e.length;s++){o=b(e.substring(s),t,n,r);if(o||r===0)break}return s===e.length||!o?null:{remainder:u+e.substring(0,s),matchList:o}}function E(e,t,n,r){var i=n[r],s,o;s=w(e,t,n,r,i);if(s){o=s.matchList;if(s.remainder){var u=b(s.remainder,t.substring(0,i),n.slice(0,r),0);if(!u)return null;o.unshift.apply(o,u)}}else o=b(e,t,n,0);return o}function S(e,t,n){function w(e){b&&(b.includesLastSegment=s>=n,b.matched&&b.includesLastSegment&&(a&&(y.lastSegment+=o*h),f+=o*h),b.matched&&!u&&(a&&(y.notStartingOnSpecial-=m),f-=m),i.push(b)),s+1<e&&i.push({text:t.substring(s+1,e),matched:!1,includesLastSegment:e>n}),b=null,o=0}function S(e){var r=e.index,i=0;a&&(y.match+=c),i+=c,r===n&&(a&&(y.beginning+=p),i+=p);if(f>0&&s+1===r){r-E===n&&(a&&(y.beginning+=p),i+=p),E++;var h=v*E;u&&(h*=2),a&&(y.consecutive+=h),i+=h}else E=1;e instanceof g&&(a&&(y.special+=l),i+=l),f+=i,r>=n&&(o+=i),(b&&!b.matched||r>s+1)&&w(r),s=r,b?b.text+=t[r]:(b={text:t[r],matched:!0},u=e instanceof g)}var r,i=[],s=-1,o=0,u=!1,f=0,y;a&&(y={special:0,match:0,lastSegment:0,beginning:0,lengthDeduction:0,consecutive:0,notStartingOnSpecial:0});var b=null,E=0;for(r=0;r<e.length;r++){var x=e[r];S(x)}w(t.length);var T=-1*Math.round(t.length*d);a&&(y.lengthDeduction=T),f+=T;var N={ranges:i,matchGoodness:f};return a&&(N.scoreDebug=y),N}function x(e,t){var n=new i(e);return n.matchGoodness=-Number.MAX_VALUE,a&&(n.scoreDebug={beginning:Number.MAX_VALUE}),n.stringRanges=[{text:e.substr(0,t.length),matched:!0,includesLastSegment:!0}],e.length>t.length&&n.stringRanges.push({text:e.substring(t.length),matched:!1,includesLastSegment:!0}),n}function T(e,t,n,r){var o;n=n||{};if(!t)return o=new i(e),o.matchGoodness=0,a&&(o.scoreDebug={}),o.stringRanges=[{text:e,matched:!1,includesLastSegment:!0}],o;t=t.toLowerCase();var u=e.toLowerCase();n.preferPrefixMatches&&(n.segmentedSearch=!1);if(n.preferPrefixMatches&&u.substr(0,t.length)===t)return x(e,t);r||(r=s(e));var f,l;n.segmentedSearch?(f=r.specials[r.lastSegmentSpecialsIndex],l=E(t,u,r.specials,r.lastSegmentSpecialsIndex)):(f=0,l=b(t,u,r.specials,0));if(l){var c=S(l,e,f);o=new i(e),o.stringRanges=c.ranges,o.matchGoodness=-1*c.matchGoodness,a&&(o.scoreDebug=c.scoreDebug)}return o}function N(e,t){var n;Array.isArray(t)?n=t:(n=[],r.forEach(t,function(e,t){n[e]=t})),e.sort(function(e,t){var r;for(r=0;r<n.length;r++){var i=n[r];if(typeof i=="function"){var s=i(e,t);if(s)return s}else{var o=e[i],u=t[i];typeof o=="string"&&(o=o.toLowerCase(),u=u.toLowerCase());if(o<u)return-1;if(o>u)return 1}}return 0})}function C(e){N(e,{matchGoodness:0,label:1})}function k(e){this.options=e,this.reset()}var r=e("thirdparty/lodash"),o=0,u=1,a=!1,l=35,c=10,h=1,p=10,d=.2,v=7,m=25;k.prototype._specialsCache=null,k.prototype._noMatchCache=null,k.prototype.reset=function(){this._lastQuery=null,this._specialsCache={},this._noMatchCache={}},k.prototype.match=function(e,t){this._lastQuery!==null&&this._lastQuery!==t.substring(0,this._lastQuery.length)&&(this._noMatchCache={}),this._lastQuery=t;if(r.has(this._noMatchCache,e))return undefined;var n=r.has(this._specialsCache,e)?this._specialsCache[e]:undefined;n===undefined&&(n=s(e),this._specialsCache[e]=n);var i=T(e,t,this.options,n);return i||(this._noMatchCache[e]=!0),i},t._findSpecialCharacters=s,t._wholeStringSearch=E,t._lastSegmentSearch=w,t._setDebugScores=f,t._generateMatchList=b,t._SpecialMatch=g,t._NormalMatch=y,t._computeRangesAndScore=S,t.SearchResult=i,t.stringMatch=T,t.basicMatchSort=C,t.multiFieldSort=N,t.StringMatcher=k}),define("search/QuickOpen",["require","exports","module","document/DocumentManager","editor/EditorManager","command/CommandManager","strings","utils/StringUtils","command/Commands","project/ProjectManager","language/LanguageManager","utils/KeyEvent","widgets/ModalBar","utils/StringMatch","utils/ViewUtils"],function(e,t,n){function E(e,t,n,r,i,s,o,u,a,f){this.name=e,this.languageIds=t,this.done=n,this.search=r,this.match=i,this.itemFocus=s,this.itemSelect=o,this.resultsFormatter=u,this.matcherOptions=a,this.label=f}function S(e){e.fileTypes&&!e.languageIds&&(console.warn("Using fileTypes for QuickOpen plugins is deprecated. Use languageIds instead."),e.languageIds=e.fileTypes.map(function(e){return l.getLanguageForPath("file."+e).getId()}),delete e.fileTypes),m.push(new E(e.name,e.languageIds,e.done,e.search,e.match,e.itemFocus,e.itemSelect,e.resultsFormatter,e.matcherOptions,e.label))}function x(){this.$searchField=undefined,this._handleItemSelect=this._handleItemSelect.bind(this),this._handleItemFocus=this._handleItemFocus.bind(this),this._handleKeyUp=this._handleKeyUp.bind(this),this._handleResultsReady=this._handleResultsReady.bind(this),this._handleShowResults=this._handleShowResults.bind(this),this._handleBlur=this._handleBlur.bind(this),this._handleDocumentMouseDown=this._handleDocumentMouseDown.bind(this),this._filterCallback=this._filterCallback.bind(this),this._resultsFormatterCallback=this._resultsFormatterCallback.bind(this),this._filenameMatcher=new p.StringMatcher({segmentedSearch:!0}),this._matchers={}}function T(e,t){var n;return t?n=e.length:(n=e.lastIndexOf("."),n===-1&&(n=e.length)),e.slice(e.lastIndexOf("/")+1,n)}function N(e){var t=e.match(v),n;return e.length<=1||!t||t[1]&&isNaN(t[1])||t[3]&&isNaN(t[3])?null:{query:t[0],local:e.indexOf(":")===0,line:t[1]-1||0,ch:t[3]-1||0}}function C(){var e=$("input#quickOpenSearch").data("smart-autocomplete").rawResults;return e||[]}function k(e){if(!e)return null;var t=$(e).index(),n=C();return n[t]}function L(e){var t=$("input#quickOpenSearch").val();return t!==e}function A(e,t){if(!y){var n=new $.Deferred;return b.done(function(){L(e)?n.reject():n.resolve(A(e,t))}),n.promise()}var r=N(e);r&&!r.local&&r.query!==""&&(e=e.replace(r.query,""));var i=$.map(y,function(n){var r;return r=t.match(f.makeProjectRelativeIfPossible(n.fullPath),e),r&&(r.label=n.name,r.fullPath=n.fullPath,r.filenameWithoutExtension=T(n.name,!1)),r});return p.multiFieldSort(i,{matchGoodness:0,filenameWithoutExtension:1,label:2,fullPath:3}),i}function O(e,t,n){var r=e.label||e;t=t||"quicksearch-namematch";var i=e.stringRanges;i||(i=[{text:r,matched:!1,includesLastSegment:!0}]);var s="";if(e.scoreDebug){var o=e.scoreDebug;s+='<span title="sp:'+o.special+", m:"+o.match+", ls:"+o.lastSegment+", b:"+o.beginning+", ld:"+o.lengthDeduction+", c:"+o.consecutive+", nsos: "+o.notStartingOnSpecial+'">('+e.matchGoodness+") </span>"}return i.forEach(function(e){e.matched&&(s+="<span class='"+t+"'>");var r=n?n(e.includesLastSegment,e.text):e.text;s+=u.breakableUrl(r),e.matched&&(s+="</span>")}),s}function M(e,t){t=t.slice(t.indexOf("@")+1,t.length);var n=O(e);return"<li>"+n+"</li>"}function _(e,t){function n(e,t){if(e){var n=t.lastIndexOf("/");return t.substring(n+1)}return""}var r=O(e,null,n),i=O(e,"quicksearch-pathmatch");return"<li>"+r+"<br /><span class='quick-open-path'>"+i+"</span></li>"}function D(){var e=i.getActiveEditor();return e&&e.getSelectedText()||""}function P(e,t){function n(){w=new x,w.showDialog(e,t)}w?w.isOpen?w.setSearchFieldValue(e,t):w.close().done(n):n()}function H(){P("",D())}function B(){r.getCurrentDocument()&&P(":","")}function j(){r.getCurrentDocument()&&P("@",D())}var r=e("document/DocumentManager"),i=e("editor/EditorManager"),s=e("command/CommandManager"),o=e("strings"),u=e("utils/StringUtils"),a=e("command/Commands"),f=e("project/ProjectManager"),l=e("language/LanguageManager"),c=e("utils/KeyEvent"),h=e("widgets/ModalBar").ModalBar,p=e("utils/StringMatch"),d=e("utils/ViewUtils"),v=new RegExp(":([^,]+)?(,(.+)?)?"),m=[],g=null,y,b,w;x.prototype.isOpen=!1,x.prototype._filenameMatcher=null,x.prototype._matchers=null,x.prototype._closeDeferred=null,x.prototype._origDocPath=null,x.prototype._origSelections=null,x.prototype._origScrollPos=null,x.prototype._handleItemSelect=function(e,t){t||(t=$(".smart_autocomplete_container > li:first-child").get(0));var n=k(t),r=!0,o=this,u=this.$searchField.val(),f=N(u);if(g)g.itemSelect(n);else{var l=n&&n.fullPath;l?(r=!1,this.modalBar.prepareClose(),s.execute(a.FILE_ADD_TO_WORKING_SET,{fullPath:l}).done(function(){if(f){var e=i.getCurrentFullEditor();e.setCursorPos(f.line,f.ch,!0)}}).always(function(){o.close()})):f&&i.getCurrentFullEditor().setCursorPos(f.line,f.ch,!0)}r&&(this.close(),i.focusEditor())},x.prototype._handleItemFocus=function(e,t){var n=k(t);g&&g.itemFocus&&g.itemFocus(n)},x.prototype._handleKeyUp=function(e){if(e.keyCode===c.DOM_VK_RETURN||e.keyCode===c.DOM_VK_ESCAPE){e.stopImmediatePropagation(),e.preventDefault();var t=this;setTimeout(function(){e.keyCode===c.DOM_VK_ESCAPE?t.close(t._origScrollPos,t._origSelections):e.keyCode===c.DOM_VK_RETURN&&t._handleItemSelect(null,$(".smart_autocomplete_highlight").get(0))},0)}},x.prototype._isValidLineNumberQuery=function(e){if(e===":")return!0;var t=N(e),n=i.getCurrentFullEditor();return t&&n&&t.line>=n.getFirstVisibleLine()&&t.line<=n.getLastVisibleLine()},x.prototype._handleResultsReady=function(e,t){var n=t.length===0&&(y||g)&&!this._isValidLineNumberQuery(this.$searchField.val());d.toggleClass(this.$searchField,"no-results",n)},x.prototype._handleShowResults=function(e,t){$(".smart_autocomplete_highlight").length===0&&this._handleItemFocus(null,$(".smart_autocomplete_container > li:first-child").get(0))},x.prototype.close=function(e,t){if(!this.isOpen)return this._closeDeferred.promise();this.isOpen=!1,this._closeDeferred=new $.Deferred;var n;for(n=0;n<m.length;n++){var r=m[n];r.done&&r.done()}this.$searchField.trigger("lostFocus");var s=this;return setTimeout(function(){s.modalBar.close(!e).done(function(){s._closeDeferred.resolve()});var n=i.getCurrentFullEditor();t&&n.setSelections(t),e&&n.setScrollPos(e.x,e.y)},0),$(".smart_autocomplete_container").remove(),$(window.document).off("mousedown",this._handleDocumentMouseDown),this._closeDeferred.promise()},x.prototype._filterCallback=function(e){if(L(e))return C();var t=N(e);if(t&&t.local){var n={line:t.line,ch:t.ch},s={line:t.line};i.getCurrentFullEditor().setSelection(n,s,!0)}var o=r.getCurrentDocument(),u;o&&(u=o.getLanguage().getId());var a;for(a=0;a<m.length;a++){var f=m[a],l=f.languageIds.length===0||f.languageIds.indexOf(u)!==-1;if(l&&f.match&&f.match(e)){g=f;var c=this._matchers[g.name];return c||(c=new p.StringMatcher(f.matcherOptions),this._matchers[g.name]=c),this._updateDialogLabel(f,e),f.search(e,c)}}return this._updateDialogLabel(null,e),g=null,A(e,this._filenameMatcher)},x.prototype._resultsFormatterCallback=function(e){var t=this.$searchField.val(),n;return g?n=g.resultsFormatter||M:n=_,n(e,t)},x.prototype.setSearchFieldValue=function(e,t){e=e||"",t=t||"",t=e+t;var n=this.$searchField;n.val(t),n.get(0).setSelectionRange(e.length,t.length),n.trigger("keyIn",[t])},x.prototype._updateDialogLabel=function(e,t){var n="";if(e&&e.label)n=e.label;else{var r=t.length>0?t.charAt(0):"";switch(r){case":":n=o.CMD_GOTO_LINE+"…";break;case"@":n=o.CMD_GOTO_DEFINITION+"…";break;default:n=""}}$(".find-dialog-label",this.dialog).text(n)},x.prototype._handleDocumentMouseDown=function(e){this.modalBar.getRoot().find(e.target).length===0&&$(".smart_autocomplete_container").find(e.target).length===0?this.close():$("input#quickOpenSearch").get(0)!==e.target&&(e.preventDefault(),e.stopPropagation())},x.prototype._handleBlur=function(e){this.close()},x.prototype.showDialog=function(e,t){function u(e){return!l.getLanguageForPath(e.fullPath).isBinary()||i.getCustomViewerForPath(e.fullPath)}if(this.isOpen)return;this.isOpen=!0,$(window.document).on("mousedown",this._handleDocumentMouseDown);var n=r.getCurrentDocument();this._origDocPath=n?n.file.fullPath:null,n?(this._origSelections=i.getCurrentFullEditor().getSelections(),this._origScrollPos=i.getCurrentFullEditor().getScrollPos()):(this._origSelections=null,this._origScrollPos=null);var s="<div align='right'><input type='text' autocomplete='off' id='quickOpenSearch' placeholder='"+o.CMD_QUICK_OPEN+"…' style='width: 30em'><span class='find-dialog-label'></span></div>";this.modalBar=new h(s,!1),this.$searchField=$("input#quickOpenSearch"),this.$searchField.bind({resultsReady:this._handleResultsReady,showResults:this._handleShowResults,itemSelect:this._handleItemSelect,itemFocus:this._handleItemFocus,keyup:this._handleKeyUp,blur:this._handleBlur}),this.$searchField.smartAutoComplete({source:[],maxResults:20,minCharLimit:0,autocompleteFocused:!0,forceSelect:!1,typeAhead:!1,filter:this._filterCallback,resultFormatter:this._resultsFormatterCallback}),this.setSearchFieldValue(e,t),b=f.getAllFiles(u,!0).done(function(e){y=e,b=null,this._filenameMatcher.reset()}.bind(this))},$(f).on("projectOpen",function(){y=null}),s.register(o.CMD_QUICK_OPEN,a.NAVIGATE_QUICK_OPEN,H),s.register(o.CMD_GOTO_DEFINITION,a.NAVIGATE_GOTO_DEFINITION,j),s.register(o.CMD_GOTO_LINE,a.NAVIGATE_GOTO_LINE,B),t.beginSearch=P,t.addQuickOpenPlugin=S,t.highlightMatch=O,t.stringMatch=p.stringMatch,t.SearchResult=p.SearchResult,t.basicMatchSort=p.basicMatchSort,t.multiFieldSort=p.multiFieldSort}),define("text!htmlContent/main-view.html",[],function(){return'<!-- \n  Copyright (c) 2012 Adobe Systems Incorporated. All rights reserved.\n   \n  Permission is hereby granted, free of charge, to any person obtaining a\n  copy of this software and associated documentation files (the "Software"), \n  to deal in the Software without restriction, including without limitation \n  the rights to use, copy, modify, merge, publish, distribute, sublicense, \n  and/or sell copies of the Software, and to permit persons to whom the \n  Software is furnished to do so, subject to the following conditions:\n   \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n   \n  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \n  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER \n  DEALINGS IN THE SOFTWARE.\n-->\n\n\n<!--\n    HTML template for the body tag of index.html. It is rendered dynamically in\n    brackets.js with Mustache and localized with the i18n RequireJS plugin.\n\n    LOCALIZATION NOTE:\n    All display text for this file must use templating so the text can be localized.\n    \n    English text goes in src/nls/root/strings.js. All other translations go in the strings.js file for\n    the specific local in the nls folder. If a translation is missing for a specific key English\n    is used as a fallback\n\n    Strings should be referenced using the double brackets syntax.\n    Example: {{keyname}}. Note, all strings are HTML escaped unless the form \n    {{&keyname}} is used.\n\n-->\n\n    <!-- Main UI: horizontal set of sidebar, main content vertical stack, and vertical toolbar -->\n    <div class="main-view">\n        <div id="sidebar" class="sidebar panel quiet-scrollbars horz-resizable right-resizer collapsible" data-minsize="0" data-forceleft=".content">\n            <div id="working-set-header">{{WORKING_FILES}}\n                <div id="working-set-option-btn" class="btn-alt-quiet"></div>\n            </div>\n            <div id="open-files-container">\n                <!-- This will contain runtime-generated <li>\'s for each file in the working set -->\n                <ul>\n                </ul>\n            </div>\n        \n            <div id="project-files-header">\n                <span id="project-title" class="title"></span>\n            </div>\n            <div id="project-files-container">\n                <!-- This will contain a dynamically generated <ul> hierarchy at runtime -->\n            </div>\n        </div>\n        \n        <!--\n            Vertical stack of titlebar (in-browser), editor, bottom panels, status bar\n                (status bar is injected later - see StatusBar.init()).\n            Note: all children must be in a vertical stack with heights explicitly set in a fixed\n                unit such as px (not percent/em/auto). If you change the height later, you must\n                call EditorManager.resizeEditor() each time. Otherwise editor-holder\'s height will\n                not get set correctly. Use PanelManager to have this managed for you automatically.\n         -->\n        <div class="content">\n            <!-- Horizontal titlebar containing menus & filename when inBrowser -->\n            <div id="titlebar" class="toolbar no-focus">\n                <!-- Menu bar -->\n                <ul class="nav" data-dropdown="dropdown">\n                </ul>\n                \n                <!-- Filename label -->\n                <div class="title-wrapper">\n                    <span class="title"></span>&nbsp;<span class=\'dirty-dot\' style="visibility:hidden;">•</span>\n                </div>\n            </div>\n            \n            <!-- Editors are programmatically created inside here -->\n            <div id="editor-holder">\n                <div id="not-editor">\n                </div>\n            </div>\n            \n            <!-- Bottom panels and status bar are programmatically created here -->\n            \n        </div>\n\n        <!-- Vertical toolbar docked to right -->\n        <div id="main-toolbar" class="toolbar no-focus">\n            <!-- Top-aligned buttons -->\n            <div class="buttons">\n                <a id="toolbar-go-live" href="#"></a> <!-- tooltip for this is set in JS -->\n                <a id="toolbar-extension-manager" title="{{EXTENSION_MANAGER_TITLE}}" href="#"></a>\n                <a id="update-notification" title="{{UPDATE_NOTIFICATION_TOOLTIP}}" href="#" style="display: none"></a>\n            </div>\n            <div class="bottom-buttons"></div>\n        </div>\n        \n        <!-- Hack to ensure that the code editor\'s web font is loaded early. -->\n        <!-- For more info, see note in brackets.less for class .dummy-text, or issue 76 -->\n        <div class="dummy-text">x</div>\n    </div>\n\n    <!-- Modal Windows -->\n    <div id="context-menu-bar">\n        <ul data-dropdown="dropdown"></ul>\n    </div>\n    <div id="codehint-menu-bar">\n        <ul data-dropdown="dropdown"></ul>\n    </div>'}),define("project/SidebarView",["require","exports","module","utils/AppInit","project/ProjectManager","project/WorkingSetView","command/CommandManager","command/Commands","strings","editor/EditorManager","utils/Global","utils/Resizer","thirdparty/lodash"],function(e,t,n){function y(){var e=i.getProjectRoot().name,t=i.getProjectRoot().fullPath;e===""&&t==="/"&&(e="/"),m.html(h.escape(e)),m.attr("title",t),g.trigger("scroll")}function b(){c.toggle(p)}function w(){c.show(p)}function E(){c.hide(p)}function S(){return c.isVisible(p)}var r=e("utils/AppInit"),i=e("project/ProjectManager"),s=e("project/WorkingSetView"),o=e("command/CommandManager"),u=e("command/Commands"),a=e("strings"),f=e("editor/EditorManager"),l=e("utils/Global"),c=e("utils/Resizer"),h=e("thirdparty/lodash"),p,d,v,m,g;r.htmlReady(function(){function e(){var e;p.find(".sidebar-selection").each(function(t,n){e=$(n),e.width(e.parent()[0].scrollWidth)})}p=$("#sidebar"),d=$("#menu-view-hide-sidebar span"),v=$("#open-files-container"),m=$("#project-title"),g=$("#project-files-container"),s.create(v),p.on("panelResizeStart",function(e,t){p.find(".sidebar-selection-triangle").css("display","none"),p.find(".scroller-shadow").css("display","none")}),p.on("panelResizeUpdate",function(e,t){p.find(".sidebar-selection").width(t)}),p.on("panelResizeEnd",function(t,n){e(),p.find(".sidebar-selection-triangle").css("display","block").css("left",n),p.find(".scroller-shadow").css("display","block"),g.triggerHandler("scroll"),v.triggerHandler("scroll")}),p.on("panelCollapsed",function(e,t){o.get(u.VIEW_HIDE_SIDEBAR).setName(a.CMD_SHOW_SIDEBAR)}),p.on("panelExpanded",function(t,n){s.refresh(),e(),p.find(".scroller-shadow").css("display","block"),p.find(".sidebar-selection-triangle").css("left",n),g.triggerHandler("scroll"),v.triggerHandler("scroll"),o.get(u.VIEW_HIDE_SIDEBAR).setName(a.CMD_HIDE_SIDEBAR)}),p.is(":visible")||p.trigger("panelCollapsed")}),$(i).on("projectOpen",y),o.register(a.CMD_HIDE_SIDEBAR,u.VIEW_HIDE_SIDEBAR,b),t.toggle=b,t.show=w,t.hide=E,t.isVisible=S}),define("utils/NodeConnection",["require","exports","module"],function(e,t,n){function u(e,t){var n=setTimeout(function(){e.reject("timeout")},t);e.always(function(){clearTimeout(n)})}function a(){var e=$.Deferred(),t=null,n=null;return u(e,i),brackets.app.getNodeState(function(r,i){!r&&i&&e.state()!=="rejected"?(t=i,n=new WebSocket("ws://localhost:"+t),n.binaryType="arraybuffer",n.onclose=function(){e.reject("WebSocket closed")},n.onopen=function(){n.onclose=null,e.resolveWith(null,[n,t])}):e.reject("brackets.app.getNodeState error: "+r)}),e.promise()}function f(){this.domains={},this._registeredModules=[],this._pendingInterfaceRefreshDeferreds=[],this._pendingCommandDeferreds=[]}var r=10,i=1e4,s=500,o=4294967295;f.prototype.domains=null,f.prototype._registeredModules=null,f.prototype._ws=null,f.prototype._port=null,f.prototype._commandCount=1,f.prototype._autoReconnect=!1,f.prototype._pendingInterfaceRefreshDeferreds=null,f.prototype._pendingCommandDeferreds=null,f.prototype._getNextCommandID=function(){var e;return this._commandCount>o?e=this._commandCount=0:e=this._commandCount++,e},f.prototype._cleanup=function(){this.domains={};if(this._ws&&this._ws.readyState!==WebSocket.CLOSED)try{this._ws.close()}catch(e){}var t=this._pendingInterfaceRefreshDeferreds.concat(this._pendingCommandDeferreds);t.forEach(function(e){e.reject("cleanup")}),this._pendingInterfaceRefreshDeferreds=[],this._pendingCommandDeferreds=[],this._ws=null,this._port=null},f.prototype.connect=function(e){function u(e,r){function i(){t._ws.onclose=function(){if(t._autoReconnect){var e=t.connect(!0);$(t).triggerHandler("close",[e])}else t._cleanup(),$(t).triggerHandler("close")},n.resolve()}function s(e){t._cleanup(),n.reject(e)}t._ws=e,t._port=r,t._ws.onmessage=t._receive.bind(t),t._refreshInterface().then(function(){t._registeredModules.length>0?t.loadDomains(t._registeredModules,!1).then(i,s):i()},s)}function f(){i++,o=new Date,a().then(u,function(){if(i<r){var e=new Date,t=Math.max(s-(e-o),1);setTimeout(f,t)}else n.reject("Max connection attempts reached")})}var t=this;t._autoReconnect=e;var n=$.Deferred(),i=0,o=null;return t._cleanup(),f(),n.promise()},f.prototype.connected=function(){return!!this._ws&&this._ws.readyState===WebSocket.OPEN},f.prototype.disconnect=function(){this._autoReconnect=!1,this._cleanup()},f.prototype.loadDomains=function(e,t){var n=$.Deferred();u(n,i);var r=e;return Array.isArray(e)||(r=[e]),t&&Array.prototype.push.apply(this._registeredModules,r),this.domains.base&&this.domains.base.loadDomainModulesFromPaths?(this.domains.base.loadDomainModulesFromPaths(r).then(function(e){e||n.reject("loadDomainModulesFromPaths failed")},function(e){n.reject("Unable to load one of the modules: "+r+(e?", reason: "+e:""))}),this._pendingInterfaceRefreshDeferreds.push(n)):n.reject("this.domains.base is undefined"),n.promise()},f.prototype._send=function(e){if(this.connected()){var t=null;if(typeof e=="string")t=e;else try{t=JSON.stringify(e)}catch(n){console.error("[NodeConnection] Unable to stringify message in order to send: "+n.message)}if(t)try{this._ws.send(t)}catch(r){console.error("[NodeConnection] Error sending message: "+r.message)}}else console.error("[NodeConnection] Not connected to node, unable to send.")},f.prototype._receive=function(e){var t=null,n=e.data,r;if(e.data instanceof ArrayBuffer){if(n.byteLength<4){console.error("[NodeConnection] received malformed binary message");return}var i=n.slice(0,4),s=n.slice(4),o=new Uint32Array(i),u=o[0];r={type:"commandResponse",message:{id:u,response:s}}}else try{r=JSON.parse(n)}catch(a){console.error("[NodeConnection] received malformed message",e,a.message);return}switch(r.type){case"event":var f=$(this);r.message.domain==="base"&&r.message.event==="newDomains"&&this._refreshInterface(),f.triggerHandler(r.message.domain+"."+r.message.event,r.message.parameters),f.triggerHandler(r.message.domain+":"+r.message.event,r.message.parameters);break;case"commandResponse":t=this._pendingCommandDeferreds[r.message.id],t&&(t.resolveWith(this,[r.message.response]),delete this._pendingCommandDeferreds[r.message.id]);break;case"commandError":t=this._pendingCommandDeferreds[r.message.id],t&&(t.rejectWith(this,[r.message.message,r.message.stack]),delete this._pendingCommandDeferreds[r.message.id]);break;case"error":console.error("[NodeConnection] received error: "+r.message.message);break;default:console.error("[NodeConnection] unknown event type: "+r.type)}},f.prototype._refreshInterface=function(){function r(n){function r(e,n){return function(){var r=$.Deferred(),i=Array.prototype.slice.call(arguments,0),s=t._getNextCommandID();return t._pendingCommandDeferreds[s]=r,t._send({id:s,domain:e,command:n.name,parameters:i}),r}}t.domains={},t.domainEvents={},n.forEach(function(e){t.domains[e.domain]={},e.commands.forEach(function(n){t.domains[e.domain][n.name]=r(e.domain,n)}),t.domainEvents[e.domain]={},e.events.forEach(function(n){var r=n.parameters;t.domainEvents[e.domain][n.name]=r})}),e.resolve()}var e=$.Deferred(),t=this,n=this._pendingInterfaceRefreshDeferreds;return this._pendingInterfaceRefreshDeferreds=[],e.then(function(){n.forEach(function(e){e.resolve()})},function(e){n.forEach(function(t){t.reject(e)})}),this.connected()?$.getJSON("http://localhost:"+this._port+"/api").done(r).fail(function(t){e.reject(t)}):e.reject("Attempted to call _refreshInterface when not connected."),e.promise()},f._getConnectionTimeout=function(){return i},n.exports=f}),define("extensibility/Package",["require","exports","module","utils/AppInit","filesystem/FileSystem","file/FileUtils","utils/StringUtils","strings","utils/ExtensionLoader","utils/NodeConnection","preferences/PreferencesManager"],function(e,t,n){function m(e){return p.domains.extensionManager?e(p.domains.extensionManager):(new $.Deferred).reject("extensionManager domain is undefined").promise()}function g(e,t){return m(function(n){var r=new $.Deferred;return n.validate(e,t).done(function(e){r.resolve({errors:e.errors,metadata:e.metadata})}).fail(function(e){r.reject(e)}),r.promise()})}function y(e,t,n){return m(function(r){var i=new $.Deferred,o=a.getUserExtensionPath(),u=o.replace(/\/user$/,"/disabled"),f=s.getNativeBracketsDirectoryPath()+"/extensions/default/",l=n?"update":"install";return r[l](e,o,{disabledDirectory:u,systemExtensionDirectory:f,apiVersion:brackets.metadata.apiVersion,nameHint:t}).done(function(e){e.installationStatus!==h.INSTALLED||n?i.resolve(e):a.loadExtension(e.name,{baseUrl:s.convertWindowsPathToUnixPath(e.installedTo)},"main").then(function(){i.resolve(e)},function(){i.reject(c.ERROR_LOADING)})}).fail(function(e){i.reject(e)}),i.promise()})}function b(e){if(e.parsed.hostname==="github.com"||e.parsed.hostname==="www.github.com"){var t=/^\/[^\/?]+\/([^\/?]+)(\/?)$/.exec(e.parsed.pathname);t?(t[2]||(e.url+="/"),e.url+="archive/master.zip",e.filenameHint=t[1]+".zip"):(t=/^\/[^\/?]+\/([^\/?]+)\/archive\/master.zip$/.exec(e.parsed.pathname),t&&(e.filenameHint=t[1]+".zip"))}}function w(e,t){return m(function(n){var r=new $.Deferred,i=PathUtils.parseUrl(e);if(!i.hostname)return r.reject(c.MALFORMED_URL),r.promise();if(i.protocol!=="http:"&&i.protocol!=="https:")return r.reject(c.UNSUPPORTED_PROTOCOL),r.promise();var o={url:e,parsed:i,filenameHint:i.filename};b(o);var u=o.filenameHint;u=u.replace(/[^a-zA-Z0-9_\- \(\)\.]/g,"_"),u||(u="extension.zip");var a=n.downloadFile(t,o.url,l.get("proxy"));return a.done(function(e){r.resolve({localPath:s.convertWindowsPathToUnixPath(e),filenameHint:o.filenameHint})}).fail(function(e){r.reject(e)}),r.promise()})}function E(e){return m(function(t){return t.abortDownload(e)})}function S(e,t){var n=new $.Deferred;return y(e,t).done(function(e){var t=e.installationStatus;t===h.ALREADY_INSTALLED||t===h.NEEDS_UPDATE||t===h.SAME_VERSION||t===h.OLDER_VERSION?n.resolve(e):e.errors&&e.errors.length>0?n.reject(e.errors[0]):e.disabledReason?n.reject(e.disabledReason):n.resolve(e)}).fail(function(e){n.reject(e)}),n.promise()}function x(e){var t=1,n=2,r=3,s=4,o=new $.Deferred,u=t,a=v++;return w(e,a).done(function(e){u=n,S(e.localPath,e.filenameHint).done(function(t){var n=t.installationStatus;u=r,t.localPath=e.localPath,n===h.INSTALLED&&i.getFileForPath(e.localPath).unlink(),o.resolve(t)}).fail(function(t){u=s,i.getFileForPath(e.localPath).unlink(),o.reject(t)})}).fail(function(e){u=s,o.reject(e)}),{promise:o.promise(),cancel:function(){u===t&&E(a)}}}function T(e){function t(e){return u[e]?u[e]:(console.log("Unknown installation error",e),u.UNKNOWN_ERROR)}return Array.isArray(e)?(e[0]=t(e[0]),o.format.apply(window,e)):t(e)}function N(e){return m(function(t){return t.remove(e)})}function C(e,t,n){var r=new $.Deferred;return y(e,t,!0).done(function(e){e.installationStatus!==h.INSTALLED?r.reject(e.errors):r.resolve(e)}).fail(function(e){r.reject(e)}).always(function(){n||i.getFileForPath(e).unlink()}),r.promise()}function k(){return d}var r=e("utils/AppInit"),i=e("filesystem/FileSystem"),s=e("file/FileUtils"),o=e("utils/StringUtils"),u=e("strings"),a=e("utils/ExtensionLoader"),f=e("utils/NodeConnection"),l=e("preferences/PreferencesManager");l.definePreference("proxy","string");var c={ERROR_LOADING:"ERROR_LOADING",MALFORMED_URL:"MALFORMED_URL",UNSUPPORTED_PROTOCOL:"UNSUPPORTED_PROTOCOL"},h={FAILED:"FAILED",INSTALLED:"INSTALLED",ALREADY_INSTALLED:"ALREADY_INSTALLED",SAME_VERSION:"SAME_VERSION",OLDER_VERSION:"OLDER_VERSION",NEEDS_UPDATE:"NEEDS_UPDATE",DISABLED:"DISABLED"},p,d=$.Deferred(),v=0;r.appReady(function(){p=new f,p.connect(!0).then(function(){var e=s.getNativeBracketsDirectoryPath()+"/"+s.getNativeModuleDirectoryPath(n)+"/node/ExtensionManagerDomain";p.loadDomains(e,!0).then(function(){d.resolve()},function(){console.error("[Extensions] Failed to connect to node",arguments),d.reject()})})}),t._getNodeConnectionDeferred=k,t.installFromURL=x,t.installFromPath=S,t.validate=g,t.install=y,t.remove=N,t.installUpdate=C,t.formatError=T,t.InstallationStatuses=h}),define("view/ViewCommandHandlers",["require","exports","module","command/Commands","command/CommandManager","command/KeyBindingManager","strings","utils/StringUtils","project/ProjectManager","editor/EditorManager","preferences/PreferencesManager","document/DocumentManager","view/ThemeSettings","utils/AppInit"],function(e,t,n){function E(e){$("#"+e).remove()}function S(e,t,n,r,i){i=i||".CodeMirror";var s=$("<style type='text/css'></style>").attr("id",e),o=u.format("{0}: {1}{2}",t,n,r?" !important":"");s.html(i+"{ "+o+" }"),E(e),$("head").append(s)}function x(){E(v)}function T(e){S(v,"font-size",e,!0)}function N(){E(m)}function C(e){S(m,"font-family",e)}function k(e){var t=f.getCurrentFullEditor(),n=t._codeMirror.defaultCharWidth(),r=d.get("fontSize"),i=e,s=0,o=0,u=t.getScrollPos(),a=t._codeMirror.lineAtHeight(u.y,"local");s=/em$/.test(r)?10:1,o=parseInt((parseFloat(i)-parseFloat(r))*s,10),o&&t.refreshAll();var l=t._codeMirror.defaultCharWidth(),c=u.x/n,h=u.x+Math.round(c*(l-n)),p=t._codeMirror.heightAtLine(a,"local");t.setScrollPos(h,p)}function L(e){var n=d.get("fontSize");if(n===e)return;x(),e&&T(e),f.getCurrentFullEditor()&&k(e),$(t).triggerHandler("fontSizeChange",[e,n]),d.set("fontSize",e)}function A(){return d.get("fontSize")}function O(e){var n=f.getCurrentFullEditor(),r=d.get("fontFamily");if(r===e)return;N(),e&&C(e),$(t).triggerHandler("fontFamilyChange",[e,r]),d.set("fontFamily",e),n&&n.refreshAll()}function M(){return d.get("fontFamily")}function _(e){var t=d.get("fontSize"),n=/^[\d\.]+(px|em)$/;if(t.search(n)===-1)return!1;var r=t.substring(t.length-2,t.length),i=r==="px"?1:.1,s=parseFloat(t.substring(0,t.length-2)),o=s+i*e,u=o+r;return o<g*i||o>y*i?!1:(L(u),!0)}function D(){_(1)}function P(){_(-1)}function H(){L(b+"px")}function B(){c.getCurrentDocument()!==null?i.get(r.VIEW_INCREASE_FONT_SIZE).getEnabled()||(i.get(r.VIEW_INCREASE_FONT_SIZE).setEnabled(!0),i.get(r.VIEW_DECREASE_FONT_SIZE).setEnabled(!0),i.get(r.VIEW_RESTORE_FONT_SIZE).setEnabled(!0)):(i.get(r.VIEW_INCREASE_FONT_SIZE).setEnabled(!1),i.get(r.VIEW_DECREASE_FONT_SIZE).setEnabled(!1),i.get(r.VIEW_RESTORE_FONT_SIZE).setEnabled(!1))}function j(){C(d.get("fontFamily")),T(d.get("fontSize")),B()}function F(){var e=d.get("fontSize"),t=l.getViewState("fontSizeAdjustment");t&&(l.setViewState("fontSizeAdjustment"),e||(e=b+t+"px",d.set("fontSize",e))),e&&(x(),T(e))}function I(){O(w),L(b+"px")}function q(e,t,n){var r=t/e,i=(t+n)/e,s=Math.ceil(r),o=Math.floor(i)-1;return{first:s,last:o}}function R(e){var t=f.getCurrentFullEditor(),n=t.getTextHeight(),r=t.getCursorPos(),i=t.hasSelection(),s=t.getInlineWidgets(),o=t._codeMirror.getScrollInfo(),u=t._getLineSpaceElement().offsetTop,a=o.clientHeight,l=o.top-u,c=u,h,p;s.forEach(function(e){h=t._getInlineWidgetLineNumber(e),p=t._codeMirror.charCoords({line:h,ch:0},"local"),p.top<o.top?(l-=e.info.height,c+=e.info.height):p.top+e.info.height<o.top+a&&(a-=e.info.height)});var d=q(n,l,a);i||(r.line<d.first?t.setCursorPos({line:d.first+e,ch:r.ch}):r.line>d.last?t.setCursorPos({line:d.last+e,ch:r.ch}):(e>0&&r.line===d.first||e<0&&r.line===d.last)&&t._codeMirror.moveV(e,"line"));var v=d.first+e;t.setScrollPos(o.left,n*v+c)}function U(){R(-1)}function z(){R(1)}function W(){h.showDialog()}function X(e,t){return{fontSizeStyle:b+t+"px"}}var r=e("command/Commands"),i=e("command/CommandManager"),s=e("command/KeyBindingManager"),o=e("strings"),u=e("utils/StringUtils"),a=e("project/ProjectManager"),f=e("editor/EditorManager"),l=e("preferences/PreferencesManager"),c=e("document/DocumentManager"),h=e("view/ThemeSettings"),p=e("utils/AppInit"),d=l.getExtensionPrefs("fonts"),v="codemirror-dynamic-fonts",m="codemirror-dynamic-font-family",g=1,y=72,b=12,w="'SourceCodePro-Medium', ＭＳ ゴシック, 'MS Gothic', monospace";i.register(o.CMD_INCREASE_FONT_SIZE,r.VIEW_INCREASE_FONT_SIZE,D),i.register(o.CMD_DECREASE_FONT_SIZE,r.VIEW_DECREASE_FONT_SIZE,P),i.register(o.CMD_RESTORE_FONT_SIZE,r.VIEW_RESTORE_FONT_SIZE,H),i.register(o.CMD_SCROLL_LINE_UP,r.VIEW_SCROLL_LINE_UP,U),i.register(o.CMD_SCROLL_LINE_DOWN,r.VIEW_SCROLL_LINE_DOWN,z),i.register(o.CMD_THEMES,r.CMD_THEMES_OPEN_SETTINGS,W),l.convertPreferences(n,{fontSizeAdjustment:"user"},!0,X),d.definePreference("fontSize","string",b+"px"),d.definePreference("fontFamily","string",w),$(c).on("currentDocumentChange",B),p.appReady(j),t.restoreFontSize=F,t.restoreFonts=I,t.getFontSize=A,t.setFontSize=L,t.getFontFamily=M,t.setFontFamily=O}),define("text!htmlContent/themes-settings.html",[],function(){return'<div class="theme-settings modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">Themes Settings</h1>\n    </div>\n    <div class="modal-body">\n        <form class="form-horizontal">\n            <div class="control-group">\n                <label class="control-label">{{Strings.CURRENT_THEME}}:</label>\n                <div class="controls">\n                    <select>\n                        {{#themes}}\n                        <option style="text-align:left;" value="{{name}}" data-target="theme">{{displayName}}</option>\n                        {{/themes}}\n                    </select>\n                </div>\n            </div>\n\n            <div class="control-group">\n                <label class="control-label">{{Strings.USE_THEME_SCROLLBARS}}:</label>\n                <div class="controls">\n                    {{#settings.themeScrollbars}}\n                        <input type="checkbox" data-target="themeScrollbars" checked>\n                    {{/settings.themeScrollbars}}\n                    {{^settings.themeScrollbars}}\n                        <input type="checkbox" data-target="themeScrollbars">\n                    {{/settings.themeScrollbars}}\n                </div>\n            </div>\n\n            <div class="control-group">\n                <label class="control-label">{{Strings.FONT_SIZE}}:</label>\n                <div class="controls">\n                    <input type="text" data-target="fontSize" value="{{settings.fontSize}}">\n                </div>\n            </div>\n\n            <div class="control-group">\n                <label class="control-label">{{Strings.FONT_FAMILY}}:</label>\n                <div class="controls">\n                    <input type="text" data-target="fontFamily" value="{{settings.fontFamily}}">\n                </div>\n            </div>\n        </form>\n    </div>\n    <div class="modal-footer">\n        <button class="dialog-button btn" data-button-id="cancel">{{Strings.CANCEL}}</button>\n        <button class="dialog-button btn primary" data-button-id="save">{{Strings.DONE}}</button>\n    </div>\n</div>\n'}),define("view/ThemeSettings",["require","exports","module","thirdparty/lodash","widgets/Dialogs","strings","view/ViewCommandHandlers","text!htmlContent/themes-settings.html","preferences/PreferencesManager"],function(e,t,n){function p(){var e={};return Object.keys(c).forEach(function(t){e[t]=f.get(t)}),e.fontFamily=o.getFontFamily(),e.fontSize=o.getFontSize(),e}function d(){var e=p(),t={},n=r.map(l,function(e){return e}),u=$("<div>").append(h).html(),a=$(Mustache.render(u,{settings:e,themes:n,Strings:s})),d=a.find("[value='"+e.theme+"']");d.length===0&&(d=a.find("[value='"+c.theme+"']")),d.attr("selected","selected"),a.find("[data-toggle=tab].default").tab("show"),a.on("change","[data-target]:checkbox",function(){var e=$(this),n=e.attr("data-target");t[n]=e.is(":checked")}).on("input","[data-target]:text",function(){var e=$(this),n=e.attr("data-target");t[n]=e.val()}).on("change",function(){var e=$(":selected",this),t=e.attr("data-target");t&&f.set(t,e.val())}),i.showModalDialogUsingTemplate(a).done(function(n){var r;n==="save"?Object.keys(t).forEach(function(e){c.hasOwnProperty(e)?f.set(e,t[e]):(r="set"+e[0].toLocaleUpperCase()+e.substr(1),typeof o[r]=="function"&&o[r](t[e]))}):n==="cancel"&&f.set("theme",e.theme)})}function v(e){l=e}function m(){f.set("theme",c.theme),f.set("themeScrollbars",c.themeScrollbars)}var r=e("thirdparty/lodash"),i=e("widgets/Dialogs"),s=e("strings"),o=e("view/ViewCommandHandlers"),u=e("text!htmlContent/themes-settings.html"),a=e("preferences/PreferencesManager"),f=a.getExtensionPrefs("themes"),l={},c={themeScrollbars:!0,theme:"light-theme"},h=$(u).addClass("themeSettings");f.definePreference("theme","string",c.theme),f.definePreference("themeScrollbars","boolean",c.themeScrollbars),t._setThemes=v,t.restore=m,t.showDialog=d}),define("view/ThemeView",["require","exports","module","thirdparty/lodash","thirdparty/CodeMirror2/lib/codemirror","preferences/PreferencesManager"],function(e,t,n){function f(e){e=e||{};if(u.get("themeScrollbars")){var t=(e.scrollbar||[]).join(" ");a.text(t||"")}else a.text("")}function l(e){var t=u.get("theme"),n=(e.getOption("theme")||"").replace(/[\s]*/,"");if(n===t)return;s.defaults.theme=t,e.setOption("theme",t)}var r=[],i=e("thirdparty/lodash"),s=e("thirdparty/CodeMirror2/lib/codemirror"),o=e("preferences/PreferencesManager"),u=o.getExtensionPrefs("themes"),a=$("<style id='scrollbars'>").appendTo("head");t.updateScrollbars=f,t.updateThemes=l}),define("view/ThemeManager",["require","exports","module","thirdparty/lodash","filesystem/FileSystem","file/FileUtils","editor/EditorManager","utils/ExtensionUtils","view/ThemeSettings","view/ThemeView","utils/AppInit","preferences/PreferencesManager"],function(e,t,n){function E(e){var t=e.lastIndexOf(".");return e=e.substring(0,t!==-1?t:undefined).replace(/-/g," "),e.split(" ").map(function(e){return e[0].toUpperCase()+e.substring(1)}).join(" ")}function S(e,t){t=t||{};var n=e.name;this.file=e,this.name=t.name||(t.title||n).toLocaleLowerCase().replace(/[\W]/g,"-"),this.displayName=t.title||E(n),this.dark=t.theme!==undefined&&t.theme.dark===!0}function x(e){var t=[];return e=e.replace(y,function(e){return t.push(e),""}),{content:e,scrollbar:t}}function T(e){return e.replace(/^([A-Z]+:)?\//,function(e){return e.toLocaleLowerCase()})}function N(e,t){var n=new $.Deferred,r=new less.Parser({rootpath:T(b),filename:T(t.file._path)});return r.parse("#editor-holder {"+e+"\n}",function(e,t){e?n.reject(e):n.resolve(t.toCSS())}),n.promise()}function C(e){return e.isFile&&w.indexOf(s.getFileExtension(e.name))!==-1}function k(e){var t=e._path;return r.find(p,function(e){return e.file._path===t})}function L(){return d||(d=p[h.get("theme")]||p[m]),d}function A(){return r.map(p,function(e){return e})}function O(){var e=L(),t=e&&s.readAsText(e.file).then(function(t){return N(t.replace(g,""),e)}).then(function(t){var n=x(t);return e.scrollbar=n.scrollbar,n.content}).then(function(t){return $("body").toggleClass("dark",e.dark),v.text(t),e});return $.when(t)}function M(e){e&&(d=null),$.when(e&&O()).done(function(){var e=o.getActiveEditor();if(!e||!e._codeMirror)return;var t=e._codeMirror;f.updateThemes(t)})}function _(e,t){var n=new $.Deferred,r=i.getFileForPath(e),s=h.get("theme");return r.exists(function(e,i){var o;i?(o=new S(r,t),p[o.name]=o,a._setThemes(p),s===o.name&&M(!0),n.resolve(o)):(e||!i)&&n.reject(e)}),n.promise()}function D(e){var t=e.path+"/"+e.metadata.theme.file;return _(t,e.metadata)}var r=e("thirdparty/lodash"),i=e("filesystem/FileSystem"),s=e("file/FileUtils"),o=e("editor/EditorManager"),u=e("utils/ExtensionUtils"),a=e("view/ThemeSettings"),f=e("view/ThemeView"),l=e("utils/AppInit"),c=e("preferences/PreferencesManager"),h=c.getExtensionPrefs("themes"),p={},d=null,v=$(u.addEmbeddedStyleSheet("")),m="thor-light-theme",g=/\/\*([\s\S]*?)\*\//mg,y=/((?:[^}|,]*)::-webkit-scrollbar(?:[^{]*)[{](?:[^}]*?)[}])/mgi,b=s.getNativeBracketsDirectoryPath()+"/styles/",w=["css","less"];h.on("change","theme",function(){if(d&&d.name===h.get("theme"))return;M(!0),f.updateScrollbars(L()),$(t).trigger("themeChange",L())}),h.on("change","themeScrollbars",function(){M(),f.updateScrollbars(L())}),i.on("change",function(e,t){if(!t||t.isDirectory)return;k(t)&&M(!0)}),$(o).on("activeEditorChange",function(){M()}),t.refresh=M,t.loadFile=_,t.loadPackage=D,t.getCurrentTheme=L,t.getAllThemes=A,t._toDisplayName=E,t._extractScrollbars=x}),function(e){function W(e,n){var r=n?t[y]:t[v];return r.test(e)?new $(e,n):null}function X(e,t){var n=W(e,t);return n?n.version:null}function V(e,t){var n=W(e,t);return n?n.version:null}function $(e,n){if(e instanceof $){if(e.loose===n)return e;e=e.version}if(!(this instanceof $))return new $(e,n);this.loose=n;var r=e.trim().match(n?t[y]:t[v]);if(!r)throw new TypeError("Invalid Version: "+e);this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],r[4]?this.prerelease=r[4].split(".").map(function(e){return/^[0-9]+$/.test(e)?+e:e}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}function J(e,t,n){try{return(new $(e,n)).inc(t).version}catch(r){return null}}function Q(e,t){var n=K.test(e),r=K.test(t);return n&&r&&(e=+e,t=+t),n&&!r?-1:r&&!n?1:e<t?-1:e>t?1:0}function G(e,t){return Q(t,e)}function Y(e,t,n){return(new $(e,n)).compare(t)}function Z(e,t){return Y(e,t,!0)}function et(e,t,n){return Y(t,e,n)}function tt(t,n){return t.sort(function(t,r){return e.compare(t,r,n)})}function nt(t,n){return t.sort(function(t,r){return e.rcompare(t,r,n)})}function rt(e,t,n){return Y(e,t,n)>0}function it(e,t,n){return Y(e,t,n)<0}function st(e,t,n){return Y(e,t,n)===0}function ot(e,t,n){return Y(e,t,n)!==0}function ut(e,t,n){return Y(e,t,n)>=0}function at(e,t,n){return Y(e,t,n)<=0}function ft(e,t,n,r){var i;switch(t){case"===":i=e===n;break;case"!==":i=e!==n;break;case"":case"=":case"==":i=st(e,n,r);break;case"!=":i=ot(e,n,r);break;case">":i=rt(e,n,r);break;case">=":i=ut(e,n,r);break;case"<":i=it(e,n,r);break;case"<=":i=at(e,n,r);break;default:throw new TypeError("Invalid operator: "+t)}return i}function lt(e,t){if(e instanceof lt){if(e.loose===t)return e;e=e.value}if(!(this instanceof lt))return new lt(e,t);this.loose=t,this.parse(e),this.semver===ct?this.value="":this.value=this.operator+this.semver.version}function ht(e,t){if(e instanceof ht&&e.loose===t)return e;if(!(this instanceof ht))return new ht(e,t);this.loose=t,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length});if(!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function pt(e,t){return(new ht(e,t)).set.map(function(e){return e.map(function(e){return e.value}).join(" ").trim().split(" ")})}function dt(e,t){return e=yt(e,t),e=mt(e,t),e=wt(e,t),e=St(e,t),e}function vt(e){return!e||e.toLowerCase()==="x"||e==="*"}function mt(e,t){return e.trim().split(/\s+/).map(function(e){return gt(e,t)}).join(" ")}function gt(e,n){var r=n?t[O]:t[A];return e.replace(r,function(e,t,n,r,i){var s;return vt(t)?s="":vt(n)?s=">="+t+".0.0-0 <"+(+t+1)+".0.0-0":vt(r)?s=">="+t+"."+n+".0-0 <"+t+"."+(+n+1)+".0-0":i?(i.charAt(0)!=="-"&&(i="-"+i),s=">="+t+"."+n+"."+r+i+" <"+t+"."+(+n+1)+".0-0"):s=">="+t+"."+n+"."+r+"-0"+" <"+t+"."+(+n+1)+".0-0",s})}function yt(e,t){return e.trim().split(/\s+/).map(function(e){return bt(e,t)}).join(" ")}function bt(e,n){var r=n?t[H]:t[P];return e.replace(r,function(e,t,n,r,i){var s;return vt(t)?s="":vt(n)?s=">="+t+".0.0-0 <"+(+t+1)+".0.0-0":vt(r)?t==="0"?s=">="+t+"."+n+".0-0 <"+t+"."+(+n+1)+".0-0":s=">="+t+"."+n+".0-0 <"+(+t+1)+".0.0-0":i?(i.charAt(0)!=="-"&&(i="-"+i),t==="0"?n==="0"?s="="+t+"."+n+"."+r+i:s=">="+t+"."+n+"."+r+i+" <"+t+"."+(+n+1)+".0-0":s=">="+t+"."+n+"."+r+i+" <"+(+t+1)+".0.0-0"):t==="0"?n==="0"?s="="+t+"."+n+"."+r:s=">="+t+"."+n+"."+r+"-0"+" <"+t+"."+(+n+1)+".0-0":s=">="+t+"."+n+"."+r+"-0"+" <"+(+t+1)+".0.0-0",s})}function wt(e,t){return e.split(/\s+/).map(function(e){return Et(e,t)}).join(" ")}function Et(e,n){e=e.trim();var r=n?t[N]:t[T];return e.replace(r,function(e,t,n,r,i,s){var o=vt(n),u=o||vt(r),a=u||vt(i),f=a;return t==="="&&f&&(t=""),t&&f?(o&&(n=0),u&&(r=0),a&&(i=0),t===">"&&(t=">=",o||(u?(n=+n+1,r=0,i=0):a&&(r=+r+1,i=0))),e=t+n+"."+r+"."+i+"-0"):o?e="*":u?e=">="+n+".0.0-0 <"+(+n+1)+".0.0-0":a&&(e=">="+n+"."+r+".0-0 <"+n+"."+(+r+1)+".0-0"),e})}function St(e,n){return e.trim().replace(t[U],"")}function xt(e,t,n,r,i,s,o,u,a,f,l,c,h){return vt(n)?t="":vt(r)?t=">="+n+".0.0-0":vt(i)?t=">="+n+"."+r+".0-0":t=">="+t,vt(a)?u="":vt(f)?u="<"+(+a+1)+".0.0-0":vt(l)?u="<"+a+"."+(+f+1)+".0-0":c?u="<="+a+"."+f+"."+l+"-"+c:u="<="+u,(t+" "+u).trim()}function Tt(e,t){for(var n=0;n<e.length;n++)if(!e[n].test(t))return!1;return!0}function Nt(e,t,n){try{t=new ht(t,n)}catch(r){return!1}return t.test(e)}function Ct(e,t,n){return e.filter(function(e){return Nt(e,t,n)}).sort(function(e,t){return et(e,t,n)})[0]||null}function kt(e,t){try{return(new ht(e,t)).range||"*"}catch(n){return null}}typeof module=="object"&&module.exports===e&&(e=module.exports=$),e.SEMVER_SPEC_VERSION="2.0.0";var t=e.re=[],n=e.src=[],r=0,i=r++;n[i]="0|[1-9]\\d*";var s=r++;n[s]="[0-9]+";var o=r++;n[o]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var u=r++;n[u]="("+n[i]+")\\."+"("+n[i]+")\\."+"("+n[i]+")";var a=r++;n[a]="("+n[s]+")\\."+"("+n[s]+")\\."+"("+n[s]+")";var f=r++;n[f]="(?:"+n[i]+"|"+n[o]+")";var l=r++;n[l]="(?:"+n[s]+"|"+n[o]+")";var c=r++;n[c]="(?:-("+n[f]+"(?:\\."+n[f]+")*))";var h=r++;n[h]="(?:-?("+n[l]+"(?:\\."+n[l]+")*))";var p=r++;n[p]="[0-9A-Za-z-]+";var d=r++;n[d]="(?:\\+("+n[p]+"(?:\\."+n[p]+")*))";var v=r++,m="v?"+n[u]+n[c]+"?"+n[d]+"?";n[v]="^"+m+"$";var g="[v=\\s]*"+n[a]+n[h]+"?"+n[d]+"?",y=r++;n[y]="^"+g+"$";var b=r++;n[b]="((?:<|>)?=?)";var w=r++;n[w]=n[s]+"|x|X|\\*";var E=r++;n[E]=n[i]+"|x|X|\\*";var S=r++;n[S]="[v=\\s]*("+n[E]+")"+"(?:\\.("+n[E]+")"+"(?:\\.("+n[E]+")"+"(?:("+n[c]+")"+")?)?)?";var x=r++;n[x]="[v=\\s]*("+n[w]+")"+"(?:\\.("+n[w]+")"+"(?:\\.("+n[w]+")"+"(?:("+n[h]+")"+")?)?)?";var T=r++;n[T]="^"+n[b]+"\\s*"+n[S]+"$";var N=r++;n[N]="^"+n[b]+"\\s*"+n[x]+"$";var C=r++;n[C]="(?:~>?)";var k=r++;n[k]="(\\s*)"+n[C]+"\\s+",t[k]=new RegExp(n[k],"g");var L="$1~",A=r++;n[A]="^"+n[C]+n[S]+"$";var O=r++;n[O]="^"+n[C]+n[x]+"$";var M=r++;n[M]="(?:\\^)";var _=r++;n[_]="(\\s*)"+n[M]+"\\s+",t[_]=new RegExp(n[_],"g");var D="$1^",P=r++;n[P]="^"+n[M]+n[S]+"$";var H=r++;n[H]="^"+n[M]+n[x]+"$";var B=r++;n[B]="^"+n[b]+"\\s*("+g+")$|^$";var j=r++;n[j]="^"+n[b]+"\\s*("+m+")$|^$";var F=r++;n[F]="(\\s*)"+n[b]+"\\s*("+g+"|"+n[S]+")",t[F]=new RegExp(n[F],"g");var I="$1$2$3",q=r++;n[q]="^\\s*("+n[S]+")"+"\\s+-\\s+"+"("+n[S]+")"+"\\s*$";var R=r++;n[R]="^\\s*("+n[x]+")"+"\\s+-\\s+"+"("+n[x]+")"+"\\s*$";var U=r++;n[U]="(<|>)?=?\\s*\\*";for(var z=0;z<r;z++)t[z]||(t[z]=new RegExp(n[z]));e.parse=W,e.valid=X,e.clean=V,e.SemVer=$,$.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},$.prototype.inspect=function(){return'<SemVer "'+this+'">'},$.prototype.toString=function(){return this.version},$.prototype.compare=function(e){return e instanceof $||(e=new $(e,this.loose)),this.compareMain(e)||this.comparePre(e)},$.prototype.compareMain=function(e){return e instanceof $||(e=new $(e,this.loose)),Q(this.major,e.major)||Q(this.minor,e.minor)||Q(this.patch,e.patch)},$.prototype.comparePre=function(e){e instanceof $||(e=new $(e,this.loose));if(this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.lenth&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],r=e.prerelease[t];if(n===undefined&&r===undefined)return 0;if(r===undefined)return 1;if(n===undefined)return-1;if(n===r)continue;return Q(n,r)}while(++t)},$.prototype.inc=function(e){switch(e){case"major":this.major++,this.minor=-1;case"minor":this.minor++,this.patch=-1;case"patch":this.patch++,this.prerelease=[];break;case"prerelease":if(this.prerelease.length===0)this.prerelease=[0];else{var t=this.prerelease.length;while(--t>=0)typeof this.prerelease[t]=="number"&&(this.prerelease[t]++,t=-2);t===-1&&this.prerelease.push(0)}break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this},e.inc=J,e.compareIdentifiers=Q;var K=/^[0-9]+$/;e.rcompareIdentifiers=G,e.compare=Y,e.compareLoose=Z,e.rcompare=et,e.sort=tt,e.rsort=nt,e.gt=rt,e.lt=it,e.eq=st,e.neq=ot,e.gte=ut,e.lte=at,e.cmp=ft,e.Comparator=lt;var ct={};lt.prototype.parse=function(e){var n=this.loose?t[B]:t[j],r=e.match(n);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],r[2]?(this.semver=new $(r[2],this.loose),this.operator==="<"&&!this.semver.prerelease.length&&(this.semver.prerelease=["0"],this.semver.format())):this.semver=ct},lt.prototype.inspect=function(){return'<SemVer Comparator "'+this+'">'},lt.prototype.toString=function(){return this.value},lt.prototype.test=function(e){return this.semver===ct?!0:ft(e,this.operator,this.semver,this.loose)},e.Range=ht,ht.prototype.inspect=function(){return'<SemVer Range "'+this.range+'">'},ht.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range},ht.prototype.toString=function(){return this.range},ht.prototype.parseRange=function(e){var n=this.loose;e=e.trim();var r=n?t[R]:t[q];e=e.replace(r,xt),e=e.replace(t[F],I),e=e.replace(t[k],L),e=e.replace(t[_],D),e=e.split(/\s+/).join(" ");var i=n?t[B]:t[j],s=e.split(" ").map(function(e){return dt(e,n)}).join(" ").split(/\s+/);return this.loose&&(s=s.filter(function(e){return!!e.match(i)})),s=s.map(function(e){return new lt(e,n)}),s},e.toComparators=pt,ht.prototype.test=function(e){if(!e)return!1;for(var t=0;t<this.set.length;t++)if(Tt(this.set[t],e))return!0;return!1},e.satisfies=Nt,e.maxSatisfying=Ct,e.validRange=kt,typeof define=="function"&&define.amd&&define("extensibility/node/node_modules/semver/semver.browser",e)}(typeof exports=="object"?exports:typeof define=="function"&&define.amd?{}:semver={}),define("extensibility/ExtensionManager",["require","exports","module","thirdparty/lodash","file/FileUtils","extensibility/Package","utils/Async","utils/ExtensionLoader","utils/ExtensionUtils","filesystem/FileSystem","strings","utils/StringUtils","view/ThemeManager","extensibility/node/node_modules/semver/semver.browser"],function(e,t,n){function x(e){var n=w[e];if(!n||!n.installInfo||!n.registryInfo)return;n.installInfo.owner=n.registryInfo.owner,n.installInfo.updateAvailable=!1,n.registryInfo.updateAvailable=!1,n.installInfo.updateCompatible=!1,n.registryInfo.updateCompatible=!1;var i=n.installInfo.metadata?n.installInfo.metadata.version:null;if(i&&p.lt(i,n.registryInfo.metadata.version)){n.registryInfo.updateAvailable=!0,n.installInfo.updateAvailable=!0;var s=r.findLast(n.registryInfo.versions,function(e){return p.satisfies(brackets.metadata.apiVersion,e.brackets)});s&&s.version&&p.lt(i,s.version)&&(n.installInfo.updateCompatible=!0,n.registryInfo.updateCompatible=!0,n.installInfo.lastCompatibleVersion=s.version,n.registryInfo.lastCompatibleVersion=s.version)}$(t).triggerHandler("registryUpdate",[e])}function T(e){var t=w[e];t.installInfo&&t.installInfo.metadata&&t.installInfo.metadata.theme&&h.loadPackage(t.installInfo)}function N(e){t.extensions=w=e,Object.keys(w).forEach(function(e){x(e)})}function C(){t.extensions=w={},E=[],S=[]}function k(){var e=new $.Deferred;return $.ajax({url:brackets.config.extension_registry,dataType:"json",cache:!1}).done(function(n){Object.keys(n).forEach(function(e){w[e]||(w[e]={}),w[e].registryInfo=n[e],x(e)}),$(t).triggerHandler("registryDownload"),e.resolve()}).fail(function(){e.reject()}),e.promise()}function L(e,n){function r(r,i){var s,o=u.getUserExtensionPath();if(n.indexOf(o)===0)s=y;else{var a=n.split("/"),f;a.length>2&&(f=a[a.length-2]),f==="dev"?s=g:f==="default"?s=m:s=b}w[r]||(w[r]={}),w[r].installInfo={metadata:i,path:n,locationType:s,status:e.type==="loadFailed"?v:d},x(r),T(r),$(t).triggerHandler("statusChange",[r])}a.loadPackageJson(n).done(function(e){r(e.name,e)}).fail(function(){var e=n.match(/\/([^\/]+)$/),t=e&&e[1]||n,i={name:t,title:t};r(t,i)})}function A(e,t){var n=e.brackets||e.engines&&e.engines.brackets,r={};r.isCompatible=!n||p.satisfies(t,n);if(r.isCompatible)r.compatibleVersion=e.version;else if(n.charAt(0)==="<")r.requiresNewer=!1;else if(n.charAt(0)===">")r.requiresNewer=!0;else if(n.charAt(0)==="~"){var i=n.slice(1);i.match(/^[0-9]+$/)?i+=".0.0":i.match(/^[0-9]+\.[0-9]+$/)&&(i+=".0"),r.requiresNewer=p.lt(t,i)}return r}function O(e,t){if(!e.versions){var n=A(e.metadata,t);return n.isCompatible&&(n.isLatestVersion=!0),n}var r=e.versions.length-1,i=A(e.versions[r],t);if(i.isCompatible)return i.isLatestVersion=!0,i;for(r--;r>=0;r--){var s=A(e.versions[r],t);if(s.isCompatible)return s.isLatestVersion=!1,s.requiresNewer=i.requiresNewer,s}return i}function M(e,t){return c.format(brackets.config.extension_url,e,t)}function _(e){var n=new $.Deferred;return w[e]&&w[e].installInfo?s.remove(w[e].installInfo.path).done(function(){w[e].installInfo=null,n.resolve(),$(t).triggerHandler("statusChange",[e])}).fail(function(e){n.reject(e)}):n.reject(c.format(l.EXTENSION_NOT_INSTALLED,e)),n.promise()}function D(e,t,n){return s.installUpdate(t,e,n)}function P(){Object.keys(S).forEach(function(e){var t=S[e],n=t.keepFile,r=t.localPath;r&&!n&&f.getFileForPath(r).unlink()}),S={}}function H(){E={}}function B(e,n){n?E[e]=!0:delete E[e],$(t).triggerHandler("statusChange",[e])}function j(e){return!!E[e]}function F(){return Object.keys(E).length>0}function I(e){var n=e.installationStatus;if(n===s.InstallationStatuses.ALREADY_INSTALLED||n===s.InstallationStatuses.NEEDS_UPDATE||n===s.InstallationStatuses.SAME_VERSION||n===s.InstallationStatuses.OLDER_VERSION){var r=e.name;delete E[r],S[r]=e,$(t).triggerHandler("statusChange",[r])}}function q(e){var n=S[e];if(!n)return;n.localPath&&!n.keepFile&&f.getFileForPath(n.localPath).unlink(),delete S[e],$(t).triggerHandler("statusChange",[e])}function R(e){return!!S[e]}function U(){return Object.keys(S).length>0}function z(){return o.doInParallel_aggregateErrors(Object.keys(E),function(e){return _(e)})}function W(){return o.doInParallel_aggregateErrors(Object.keys(S),function(e){var t=S[e];return D(t.name,t.localPath,t.keepFile)})}function X(){var e=[];return Object.keys(w).forEach(function(t){var n=w[t];if(!n.installInfo||!n.registryInfo)return;n.registryInfo.updateCompatible&&e.push({id:t,installVersion:n.installInfo.metadata.version,registryVersion:n.registryInfo.lastCompatibleVersion})}),e}function V(e){return e.reduce(function(e,t){var n=w[t.id];if(!n||!n.installInfo)return e;var r=n.installInfo.metadata.version;return p.lt(r,t.registryVersion)&&e.push(t),e},[])}function J(e,t,n){var r,i,s=w[e];n?(r=s.installInfo?s.installInfo.metadata.description:s.registryInfo.metadata.description,i=l.VIEW_TRUNCATED_DESCRIPTION):(r=s.installInfo?s.installInfo.metadata.shortdescription:s.registryInfo.metadata.shortdescription,i=l.VIEW_COMPLETE_DESCRIPTION),t.attr("data-toggle-desc",n?"trunc-desc":"expand-desc").attr("title",i).prev(".ext-full-description").html(r)}var r=e("thirdparty/lodash"),i=e("file/FileUtils"),s=e("extensibility/Package"),o=e("utils/Async"),u=e("utils/ExtensionLoader"),a=e("utils/ExtensionUtils"),f=e("filesystem/FileSystem"),l=e("strings"),c=e("utils/StringUtils"),h=e("view/ThemeManager"),p=e("extensibility/node/node_modules/semver/semver.browser"),d="enabled",v="startFailed",m="default",g="dev",y="user",b="unknown",w={},E=[],S=[];$(u).on("load",L).on("loadFailed",L),t.downloadRegistry=k,t.getCompatibilityInfo=O,t.getExtensionURL=M,t.remove=_,t.update=D,t.extensions=w,t.cleanupUpdates=P,t.markForRemoval=B,t.isMarkedForRemoval=j,t.unmarkAllForRemoval=H,t.hasExtensionsToRemove=F,t.updateFromDownload=I,t.removeUpdate=q,t.isMarkedForUpdate=R,t.hasExtensionsToUpdate=U,t.removeMarkedExtensions=z,t.updateExtensions=W,t.getAvailableUpdates=X,t.cleanAvailableUpdates=V,t.toggleDescription=J,t.ENABLED=d,t.START_FAILED=v,t.LOCATION_DEFAULT=m,t.LOCATION_DEV=g,t.LOCATION_USER=y,t.LOCATION_UNKNOWN=b,t._reset=C,t._setExtensions=N}),define("text!htmlContent/update-dialog.html",[],function(){return'<div class="update-dialog modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{UPDATE_AVAILABLE_TITLE}}</h1>\n    </div>\n    <div class="modal-body no-padding">\n        <img class="update-icon" src="styles/images/update_large_icon.svg">\n        <div class="update-text">\n            <p class="dialog-message">{{UPDATE_MESSAGE}}</p>\n            <div class="update-info">\n            </div>\n        </div>\n    </div>\n    <div class="modal-footer">\n        <button class="dialog-button btn left" data-button-id="cancel">{{CANCEL}}</button>\n        <button class="dialog-button btn primary" data-button-id="download">{{GET_IT_NOW}}</button>\n    </div>\n</div>\n'}),define("text!htmlContent/update-list.html",[],function(){return'{{#.}}\n<div>\n    <h3>{{versionString}} - {{dateString}} (<a href="{{releaseNotesURL}}" title="{{releaseNotesURL}}">{{Strings.RELEASE_NOTES}}</a>)</h3>\n    <ul>\n        {{#newFeatures}}\n        <li><b>{{name}}</b> - {{description}}</li>\n        {{/newFeatures}}\n    </ul>\n</div>\n{{/.}}'}),define("utils/UpdateNotification",["require","exports","module","widgets/Dialogs","widgets/DefaultDialogs","extensibility/ExtensionManager","preferences/PreferencesManager","utils/Global","utils/NativeApp","utils/StringUtils","strings","text!htmlContent/update-dialog.html","text!htmlContent/update-list.html"],function(e,t,n){function g(e,t){return e=e||brackets.getLocale(),t&&(e=e.substring(0,2)),brackets.config.update_info_url+e+".json"}function y(e,t,n){var r=o.getViewState("lastInfoURLFetchTime"),i=new $.Deferred,s=!1,u;e&&(s=!0),u=o.getViewState("updateInfo"),u||(s=!0),(new Date).getTime()>r+p&&(s=!0);if(s){var a=new $.Deferred,f,l=brackets.getLocale().toLowerCase();l!=="en"&&l!=="en-us"?(f=n||g(),$.ajax({url:f,cache:!1,type:"HEAD"}).fail(function(e,t,n){var r=g(brackets.getLocale(),!0);r!==f?$.ajax({url:r,cache:!1,type:"HEAD"}).fail(function(e,t,n){f=g("en")}).done(function(e,t,n){f=r}).always(function(e,t,n){a.resolve()}):(f=g("en"),a.resolve())}).done(function(e,t,n){a.resolve()})):(f=n||g("en"),a.resolve()),a.done(function(){$.ajax({url:f,dataType:"json",cache:!1}).done(function(e,n,s){t||(r=(new Date).getTime(),o.setViewState("lastInfoURLFetchTime",r),o.setViewState("updateInfo",e)),i.resolve(e)}).fail(function(e,t,n){if(!e.responseText){i.reject();return}try{u=JSON.parse(e.responseText),i.resolve(u)}catch(r){i.reject()}})})}else i.resolve(u);return i.promise()}function b(e,t){var n=0,r=e.length;while(n<r){if(e[n].buildNumber<=t)break;n++}return n>0?e.slice(0,n):null}function w(e){r.showModalDialogUsingTemplate(Mustache.render(c,l)).done(function(t){t===r.DIALOG_BTN_DOWNLOAD&&a.openURLInDefaultBrowser(e[0].downloadURL)});var t=$(".update-dialog.instance"),n=t.find(".update-info");e.Strings=l,n.html(Mustache.render(h,e))}function E(){var e=s.getAvailableUpdates();o.setViewState("extensionUpdateInfo",e),o.setViewState("lastExtensionRegistryCheckTime",(new Date).getTime()),$("#toolbar-extension-manager").toggleClass("updatesAvailable",e.length>0)}function S(){var e=o.getViewState("lastExtensionRegistryCheckTime"),t=e+p,n=(new Date).getTime(),r=o.getViewState("extensionUpdateInfo");r=s.cleanAvailableUpdates(r),$("#toolbar-extension-manager").toggleClass("updatesAvailable",r.length>0),r.length===0&&(n>t?s.downloadRegistry().done(function(){setTimeout(S,p+d)}):setTimeout(S,t-n+d))}function x(e,t){var n=o.getViewState("lastNotifiedBuildNumber"),s,u=!1,a=new $.Deferred,f;return t&&(s={},t.hasOwnProperty("_buildNumber")&&(s._buildNumber=v,v=t._buildNumber,u=!0),t.hasOwnProperty("lastNotifiedBuildNumber")&&(s.lastNotifiedBuildNumber=n,n=t.lastNotifiedBuildNumber,u=!0),t.hasOwnProperty("_versionInfoURL")&&(f=t._versionInfoURL,u=!0)),y(e||u,u,f).done(function(t){var f=b(t,v);if(v===0&&!e){a.resolve();return}if(f){var c=$("#update-notification");c.css("display","block"),m||(m=!0,c.on("click",function(){x(!0)}));if(e||f[0].buildNumber>n)w(f),n=f[0].buildNumber,u||o.setViewState("lastNotifiedBuildNumber",n)}else e&&r.showModalDialog(i.DIALOG_ID_ERROR,l.NO_UPDATE_TITLE,l.NO_UPDATE_MESSAGE);s&&(s.hasOwnProperty("_buildNumber")&&(v=s._buildNumber),s.hasOwnProperty("lastNotifiedBuildNumber")&&(n=s.lastNotifiedBuildNumber)),a.resolve()}).fail(function(){e&&r.showModalDialog(i.DIALOG_ID_ERROR,l.ERROR_FETCHING_UPDATE_INFO_TITLE,l.ERROR_FETCHING_UPDATE_INFO_MSG),a.reject()}),a.promise()}function T(){x(),S(),window.setInterval(x,p+d)}var r=e("widgets/Dialogs"),i=e("widgets/DefaultDialogs"),s=e("extensibility/ExtensionManager"),o=e("preferences/PreferencesManager"),u=e("utils/Global"),a=e("utils/NativeApp"),f=e("utils/StringUtils"),l=e("strings"),c=e("text!htmlContent/update-dialog.html"),h=e("text!htmlContent/update-list.html"),p=864e5,d=12e4,v=Number(/-([0-9]+)/.exec(brackets.metadata.version)[1]);o.stateManager.definePreference("lastNotifiedBuildNumber","number",0),o.stateManager.definePreference("lastInfoURLFetchTime","number",0),o.stateManager.definePreference("lastExtensionRegistryCheckTime","number",0),o.stateManager.definePreference("extensionUpdateInfo","Array",[]),o.convertPreferences(n,{lastNotifiedBuildNumber:"user",lastInfoURLFetchTime:"user",updateInfo:"user"},!0);var m=!1;$(s).on("registryDownload",E),t.launchAutomaticUpdate=T,t.checkForUpdate=x}),define("LiveDevelopment/Servers/BaseServer",["require","exports","module"],function(e,t,n){function r(e){this._baseUrl=e.baseUrl,this._root=e.root,this._pathResolver=e.pathResolver,this._liveDocuments={}}r.prototype.getBaseUrl=function(){return this._baseUrl},r.prototype._setDocInfo=function(e){var t,n,r,i=e.doc;r=/^(.*\/)(.+\.([^.]+))$/.exec(i.file.fullPath);if(!r)return;i.extension=r[3],t=this.pathToUrl(r[1]),i.url=t+encodeURI(r[2]),i.root={url:i.url},i.isDirty&&e._updateBrowser&&e._updateBrowser()},r.prototype.pathToUrl=function(e){var t=null,n=this.getBaseUrl(),r=this._pathResolver(e);if(r!==e){var i=encodeURI(e),s=encodeURI(this._root);return i.replace(s,n)}return null},r.prototype.urlToPath=function(e){var t,n="";return n=this.getBaseUrl(),n!==""&&e.indexOf(n)===0?(t=e.replace(n,encodeURI(this._root)),decodeURI(t)):null},r.prototype.readyToServe=function(){return $.Deferred().resolve().promise()},r.prototype.canServe=function(e){return!0},r.prototype._documentKey=function(e){return"/"+encodeURI(this._pathResolver(e))},r.prototype.add=function(e){if(!e)return;var t=this._documentKey(e.doc.file.fullPath);this._setDocInfo(e),this._liveDocuments[t]=e},r.prototype.remove=function(e){if(!e)return;var t=this._liveDocuments[this._documentKey(e.doc.file.fullPath)];t&&delete this._liveDocuments[t]},r.prototype.get=function(e){return this._liveDocuments[this._documentKey(e)]},r.prototype.clear=function(){this._liveDocuments={}},r.prototype.start=function(){},r.prototype.stop=function(){},t.BaseServer=r}),define("LiveDevelopment/Servers/FileServer",["require","exports","module","LiveDevelopment/Servers/BaseServer","file/FileUtils"],function(e,t,n){function o(e){r.call(this,e)}var r=e("LiveDevelopment/Servers/BaseServer").BaseServer,i=e("file/FileUtils"),s=brackets.platform==="win"?"file:///":"file://";o.prototype=Object.create(r.prototype),o.prototype.constructor=o,o.prototype.canServe=function(e){return!this._baseUrl&&i.isStaticHtmlFileExt(e)},o.prototype.urlToPath=function(e){return e.indexOf(s)===0?decodeURI(e.slice(s.length)):null},o.prototype.pathToUrl=function(e){return encodeURI(s+e)},t.FileServer=o}),define("LiveDevelopment/LiveDevServerManager",["require","exports","module","file/FileUtils","project/ProjectManager"],function(e,t,n){function o(e,t){return t.priority-e.priority}function u(e){var t,n,r;for(r=0;r<s.length;r++){t=s[r],n=t.create();if(n.canServe(e))return n}return null}function a(e,t){if(!e.create){console.error("Incompatible live development server provider");return}var n={};n.create=e.create,n.priority=t||0,s.push(n),s.sort(o)}var r=e("file/FileUtils"),i=e("project/ProjectManager"),s=[];t.getProvider=u,t.registerProvider=a,t.getServer=u,t.registerServer=a}),define("LiveDevelopment/Servers/UserServer",["require","exports","module","LiveDevelopment/Servers/BaseServer","file/FileUtils"],function(e,t,n){function s(e){r.call(this,e)}var r=e("LiveDevelopment/Servers/BaseServer").BaseServer,i=e("file/FileUtils");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.canServe=function(e){return this._baseUrl?e===this._pathResolver(e)?!1:i.isStaticHtmlFileExt(e)||i.isServerHtmlFileExt(e):!1},t.UserServer=s}),define("LiveDevelopment/Agents/CSSAgent",["require","exports","module","thirdparty/path-utils/path-utils.min","LiveDevelopment/Inspector/Inspector"],function(t,n,r){function a(e){return PathUtils.parseUrl(e).hrefNoSearch}function f(e,t){s={},o={}}function l(e){return s[a(e)]}function c(){var e=[],t;for(t in s)s.hasOwnProperty(t)&&e.push(t);return e}function h(e){var t=l(e.url);return console.assert(t,"Style Sheet for document not loaded: "+e.url),i.CSS.setStyleSheetText(t.styleSheetId,e.getText())}function p(e){var t=l(e.url);return console.assert(t,"Style Sheet for document not loaded: "+e.url),i.CSS.setStyleSheetText(t.styleSheetId,"")}function d(e,t){var r=a(t.header.sourceURL),i=s[r];if(i&&i.styleSheetId===t.header.styleSheetId)return;s[r]=t.header,o[t.header.styleSheetId]=r,$(n).triggerHandler("styleSheetAdded",[r,t.header])}function v(e,t){var r=o[t.styleSheetId],i=r&&s[r];r&&delete s[r],delete o[t.styleSheetId],$(n).triggerHandler("styleSheetRemoved",[r,i])}function m(e,t){var n,r,s;if(u===undefined){n=/Chrome\/(\d+)\./,r=i.getUserAgent(),s=r.match(n);if(s&&parseInt(s[1],10)>=34){u=!0,$(i.Page).off("frameStoppedLoading.CSSAgent",m);return}}i.send("CSS","getAllStyleSheets").done(function(e){e.headers.forEach(function(e){u=!1,d(null,{header:e})})}).fail(function(e){u=e.code===-32601,$(i.Page).off("frameStoppedLoading.CSSAgent",m)})}function g(){return i.CSS.enable()}function y(){$(i.Page).on("frameNavigated.CSSAgent",f),$(i.CSS).on("styleSheetAdded.CSSAgent",d),$(i.CSS).on("styleSheetRemoved.CSSAgent",v),u||$(i.Page).on("frameStoppedLoading.CSSAgent",m)}function b(){$(i.Page).off(".CSSAgent"),$(i.CSS).off(".CSSAgent")}t("thirdparty/path-utils/path-utils.min");var i=t("LiveDevelopment/Inspector/Inspector"),s={},o,u;n.enable=g,n.styleForURL=l,n.getStylesheetURLs=c,n.reloadCSSForDocument=h,n.clearCSSForDocument=p,n.load=y,n.unload=b}),define("text!LiveDevelopment/Agents/RemoteFunctions.js",[],function(){return'/*\n * Copyright (c) 2012 Adobe Systems Incorporated. All rights reserved.\n *  \n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the "Software"), \n * to deal in the Software without restriction, including without limitation \n * the rights to use, copy, modify, merge, publish, distribute, sublicense, \n * and/or sell copies of the Software, and to permit persons to whom the \n * Software is furnished to do so, subject to the following conditions:\n *  \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *  \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER \n * DEALINGS IN THE SOFTWARE.\n * \n */\n\n\n/*jslint vars: true, plusplus: true, browser: true, nomen: true, indent: 4, forin: true, maxerr: 50, regexp: true */\n/*global define, $, window, navigator, Node, console */\n/*theseus instrument: false */\n\n/**\n * RemoteFunctions define the functions to be executed in the browser. This\n * modules should define a single function that returns an object of all\n * exported functions.\n */\nfunction RemoteFunctions(experimental) {\n    \n\n    var lastKeepAliveTime = Date.now();\n    \n    /**\n     * @type {DOMEditHandler}\n     */\n    var _editHandler;\n    \n    var HIGHLIGHT_CLASSNAME = "__brackets-ld-highlight",\n        KEEP_ALIVE_TIMEOUT  = 3000;   // Keep alive timeout value, in milliseconds\n    \n    // determine whether an event should be processed for Live Development\n    function _validEvent(event) {\n        if (navigator.platform.substr(0, 3) === "Mac") {\n            // Mac\n            return event.metaKey;\n        } else {\n            // Windows\n            return event.ctrlKey;\n        }\n    }\n\n    // determine the color for a type\n    function _typeColor(type, highlight) {\n        switch (type) {\n        case "html":\n            return highlight ? "#eec" : "#ffe";\n        case "css":\n            return highlight ? "#cee" : "#eff";\n        case "js":\n            return highlight ? "#ccf" : "#eef";\n        default:\n            return highlight ? "#ddd" : "#eee";\n        }\n    }\n\n    // compute the screen offset of an element\n    function _screenOffset(element, key) {\n        var bounds = element.getBoundingClientRect();\n        if (key === "offsetLeft") {\n            return bounds.left + window.pageXOffset;\n        } else {\n            return bounds.top + window.pageYOffset;\n        }\n    }\n\n    // set an event on a element\n    function _trigger(element, name, value, autoRemove) {\n        var key = "data-ld-" + name;\n        if (value !== undefined && value !== null) {\n            element.setAttribute(key, value);\n            if (autoRemove) {\n                window.setTimeout(element.removeAttribute.bind(element, key));\n            }\n        } else {\n            element.removeAttribute(key);\n        }\n    }\n\n    // construct the info menu\n    function Menu(element) {\n        this.element = element;\n        _trigger(this.element, "showgoto", 1, true);\n        window.setTimeout(window.remoteShowGoto);\n        this.remove = this.remove.bind(this);\n    }\n\n    Menu.prototype = {\n        onClick: function (url, event) {\n            event.preventDefault();\n            _trigger(this.element, "goto", url, true);\n            this.remove();\n        },\n\n        createBody: function () {\n            if (this.body) {\n                return;\n            }\n\n            // compute the position on screen\n            var x = _screenOffset(this.element, "offsetLeft");\n            var y = _screenOffset(this.element, "offsetTop") + this.element.offsetHeight;\n\n            // create the container\n            this.body = document.createElement("div");\n            this.body.style.setProperty("z-index", 2147483647);\n            this.body.style.setProperty("position", "absolute");\n            this.body.style.setProperty("left", x + "px");\n            this.body.style.setProperty("top", y + "px");\n            this.body.style.setProperty("font-size", "11pt");\n\n            // draw the background\n            this.body.style.setProperty("background", "#fff");\n            this.body.style.setProperty("border", "1px solid #888");\n            this.body.style.setProperty("-webkit-box-shadow", "2px 2px 6px 0px #ccc");\n            this.body.style.setProperty("border-radius", "6px");\n            this.body.style.setProperty("padding", "6px");\n        },\n\n        addItem: function (target) {\n            var item = document.createElement("div");\n            item.style.setProperty("padding", "2px 6px");\n            if (this.body.childNodes.length > 0) {\n                item.style.setProperty("border-top", "1px solid #ccc");\n            }\n            item.style.setProperty("cursor", "pointer");\n            item.style.setProperty("background", _typeColor(target.type));\n            item.innerHTML = target.name;\n            item.addEventListener("click", this.onClick.bind(this, target.url));\n\n            if (target.file) {\n                var file = document.createElement("i");\n                file.style.setProperty("float", "right");\n                file.style.setProperty("margin-left", "12px");\n                file.innerHTML = " " + target.file;\n                item.appendChild(file);\n            }\n            this.body.appendChild(item);\n        },\n\n        show: function () {\n            if (!this.body) {\n                this.body = this.createBody();\n            }\n            if (!this.body.parentNode) {\n                document.body.appendChild(this.body);\n            }\n            document.addEventListener("click", this.remove);\n        },\n\n        remove: function () {\n            if (this.body && this.body.parentNode) {\n                document.body.removeChild(this.body);\n            }\n            document.removeEventListener("click", this.remove);\n        }\n\n    };\n\n    function Editor(element) {\n        this.onBlur = this.onBlur.bind(this);\n        this.onKeyPress = this.onKeyPress.bind(this);\n\n        this.element = element;\n        this.element.setAttribute("contenteditable", "true");\n        this.element.focus();\n        this.element.addEventListener("blur", this.onBlur);\n        this.element.addEventListener("keypress", this.onKeyPress);\n\n        this.revertText = this.element.innerHTML;\n\n        _trigger(this.element, "edit", 1);\n    }\n\n    Editor.prototype = {\n        onBlur: function (event) {\n            this.element.removeAttribute("contenteditable");\n            this.element.removeEventListener("blur", this.onBlur);\n            this.element.removeEventListener("keypress", this.onKeyPress);\n            _trigger(this.element, "edit", 0, true);\n        },\n\n        onKeyPress: function (event) {\n            switch (event.which) {\n            case 13: // return\n                this.element.blur();\n                break;\n            case 27: // esc\n                this.element.innerHTML = this.revertText;\n                this.element.blur();\n                break;\n            }\n        }\n    };\n\n    function Highlight(color, trigger) {\n        this.color = color;\n        this.trigger = !!trigger;\n        this.elements = [];\n        this.selector = "";\n    }\n\n    Highlight.prototype = {\n        _elementExists: function (element) {\n            var i;\n            for (i in this.elements) {\n                if (this.elements[i] === element) {\n                    return true;\n                }\n            }\n            return false;\n        },\n\n        _makeHighlightDiv: function (element, doAnimation) {\n            var elementBounds = element.getBoundingClientRect(),\n                highlight = window.document.createElement("div"),\n                styles = window.getComputedStyle(element);\n            \n            // Don\'t highlight elements with 0 width & height\n            if (elementBounds.width === 0 && elementBounds.height === 0) {\n                return;\n            }\n            \n            highlight.className = HIGHLIGHT_CLASSNAME;\n            \n            var stylesToSet = {\n                "left": _screenOffset(element, "offsetLeft") + "px",\n                "top": _screenOffset(element, "offsetTop") + "px",\n                "width": elementBounds.width + "px",\n                "height": elementBounds.height + "px",\n                "z-index": 2000000,\n                "margin": 0,\n                "padding": 0,\n                "position": "absolute",\n                "pointer-events": "none",\n                "border-top-left-radius": styles.borderTopLeftRadius,\n                "border-top-right-radius": styles.borderTopRightRadius,\n                "border-bottom-left-radius": styles.borderBottomLeftRadius,\n                "border-bottom-right-radius": styles.borderBottomRightRadius,\n                "border-style": "solid",\n                "border-width": "1px",\n                "border-color": "#00a2ff",\n                "box-shadow": "0 0 1px #fff",\n                "box-sizing": "border-box"\n            };\n            \n            var animateStartValues = {\n                "background-color": "rgba(0, 162, 255, 0.5)",\n                "opacity": 0\n            };\n            \n            var animateEndValues = {\n                "background-color": "rgba(0, 162, 255, 0)",\n                "opacity": 1\n            };\n            \n            var transitionValues = {\n                "-webkit-transition-property": "opacity, background-color",\n                "-webkit-transition-duration": "300ms, 2.3s",\n                "transition-property": "opacity, background-color",\n                "transition-duration": "300ms, 2.3s"\n            };\n            \n            function _setStyleValues(styleValues, obj) {\n                var prop;\n                \n                for (prop in styleValues) {\n                    obj.setProperty(prop, styleValues[prop]);\n                }\n            }\n\n            _setStyleValues(stylesToSet, highlight.style);\n            _setStyleValues(\n                doAnimation ? animateStartValues : animateEndValues,\n                highlight.style\n            );\n            \n            \n            if (doAnimation) {\n                _setStyleValues(transitionValues, highlight.style);\n                \n                window.setTimeout(function () {\n                    _setStyleValues(animateEndValues, highlight.style);\n                }, 0);\n            }\n        \n            window.document.body.appendChild(highlight);\n        },\n        \n        add: function (element, doAnimation) {\n            if (this._elementExists(element) || element === document) {\n                return;\n            }\n            if (this.trigger) {\n                _trigger(element, "highlight", 1);\n            }\n            this.elements.push(element);\n            \n            this._makeHighlightDiv(element, doAnimation);\n        },\n\n        clear: function () {\n            var i, highlights = window.document.querySelectorAll("." + HIGHLIGHT_CLASSNAME),\n                body = window.document.body;\n        \n            for (i = 0; i < highlights.length; i++) {\n                body.removeChild(highlights[i]);\n            }\n\n            if (this.trigger) {\n                for (i = 0; i < this.elements.length; i++) {\n                    _trigger(this.elements[i], "highlight", 0);\n                }\n            }\n            \n            this.elements = [];\n        },\n        \n        redraw: function () {\n            var i, highlighted;\n            \n            // When redrawing a selector-based highlight, run a new selector\n            // query to ensure we have the latest set of elements to highlight.\n            if (this.selector) {\n                highlighted = window.document.querySelectorAll(this.selector);\n            } else {\n                highlighted = this.elements.slice(0);\n            }\n            \n            this.clear();\n            for (i = 0; i < highlighted.length; i++) {\n                this.add(highlighted[i], false);\n            }\n        }\n    };\n\n    var _currentEditor;\n    function _toggleEditor(element) {\n        _currentEditor = new Editor(element);\n    }\n\n    var _currentMenu;\n    function _toggleMenu(element) {\n        if (_currentMenu) {\n            _currentMenu.remove();\n        }\n        _currentMenu = new Menu(element);\n    }\n\n    var _localHighlight;\n    var _remoteHighlight;\n    var _setup = false;\n\n\n    /** Event Handlers ***********************************************************/\n\n    function onMouseOver(event) {\n        if (_validEvent(event)) {\n            _localHighlight.add(event.target, true);\n        }\n    }\n\n    function onMouseOut(event) {\n        if (_validEvent(event)) {\n            _localHighlight.clear();\n        }\n    }\n\n    function onMouseMove(event) {\n        onMouseOver(event);\n        document.removeEventListener("mousemove", onMouseMove);\n    }\n\n    function onClick(event) {\n        if (_validEvent(event)) {\n            event.preventDefault();\n            event.stopPropagation();\n            if (event.altKey) {\n                _toggleEditor(event.target);\n            } else {\n                _toggleMenu(event.target);\n            }\n        }\n    }\n\n    function onKeyUp(event) {\n        if (_setup && !_validEvent(event)) {\n            document.removeEventListener("keyup", onKeyUp);\n            document.removeEventListener("mouseover", onMouseOver);\n            document.removeEventListener("mouseout", onMouseOut);\n            document.removeEventListener("mousemove", onMouseMove);\n            document.removeEventListener("click", onClick);\n            _localHighlight.clear();\n            _localHighlight = undefined;\n            _setup = false;\n        }\n    }\n\n    function onKeyDown(event) {\n        if (!_setup && _validEvent(event)) {\n            document.addEventListener("keyup", onKeyUp);\n            document.addEventListener("mouseover", onMouseOver);\n            document.addEventListener("mouseout", onMouseOut);\n            document.addEventListener("mousemove", onMouseMove);\n            document.addEventListener("click", onClick);\n            _localHighlight = new Highlight("#ecc", true);\n            _setup = true;\n        }\n    }\n\n    /** Public Commands **********************************************************/\n\n    // keep alive. Called once a second when a Live Development connection is active.\n    // If several seconds have passed without this method being called, we can assume\n    // that the connection has been severed and we should remove all our code/hooks.\n    function keepAlive() {\n        lastKeepAliveTime = Date.now();\n    }\n    \n    // show goto\n    function showGoto(targets) {\n        if (!_currentMenu) {\n            return;\n        }\n        _currentMenu.createBody();\n        var i;\n        for (i in targets) {\n            _currentMenu.addItem(targets[i]);\n        }\n        _currentMenu.show();\n    }\n\n    // remove active highlights\n    function hideHighlight() {\n        if (_remoteHighlight) {\n            _remoteHighlight.clear();\n            _remoteHighlight = null;\n        }\n    }\n\n    // highlight a node\n    function highlight(node, clear) {\n        if (!_remoteHighlight) {\n            _remoteHighlight = new Highlight("#cfc");\n        }\n        if (clear) {\n            _remoteHighlight.clear();\n        }\n        _remoteHighlight.add(node, true);\n    }\n\n    // highlight a rule\n    function highlightRule(rule) {\n        hideHighlight();\n        var i, nodes = document.querySelectorAll(rule);\n        for (i = 0; i < nodes.length; i++) {\n            highlight(nodes[i]);\n        }\n        _remoteHighlight.selector = rule;\n    }\n    \n    // redraw active highlights\n    function redrawHighlights() {\n        if (_remoteHighlight) {\n            _remoteHighlight.redraw();\n        }\n    }\n    \n    window.addEventListener("resize", redrawHighlights);\n    // Add a capture-phase scroll listener to update highlights when\n    // any element scrolls.\n    \n    function _scrollHandler(e) {\n        // Document scrolls can be updated immediately. Any other scrolls\n        // need to be updated on a timer to ensure the layout is correct.\n        if (e.target === document) {\n            redrawHighlights();\n        } else {\n            if (_remoteHighlight || _localHighlight) {\n                window.setTimeout(redrawHighlights, 0);\n            }\n        }\n    }\n    \n    window.addEventListener("scroll", _scrollHandler, true);\n    \n    var aliveTest = window.setInterval(function () {\n        if (Date.now() > lastKeepAliveTime + KEEP_ALIVE_TIMEOUT) {\n            // Remove highlights\n            hideHighlight();\n            \n            // Remove listeners\n            window.removeEventListener("resize", redrawHighlights);\n            window.removeEventListener("scroll", _scrollHandler, true);\n            \n            // Clear this interval\n            window.clearInterval(aliveTest);\n        }\n    }, 1000);\n    \n    /**\n     * Constructor\n     * @param {Document} htmlDocument\n     */\n    function DOMEditHandler(htmlDocument) {\n        this.htmlDocument = htmlDocument;\n        this.rememberedNodes = null;\n        this.entityParseParent = htmlDocument.createElement("div");\n    }\n\n    /**\n     * @private\n     * Find the first matching element with the specified data-brackets-id\n     * @param {string} id\n     * @return {Element}\n     */\n    DOMEditHandler.prototype._queryBracketsID = function (id) {\n        if (!id) {\n            return null;\n        }\n        \n        if (this.rememberedNodes && this.rememberedNodes[id]) {\n            return this.rememberedNodes[id];\n        }\n        \n        var results = this.htmlDocument.querySelectorAll("[data-brackets-id=\'" + id + "\']");\n        return results && results[0];\n    };\n    \n    /**\n     * @private\n     * Insert a new child element\n     * @param {Element} targetElement Parent element already in the document\n     * @param {Element} childElement New child element\n     * @param {Object} edit\n     */\n    DOMEditHandler.prototype._insertChildNode = function (targetElement, childElement, edit) {\n        var before = this._queryBracketsID(edit.beforeID),\n            after  = this._queryBracketsID(edit.afterID);\n        \n        if (edit.firstChild) {\n            before = targetElement.firstChild;\n        } else if (edit.lastChild) {\n            after = targetElement.lastChild;\n        }\n        \n        if (before) {\n            targetElement.insertBefore(childElement, before);\n        } else if (after && (after !== targetElement.lastChild)) {\n            targetElement.insertBefore(childElement, after.nextSibling);\n        } else {\n            targetElement.appendChild(childElement);\n        }\n    };\n    \n    /**\n     * @private\n     * Given a string containing encoded entity references, returns the string with the entities decoded.\n     * @param {string} text The text to parse.\n     * @return {string} The decoded text.\n     */\n    DOMEditHandler.prototype._parseEntities = function (text) {\n        // Kind of a hack: just set the innerHTML of a div to the text, which will parse the entities, then\n        // read the content out.\n        var result;\n        this.entityParseParent.innerHTML = text;\n        result = this.entityParseParent.textContent;\n        this.entityParseParent.textContent = "";\n        return result;\n    };\n    \n    /**\n     * @private\n     * @param {Node} node\n     * @return {boolean} true if node expects its content to be raw text (not parsed for entities) according to the HTML5 spec.\n     */\n    function _isRawTextNode(node) {\n        return (node.nodeType === Node.ELEMENT_NODE && /script|style|noscript|noframes|noembed|iframe|xmp/i.test(node.tagName));\n    }\n    \n    /**\n     * @private\n     * Replace a range of text and comment nodes with an optional new text node\n     * @param {Element} targetElement\n     * @param {Object} edit\n     */\n    DOMEditHandler.prototype._textReplace = function (targetElement, edit) {\n        function prevIgnoringHighlights(node) {\n            do {\n                node = node.previousSibling;\n            } while (node && node.className === HIGHLIGHT_CLASSNAME);\n            return node;\n        }\n        function nextIgnoringHighlights(node) {\n            do {\n                node = node.nextSibling;\n            } while (node && node.className === HIGHLIGHT_CLASSNAME);\n            return node;\n        }\n        function lastChildIgnoringHighlights(node) {\n            node = (node.childNodes.length ? node.childNodes.item(node.childNodes.length - 1) : null);\n            if (node && node.className === HIGHLIGHT_CLASSNAME) {\n                node = prevIgnoringHighlights(node);\n            }\n            return node;\n        }\n        \n        var start           = (edit.afterID)  ? this._queryBracketsID(edit.afterID)  : null,\n            startMissing    = edit.afterID && !start,\n            end             = (edit.beforeID) ? this._queryBracketsID(edit.beforeID) : null,\n            endMissing      = edit.beforeID && !end,\n            moveNext        = start && nextIgnoringHighlights(start),\n            current         = moveNext || (end && prevIgnoringHighlights(end)) || lastChildIgnoringHighlights(targetElement),\n            next,\n            textNode        = (edit.content !== undefined) ? this.htmlDocument.createTextNode(_isRawTextNode(targetElement) ? edit.content : this._parseEntities(edit.content)) : null,\n            lastRemovedWasText,\n            isText;\n        \n        // remove all nodes inside the range\n        while (current && (current !== end)) {\n            isText = current.nodeType === Node.TEXT_NODE;\n\n            // if start is defined, delete following text nodes\n            // if start is not defined, delete preceding text nodes\n            next = (moveNext) ? nextIgnoringHighlights(current) : prevIgnoringHighlights(current);\n\n            // only delete up to the nearest element.\n            // if the start/end tag was deleted in a prior edit, stop removing\n            // nodes when we hit adjacent text nodes\n            if ((current.nodeType === Node.ELEMENT_NODE) ||\n                    ((startMissing || endMissing) && (isText && lastRemovedWasText))) {\n                break;\n            } else {\n                lastRemovedWasText = isText;\n\n                current.remove();\n                current = next;\n            }\n        }\n        \n        if (textNode) {\n            // OK to use nextSibling here (not nextIgnoringHighlights) because we do literally\n            // want to insert immediately after the start tag.\n            if (start && start.nextSibling) {\n                targetElement.insertBefore(textNode, start.nextSibling);\n            } else if (end) {\n                targetElement.insertBefore(textNode, end);\n            } else {\n                targetElement.appendChild(textNode);\n            }\n        }\n    };\n    \n    /**\n     * @private\n     * Apply an array of DOM edits to the document\n     * @param {Array.<Object>} edits\n     */\n    DOMEditHandler.prototype.apply = function (edits) {\n        var targetID,\n            targetElement,\n            childElement,\n            self = this;\n        \n        this.rememberedNodes = {};\n        \n        edits.forEach(function (edit) {\n            var editIsSpecialTag = edit.type === "elementInsert" && (edit.tag === "html" || edit.tag === "head" || edit.tag === "body");\n            \n            if (edit.type === "rememberNodes") {\n                edit.tagIDs.forEach(function (tagID) {\n                    var node = self._queryBracketsID(tagID);\n                    self.rememberedNodes[tagID] = node;\n                    node.remove();\n                });\n                return;\n            }\n            \n            targetID = edit.type.match(/textReplace|textDelete|textInsert|elementInsert|elementMove/) ? edit.parentID : edit.tagID;\n            targetElement = self._queryBracketsID(targetID);\n            \n            if (!targetElement && !editIsSpecialTag) {\n                console.error("data-brackets-id=" + targetID + " not found");\n                return;\n            }\n            \n            switch (edit.type) {\n            case "attrChange":\n            case "attrAdd":\n                targetElement.setAttribute(edit.attribute, self._parseEntities(edit.value));\n                break;\n            case "attrDelete":\n                targetElement.removeAttribute(edit.attribute);\n                break;\n            case "elementDelete":\n                targetElement.remove();\n                break;\n            case "elementInsert":\n                childElement = null;\n                if (editIsSpecialTag) {\n                    // If we already have one of these elements (which we should), then\n                    // just copy the attributes and set the ID.\n                    childElement = self.htmlDocument[edit.tag === "html" ? "documentElement" : edit.tag];\n                    if (!childElement) {\n                        // Treat this as a normal insertion.\n                        editIsSpecialTag = false;\n                    }\n                }\n                if (!editIsSpecialTag) {\n                    childElement = self.htmlDocument.createElement(edit.tag);\n                }\n                \n                Object.keys(edit.attributes).forEach(function (attr) {\n                    childElement.setAttribute(attr, self._parseEntities(edit.attributes[attr]));\n                });\n                childElement.setAttribute("data-brackets-id", edit.tagID);\n                \n                if (!editIsSpecialTag) {\n                    self._insertChildNode(targetElement, childElement, edit);\n                }\n                break;\n            case "elementMove":\n                childElement = self._queryBracketsID(edit.tagID);\n                self._insertChildNode(targetElement, childElement, edit);\n                break;\n            case "textInsert":\n                var textElement = self.htmlDocument.createTextNode(_isRawTextNode(targetElement) ? edit.content : self._parseEntities(edit.content));\n                self._insertChildNode(targetElement, textElement, edit);\n                break;\n            case "textReplace":\n            case "textDelete":\n                self._textReplace(targetElement, edit);\n                break;\n            }\n        });\n        \n        this.rememberedNodes = {};\n        \n        // update highlight after applying diffs\n        redrawHighlights();\n    };\n    \n    function applyDOMEdits(edits) {\n        _editHandler.apply(edits);\n    }\n    \n    /**\n     *\n     * @param {Element} elem\n     */\n    function _domElementToJSON(elem) {\n        var json = { tag: elem.tagName.toLowerCase(), attributes: {}, children: [] },\n            i,\n            len,\n            node,\n            value;\n        \n        len = elem.attributes.length;\n        for (i = 0; i < len; i++) {\n            node = elem.attributes.item(i);\n            value = (node.name === "data-brackets-id") ? parseInt(node.value, 10) : node.value;\n            json.attributes[node.name] = value;\n        }\n        \n        len = elem.childNodes.length;\n        for (i = 0; i < len; i++) {\n            node = elem.childNodes.item(i);\n            \n            // ignores comment nodes and visuals generated by live preview\n            if (node.nodeType === Node.ELEMENT_NODE && node.className !== HIGHLIGHT_CLASSNAME) {\n                json.children.push(_domElementToJSON(node));\n            } else if (node.nodeType === Node.TEXT_NODE) {\n                json.children.push({ content: node.nodeValue });\n            }\n        }\n        \n        return json;\n    }\n    \n    function getSimpleDOM() {\n        return JSON.stringify(_domElementToJSON(document.documentElement));\n    }\n\n    // init\n    _editHandler = new DOMEditHandler(window.document);\n    \n    if (experimental) {\n        window.document.addEventListener("keydown", onKeyDown);\n    }\n\n    return {\n        "DOMEditHandler"        : DOMEditHandler,\n        "keepAlive"             : keepAlive,\n        "showGoto"              : showGoto,\n        "hideHighlight"         : hideHighlight,\n        "highlight"             : highlight,\n        "highlightRule"         : highlightRule,\n        "redrawHighlights"      : redrawHighlights,\n        "applyDOMEdits"         : applyDOMEdits,\n        "getSimpleDOM"          : getSimpleDOM\n    };\n}'}),define("LiveDevelopment/Agents/RemoteAgent",["require","exports","module","LiveDevelopment/LiveDevelopment","LiveDevelopment/Inspector/Inspector","text!LiveDevelopment/Agents/RemoteFunctions.js"],function(t,n,r){function c(e,t){var n=/^data-ld-(.*)/.exec(t.name);n&&i.triggerHandler(n[1],t)}function h(e,t,n){console.assert(e,"Attempted to call remote method without objectId set.");var r=Array.prototype.slice.call(arguments,2),i,s=new $.Deferred;return typeof r[r.length-1]=="function"&&(i=r.pop()),r=r.map(function(e){return e&&e.nodeId?e.resolve():e}),$.when.apply(undefined,r).done(function(){var u=[];r.forEach(function(e){e.objectId?u.push({objectId:e.objectId}):u.push({value:e})}),o.Runtime.callFunctionOn(e,t,u,undefined,i).then(s.resolve,s.reject)}),s.promise()}function p(e,t){var n=[f,"_LD."+e];return arguments.length>1&&(n=n.concat(Array.prototype.slice.call(arguments,1))),h.apply(null,n)}function d(){l&&(window.clearInterval(l),l=null)}function v(){d(),l=window.setInterval(function(){p("keepAlive")},1e3)}function m(e,t){d();var n="window._LD="+u+"("+s.config.experimental+");";o.Runtime.evaluate(n,function(t){t.error||t.wasThrown?a.reject(t.error):(f=t.result.objectId,a.resolve(),v())})}function g(){return a=new $.Deferred,$(o.Page).on("frameNavigated.RemoteAgent",m),$(o.Page).on("frameStartedLoading.RemoteAgent",d),$(o.DOM).on("attributeModified.RemoteAgent",c),a.promise()}function y(){$(o.Page).off(".RemoteAgent"),$(o.DOM).off(".RemoteAgent"),d()}var i=$(n),s=t("LiveDevelopment/LiveDevelopment"),o=t("LiveDevelopment/Inspector/Inspector"),u=t("text!LiveDevelopment/Agents/RemoteFunctions.js"),a,f,l;n.call=p,n.load=g,n.unload=y}),define("LiveDevelopment/Agents/ScriptAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/DOMAgent"],function(t,n,r){function l(e,t){var n=s.nodeWithId(e);n.trace=t}function c(e){return a[e]}function h(e){return u[e]}function p(e,t){i.DOMDebugger.setDOMBreakpoint(t.root.nodeId,"subtree-modified"),o.resolve()}function d(e,t){if(f){var n=s.nodeWithId(t.node.nodeId);n.trace=f,f=undefined}}function v(e,t){a[t.scriptId]=t,u[t.url]=t}function m(e,t){}function g(e,t){switch(t.reason){case"exception":i.Debugger.resume();break;case"DOM":i.Debugger.resume(),t.data.type==="subtree-modified"&&t.data.insertion===!0&&(f=t.callFrames)}}function y(){u={},a={}}function b(e,t){y()}function w(){y(),o=new $.Deferred;var e=new $.Deferred;return i.Debugger.enable().done(function(){i.Debugger.setPauseOnExceptions("uncaught").done(function(){e.resolve()})}),$(i.Page).on("frameNavigated.ScriptAgent",b),$(s).on("getDocument.ScriptAgent",p),$(i.Debugger).on("scriptParsed.ScriptAgent",v).on("scriptFailedToParse.ScriptAgent",m).on("paused.ScriptAgent",g),$(i.DOM).on("childNodeInserted.ScriptAgent",d),$.when(o.promise(),e.promise())}function E(){y(),$(i.Page).off(".ScriptAgent"),$(s).off(".ScriptAgent"),$(i.Debugger).off(".ScriptAgent"),$(i.DOM).off(".ScriptAgent")}var i=t("LiveDevelopment/Inspector/Inspector"),s=t("LiveDevelopment/Agents/DOMAgent"),o,u,a,f;n.scriptWithId=c,n.scriptForURL=h,n.load=w,n.unload=E}),define("LiveDevelopment/Agents/GotoAgent",["require","exports","module","utils/Global","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/DOMAgent","LiveDevelopment/Agents/ScriptAgent","LiveDevelopment/Agents/RemoteAgent","document/DocumentManager","editor/EditorManager"],function(t,n,r){function l(e){var t=e.search(/[#\?]/);return t>=0&&(e=e.substr(0,t)),e}function c(e){var t=e.split("/");return t[t.length-1]}function h(e,t){if(t.location){var n={},r=s.url,i=t.location;t.canHaveChildren()&&(i+=t.length),r+=":"+i;var o="&lt;"+t.name+"&gt;",u=c(r);e.push({type:"html",url:r,name:o,file:u})}}function p(e,t){if(t.sourceURL){var n={},r=t.sourceURL;r+=":"+t.style.range.start;var i=t.selectorList.text,s=c(r);e.push({type:"css",url:r,name:i,file:s})}}function d(e,t){var n=o.scriptWithId(t.location.scriptId);if(n&&n.url){var r={},i=n.url;i+=":"+t.location.lineNumber+","+t.location.columnNumber;var s=t.functionName;s===""&&(s="anonymous function");var u=c(i);e.push({type:"js",url:i,name:s,file:u})}}function v(e,t){var n=s.nodeWithId(t.nodeId);i.CSS.getMatchedStylesForNode(n.nodeId,function(t){var r,i,s,o,a,f,l=[];h(l,n);for(r in n.trace)d(l,n.trace[r]);for(r in n.events){var c=n.events[r];d(l,c.callFrames[0])}for(r in t.matchedCSSRules.reverse())p(l,t.matchedCSSRules[r].rule);u.call("showGoto",l)})}function m(e,t){var n=f.getCurrentFullEditor(),r=n._codeMirror;typeof e=="number"&&(e=r.posFromIndex(e)),r.setCursor(e),n.focus(),t||(r.addLineClass(e.line,"wrap","flash"),window.setTimeout(function(){r.removeLineClass(e.line,"wrap","flash")},1e3))}function g(e,t,n){console.assert(e.substr(0,7)==="file://","Cannot open non-file URLs");var r=new $.Deferred;e=l(e);var i=e.slice(brackets.platform==="win"?8:7);i=decodeURI(i);var s=a.getDocumentForPath(i);return s.done(function(i){a.setCurrentDocument(i),t&&m(t,n),r.resolve()}),s.fail(function(t){console.error(t),r.reject(t)}),r.promise()}function y(e,t){var n,r=t.value,i=/^(.*):([^:]+)$/.exec(r);i&&(r=i[1],n=i[2].split(","),n.length===1?n=parseInt(n[0],10):n={line:parseInt(n[0],10),ch:parseInt(n[1],10)}),g(r,n)}function b(){$(u).on("showgoto.GotoAgent",v).on("goto.GotoAgent",y)}function w(){$(u).off(".GotoAgent")}t("utils/Global");var i=t("LiveDevelopment/Inspector/Inspector"),s=t("LiveDevelopment/Agents/DOMAgent"),o=t("LiveDevelopment/Agents/ScriptAgent"),u=t("LiveDevelopment/Agents/RemoteAgent"),a=t("document/DocumentManager"),f=t("editor/EditorManager");n.openLocation=m,n.open=g,n.load=b,n.unload=w}),define("LiveDevelopment/Agents/EditAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/DOMAgent","LiveDevelopment/Agents/RemoteAgent","LiveDevelopment/Agents/GotoAgent","editor/EditorManager"],function(t,n,r){function l(e,t){if(e===t)return undefined;var n=e.length,r=0,i;for(i=0;i<n;i++)if(t[i]!==e[i])break;r+=i,t=t.substr(i),n-=i;for(i=0;i<n;i++)if(t[t.length-1-i]!==e[e.length-1-i])break;return n-=i,t=t.substr(0,t.length-i),{from:r,to:r+n,text:t}}function c(e,t){if(f.nodeId!==t.nodeId)return;u.open(s.url);var r=a.getCurrentFullEditor(),i=r._codeMirror,o=l(f.value,t.characterData);if(o){var c=i.posFromIndex(f.location+o.from),h=i.posFromIndex(f.location+o.to);n.isEditing=!0,r.document.replaceRange(o.text,c,h),n.isEditing=!1;var p=i.posFromIndex(f.location+o.from+o.text.length);r.setCursorPos(p.line,p.ch)}}function h(e,t){if(t.value==="0"){$(i.DOM).off(".EditAgent");return}var n=s.nodeWithId(t.nodeId);n=n.children[0];if(!n.location)return;f=n,$(i.DOM).on("characterDataModified.EditAgent",c)}function p(){$(o).on("edit.EditAgent",h)}function d(){$(o).off(".EditAgent")}var i=t("LiveDevelopment/Inspector/Inspector"),s=t("LiveDevelopment/Agents/DOMAgent"),o=t("LiveDevelopment/Agents/RemoteAgent"),u=t("LiveDevelopment/Agents/GotoAgent"),a=t("editor/EditorManager"),f;n.load=p,n.unload=d}),define("LiveDevelopment/Agents/DOMHelpers",["require","exports","module"],function(t,n,r){function i(e,t,n){return t==="\\"?!1:n!==undefined?e===n:e==='"'||e==="'"}function s(e){if(i(e[0])&&e[e.length-1]===e[0]){var t=e[0];e=e.substr(1,e.length-2),e=e.replace("\\"+t,t)}return e}function o(e,t,n,r,s){typeof t=="string"&&(t=[t,t.length]),n===undefined&&(n=0);var o,u,a=!1;for(o=n;o<e.length;o++)if(r&&i(e[o],e[o-1],u))u=u?undefined:e[o];else if(!u)if(s&&!a&&e.substr(o,s[0].length)===s[0])a=!0,o+=s[0].length-1;else if(a)e.substr(o,s[1].length)===s[1]&&(a=!1,o+=s[1].length-1);else if(e.substr(o,t[1]).search(t[0])===0)return o;return-1}function u(e,t,n,r,i){var s=0,u;while(s<e.length)u=o(e,t,s,n,r),u<0&&(u=e.length),i(e.substr(s,u-s)),s=u+1}function a(e,t){var n,r,i;return n=o(e,[/<[a-z!\/]/i,2],t),n<0?null:(e.substr(n,4)==="<!--"?(r=o(e,"-->",n+4),i=3):e.substr(n,7).toLowerCase()==="<script"?(r=o(e.toLowerCase(),"</script>",n+7),i=9):e.substr(n,6).toLowerCase()==="<style"?(r=o(e.toLowerCase(),"</style>",n+6),i=8):(r=o(e,">",n+1,!0),i=1),r<0?null:{from:n,length:r+i-n})}function f(e){e=e.replace(/^<\S+\s*/,""),e=e.replace(/\s*\/?>$/,"");if(e.length===0)return;var t,n,r,i={};return u(e,[/\s/,1],!0,undefined,function(o){t=o.search("=");if(t<0)return;n=o.substr(0,t).trim();if(n.length===0)return;r=o.substr(t+1).trim(),r=s(r),i[n]=r}),i}function l(e){var t={};if(e[0]!=="<")t.nodeType=3,t.nodeValue=e;else if(e.substr(0,4)==="<!--")t.nodeType=8,t.nodeValue=e.substr(4,e.length-7);else if(e[1]==="!")t.nodeType=10;else{t.nodeType=1,t.nodeName=/^<([^>\s]+)/.exec(e)[1].toUpperCase(),t.attributes=f(e),t.nodeName[0]==="/"&&(t.nodeName=t.nodeName.substr(1),t.closing=!0),e[e.length-2]==="/"&&(t.closed=!0);if(t.nodeName==="SCRIPT"||t.nodeName==="STYLE")t.closed=!0}return t}function c(e,t){var n=0,r,i,s,o,u=0;while(n<e.length)i=a(e,n),i||(i={from:e.length,length:0}),s=i.from-n,s>0&&(r=e.substr(n,s),/\S/.test(r)&&(o=l(r),o.sourceOffset=n,o.sourceLength=s,t(o))),i.length>0&&(o=l(e.substr(i.from,i.length)),o.sourceOffset=i.from,o.sourceLength=i.length,t(o)),n=i.from+i.length}n.extractPayload=l,n.eachNode=c}),define("LiveDevelopment/Agents/DOMNode",["require","exports","module","LiveDevelopment/Agents/DOMHelpers"],function(t,n,r){function s(e,t,n){n===undefined&&(n=" ");while(e.length<t)e+=n;return e}function o(e){switch(typeof e){case"function":return e;case"string":return function(t,n){return n.name===t}.bind(undefined,e.toUpperCase());case"number":return function(t,n){return n.type===t}.bind(undefined,e);default:console.error("Invalid find condition: "+e)}}var i=t("LiveDevelopment/Agents/DOMHelpers"),u=function(t,n){this.agent=t,this.children=[],this.attributes={},typeof n=="string"&&(n=i.extractPayload(n)),n&&this.setPayload(n),this.agent.addNode(this)},a=u.TYPE_ELEMENT=1,f=u.TYPE_ATTRIBUTE=2,l=u.TYPE_TEXT=3,c=u.TYPE_COMMENT=8,h=u.TYPE_DOCUMENT=9;return u.prototype.remove=function(){this.agent.removeNode(this),this.parent&&this.parent.removeChild(this)},u.prototype.setPayload=function(t){this.nodeId=t.nodeId,this.type=t.nodeType,t.nodeName&&(this.name=t.nodeName),t.nodeValue&&(this.value=t.nodeValue),this.attributes={};if(t.attributes){var n,r,i;for(n=0;n<t.attributes.length;n+=2)r=t.attributes[n],i=t.attributes[n+1],this.attributes[r]=i}t.sourceOffset&&(this.location=t.sourceOffset),t.sourceLength?this.length=t.sourceLength:this.value?this.length=this.value.length:this.name&&(this.length=this.name.length+2),t.children?this.setChildrenPayload(t.children):t.childNodeCount&&this.agent.requestChildNodes(this)},u.prototype.setChildrenPayload=function(t){var n,r,i;for(n in t)r=t[n],i=new u(this.agent,r),this.appendChild(i)},u.prototype.payload=function(){var t={type:this.type};return this.nodeType===a?t.nodeName=this.name:t.value=this.value,t},u.prototype.findParentForNextNodeMatchingPayload=function(t){var n=this.canHaveChildren()?this:this.parent;while(n&&!n.matchesPayload(t))n=n.parent;return n},u.prototype.findNextNodeMatchingPayload=function(t){var n=this.nextNode();while(n&&!n.matchesPayload(t))n=n.nextNode();return n},u.prototype.matchesPayload=function(t){var n=!1;if(this.type===t.nodeType)switch(this.type){case 1:n=this.name===t.nodeName;break;case 3:n=!0;break;default:n=!0}return n},u.prototype.resolve=function(){var t=new $.Deferred;return this.objectId?t.resolve(this):this.nodeId?this.agent.resolveNode(this,function(n){this.objectId=n.object.objectId,t.resolve(this)}.bind(this)):t.reject(),t.promise()},u.prototype.canHaveChildren=function(){return this.type===1&&!this.closed&&!this.closing&&this.nodeName!=="LINK"},u.prototype.removeChild=function(t){this.children.splice(this.indexOfChild(t),1),delete t.parent},u.prototype.insertChildAt=function(t,n){t.parent&&t.parent.removeChild(t);if(!n||n<0||n>this.children.length)n=this.children.length;return this.children.splice(n,0,t),t.parent=this,t},u.prototype.appendChild=function(t){return this.insertChildAt(t)},u.prototype.insertChildAfter=function(t,n){var r=this.indexOfChild(n);return r>=0&&r++,this.insertChildAt(t,r)},u.prototype.insertChildBefore=function(t,n){var r=this.indexOfChild(n);return this.insertChildAt(t,r)},u.prototype.indexOfChild=function(t){if(!t)return-1;var n;for(n in this.children)if(this.children[n]===t)return parseInt(n,0);return-1},u.prototype.previousSibling=function(){return this.parent?this.parent.children[this.parent.indexOfChild(this)-1]:null},u.prototype.nextSibling=function(){return this.parent?this.parent.children[this.parent.indexOfChild(this)+1]:null},u.prototype.previousNode=function(){var t=this.previousSibling();return t?t.children.length>0&&(t=t.children[t.children.length-1]):t=this.parent,t},u.prototype.nextNode=function(){if(this.children.length>0)return this.children[0];var t,n=this;while(n){t=n.nextSibling();if(t)return t;n=n.parent}return null},u.prototype.each=function(t){if(t(this)===!1)return!1;var n;for(n in this.children)if(this.children[n].each(t)===!1)return!1;return!0},u.prototype.find=function(t){var n=o(t),r=null;return this.each(function(t){if(n(t))return r=t,!1}),r},u.prototype.findAll=function(t){var n=[],r=o(t);return this.each(function(t){r(t)&&n.push(t)}),n},u.prototype.eachParent=function(t){var n=this.parent;while(n){if(t(n)===!1)return;n=n.parent}return null},u.prototype.findParent=function(t){var n=null;return this.eachParent(function(r){if(t(r))return n=r,!1}),n},u.prototype.root=function(){var t=this;while(t.parent)t=t.parent;return t},u.prototype.isAtLocation=function(t,n){n===undefined&&(n=!0);if(!this.location||t<this.location)return!1;var r;return n&&this.closeLocation?r=this.closeLocation+this.closeLength:r=this.location+this.length,this.type===l&&(r+=1),t<r},u.prototype.isEmpty=function(){return this.type===l&&/^\s*$/.test(this.value)},u.prototype.toString=function p(){var e;switch(this.type){case a:e="<"+this.name+">";break;case f:e="[ATTRIBUTE]";break;case l:e=this.value.replace(/\s+/," ").substr(0,40);break;case c:e="<!--"+this.value.replace(/\s+/," ").substr(0,33)+"-->";break;case h:e="<!DOCTYPE>"}return e},u.prototype.dump=function(t){t===undefined&&(t="");var n=t+this.toString();this.location&&(n=s(n,60),n+=" ("+this.location+","+(this.location+this.length)+")",this.closeLocation&&(n+=" ("+this.closeLocation+","+(this.closeLocation+this.closeLength)+")")),this.nodeId&&(n=s(n,80),n+=" {"+this.nodeId+"}"),console.info(n),t+=". ";var r;for(r in this.children)this.children[r].dump(t)},u}),define("LiveDevelopment/Agents/DOMAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/RemoteAgent","LiveDevelopment/Agents/EditAgent","LiveDevelopment/Agents/DOMNode","LiveDevelopment/Agents/DOMHelpers"],function(t,n,r){function p(e){var t;return n.root.each(function(r){if(!r.location||e<r.location)return!0;if(!t||t.location<r.location)t=r}),t}function d(e){var t=[];return n.root.each(function(r){r.type===a.TYPE_ELEMENT&&r.isAtLocation(e)&&t.push(r)}),t}function v(e){return n.root.find(function(n){return n.isAtLocation(e,!1)})}function m(e){return c[e]}function g(e){e.nodeId&&delete c[e.nodeId]}function y(e){e.nodeId&&(c[e.nodeId]=e)}function b(e){h>=0&&h++,s.DOM.requestChildNodes(e.nodeId)}function w(e,t){console.assert(e.nodeId,"Attempted to resolve node without id"),s.DOM.resolveNode(e.nodeId,t)}function E(e){var t=e.search(/[#\?]/);return t>=0&&(e=e.substr(0,t)),e}function S(e){var t=n.root;f.eachNode(e,function(n){if(!t)return!0;if(n.closing){var r=t.findParentForNextNodeMatchingPayload(n);if(!r)return console.warn("Matching Parent not at "+n.sourceOffset+" ("+n.nodeName+")");r.closeLocation=n.sourceOffset,r.closeLength=n.sourceLength}else{var i=t.findNextNodeMatchingPayload(n);if(!i)return console.warn("Skipping Source Node at "+n.sourceOffset);t=i,t.location=n.sourceOffset,t.length=n.sourceLength,n.closed&&(t.closed=n.closed)}})}function x(){var e=new XMLHttpRequest;e.open("GET",n.url),e.onload=function(){if(e.status>=200&&e.status<300||e.status===304||e.status===0)S(e.response),l.resolve();else{var r="Received status "+e.status+" from XMLHttpRequest while attempting to load source file at "+n.url;l.reject(r,{message:r})}},e.onerror=function(){var t="Could not load source file at "+n.url;l.reject(t,{message:t})},e.send(null)}function T(e,t){s.DOM.getDocument(function(t){i.triggerHandler("getDocument",t),c={},h=0,n.root=new a(n,t.root)})}function N(e,t){t.frame.parentId||(n.url=E(t.frame.url))}function C(e,t){}function k(e,t){var n=m(t.parentId);n.setChildrenPayload(t.nodes),h>0&&--h===0&&x()}function L(e,t){t.nodeId>0&&s.DOM.requestChildNodes(t.nodeId)}function A(e,t){if(t.node.nodeId>0){var r=m(t.parentNodeId),i=m(t.previousNodeId),s=new a(n,t.node);r.insertChildAfter(s,i)}}function O(e,t){if(t.nodeId>0){var n=m(t.nodeId);n.remove()}}function M(e,t,r){var i=e-t+r.length,o=v(e);if(!o)/^\s*$/.test(r)||(console.warn("Inserting nodes not supported."),o=p(e));else if(o.type===3){var a=o.value.substr(0,e-o.location);a+=r,a+=o.value.substr(t-o.location),o.value=a,u.isEditing||s.DOM.setNodeValue(o.nodeId,o.value)}else console.warn("Changing non-text nodes not supported.");o&&(o.length+=i,n.root.each(function(t){t.location>o.location&&(t.location+=i),t.closeLocation!==undefined&&t.closeLocation>o.location&&(t.closeLocation+=i)}))}function _(){return l=new $.Deferred,$(s.Page).on("frameNavigated.DOMAgent",N).on("loadEventFired.DOMAgent",T),$(s.DOM).on("documentUpdated.DOMAgent",C).on("setChildNodes.DOMAgent",k).on("childNodeCountUpdated.DOMAgent",L).on("childNodeInserted.DOMAgent",A).on("childNodeRemoved.DOMAgent",O),l.promise()}function D(){$(s.Page).off(".DOMAgent"),$(s.DOM).off(".DOMAgent")}var i=$(n),s=t("LiveDevelopment/Inspector/Inspector"),o=t("LiveDevelopment/Agents/RemoteAgent"),u=t("LiveDevelopment/Agents/EditAgent"),a=t("LiveDevelopment/Agents/DOMNode"),f=t("LiveDevelopment/Agents/DOMHelpers"),l,c,h;n.nodeBeforeLocation=p,n.allNodesAtLocation=d,n.nodeAtLocation=v,n.nodeWithId=m,n.removeNode=g,n.addNode=y,n.requestChildNodes=b,n.applyChange=M,n.load=_,n.unload=D}),define("LiveDevelopment/Agents/HighlightAgent",["require","exports","module","LiveDevelopment/Agents/DOMAgent","LiveDevelopment/Inspector/Inspector","LiveDevelopment/LiveDevelopment","LiveDevelopment/Agents/RemoteAgent","thirdparty/lodash"],function(t,n,r){function l(e,t){var r;t.value==="1"&&(r=i.nodeWithId(t.nodeId)),$(n).triggerHandler("highlight",[r])}function c(){switch(f.type){case"node":s.DOM.hideHighlight();break;case"css":u.call("hideHighlight")}f={}}function h(e){if(!o.config.experimental)return;if(!s.config.highlight)return;e&&e.type===3&&(e=e.parent);if(!e||!e.nodeId||e.type!==1)return c();if(f.type==="node"&&f.ref===e.nodeId)return;f={type:"node",ref:e.nodeId},s.DOM.highlightNode(e.nodeId,s.config.highlightConfig)}function p(e){if(f.ref===e)return;c(),f={type:"css",ref:e},u.call("highlightRule",e)}function d(e){var t="";Array.isArray(e)||(e=[e]),a.each(e,function(e){t!==""&&(t+=","),t+="[data-brackets-id='"+e+"']"}),p(t)}function v(){u.call("redrawHighlights")}function m(){o.config.experimental&&$(u).on("highlight.HighlightAgent",l)}function g(){o.config.experimental&&$(u).off(".HighlightAgent")}var i=t("LiveDevelopment/Agents/DOMAgent"),s=t("LiveDevelopment/Inspector/Inspector"),o=t("LiveDevelopment/LiveDevelopment"),u=t("LiveDevelopment/Agents/RemoteAgent"),a=t("thirdparty/lodash"),f={};n.hide=c,n.node=h,n.rule=p,n.domElement=d,n.redraw=v,n.load=m,n.unload=g}),define("LiveDevelopment/Documents/CSSDocument",["require","exports","module","thirdparty/lodash","LiveDevelopment/Agents/CSSAgent","language/CSSUtils","editor/EditorManager","LiveDevelopment/Agents/HighlightAgent","LiveDevelopment/Inspector/Inspector"],function(t,n,r){var i=t("thirdparty/lodash"),s=t("LiveDevelopment/Agents/CSSAgent"),o=t("language/CSSUtils"),u=t("editor/EditorManager"),a=t("LiveDevelopment/Agents/HighlightAgent"),f=t("LiveDevelopment/Inspector/Inspector"),l=function(t,n){this.doc=t,this._highlight=[],this.onHighlight=this.onHighlight.bind(this),this.onCursorActivity=this.onCursorActivity.bind(this),this.doc.addRef(),this.onChange=this.onChange.bind(this),this.onDeleted=this.onDeleted.bind(this),$(this.doc).on("change.CSSDocument",this.onChange),$(this.doc).on("deleted.CSSDocument",this.onDeleted),this.onActiveEditorChange=this.onActiveEditorChange.bind(this),$(u).on("activeEditorChange",this.onActiveEditorChange),n&&this.attachToEditor(n)};l.prototype._getStyleSheetHeader=function(){return s.styleForURL(this.doc.url)},l.prototype.getStyleSheetFromBrowser=function(){return(new $.Deferred).reject().promise()},l.prototype.getSourceFromBrowser=function(){var t=new $.Deferred,n=this._getStyleSheetHeader().styleSheetId,r=f.CSS.getStyleSheetText(n);return r.then(function(e){t.resolve(e.text)},t.reject),t.promise()},l.prototype.close=function(){$(this.doc).off(".CSSDocument"),$(u).off("activeEditorChange",this.onActiveEditorChange),this.doc.releaseRef(),this.detachFromEditor()},l.prototype._updateBrowser=function(){var e=s.reloadCSSForDocument(this.doc);f.config.highlight&&e.done(a.redraw)},l.prototype.attachToEditor=function(e){this.editor=e,this.editor&&($(a).on("highlight",this.onHighlight),$(this.editor).on("cursorActivity.CSSDocument",this.onCursorActivity),this.updateHighlight())},l.prototype.detachFromEditor=function(){this.editor&&(a.hide(),$(a).off("highlight",this.onHighlight),$(this.editor).off(".CSSDocument"),this.onHighlight(),this.editor=null)},l.prototype.updateHighlight=function(){if(f.config.highlight&&this.editor){var e=this.editor,t=e._codeMirror,n=[];i.each(this.editor.getSelections(),function(t){var r=o.findSelectorAtDocumentPos(e,t.reversed?t.end:t.start);r&&n.push(r)}),n.length?a.rule(n.join(",")):a.hide()}},l.prototype.setInstrumentationEnabled=function(t){},l.prototype.isLiveEditingEnabled=function(){return!0},l.prototype.getResponseData=function(t){return{body:this.doc.getText()}},l.prototype.onCursorActivity=function(t,n){this.updateHighlight()},l.prototype.onChange=function(t,n,r){this._updateBrowser()},l.prototype.onDeleted=function(t,n,r){s.clearCSSForDocument(this.doc),this.close(),$(this).triggerHandler("deleted",[this])},l.prototype.onActiveEditorChange=function(e,t,n){this.detachFromEditor(),t&&t.document===this.doc&&this.attachToEditor(t)},l.prototype.onHighlight=function(t,n){var r;for(r in this._highlight)this._highlight[r].clear();this._highlight=[];if(!n||!n.location)return;f.CSS.getMatchedStylesForNode(n.nodeId,function(t){var n=this.editor._codeMirror,r=this._getStyleSheetHeader().styleSheetId,i,s,o,u;for(i in t.matchedCSSRules)s=t.matchedCSSRules[i],s.ruleId&&s.ruleId.styleSheetId===r&&(o=n.posFromIndex(s.selectorRange.start),u=n.posFromIndex(s.style.range.end),this._highlight.push(n.markText(o,u,{className:"highlight"})))}.bind(this))},r.exports=l}),define("language/HTMLTokenizer",["require","exports","module"],function(e,t,n){function tt(e){return e===" "||e==="	"||e==="\r"||e==="\n"}function nt(e){return/[A-Za-z0-9\-]/.test(e)}function rt(e){return e!=='"'&&e!=="'"&&e!=="<"&&e!=="="}function it(e){return e!=="<"&&e!=="="}function st(e,t){return e?{line:e.line,ch:e.ch+(t||0)}:null}function ot(e){this._state=i,this._buffer=e,this._sectionStart=0,this._sectionStartPos={line:0,ch:0},this._index=0,this._indexPos={line:0,ch:0},this._special=0,this._token=null,this._nextToken=null}var r=0,i=r++,s=r++,o=r++,u=r++,a=r++,f=r++,l=r++,c=r++,h=r++,p=r++,d=r++,v=r++,m=r++,g=r++,y=r++,b=r++,w=r++,E=r++,S=r++,x=r++,T=r++,N=r++,C=r++,k=r++,L=r++,A=r++,O=r++,M=r++,_=r++,D=r++,P=r++,H=r++,B=r++,j=r++,F=r++,I=r++,q=r++,R=r++,U=r++,z=r++,W=r++,X=r++,V=r++,$=r++,J=r++,K=r++,Q=r++,G=r++,Y=r++,Z=r++,et=r++;ot.prototype.nextToken=function(){this._token=null;if(this._nextToken){var e=this._nextToken;return this._nextToken=null,e}while(this._index<this._buffer.length&&!this._token){var t=this._buffer.charAt(this._index);if(this._state===i)t==="<"&&(this._emitTokenIfNonempty("text"),this._state=s,this._startSection());else if(this._state===s)if(t==="/")this._state=u;else if(t===">"||this._special>0)this._state=i;else if(t==="!")this._state=b,this._startSection(1);else if(t==="?")this._state=E,this._startSection(1);else if(t==="s"||t==="S")this._state=H,this._startSection();else{if(!nt(t)){this._emitSpecialToken("error");break}tt(t)||(this._state=o,this._startSection())}else if(this._state===o){if(t==="/")this._emitToken("opentagname"),this._emitSpecialToken("selfclosingtag",this._index+2,st(this._indexPos,2)),this._state=l;else if(t===">")this._emitToken("opentagname"),this._emitSpecialToken("opentagend",this._index+1,st(this._indexPos,1)),this._state=i,this._startSection(1);else if(tt(t))this._emitToken("opentagname"),this._state=c;else if(!nt(t)){this._emitSpecialToken("error");break}}else if(this._state===u)if(t===">")this._state=i;else if(this._special>0){if(t!=="s"&&t!=="S"){this._state=i;continue}this._state=B}else{if(!nt(t)){this._emitSpecialToken("error");break}tt(t)||(this._state=a,this._startSection())}else if(this._state===a){if(t===">")this._emitToken("closetag"),this._state=i,this._startSection(1),this._special=0;else if(tt(t))this._emitToken("closetag"),this._state=f,this._special=0;else if(!nt(t)){this._emitSpecialToken("error");break}}else if(this._state===f){if(t===">")this._state=i,this._startSection(1);else if(!tt(t)){this._emitSpecialToken("error");break}}else if(this._state===l){if(t!==">"){this._emitSpecialToken("error");break}this._state=i,this._startSection(1)}else if(this._state===c)if(t===">")this._state=i,this._emitSpecialToken("opentagend",this._index+1,st(this._indexPos,1)),this._startSection(1);else if(t==="/")this._emitSpecialToken("selfclosingtag",this._index+2,st(this._indexPos,2)),this._state=l;else{if(!rt(t)){this._emitSpecialToken("error");break}tt(t)||(this._state=p,this._startSection())}else if(this._state===p)if(t==="=")this._emitTokenIfNonempty("attribname"),this._state=v;else if(tt(t))this._emitTokenIfNonempty("attribname"),this._state=d;else{if(t==="/"||t===">"){this._emitTokenIfNonempty("attribname"),this._state=c;continue}if(!rt(t)){this._emitSpecialToken("error");break}}else if(this._state===d)if(t==="=")this._state=v;else{if(t==="/"||t===">"){this._state=c;continue}if(!rt(t)){this._emitSpecialToken("error");break}tt(t)||(this._state=p,this._startSection())}else if(this._state===v)if(t==='"')this._state=m,this._startSection(1);else if(t==="'")this._state=g,this._startSection(1);else{if(!it(t)){this._emitSpecialToken("error");break}tt(t)||(this._state=y,this._startSection())}else if(this._state===m)t==='"'&&(this._emitToken("attribvalue"),this._state=h);else if(this._state===g)t==="'"&&(this._state=h,this._emitToken("attribvalue"));else if(this._state===y){if(t===">")this._emitToken("attribvalue"),this._emitSpecialToken("opentagend",this._index+1,st(this._indexPos,1)),this._state=i,this._startSection(1);else if(tt(t))this._emitToken("attribvalue"),this._state=c;else if(!it(t)){this._emitSpecialToken("error");break}}else if(this._state===h)if(t===">")this._state=i,this._emitSpecialToken("opentagend",this._index+1,st(this._indexPos,1)),this._startSection(1);else if(t==="/")this._emitSpecialToken("selfclosingtag",this._index+2,st(this._indexPos,2)),this._state=l;else{if(!tt(t)){this._emitSpecialToken("error");break}this._state=c}else if(this._state===b)t==="["?this._state=C:t==="-"?this._state=S:this._state=w;else if(this._state===w)t===">"&&(this._emitToken("declaration"),this._state=i,this._startSection(1));else if(this._state===E)t===">"&&(this._emitToken("processinginstruction"),this._state=i,this._startSection(1));else if(this._state===S)t==="-"?(this._state=x,this._startSection(1)):this._state=w;else if(this._state===x)t==="-"&&(this._state=T);else if(this._state===T)t==="-"?this._state=N:this._state=x;else if(this._state===N)t===">"?(this._emitToken("comment",this._index-2,st(this._indexPos,-2)),this._state=i,this._startSection(1)):t!=="-"&&(this._state=x);else if(this._state===C)t==="C"?this._state=k:this._state=w;else if(this._state===k)t==="D"?this._state=L:this._state=w;else if(this._state===L)t==="A"?this._state=A:this._state=w;else if(this._state===A)t==="T"?this._state=O:this._state=w;else if(this._state===O)t==="A"?this._state=M:this._state=w;else if(this._state===M)t==="["?(this._state=_,this._startSection(1)):this._state=w;else if(this._state===_)t==="]"&&(this._state=D);else if(this._state===D)t==="]"?this._state=P:this._state=_;else if(this._state===P)t===">"?(this._emitToken("cdata",this._index-2,st(this._indexPos,-2)),this._state=i,this._startSection(1)):t!=="]"&&(this._state=_);else if(this._state===H)if(t==="c"||t==="C")this._state=j;else{if(t!=="t"&&t!=="T"){this._state=o;continue}this._state=$}else if(this._state===B)this._special!==1||t!=="c"&&t!=="C"?this._special!==2||t!=="t"&&t!=="T"?this._state=i:this._state=G:this._state=U;else if(this._state===j){if(t!=="r"&&t!=="R"){this._state=o;continue}this._state=F}else if(this._state===F){if(t!=="i"&&t!=="I"){this._state=o;continue}this._state=I}else if(this._state===I){if(t!=="p"&&t!=="P"){this._state=o;continue}this._state=q}else if(this._state===q){if(t!=="t"&&t!=="T"){this._state=o;continue}this._state=R}else{if(this._state===R){if(t==="/"||t===">"||tt(t))this._special=1;this._state=o;continue}if(this._state===U)t==="r"||t==="R"?this._state=z:this._state=i;else if(this._state===z)t==="i"||t==="I"?this._state=W:this._state=i;else if(this._state===W)t==="p"||t==="P"?this._state=X:this._state=i;else if(this._state===X)t==="t"||t==="T"?this._state=V:this._state=i;else if(this._state===V){if(t===">"||tt(t)){this._state=a,this._startSection(-6);continue}this._state=i}else if(this._state===$){if(t!=="y"&&t!=="Y"){this._state=o;continue}this._state=J}else if(this._state===J){if(t!=="l"&&t!=="L"){this._state=o;continue}this._state=K}else if(this._state===K){if(t!=="e"&&t!=="E"){this._state=o;continue}this._state=Q}else{if(this._state===Q){if(t==="/"||t===">"||tt(t))this._special=2;this._state=o;continue}if(this._state===G)t==="y"||t==="Y"?this._state=Y:this._state=i;else if(this._state===Y)t==="l"||t==="L"?this._state=Z:this._state=i;else if(this._state===Z)t==="e"||t==="E"?this._state=et:this._state=i;else{if(this._state!==et){console.error("HTMLTokenizer: Encountered unknown state"),this._emitSpecialToken("error");break}if(t===">"||tt(t)){this._state=a,this._startSection(-5);continue}this._state=i}}}t==="\n"?(this._indexPos.line++,this._indexPos.ch=0):this._indexPos.ch++,this._index++}return this._index===this._buffer.length&&this._state!==i&&this._emitSpecialToken("error"),this._token},ot.prototype._startSection=function(e){e=e||0,this._sectionStart=this._index+e,this._sectionStartPos=st(this._indexPos,e)},ot.prototype._setToken=function(e,t,n){t===undefined&&(t=this._index),n===undefined&&(n=this._indexPos);var r={type:e,contents:this._sectionStart===-1?"":this._buffer.substring(this._sectionStart,t),start:this._sectionStart,end:t,startPos:st(this._sectionStartPos),endPos:st(n)};this._token?(this._nextToken&&console.error("HTMLTokenizer: Tried to emit more than two tokens in a single call"),this._nextToken=r):this._token=r},ot.prototype._emitToken=function(e,t,n){this._setToken(e,t,n),this._sectionStart=-1,this._sectionStartPos=null},ot.prototype._emitSpecialToken=function(e,t,n){this._sectionStart=-1,this._sectionStartPos=null,this._emitToken(e,t,n)},ot.prototype._emitTokenIfNonempty=function(e){this._index>this._sectionStart&&this._setToken(e),this._sectionStart=-1,this._sectionStartPos=null},t.Tokenizer=ot}),define("thirdparty/murmurhash3_gc",["require","exports","module"],function(e,t,n){var r={mul32:function(e,t){var n=t&65535,r=t-n;return(r*e|0)+(n*e|0)|0},hashBytes:function(e,t,n){var r=3432918353,i=461845907,s=n,o=t&-4;for(var u=0;u<o;u+=4){var a=e.charCodeAt(u)&255|(e.charCodeAt(u+1)&255)<<8|(e.charCodeAt(u+2)&255)<<16|(e.charCodeAt(u+3)&255)<<24;a=this.mul32(a,r),a=(a&131071)<<15|a>>>17,a=this.mul32(a,i),s^=a,s=(s&524287)<<13|s>>>19,s=s*5+3864292196|0}a=0;switch(t%4){case 3:a=(e.charCodeAt(o+2)&255)<<16;case 2:a|=(e.charCodeAt(o+1)&255)<<8;case 1:a|=e.charCodeAt(o)&255,a=this.mul32(a,r),a=(a&131071)<<15|a>>>17,a=this.mul32(a,i),s^=a}return s^=t,s^=s>>>16,s=this.mul32(s,2246822507),s^=s>>>13,s=this.mul32(s,3266489909),s^=s>>>16,s},hashString:function(e,t,n){var r=3432918353,i=461845907,s=n,o=t&-2;for(var u=0;u<o;u+=2){var a=e.charCodeAt(u)|e.charCodeAt(u+1)<<16;a=this.mul32(a,r),a=(a&131071)<<15|a>>>17,a=this.mul32(a,i),s^=a,s=(s&524287)<<13|s>>>19,s=s*5+3864292196|0}return t%2==1&&(a=e.charCodeAt(o),a=this.mul32(a,r),a=(a&131071)<<15|a>>>17,a=this.mul32(a,i),s^=a),s^=t<<1,s^=s>>>16,s=this.mul32(s,2246822507),s^=s>>>13,s=this.mul32(s,3266489909),s^=s>>>16,s}};typeof n!="undefined"&&typeof n.exports!="undefined"&&(n.exports=r)}),define("language/HTMLSimpleDOM",["require","exports","module","document/DocumentManager","language/HTMLTokenizer","thirdparty/murmurhash3_gc","utils/PerfUtils"],function(e,t,n){function c(e){$.extend(this,e)}function h(e){var t=e.parent.children.indexOf(e);return t===0?e.parent.tagID+".0":e.parent.children[t-1].tagID+"t"}function p(e,t){return{line:e.line+t.line,ch:t.line===0?e.ch+t.ch:t.ch}}function d(e,t){return{line:e.line,ch:e.ch+t}}function v(e,t,n){this.stack=[],this.text=e,this.t=new i(e),this.currentTag=null,this.startOffset=t||0,this.startOffsetPos=n||{line:0,ch:0}}function m(e,t){var n=new v(e);return n.build(t)}function g(e){function r(e){e.tag?t+=n+"TAG "+e.tagID+" "+e.tag+" "+JSON.stringify(e.attributes)+"\n":t+=n+"TEXT "+(e.tagID||"- ")+e.content+"\n",e.isElement()&&(n+="  ",e.children.forEach(r),n=n.slice(2))}var t="",n="";return r(e),t}var r=e("document/DocumentManager"),i=e("language/HTMLTokenizer").Tokenizer,s=e("thirdparty/murmurhash3_gc"),o=e("utils/PerfUtils"),u=Math.floor(Math.random()*65535),a=1,f={li:{li:!0},dt:{dd:!0,dt:!0},dd:{dd:!0,dt:!0},address:{p:!0},article:{p:!0},aside:{p:!0},blockquote:{p:!0},dir:{p:!0},div:{p:!0},dl:{p:!0},fieldset:{p:!0},footer:{p:!0},form:{p:!0},h1:{p:!0},h2:{p:!0},h3:{p:!0},h4:{p:!0},h5:{p:!0},h6:{p:!0},header:{p:!0},hgroup:{p:!0},hr:{p:!0},main:{p:!0},menu:{p:!0},nav:{p:!0},ol:{p:!0},p:{p:!0},pre:{p:!0},section:{p:!0},table:{p:!0},ul:{p:!0},rt:{rp:!0,rt:!0},rp:{rp:!0,rt:!0},optgroup:{optgroup:!0,option:!0},option:{option:!0},tbody:{thead:!0,tbody:!0,tfoot:!0},tfoot:{tbody:!0},tr:{tr:!0,th:!0,td:!0},th:{th:!0,td:!0},td:{thead:!0,th:!0,td:!0},body:{head:!0,link:!0,script:!0}},l={area:!0,base:!0,basefont:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};c.prototype={update:function(){if(this.isElement()){var e,t="",n="",r;for(e=0;e<this.children.length;e++)r=this.children[e],r.isElement()?(n+=String(r.tagID),t+=String(r.tagID)+r.attributeSignature+r.subtreeSignature):(n+=r.textSignature,t+=r.textSignature);this.childSignature=s.hashString(n,n.length,u),this.subtreeSignature=s.hashString(t,t.length,u)}else this.textSignature=s.hashString(this.content,this.content.length,u)},updateAttributeSignature:function(){var e=JSON.stringify(this.attributes);this.attributeSignature=s.hashString(e,e.length,u)},isElement:function(){return!!this.children},isText:function(){return!this.children}},v.prototype._logError=function(e){var t={token:e},n=e?e.startPos||e.endPos:this.startOffsetPos,r=e?e.endPos:this.startOffsetPos;t.startPos=p(this.startOffsetPos,n),t.endPos=p(this.startOffsetPos,r),this.errors||(this.errors=[]),this.errors.push(t)},v.prototype.build=function(e,t){function b(e,t){i=a[a.length-1],a.pop(),i.update(),i.end=n.startOffset+e,i.endPos=p(n.startOffsetPos,t)}var n=this,r,i,s,u=0,a=this.stack,v=null,m={};t=t||{};var g="HTMLInstr. Build DOM Full",y="HTMLInstr. Build DOM Partial";o.markStart([g,y]);while((r=this.t.nextToken())!==null){r.type!=="text"&&r.type!=="comment"&&s&&(s=null);if(r.type==="error")return o.finalizeMeasurement(g),o.addMeasurement(y),this._logError(r),null;if(r.type==="opentagname"){var w=r.contents.toLowerCase(),E;if(f.hasOwnProperty(w)){var S=f[w];while(a.length>0&&S.hasOwnProperty(a[a.length-1].tag))b(r.start-1,d(r.startPos,-1))}E=new c({tag:r.contents.toLowerCase(),children:[],attributes:{},parent:a.length?a[a.length-1]:null,start:this.startOffset+r.start-1,startPos:p(this.startOffsetPos,d(r.startPos,-1))}),E.tagID=this.getID(E,t),m[E.tagID]&&(E.tagID=this.getNewID()),m[E.tagID]=E,E.parent&&E.parent.children.push(E),this.currentTag=E,l.hasOwnProperty(E.tag)?E.update():a.push(E)}else if(r.type==="opentagend"||r.type==="selfclosingtag")this.currentTag&&(r.type==="selfclosingtag"&&a.length&&a[a.length-1]===this.currentTag?b(r.end,r.endPos):(this.currentTag.end=this.startOffset+r.end,this.currentTag.endPos=p(this.startOffsetPos,r.endPos),i=this.currentTag,this.currentTag.updateAttributeSignature(),this.currentTag=null));else if(r.type==="closetag"){var x=r.contents.toLowerCase();if(!l.hasOwnProperty(x)){var T;for(T=a.length-1;T>=0;T--)if(a[T].tag===x)break;if(e&&T!==a.length-1)return o.finalizeMeasurement(g),o.addMeasurement(y),this._logError(r),null;if(T>=0){do a.length===T+1?b(r.end+1,d(r.endPos,1)):b(r.start-2,d(r.startPos,-2));while(a.length>T)}else if(e)return o.finalizeMeasurement(g),o.addMeasurement(y),this._logError(r),null}}else if(r.type==="attribname")v=r.contents.toLowerCase(),this.currentTag.attributes[v]="";else if(r.type==="attribvalue"&&v!==null)this.currentTag.attributes[v]=r.contents,v=null;else if(r.type==="text"&&a.length){var N=a[a.length-1],C;s?(C=s,C.content+=r.contents):(C=new c({parent:a[a.length-1],content:r.contents}),N.children.push(C),C.tagID=h(C),m[C.tagID]=C,s=C),C.update()}u=r.end}if(a.length){if(e)return o.finalizeMeasurement(g),o.addMeasurement(y),this._logError(r),null;var k=this.text.split("\n"),L={line:k.length-1,ch:k[k.length-1].length};while(a.length)b(this.text.length,L)}var A=i;return A?(A.nodeMap=m,o.addMeasurement(g),o.finalizeMeasurement(y),A):(this._logError(r),null)},v.prototype.getNewID=function(){return a++},v.prototype.getID=v.prototype.getNewID,t.build=m,t.Builder=v,t.SimpleNode=c,t._dumpDOM=g,t._offsetPos=d,t._getTextNodeID=h,t._seed=u}),define("language/HTMLDOMDiff",["require","exports","module"],function(e,t,n){function r(e,t){var n=$.extend({},e.attributes),r=t.attributes,i=[];return Object.keys(r).forEach(function(t){if(n[t]!==r[t]){var s=n.hasOwnProperty(t)?"attrChange":"attrAdd";i.push({type:s,tagID:e.tagID,attribute:t,value:r[t]})}delete n[t]}),Object.keys(n).forEach(function(t){i.push({type:"attrDelete",tagID:e.tagID,attribute:t})}),i}function i(e){return e.parent&&e.parent.tagID}function o(e,t){var n=[],i=[],o=[],u,a,f=e?e.nodeMap:{},l=t.nodeMap,c=function(e){e.children&&f[e.tagID]&&n.push(e)},h=function(e){i.push.apply(i,e.edits),o.push.apply(o,e.moves),n.push.apply(n,e.newElements)};n.push(t);do u=n.pop(),a=f[u.tagID],a?(u.attributeSignature!==a.attributeSignature&&i.push.apply(i,r(a,u)),u.childSignature!==a.childSignature&&h(s(a,f,u,l)),u.subtreeSignature!==a.subtreeSignature&&u.children.forEach(c)):(u.parent||i.push({type:"elementInsert",tag:u.tag,tagID:u.tagID,parentID:null,attributes:u.attributes}),h(s(null,f,u,l)));while(n.length);return o.length>0&&i.unshift({type:"rememberNodes",tagIDs:o}),i}var s=function(e,t,n,r){var s=0,o=0,u=n.children,a=e?e.children:[],f,l,c=[],h,p,d=[],v=[],m=[],g=function(e,t){c.forEach(function(t){t.type!=="elementDelete"&&(t.beforeID=e)}),d.push.apply(d,c),c=[],t||(p=e)},y=function(){return t[f.tagID]?!1:(h={type:"elementInsert",tag:f.tag,tagID:f.tagID,parentID:f.parent.tagID,attributes:f.attributes},c.push(h),m.push(f),p=f.tagID,s++,!0)},b=function(){return r[l.tagID]?!1:(g(l.tagID,!0),h={type:"elementDelete",tagID:l.tagID},c.push(h),o++,!0)},w=function(){h={type:"textInsert",content:f.content,parentID:f.parent.tagID},p?h.afterID=p:h.firstChild=!0,c.push(h),s++},E=function(){return s>0?n.children[s-1]:null},S=function(){var e=E();e&&!e.children?h={type:"textReplace",content:e.content}:h={type:"textDelete"};var t=c.length>0&&c[c.length-1];if(t&&t.type==="textReplace"&&t.afterID===p){o++;return}h.parentID=l.parent.tagID,l.parent.children.length===1?c.push(h):(p&&(h.afterID=p),c.push(h)),o++},x=function(){var e=t[f.tagID];return e&&n.tagID!==i(e)?(h={type:"elementMove",tagID:f.tagID,parentID:f.parent.tagID},v.push(h.tagID),c.push(h),s++,!0):!1},T=function(e){var t=r[e.tagID];return e.children&&t&&i(e)!==i(t)};while(s<u.length&&o<a.length){f=u[s];if(f.children&&x())continue;l=a[o];if(T(l)){o++;continue}f.isElement()||l.isElement()?f.isElement()&&l.isText()?(S(),y()):l.isElement()&&f.isText()?b()||w():f.tagID!==l.tagID?b()||y()||(console.error("HTML Instrumentation: This should not happen. Two elements have different tag IDs and there was no insert/delete. This generally means there was a reordering of elements."),s++,o++):(g(l.tagID,!1),s++,o++):(f.textSignature!==l.textSignature&&(h={type:"textReplace",content:f.content,parentID:f.parent.tagID},p&&(h.afterID=p),c.push(h)),s++,o++)}while(o<a.length)l=a[o],T(l)?o++:l.isElement()?b()||(console.error("HTML Instrumentation: failed to add elementDelete for remaining element in the original DOM. This should not happen.",l),o++):S();while(s<u.length)f=u[s],f.isElement()?x()||y()||(console.error("HTML Instrumentation: failed to add elementInsert for remaining element in the updated DOM. This should not happen."),s++):w();return c.forEach(function(e){if(e.type==="textInsert"||e.type==="elementInsert"||e.type==="elementMove")e.lastChild=!0,delete e.firstChild,delete e.afterID}),d.push.apply(d,c),{edits:d,moves:v,newElements:m}};t.domdiff=o}),define("language/HTMLInstrumentation",["require","exports","module","document/DocumentManager","./HTMLSimpleDOM","./HTMLDOMDiff","utils/PerfUtils"],function(e,t,n){function f(e,t){a.hasOwnProperty(t.file.fullPath)&&(delete a[t.file.fullPath],$(t).off(".htmlInstrumentation"))}function l(e,t){return e&&t&&e.line===t.line&&e.ch===t.ch}function c(e,t){return e=e.filter(function(e){return!!e.tagID}).map(function(e){return t[e.tagID]||(t[e.tagID]={mark:e,range:e.find()}),t[e.tagID]}),e.sort(function(e,t){return e.range.from.line===t.range.from.line?e.range.from.ch-t.range.from.ch:e.range.from.line-t.range.from.line}),e}function h(e,t,n,r){var i,s,o;return r=r||{},s=c(e._codeMirror.findMarksAt(t),r),s.length?(o=s[s.length-1],n&&(l(o.range.from,t)||l(o.range.to,t))&&(s.length>1?o=s[s.length-2]:o=null),o.mark):null}function p(e,t){var n={},r=c(e._codeMirror.getAllMarks(),n);r.forEach(function(e){var n=e.mark,r=e.range;console.log("<"+t[n.tagID].tag+"> ("+n.tagID+") "+r.from.line+":"+r.from.ch+" - "+r.to.line+":"+r.to.ch)})}function d(e,t,n){var r=h(e,t,!1,n);return r?r.tagID:-1}function v(e,t){t.children.forEach(function(t){t.isElement()&&v(e,t)});var n=e.markText(t.startPos,t.endPos);n.tagID=t.tagID}function m(e,t){var n=e._codeMirror,r=n.getAllMarks();n.operation(function(){r.forEach(function(e){e.hasOwnProperty("tagID")&&e.clear()})}),v(n,t)}function g(e,t,n){function u(e){return/[<>\/=\"\']/.test(e)}var r,s=0,o;this.isIncremental=!1;if(n&&n.length===1){var a=n[0];if(!u(a.text)&&!u(a.removed)){var f=h(t,a.from,!0);if(f){var l=f.find();l&&(r=t._codeMirror.getRange(l.from,l.to),this.changedTagID=f.tagID,o=l.from,s=t._codeMirror.indexFromPos(o),this.isIncremental=!0)}}}this.changedTagID||(r=t.document.getText()),i.Builder.call(this,r,s,o),this.editor=t,this.cm=t._codeMirror,this.previousDOM=e}function y(e,t){var n=e.parent;while(n&&n.tagID!==t)n=n.parent;return!!n}function b(e,t,n){u||(n=undefined);var r=new g(e,t,n),i=r.update();if(!i)return{errors:r.errors};var o=s.domdiff(i.oldSubtree,i.newSubtree);return i.newSubtree!==i.newDOM&&delete i.newSubtree.nodeMap,{dom:i.newDOM,edits:o,_wasIncremental:r.isIncremental}}function w(e,t){var n=a[e.document.file.fullPath];if(!n||!n.dom||a[e.document.file.fullPath].invalid)t=null;var r=b(n&&n.dom,e,t);return r.errors?(n&&(n.invalid=!0),{errors:r.errors}):(a[e.document.file.fullPath]={timestamp:e.document.diskTimestamp,dom:r.dom,dirty:!1},{edits:r.edits})}function E(e,t){function s(e){e.tagID=e.attributes["data-brackets-id"],delete e.attributes["data-brackets-id"],e.children.forEach(function(t){t.parent=e,t.isElement()?s(t):t.isText()&&(t.update(),t.tagID=i.getTextNodeID(t),n[t.tagID]=t)}),e.update(),n[e.tagID]=e,e.tagID===t&&(r=e)}var n={},r;return s(e),r=r||e,r.nodeMap=n,r}function S(e,t){var n=a[e.document.file.fullPath],r=n.dom,i;return i=E(t,r.tagID),{diff:s.domdiff(r,i),browser:i,editor:r}}function x(e){a.hasOwnProperty(e.file.fullPath)||($(e).on("change.htmlInstrumentation",function(){a[e.file.fullPath]&&(a[e.file.fullPath].dirty=!0)}),a[e.file.fullPath]=null);var t=a[e.file.fullPath];if(!e.isDirty&&t&&!t.dirty&&t.timestamp===e.diskTimestamp)return t.dom;var n=e.getText(),r=i.build(n);return r&&(a[e.file.fullPath]={timestamp:e.diskTimestamp,dom:r,dirty:!1}),r}function T(e){function o(e){if(e.tag){var t=" data-brackets-id='"+e.tagID+"'",n=e.start+e.tag.length+1;i+=r.substr(s,n-s)+t,s=n}e.isElement()&&e.children.forEach(o)}var t=e.document,n=x(t),r=t.getText(),i="",s=0;return n?(m(e,n),o(n),i+=r.substr(s),i):null}function N(e){var t=a[e.document.file.fullPath],n=t&&t.dom;if(!n){console.error("Couldn't find the dom for "+e.document.file.fullPath);return}m(e,n)}function C(){a={}}var r=e("document/DocumentManager"),i=e("./HTMLSimpleDOM"),s=e("./HTMLDOMDiff"),o=e("utils/PerfUtils"),u=!0,a={};g.prototype=Object.create(i.Builder.prototype),g.prototype.getID=function(e,t){var n=d(this.editor,i._offsetPos(e.startPos,1),t);if(n===-1||y(e,n))n=this.getNewID();else{var r=this.previousDOM.nodeMap[n];if(!r||r.tag!==e.tag)n=this.getNewID()}return n},g.prototype._updateMarkedRanges=function(e,t){var n=Object.keys(e),r=this.cm,i=r.getAllMarks();r.operation(function(){i.forEach(function(i){if(i.hasOwnProperty("tagID")&&e[i.tagID]){var s=e[i.tagID],o=t[i.tagID];o&&l(o.range.from,s.startPos)&&l(o.range.to,s.endPos)||(i.clear(),i=r.markText(s.startPos,s.endPos),i.tagID=s.tagID),n.splice(n.indexOf(String(s.tagID)),1)}}),n.forEach(function(t){var n=e[t],i;n.isElement()&&(i=r.markText(n.startPos,n.endPos),i.tagID=Number(t))})})},g.prototype._buildNodeMap=function(e){function n(e){e.tagID&&(t[e.tagID]=e),e.isElement()&&e.children.forEach(n)}var t={};n(e),e.nodeMap=t},g.prototype._handleDeletions=function(e,t,n){var r=[];Object.keys(t).forEach(function(t){n.hasOwnProperty(t)||(r.push(t),delete e[t])});if(r.length){var i=this.cm.getAllMarks();i.forEach(function(e){e.hasOwnProperty("tagID")&&r.indexOf(e.tagID)!==-1&&e.clear()})}},g.prototype.update=function(){var e={},t=this.build(!0,e),n={newDOM:t,oldSubtree:this.previousDOM,newSubtree:t};if(!t)return null;if(this.changedTagID){var r=this.previousDOM.nodeMap[this.changedTagID],i=r.parent;if(i){var s=i.children.indexOf(r);if(s===-1)console.error("DOMUpdater.update(): couldn't locate old subtree in tree");else{r.parent=null,t.parent=i,i.children[s]=t,$.extend(this.previousDOM.nodeMap,t.nodeMap),this._updateMarkedRanges(t.nodeMap,e),this._buildNodeMap(r),this._handleDeletions(this.previousDOM.nodeMap,r.nodeMap,t.nodeMap);var o=i;while(o)o.update(),o=o.parent;n.newDOM=this.previousDOM,n.oldSubtree=r}}}else m(this.editor,n.newDOM);return n},$(r).on("beforeDocumentDelete",f),t._markText=N,t._getMarkerAtDocumentPos=h,t._getTagIDAtDocumentPos=d,t._markTextFromDOM=m,t._updateDOM=b,t._allowIncremental=u,t._getBrowserDiff=S,t._resetCache=C,t.scanDocument=x,t.generateInstrumentedHTML=T,t.getUnappliedEditList=w}),define("LiveDevelopment/Documents/HTMLDocument",["require","exports","module","document/DocumentManager","LiveDevelopment/Agents/DOMAgent","LiveDevelopment/Agents/HighlightAgent","language/HTMLInstrumentation","LiveDevelopment/Inspector/Inspector","LiveDevelopment/LiveDevelopment","utils/PerfUtils","LiveDevelopment/Agents/RemoteAgent","utils/StringUtils","thirdparty/lodash"],function(t,n,r){var i=t("document/DocumentManager"),s=t("LiveDevelopment/Agents/DOMAgent"),o=t("LiveDevelopment/Agents/HighlightAgent"),u=t("language/HTMLInstrumentation"),a=t("LiveDevelopment/Inspector/Inspector"),f=t("LiveDevelopment/LiveDevelopment"),l=t("utils/PerfUtils"),c=t("LiveDevelopment/Agents/RemoteAgent"),h=t("utils/StringUtils"),p=t("thirdparty/lodash"),d=function(t,n){var r=this;this.doc=t;if(!n)return;this.editor=n,this._instrumentationEnabled=!1,$(this.editor).on("cursorActivity.HTMLDocument",function(e,t){r._onCursorActivity(e,t)}),$(this.editor).on("change.HTMLDocument",function(e,t,n){r._onChange(e,t,n)}),f.config.experimental&&$(o).on("highlight.HTMLDocument",function(e,t){r._onHighlight(e,t)})};d.prototype.setInstrumentationEnabled=function(t){t&&!this._instrumentationEnabled&&(u.scanDocument(this.doc),u._markText(this.editor)),this._instrumentationEnabled=t},d.prototype.isLiveEditingEnabled=function(){return this._instrumentationEnabled},d.prototype.getResponseData=function(t){var n;return this._instrumentationEnabled&&(n=u.generateInstrumentedHTML(this.editor)),{body:n||this.doc.getText()}},d.prototype.close=function(){if(!this.editor)return;$(this.editor).off(".HTMLDocument"),f.config.experimental&&this._onHighlight()},d.prototype.updateHighlight=function(){var e=this.editor,t=e._codeMirror,n=[];a.config.highlight&&(p.each(this.editor.getSelections(),function(t){var r=u._getTagIDAtDocumentPos(e,t.reversed?t.end:t.start);r!==-1&&n.push(r)}),n.length?o.domElement(n):o.hide())},d.prototype._onCursorActivity=function(e,t){if(!this.editor)return;this.updateHighlight()},d.prototype._compareWithBrowser=function(e){var t=this;c.call("getSimpleDOM").done(function(n){var r=JSON.parse(n.result.value),i,s,o;try{o=u._getBrowserDiff(t.editor,r)}catch(a){console.error("Error comparing in-browser DOM to in-editor DOM"),console.error(a.stack);return}i=o.diff.filter(function(e){return s=o.browser.nodeMap[e.parentID],s&&s.tag==="html"&&e.type==="textDelete"?!1:!0}),i.length>0&&(console.warn("Browser DOM does not match after change: "+JSON.stringify(e)),i.forEach(function(e){console.log(e)}))})},d.prototype._onChange=function(e,t,n){if(!this._instrumentationEnabled)return;var r="HTMLDocument applyDOMEdits",i=l.isActive(r);i||l.markStart(r);var s=this,o=u.getUnappliedEditList(t,n),a;o.edits&&(a=c.call("applyDOMEdits",o.edits),a.always(function(){i||l.addMeasurement(r)})),this.errors=o.errors||[],$(this).triggerHandler("statusChanged",[this]),this._debug&&(console.log("Edits applied to browser were:"),console.log(JSON.stringify(o.edits,null,2)),a.done(function(){s._compareWithBrowser(n)}))},d.prototype._onHighlight=function(e,t){if(!t||!t.location||!this.editor){this._highlight&&(this._highlight.clear(),delete this._highlight);return}var n=this.editor._codeMirror,r,i=n.posFromIndex(t.location);t.closeLocation?r=t.closeLocation+t.closeLength:r=t.location+t.length,r=n.posFromIndex(r),this._highlight&&this._highlight.clear(),this._highlight=n.markText(i,r,{className:"highlight"})},r.exports=d}),define("LiveDevelopment/Documents/JSDocument",["require","exports","module","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/ScriptAgent","LiveDevelopment/Agents/HighlightAgent"],function(t,n,r){var i=t("LiveDevelopment/Inspector/Inspector"),s=t("LiveDevelopment/Agents/ScriptAgent"),o=t("LiveDevelopment/Agents/HighlightAgent"),u=function(t,n){if(!n)return;this.doc=t,this.editor=n,this.onHighlight=this.onHighlight.bind(this),this.onChange=this.onChange.bind(this),this.onCursorActivity=this.onCursorActivity.bind(this),$(o).on("highlight",this.onHighlight),$(this.editor).on("change",this.onChange),$(this.editor).on("cursorActivity",this.onCursorActivity),this.onCursorActivity()};u.prototype.close=function(){if(!this.editor)return;$(o).off("highlight",this.onHighlight),$(this.editor).off("change",this.onChange),$(this.editor).off("cursorActivity",this.onCursorActivity),this.onHighlight()},u.prototype.script=function(){return s.scriptForURL(this.doc.url)},u.prototype.onCursorActivity=function(t,n){},u.prototype.onChange=function(t,n,r){var s=this.doc.getText();i.Debugger.setScriptSource(this.script().scriptId,s,function(t){i.Runtime.evaluate('if($)$("canvas").each(function(i,e){if(e.rerender)e.rerender()})')}.bind(this))},u.prototype.onHighlight=function(t,n){var r=this.editor._codeMirror,i;for(i in this._highlight)r.removeLineClass(this._highlight[i],"wrap","highlight");this._highlight=[];if(!n||!n.trace)return;var s=this.script().scriptId,o,u;for(i in n.trace)o=n.trace[i],o.location&&o.location.scriptId===s&&(u=o.location.lineNumber,r.addLineClass(u,"wrap","highlight"),this._highlight.push(u))},r.exports=u}),define("LiveDevelopment/Agents/ConsoleAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector"],function(t,n,r){function o(e){var t=e.level;t==="warning"&&(t="warn");var n="ConsoleAgent: "+e.text;e.url&&(n+=" (url: "+e.url+")");if(e.stackTrace){var r=e.stackTrace[0];n+=" in "+r.functionName+":"+r.columnNumber}console[t](n)}function u(e,t){s=t.message,o(s)}function a(e,t){s&&o(s)}function f(e,t){}function l(){return i.Console.enable()}function c(){$(i.Console).on("messageAdded.ConsoleAgent",u).on("messageRepeatCountUpdated.ConsoleAgent",a).on("messagesCleared.ConsoleAgent",f)}function h(){$(i.Console).off(".ConsoleAgent")}var i=t("LiveDevelopment/Inspector/Inspector"),s;n.enable=l,n.load=c,n.unload=h}),define("LiveDevelopment/Agents/NetworkAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector"],function(t,n,r){function o(e){var t=e.search(/[#\?]/);return t>=0&&(e=e.substr(0,t)),e}function u(e){return s&&s[e]}function a(e){s[o(e)]=!0}function f(e,t){a(t.request.url)}function l(){s={}}function c(e,t){l(),a(t.frame.url)}function h(){return i.Network.enable()}function p(){$(i.Page).on("frameNavigated.NetworkAgent",c),$(i.Network).on("requestWillBeSent.NetworkAgent",f)}function d(){l(),$(i.Page).off(".NetworkAgent"),$(i.Network).off(".NetworkAgent")}var i=t("LiveDevelopment/Inspector/Inspector"),s={};n.wasURLRequested=u,n.enable=h,n.load=p,n.unload=d}),define("LiveDevelopment/LiveDevelopment",["require","exports","module","utils/Global","thirdparty/lodash","utils/Async","widgets/Dialogs","widgets/DefaultDialogs","document/DocumentManager","editor/EditorManager","LiveDevelopment/Servers/FileServer","filesystem/FileSystemError","file/FileUtils","LiveDevelopment/LiveDevServerManager","utils/NativeApp","preferences/PreferencesDialogs","project/ProjectManager","strings","utils/StringUtils","LiveDevelopment/Servers/UserServer","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Documents/CSSDocument","LiveDevelopment/Documents/HTMLDocument","LiveDevelopment/Documents/JSDocument","LiveDevelopment/Agents/CSSAgent","LiveDevelopment/Agents/ConsoleAgent","LiveDevelopment/Agents/RemoteAgent","LiveDevelopment/Agents/NetworkAgent","LiveDevelopment/Agents/DOMAgent","LiveDevelopment/Agents/ScriptAgent","LiveDevelopment/Agents/HighlightAgent","LiveDevelopment/Agents/GotoAgent","LiveDevelopment/Agents/EditAgent"],function(t,n,r){function z(e){return e&&e.state()==="pending"}function W(e){return b.isStaticHtmlFileExt(e)||x.getBaseUrl()&&b.isServerHtmlFileExt(e)}function X(){return v.getCurrentDocument()}function V(e){switch(e.getLanguage().getId()){case"css":return L;case"javascript":return n.config.experimental?O:null}return W(e.file.fullPath)?A:null}function J(e){return U?U.get(e):undefined}function K(e){return e?J(e.document.file.fullPath):null}function Q(e){var t;if(!e.editor||!e._errorLineHandles||!e._errorLineHandles.length)return;e.editor._codeMirror.operation(function(){for(;;){t=e._errorLineHandles.pop();if(!t)break;e.editor._codeMirror.removeLineClass(t,"wrap",M)}})}function G(e){Q(e),e.close(),e.editor&&$(e.editor).off(".livedev"),$(e).off(".livedev")}function Y(e){F[e.doc.url]&&delete F[e.doc.url],U&&U.remove(e),G(e)}function Z(e,t){if(e===n.status)return;n.status=e;var r=e===o?t:null;$(n).triggerHandler("statusChange",[e,r])}function et(e){var t,n,r,i,s,o=e.errors.length?c:f;Z(o);if(!e.editor)return;e.editor._codeMirror.operation(function(){Q(e),e._errorLineHandles=e._errorLineHandles||[],e.errors.forEach(function(r){t=r.startPos.line,n=r.endPos.line;for(i=t;i<n+1;i++)s=e.editor._codeMirror.addLineClass(i,"wrap",M),e._errorLineHandles.push(s)})})}function tt(){j&&(G(j),j=undefined),Object.keys(F).forEach(function(e){G(F[e]),delete F[e]}),U&&U.clear()}function nt(e,t){var n=V(e),r=new n(e,t);return n?($(r).on("statusChanged.livedev",function(){et(r)}),r):null}function rt(e){e._ensureMasterEditor(),j=nt(e,e._masterEditor),U.add(j)}function it(e){D.hasOwnProperty(e)&&!H.hasOwnProperty(e)&&(H[e]=!0)}function st(e){H.hasOwnProperty(e)&&delete H[e]}function ot(e){var t=V(e),n=U&&U.get(e.file.fullPath),r=n&&n.isLiveEditingEnabled();return e.isDirty&&!r}function ut(e,t,n){var r;t.message?r=t.message:(console.warn("Expected a non-empty string in error.message, got this instead:",t.message),r=JSON.stringify(t)),r&&r.substr(0,8)==="Uncaught"&&(r=r.substr(9));var i=t.data;Array.isArray(i)&&(r+="\n"+i.join("\n")),console.error(r,t,n)}function at(e,t){var n=U&&U.urlToPath(t),r=!!F[t];if(!n||r)return;var i=v.getDocumentForPath(n);i.done(function(e){if(V(e)===L&&(!j||e!==j.doc)){var t=nt(e,e._masterEditor);t&&(U.add(t),F[e.url]=t,$(t).on("deleted.livedev",function(e,t){Y(t)}))}})}function ft(){B.forEach(function(e){D[e].unload()}),B=[]}function lt(e,t){var n;return D[e]&&D[e][t]&&(n=D[e][t].call()),n?n.fail(function(){console.error(t+" failed on agent",e)}):n=(new $.Deferred).resolve().promise(),n}function ct(){var e;return n.config.experimental?e=D:e=H,Object.keys(e)}function ht(){return h.doInParallel(ct(),function(e){return lt(e,"enable")},!0)}function pt(){if(R)return R;var e=new $.Deferred,t=[],n,r;return R=e.promise(),Z(a),r=h.doInParallel(ct(),function(e){return lt(e,"load").done(function(){B.push(e)})},!0),r=h.withTimeout(r,1e4),r.done(function(){var t=j?j.doc:null;if(t){var n=f;ot(t)&&(n=l),Z(n),e.resolve()}else e.reject()}),r.fail(e.reject),R.fail(function(){Z(s),p.showModalDialog(p.DIALOG_ID_ERROR,T.LIVE_DEVELOPMENT_ERROR_TITLE,T.LIVE_DEV_LOADING_ERROR_MESSAGE)}).always(function(){R=null}),R}function dt(){function r(e){return e.substring(0,e.lastIndexOf("/",e.length-2)+1)}function s(e){var t=e.lastIndexOf(".");return t===-1?e:e.slice(0,t)}var e=X(),t,n;if(e){t=e.file.fullPath;if(b.isStaticHtmlFileExt(t)||b.isServerHtmlFileExt(t))return(new $.Deferred).resolve(e)}var o=new $.Deferred,u=x.getBaseUrl(),a=u&&u.length;return x.getAllFiles().done(function(e){var u=x.getProjectRoot().fullPath,f,l=!1,c=!0;t?f=b.getDirectoryPath(t):f=u;var h=e.filter(function(e){var t=r(e.fullPath);return f.indexOf(t)===0}),p=function(e){if(e.fullPath.indexOf(f)===0){if(s(e.name)!=="index")return!1;if(a){if(b.isServerHtmlFileExt(e.name)||b.isStaticHtmlFileExt(e.name))return!0}else if(b.isStaticHtmlFileExt(e.name))return!0}};while(!l&&c)n=i.findIndex(h,p),n===-1?(f=r(f),f.indexOf(u)===-1&&(c=!1)):l=!0;if(n!==-1){v.getDocumentForPath(h[n].fullPath).then(o.resolve,o.resolve);return}o.resolve(null)}),o.promise()}function vt(e){var t,n=new $.Deferred,r=k.connected();return $(k.Page).off(".livedev"),$(k).off(".livedev"),R?R.always(ft):ft(),tt(),U&&(U.stop(),U=null),e&&r?(t=k.Runtime.evaluate("window.open('', '_self').close();"),t=h.withTimeout(t,5e3)):t=(new $.Deferred).resolve(),t.always(function(){k.connected()?k.disconnect().always(n.resolve):n.resolve()}),n.promise()}function mt(e,t){function i(){var e=brackets.platform==="mac"?E.closeLiveBrowser():$.Deferred().resolve();e.done(function(){Z(o,t||"explicit_close"),q.resolve()}).fail(function(e){e&&(t+=" ("+e+")"),Z(o,t||"explicit_close"),q.resolve()})}if(q)return q;q=new $.Deferred,q.always(function(){q=null});var r=q.promise();return z(I)&&I.reject(),n.status===o?q.resolve():vt(e).always(i),r}function gt(e,t){var n=t.frame.url,r,i;if(t.frame.parentId)return;if(n.match(/^file:\/\//i)||!U)return;r=U.getBaseUrl();if(!r)return;i=new RegExp("^"+N.regexEscape(r),"i"),n.match(i)||mt(!1,"navigated_away")}function yt(e){mt(!1,"closed_unknown_reason")}function bt(e,t){var n;t&&t.reason&&(n="detached_"+t.reason),mt(!1,n)}function wt(){return R?R:(ft(),i.forOwn(F,function(e){Y(e)}),pt())}function Et(){wt(),k.Page.reload()}function St(){return mt(!0)}function xt(){function r(){t&&k.connected()?k.Runtime.evaluate("window.isBracketsLiveDevelopmentInterstitialPageLoaded",function(t){var i=t.result;i.type==="boolean"&&i.value?(window.clearTimeout(n),e.resolve()):window.setTimeout(r,100)}):e.reject()}var e=$.Deferred(),t=!0,n=window.setTimeout(function(){t=!1,e.reject()},1e4);return r(),e.promise()}function Tt(){k.Runtime.evaluate("window.navigator.userAgent",function(e){k.setUserAgent(e.result.value)});var e=k.Page.enable().then(ht);e.done(function(){pt().then(I.resolve,I.reject),dt().done(function(e){e&&j?(e!==j.doc&&rt(e),U?k.Page.navigate(U.pathToUrl(e.file.fullPath)):console.error("LiveDevelopment._onInterstitialPageLoad(): No server active")):St()})})}function Nt(e){$(k.Page).on("frameNavigated.livedev",gt),$(k).on("disconnect.livedev",yt),xt().fail(function(){St(),p.showModalDialog(d.DIALOG_ID_ERROR,T.LIVE_DEVELOPMENT_ERROR_TITLE,T.LIVE_DEV_LOADING_ERROR_MESSAGE)}).done(Tt)}function Ct(){p.showModalDialog(d.DIALOG_ID_ERROR,T.LIVE_DEVELOPMENT_ERROR_TITLE,T.LIVE_DEV_NEED_HTML_MESSAGE),I.reject()}function kt(){p.showModalDialog(d.DIALOG_ID_ERROR,T.LIVE_DEVELOPMENT_ERROR_TITLE,T.LIVE_DEV_SERVER_NOT_READY_MESSAGE),I.reject()}function Lt(){var e=!1,t=0;k.connectToURL(P).fail(function r(i){if(i==="CANCEL"){I.reject(i);return}if(t>3){Z(s);var u=p.showModalDialog(d.DIALOG_ID_LIVE_DEVELOPMENT,T.LIVE_DEVELOPMENT_RELAUNCH_TITLE,T.LIVE_DEVELOPMENT_ERROR_MESSAGE,[{className:p.DIALOG_BTN_CLASS_LEFT,id:p.DIALOG_BTN_CANCEL,text:T.CANCEL},{className:p.DIALOG_BTN_CLASS_PRIMARY,id:p.DIALOG_BTN_OK,text:T.RELAUNCH_CHROME}]);u.done(function(t){t===p.DIALOG_BTN_OK?(Z(o),mt().done(function(){e=!1,Mt(!0)}).fail(function(t){Z(s),e=!1,I.reject("CLOSE_LIVE_BROWSER")})):mt().done(function(){e=!1,I.reject("CANCEL")}).fail(function(t){Z(s),e=!1,I.reject("CLOSE_LIVE_BROWSER")})});return}t++,!e&&n.status!==s&&E.openLiveBrowser(P,!0).done(function(){e=!0}).fail(function(e){var t;Z(s),e===y.NOT_FOUND?t=T.ERROR_CANT_FIND_CHROME:t=N.format(T.ERROR_LAUNCHING_BROWSER,e),t&&(t+=" "+N.format(T.LIVE_DEVELOPMENT_TROUBLESHOOTING,brackets.config.troubleshoot_url)),p.showModalDialog(d.DIALOG_ID_ERROR,T.ERROR_LAUNCHING_BROWSER_TITLE,t),I.reject("OPEN_LIVE_BROWSER")}),n.status!==s&&window.setTimeout(function(){k.connectToURL(P).fail(r)},3e3)})}function At(e){Z(u),rt(e),U.start(),$(k).one("connect",Nt),Lt()}function Ot(e){var t=new $.Deferred,r=!1;U=w.getServer(e.file.fullPath),r=!n.config.experimental&&!U&&b.isServerHtmlFileExt(e.file.fullPath);if(r)S.showProjectPreferencesDialog("",T.LIVE_DEV_NEED_BASEURL_MESSAGE).done(function(n){n===p.DIALOG_BTN_OK&&x.getBaseUrl()?Ot(e).then(t.resolve,t.reject):t.reject()});else if(U){var i=U.readyToServe();i?i.then(t.resolve,function(){kt(),t.reject()}):(kt(),t.reject())}else t.reject();return t.promise()}function Mt(e){if(z(q))return q.then(function(){return Mt(e)});if(!e){if(z(I))return I;I=new $.Deferred,I.always(function(){I=null})}return dt().done(function(e){var t=e&&Ot(e)||(new $.Deferred).reject(),n;e&&!e._masterEditor&&(n=v.getWorkingSet().length,v.addToWorkingSet(e.file),n||v.setCurrentDocument(e)),t.done(function(){At(e)}).fail(function(){Ct()})}),I.promise()}function _t(){var e=K(m.getActiveEditor());e&&e.updateHighlight&&e.updateHighlight()}function Dt(){k.connected()&&D.highlight&&D.highlight.hide()}function Pt(){k.connected()&&D.highlight&&D.highlight.redraw()}function Ht(){var e=X();if(!e||!k.connected())return;var t=U&&U.pathToUrl(e.file.fullPath),r=D.network&&D.network.wasURLRequested(t),i=n.config.experimental||U&&U.canServe(e.file.fullPath);!r&&i?(Z(u),tt(),rt(e),k.Page.navigate(t).then(function(){Z(f)},function(){mt(!1,"closed_unknown_reason")})):r&&_t()}function Bt(e,t){if(!k.connected()||!U)return;var n=t.file.fullPath,r=n&&U.get(n),i=r&&r.isLiveEditingEnabled&&r.isLiveEditingEnabled();if(i)return;var s=U.pathToUrl(n),o=D.network&&D.network.wasURLRequested(s);o&&Et()}function jt(e,t){t&&k.connected()&&U&&D.network&&D.network.wasURLRequested(U.pathToUrl(t.file.fullPath))&&Z(ot(t)?l:f)}function Ft(){return{baseUrl:x.getBaseUrl(),pathResolver:x.makeProjectRelativeIfPossible,root:x.getProjectRoot().fullPath}}function It(){return new C(Ft())}function qt(){return new g(Ft())}function Rt(e){n.config=e,$(k).on("error",ut),$(k.Inspector).on("detached",bt),$(_).on("styleSheetAdded.livedev",at),$(v).on("currentDocumentChange",Ht).on("documentSaved",Bt).on("dirtyFlagChange",jt),$(x).on("beforeProjectClose beforeAppClose",St),w.registerServer({create:It},99),w.registerServer({create:qt},0),Z(o)}function Ut(){return U}function zt(){return U&&U.getBaseUrl()}t("utils/Global");var i=t("thirdparty/lodash"),s=n.STATUS_ERROR=-1,o=n.STATUS_INACTIVE=0,u=n.STATUS_CONNECTING=1,a=n.STATUS_LOADING_AGENTS=2,f=n.STATUS_ACTIVE=3,l=n.STATUS_OUT_OF_SYNC=4,c=n.STATUS_SYNC_ERROR=5,h=t("utils/Async"),p=t("widgets/Dialogs"),d=t("widgets/DefaultDialogs"),v=t("document/DocumentManager"),m=t("editor/EditorManager"),g=t("LiveDevelopment/Servers/FileServer").FileServer,y=t("filesystem/FileSystemError"),b=t("file/FileUtils"),w=t("LiveDevelopment/LiveDevServerManager"),E=t("utils/NativeApp"),S=t("preferences/PreferencesDialogs"),x=t("project/ProjectManager"),T=t("strings"),N=t("utils/StringUtils"),C=t("LiveDevelopment/Servers/UserServer").UserServer,k=t("LiveDevelopment/Inspector/Inspector"),L=t("LiveDevelopment/Documents/CSSDocument"),A=t("LiveDevelopment/Documents/HTMLDocument"),O=t("LiveDevelopment/Documents/JSDocument"),M="live-preview-sync-error",_=t("LiveDevelopment/Agents/CSSAgent"),D={console:t("LiveDevelopment/Agents/ConsoleAgent"),remote:t("LiveDevelopment/Agents/RemoteAgent"),network:t("LiveDevelopment/Agents/NetworkAgent"),dom:t("LiveDevelopment/Agents/DOMAgent"),css:_,script:t("LiveDevelopment/Agents/ScriptAgent"),highlight:t("LiveDevelopment/Agents/HighlightAgent"),"goto":t("LiveDevelopment/Agents/GotoAgent"),edit:t("LiveDevelopment/Agents/EditAgent")},P=window.location.pathname;P=P.replace("/test/SpecRunner.html","/src/index.html"),P=P.substr(0,P.lastIndexOf("/"))+"/LiveDevelopment/launch.html",P=window.location.origin+P;var H={console:!0,remote:!0,network:!0,css:!0,highlight:!0},B=[],j,F={},I,q,R,U;n.launcherUrl=P,n._getServer=Ut,n._getInitialDocFromCurrent=dt,n.agents=D,n.open=Mt,n.close=St,n.reconnect=wt,n.reload=Et,n.enableAgent=it,n.disableAgent=st,n.getLiveDocForPath=J,n.showHighlight=_t,n.hideHighlight=Dt,n.redrawHighlight=Pt,n.init=Rt,n.getCurrentProjectServerConfig=Ft,n.getServerBaseUrl=zt}),define("text!LiveDevelopment/main.less",[],function(){return'/*\n * Copyright (c) 2012 Adobe Systems Incorporated. All rights reserved.\n *  \n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the "Software"), \n * to deal in the Software without restriction, including without limitation \n * the rights to use, copy, modify, merge, publish, distribute, sublicense, \n * and/or sell copies of the Software, and to permit persons to whom the \n * Software is furnished to do so, subject to the following conditions:\n *  \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *  \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER \n * DEALINGS IN THE SOFTWARE.\n * \n */\n\n\n.CodeMirror {\n    .highlight {\n        background: #ecc;\n    }\n    .flash {\n       -webkit-animation: flash 1s;\n    }\n}\n  \n@-webkit-keyframes flash {\n    from {\n        background: #ecc;\n    }\n    to {\n        background: inherit;\n    }\n}'}),define("LiveDevelopment/main",["require","exports","module","document/DocumentManager","command/Commands","utils/AppInit","LiveDevelopment/LiveDevelopment","LiveDevelopment/Inspector/Inspector","command/CommandManager","preferences/PreferencesManager","widgets/Dialogs","widgets/DefaultDialogs","utils/UrlParams","strings","utils/ExtensionUtils","utils/StringUtils","text!LiveDevelopment/main.less"],function(t,n,r){function N(){var e=t("text!LiveDevelopment/main.less"),n=new less.Parser;n.parse(e,function(t,n){console.assert(!t,t),v.addEmbeddedStyleSheet(n.toCSS())})}function C(e,t,n,r){$("span",e).remove(),e.removeClass(S),t&&t.length>0?$('<span class="label">').addClass(n).text(t).appendTo(e):e.addClass(n),r&&e.attr("title",r)}function k(){u.status>=u.STATUS_ACTIVE?u.close():u.status<=u.STATUS_INACTIVE&&(!g.get("skipLiveDevelopmentInfo")&&!l.getViewState("livedev.afterFirstLaunch")?(l.setViewState("livedev.afterFirstLaunch","true"),c.showModalDialog(h.DIALOG_ID_INFO,d.LIVE_DEVELOPMENT_INFO_TITLE,d.LIVE_DEVELOPMENT_INFO_MESSAGE).done(function(e){u.open()})):u.open())}function L(e){x.twipsy("hide").removeData("twipsy");if(!e||e==="explicit_close")return;var t=d["LIVE_DEV_"+e.toUpperCase()];t||(t=m.format(d.LIVE_DEV_CLOSED_UNKNOWN_REASON,e));var n={placement:"left",trigger:"manual",autoHideDelay:5e3,title:function(){return t}};x.twipsy(n).twipsy("show")}function A(){x=$("#toolbar-go-live"),x.click(function(){k()}),$(u).on("statusChange",function(t,n,r){C(x,null,E[n+1],w[n+1]),L(r),y.autoconnect&&window.sessionStorage.setItem("live.enabled",n===3)}),C(x,null,E[1],w[1])}function O(){$(u).on("statusChange",function(t,n){f.get(s.FILE_LIVE_FILE_PREVIEW).setChecked(n===u.STATUS_ACTIVE),f.get(s.FILE_LIVE_HIGHLIGHT).setEnabled(n===u.STATUS_ACTIVE)})}function M(){f.get(s.FILE_LIVE_HIGHLIGHT).setChecked(y.highlight)}function _(){y.highlight=!y.highlight,M(),y.highlight?u.showHighlight():u.hideHighlight(),l.setViewState("livedev.highlight",y.highlight)}function D(){window.ld=u,window.i=a,window.report=function(t){window.params=t,console.info(t)}}function P(){u.status>=u.STATUS_ACTIVE&&u.reload()}var i=t("document/DocumentManager"),s=t("command/Commands"),o=t("utils/AppInit"),u=t("LiveDevelopment/LiveDevelopment"),a=t("LiveDevelopment/Inspector/Inspector"),f=t("command/CommandManager"),l=t("preferences/PreferencesManager"),c=t("widgets/Dialogs"),h=t("widgets/DefaultDialogs"),p=t("utils/UrlParams").UrlParams,d=t("strings"),v=t("utils/ExtensionUtils"),m=t("utils/StringUtils"),g=new p,y={experimental:!1,debug:!0,autoconnect:!1,highlight:!0,highlightConfig:{borderColor:{r:255,g:229,b:153,a:.66},contentColor:{r:111,g:168,b:220,a:.55},marginColor:{r:246,g:178,b:107,a:.66},paddingColor:{r:147,g:196,b:125,a:.66},showInfo:!0}},b="✓",w=[d.LIVE_DEV_STATUS_TIP_NOT_CONNECTED,d.LIVE_DEV_STATUS_TIP_NOT_CONNECTED,d.LIVE_DEV_STATUS_TIP_PROGRESS1,d.LIVE_DEV_STATUS_TIP_PROGRESS2,d.LIVE_DEV_STATUS_TIP_CONNECTED,d.LIVE_DEV_STATUS_TIP_OUT_OF_SYNC,d.LIVE_DEV_STATUS_TIP_SYNC_ERROR],E=["warning","","info","info","success","out-of-sync","sync-error"],S=E.join(" "),x,T;o.appReady(function(){g.parse(),a.init(y),u.init(y),N(),A(),O(),M(),y.debug&&D(),y.autoconnect&&window.sessionStorage.getItem("live.enabled")==="true"&&i.getCurrentDocument()&&k(),$(window).focus(function(){a.connected()&&y.highlight&&u.redrawHighlight()})}),l.stateManager.definePreference("livedev.highlight","boolean",!0).on("change",function(){y.highlight=l.getViewState("livedev.highlight"),M()}),l.convertPreferences(r,{highlight:"user livedev.highlight",afterFirstLaunch:"user livedev.afterFirstLaunch"},!0),y.highlight=l.getViewState("livedev.highlight"),f.register(d.CMD_LIVE_FILE_PREVIEW,s.FILE_LIVE_FILE_PREVIEW,k),f.register(d.CMD_LIVE_HIGHLIGHT,s.FILE_LIVE_HIGHLIGHT,_),f.register(d.CMD_RELOAD_LIVE_PREVIEW,s.CMD_RELOAD_LIVE_PREVIEW,P),f.get(s.FILE_LIVE_HIGHLIGHT).setEnabled(!1)}),define("utils/NodeDomain",["require","exports","module","utils/NodeConnection"],function(e,t,n){function s(e,t){var n=new r;this.connection=n,this._domainName=e,this._domainPath=t,this._domainLoaded=!1,this._load=this._load.bind(this),this._connectionPromise=n.connect(!0).then(this._load),$(n).on("close",function(e,t){$(this.connection).off(i),this._domainLoaded=!1,this._connectionPromise=t.then(this._load)}.bind(this))}var r=e("utils/NodeConnection"),i=".NodeDomainEvent";s.prototype.connection=null,s.prototype._connectionPromise=null,s.prototype._domainName=null,s.prototype._domainPath=null,s.prototype._domainLoaded=!1,s.prototype._load=function(){var e=this.connection;return e.loadDomains(this._domainPath,!0).done(function(){this._domainLoaded=!0,this._connectionPromise=null;var t=Object.keys(e.domainEvents[this._domainName]);t.forEach(function(t){var n=this._domainName+":"+t+i;$(e).on(n,function(){var e=Array.prototype.slice.call(arguments,1);$(this).triggerHandler(t,e)}.bind(this))},this)}.bind(this)).fail(function(e){console.error('[NodeDomain] Error loading domain "'+this._domainName+'": '+e)}.bind(this))},s.prototype.ready=function(){return this._domainLoaded&&this.connection.connected()},s.prototype.promise=function(){if(this._connectionPromise)return this._connectionPromise;var e=new $.Deferred;return this.ready()?e.resolve():e.reject(),e.promise()},s.prototype.exec=function(e){var t=this.connection,n=Array.prototype.slice.call(arguments,1),r=function(){var r=t.domains[this._domainName],i=r&&r[e],s;return i?s=i.apply(r,n):s=(new $.Deferred).reject().promise(),s}.bind(this),i;return this.ready()?i=r():this._connectionPromise?i=this._connectionPromise.then(r):i=(new $.Deferred.reject).promise(),i},n.exports=s}),define("utils/ColorUtils",["require","exports","module"],function(e,t,n){var r=/#[a-f0-9]{6}\b|#[a-f0-9]{3}\b|\brgb\(\s*(?:[0-9]{1,2}|1[0-9]{2}|2[0-4][0-9]|25[0-5])\b\s*,\s*(?:[0-9]{1,2}|1[0-9]{2}|2[0-4][0-9]|25[0-5])\b\s*,\s*(?:[0-9]{1,2}|1[0-9]{2}|2[0-4][0-9]|25[0-5])\b\s*\)|\brgb\(\s*(?:[0-9]{1,2}%|100%)\s*,\s*(?:[0-9]{1,2}%|100%)\s*,\s*(?:[0-9]{1,2}%|100%)\s*\)|\brgba\(\s*(?:[0-9]{1,2}|1[0-9]{2}|2[0-4][0-9]|25[0-5])\b\s*,\s*(?:[0-9]{1,2}|1[0-9]{2}|2[0-4][0-9]|25[0-5])\b\s*,\s*(?:[0-9]{1,2}|1[0-9]{2}|2[0-4][0-9]|25[0-5])\b\s*,\s*(?:1|1\.0|0|0?\.[0-9]{1,3})\s*\)|\brgba\(\s*(?:[0-9]{1,2}%|100%)\s*,\s*(?:[0-9]{1,2}%|100%)\s*,\s*(?:[0-9]{1,2}%|100%)\s*,\s*(?:1|1\.0|0|0?\.[0-9]{1,3})\s*\)|\bhsl\(\s*(?:[0-9]{1,3})\b\s*,\s*(?:[0-9]{1,2}|100)\b%\s*,\s*(?:[0-9]{1,2}|100)\b%\s*\)|\bhsla\(\s*(?:[0-9]{1,3})\b\s*,\s*(?:[0-9]{1,2}|100)\b%\s*,\s*(?:[0-9]{1,2}|100)\b%\s*,\s*(?:1|1\.0|0|0?\.[0-9]{1,3})\s*\)|\baliceblue\b|\bantiquewhite\b|\baqua\b|\baquamarine\b|\bazure\b|\bbeige\b|\bbisque\b|\bblack\b|\bblanchedalmond\b|\bblue\b|\bblueviolet\b|\bbrown\b|\bburlywood\b|\bcadetblue\b|\bchartreuse\b|\bchocolate\b|\bcoral\b|\bcornflowerblue\b|\bcornsilk\b|\bcrimson\b|\bcyan\b|\bdarkblue\b|\bdarkcyan\b|\bdarkgoldenrod\b|\bdarkgray\b|\bdarkgreen\b|\bdarkgrey\b|\bdarkkhaki\b|\bdarkmagenta\b|\bdarkolivegreen\b|\bdarkorange\b|\bdarkorchid\b|\bdarkred\b|\bdarksalmon\b|\bdarkseagreen\b|\bdarkslateblue\b|\bdarkslategray\b|\bdarkslategrey\b|\bdarkturquoise\b|\bdarkviolet\b|\bdeeppink\b|\bdeepskyblue\b|\bdimgray\b|\bdimgrey\b|\bdodgerblue\b|\bfirebrick\b|\bfloralwhite\b|\bforestgreen\b|\bfuchsia\b|\bgainsboro\b|\bghostwhite\b|\bgold\b|\bgoldenrod\b|\bgray\b|\bgreen\b|\bgreenyellow\b|\bgrey\b|\bhoneydew\b|\bhotpink\b|\bindianred\b|\bindigo\b|\bivory\b|\bkhaki\b|\blavender\b|\blavenderblush\b|\blawngreen\b|\blemonchiffon\b|\blightblue\b|\blightcoral\b|\blightcyan\b|\blightgoldenrodyellow\b|\blightgray\b|\blightgreen\b|\blightgrey\b|\blightpink\b|\blightsalmon\b|\blightseagreen\b|\blightskyblue\b|\blightslategray\b|\blightslategrey\b|\blightsteelblue\b|\blightyellow\b|\blime\b|\blimegreen\b|\blinen\b|\bmagenta\b|\bmaroon\b|\bmediumaquamarine\b|\bmediumblue\b|\bmediumorchid\b|\bmediumpurple\b|\bmediumseagreen\b|\bmediumslateblue\b|\bmediumspringgreen\b|\bmediumturquoise\b|\bmediumvioletred\b|\bmidnightblue\b|\bmintcream\b|\bmistyrose\b|\bmoccasin\b|\bnavajowhite\b|\bnavy\b|\boldlace\b|\bolive\b|\bolivedrab\b|\borange\b|\borangered\b|\borchid\b|\bpalegoldenrod\b|\bpalegreen\b|\bpaleturquoise\b|\bpalevioletred\b|\bpapayawhip\b|\bpeachpuff\b|\bperu\b|\bpink\b|\bplum\b|\bpowderblue\b|\bpurple\b|\bred\b|\brosybrown\b|\broyalblue\b|\bsaddlebrown\b|\bsalmon\b|\bsandybrown\b|\bseagreen\b|\bseashell\b|\bsienna\b|\bsilver\b|\bskyblue\b|\bslateblue\b|\bslategray\b|\bslategrey\b|\bsnow\b|\bspringgreen\b|\bsteelblue\b|\btan\b|\bteal\b|\bthistle\b|\btomato\b|\bturquoise\b|\bviolet\b|\bwheat\b|\bwhite\b|\bwhitesmoke\b|\byellow\b|\byellowgreen\b/gi;t.COLOR_REGEX=r}),define("text!htmlContent/problems-panel.html",[],function(){return'<div id="problems-panel" class="bottom-panel vert-resizable top-resizer">\n    <div class="toolbar simple-toolbar-layout">\n        <div class="title"><!-- filled in programmatically --></div>\n        <a href="#" class="close">&times;</a>\n    </div>\n    <div class="table-container resizable-content"></div>\n</div>'}),define("text!htmlContent/problems-panel-table.html",[],function(){return'<table class="bottom-panel-table table table-striped table-condensed row-highlight">\n    <tbody>\n        {{#reportList}}\n        <tr class="inspector-section">\n            <td colspan="3"><span class="disclosure-triangle expanded"></span>{{providerName}} ({{results.length}})</td>\n        </tr>\n        {{#results}}\n        <tr>\n            <td class="line-number" data-character="{{pos.ch}}">{{friendlyLine}}</td>\n            <td class="line-text">{{message}}</td>\n            <td class="line-snippet">{{codeSnippet}}</td>\n        </tr>\n        {{/results}}\n        {{/reportList}}\n    </tbody>\n</table>\n'}),define("language/CodeInspection",["require","exports","module","thirdparty/lodash","command/Commands","view/PanelManager","command/CommandManager","document/DocumentManager","editor/EditorManager","file/FileUtils","language/LanguageManager","preferences/PreferencesManager","utils/PerfUtils","strings","utils/StringUtils","utils/AppInit","utils/Resizer","widgets/StatusBar","utils/Async","text!htmlContent/problems-panel.html","text!htmlContent/problems-panel-table.html"],function(e,t,n){function H(e){o.get(i.NAVIGATE_GOTO_FIRST_PROBLEM).setEnabled(e),M=e}function B(){_={}}function j(e){return _[l.getLanguageForPath(e).getId()]}function F(e,t){var n=new $.Deferred,r=[];return t=t||j(e.fullPath)||[],t.length?(u.getDocumentText(e).done(function(i){var s=h.markStart("CodeInspection:	"+e.fullPath),o;o=y.doInParallel(t,function(t){var n=h.markStart("CodeInspection '"+t.name+"':	"+e.fullPath),s=new $.Deferred;s.done(function(e){r.push({provider:t,result:e})});if(t.scanFileAsync)window.setTimeout(function(){var e={pos:{line:-1,col:0},message:d.format(p.LINTER_TIMED_OUT,t.name,C.get(N)),type:S.ERROR};s.resolve({errors:[e]})},C.get(N)),t.scanFileAsync(i,e.fullPath).done(function(e){h.addMeasurement(n),s.resolve(e)}).fail(function(e){var n={pos:{line:-1,col:0},message:d.format(p.LINTER_FAILED,t.name,e),type:S.ERROR};console.error("[CodeInspection] Provider "+t.name+" (async) failed: "+e),s.resolve({errors:[n]})});else try{var o=t.scanFile(i,e.fullPath);h.addMeasurement(n),s.resolve(o)}catch(u){var a={pos:{line:-1,col:0},message:d.format(p.LINTER_FAILED,t.name,u),type:S.ERROR};console.error("[CodeInspection] Provider "+t.name+" (sync) threw an error: "+u),s.resolve({errors:[a]})}return s.promise()},!1),o.then(function(){r.sort(function(e,n){return t.indexOf(e.provider)-t.indexOf(n.provider)}),h.addMeasurement(s),n.resolve(r)})}).fail(function(t){console.error("[CodeInspection] Could not read file for inspection: "+e.fullPath),n.reject(t)}),n.promise()):(n.resolve(null),n.promise())}function I(e,t,n){var r;t.length===1?(O.find(".inspector-section").hide(),e===1&&!n?r=d.format(p.SINGLE_ERROR,t[0].name):(n&&(e+="+"),r=d.format(p.MULTIPLE_ERRORS,t[0].name,e)),A.find(".title").text(r),g.updateIndicator(E,!0,"inspection-errors",r)):t.length>1&&(O.find(".inspector-section").show(),n&&(e+="+"),r=d.format(p.ERRORS_PANEL_TITLE_MULTIPLE,e),A.find(".title").text(r),g.updateIndicator(E,!0,"inspection-errors",r))}function q(){if(!k){D=!1,P=null,m.hide(A),g.updateIndicator(E,!0,"inspection-disabled",p.LINT_DISABLED),H(!1);return}var e=u.getCurrentDocument(),t=e&&j(e.file.fullPath);if(t&&t.length){var n=0,r=!1,i=[],s,o=[];(P=F(e.file,t)).then(function(u){if(this!==P)return;var a=u.reduce(function(e,t){return e+(t.result?t.result.errors.length:0)},0);D=Boolean(a);if(!a){m.hide(A);var f=p.NO_ERRORS_MULTIPLE_PROVIDER;t.length===1&&(f=d.format(p.NO_ERRORS,t[0].name)),g.updateIndicator(E,!0,"inspection-valid",f),H(!1);return}var l=h.markStart("ProblemsPanel render:	"+e.file.fullPath);u.forEach(function(t){var s=t.provider;t.result&&(t.result.errors.forEach(function(t){!isNaN(t.pos.line)&&t.pos.line+1>0&&(t.codeSnippet=e.getLine(t.pos.line))!==undefined&&(t.friendlyLine=t.pos.line+1,t.codeSnippet=t.codeSnippet.substr(0,Math.min(175,t.codeSnippet.length))),t.type!==S.META&&n++}),t.result.aborted&&(r=!0),t.result.errors.length&&(i.push({providerName:s.name,results:t.result.errors}),o.push(s)))}),s=Mustache.render(w,{reportList:i}),O.empty().append(s).scrollTop(0),L||m.show(A),I(n,o,r),H(!0),h.addMeasurement(l)})}else{D=!1,P=null,m.hide(A);var a=e&&l.getLanguageForPath(e.file.fullPath);a?g.updateIndicator(E,!0,"inspection-disabled",d.format(p.NO_LINT_AVAILABLE,a.getName())):g.updateIndicator(E,!0,"inspection-disabled",p.NOTHING_TO_LINT),H(!1)}}function R(e,t){_[e]||(_[e]=[]),e==="javascript"&&r.remove(_[e],function(e){return e.name==="JSLint"}),_[e].push(t),q()}function U(){k?$(u).on("currentDocumentChange.codeInspection currentDocumentLanguageChanged.codeInspection",function(){q()}).on("documentSaved.codeInspection documentRefreshed.codeInspection",function(e,t){t===u.getCurrentDocument()&&q()}):$(u).off(".codeInspection")}function z(e,t){e===undefined&&(e=!k);if(e===k)return;k=e,o.get(i.VIEW_TOGGLE_INSPECTION).setChecked(k),U(),t||(C.set(x,k),C.save()),q()}function W(e,t){e===undefined&&(e=!L);if(e===L)return;L=e,t||(C.set(T,L),C.save()),L?m.hide(A):D&&m.show(A)}function X(){q(),M&&A.find("tr:not(.inspector-section)").first().trigger("click")}var r=e("thirdparty/lodash"),i=e("command/Commands"),s=e("view/PanelManager"),o=e("command/CommandManager"),u=e("document/DocumentManager"),a=e("editor/EditorManager"),f=e("file/FileUtils"),l=e("language/LanguageManager"),c=e("preferences/PreferencesManager"),h=e("utils/PerfUtils"),p=e("strings"),d=e("utils/StringUtils"),v=e("utils/AppInit"),m=e("utils/Resizer"),g=e("widgets/StatusBar"),y=e("utils/Async"),b=e("text!htmlContent/problems-panel.html"),w=e("text!htmlContent/problems-panel-table.html"),E="status-inspection",S={ERROR:"problem_type_error",WARNING:"problem_type_warning",META:"problem_type_meta"},x="enabled",T="collapsed",N="asyncTimeout",C=c.getExtensionPrefs("linting");c.convertPreferences(n,{enabled:"user linting.enabled",collapsed:"user linting.collapsed"});var k=!1,L=!1,A,O,M=!1,_={},D,P=null;o.register(p.CMD_VIEW_TOGGLE_INSPECTION,i.VIEW_TOGGLE_INSPECTION,z),o.register(p.CMD_GOTO_FIRST_PROBLEM,i.NAVIGATE_GOTO_FIRST_PROBLEM,X),C.definePreference(x,"boolean",brackets.config["linting.enabled_by_default"]).on("change",function(e,t){z(C.get(x),!0)}),C.definePreference(T,"boolean",!1).on("change",function(e,t){W(C.get(T),!0)}),C.definePreference(N,"number",1e4),v.htmlReady(function(){var e=Mustache.render(b,p),t=s.createBottomPanel("errors",$(e),100);A=$("#problems-panel");var n;O=A.find(".table-container").on("click","tr",function(e){n&&n.removeClass("selected"),n=$(e.currentTarget),n.addClass("selected");if(n.hasClass("inspector-section")){n.nextUntil(".inspector-section").toggle();var t=$(".disclosure-triangle",n);t.toggleClass("expanded").toggleClass("collapsed")}else{var r=n.find(".line-number"),i=parseInt(r.text(),10)-1;if(!isNaN(i)){var s=r.data("character"),o=a.getCurrentFullEditor();o.setCursorPos(i,s,!0),a.focusEditor()}}}),$("#problems-panel .close").click(function(){W(!0)});var r=Mustache.render('<div id="status-inspection">&nbsp;</div>',p);g.addIndicator(E,$(r),!0,"","","status-indent"),$("#status-inspection").click(function(){D&&W()}),z(C.get(x),!0),W(C.get(T),!0)}),t._unregisterAll=B,t._PREF_ASYNC_TIMEOUT=N,t.register=R,t.Type=S,t.toggleEnabled=z,t.inspectFile=F,t.requestRun=q}),define("command/DefaultMenus",["require","exports","module","utils/AppInit","command/Commands","command/Menus","editor/EditorManager","command/Menus","strings"],function(e,t,n){var r=e("utils/AppInit"),i=e("command/Commands"),s=e("command/Menus"),o=e("editor/EditorManager"),u=e("command/Menus"),a=e("strings");r.htmlReady(function(){var e;e=u.addMenu(a.FILE_MENU,u.AppMenuBar.FILE_MENU),e.addMenuItem(i.FILE_NEW_UNTITLED),e.addMenuItem(i.FILE_OPEN),e.addMenuItem(i.FILE_OPEN_FOLDER),e.addMenuItem(i.FILE_CLOSE),e.addMenuItem(i.FILE_CLOSE_ALL),e.addMenuDivider(),e.addMenuItem(i.FILE_SAVE),e.addMenuItem(i.FILE_SAVE_ALL),e.addMenuItem(i.FILE_SAVE_AS),e.addMenuDivider(),e.addMenuItem(i.FILE_LIVE_FILE_PREVIEW),e.addMenuItem(i.FILE_PROJECT_SETTINGS),e.addMenuDivider(),e.addMenuItem(i.FILE_EXTENSION_MANAGER);if(brackets.platform!=="mac"||!brackets.nativeMenus)e.addMenuDivider(),e.addMenuItem(i.FILE_QUIT);e=u.addMenu(a.EDIT_MENU,u.AppMenuBar.EDIT_MENU),e.addMenuItem(i.EDIT_UNDO),e.addMenuItem(i.EDIT_REDO),e.addMenuDivider(),e.addMenuItem(i.EDIT_CUT),e.addMenuItem(i.EDIT_COPY),e.addMenuItem(i.EDIT_PASTE),e.addMenuDivider(),e.addMenuItem(i.EDIT_SELECT_ALL),e.addMenuItem(i.EDIT_SELECT_LINE),e.addMenuItem(i.EDIT_SPLIT_SEL_INTO_LINES),e.addMenuItem(i.EDIT_ADD_CUR_TO_PREV_LINE),e.addMenuItem(i.EDIT_ADD_CUR_TO_NEXT_LINE),e.addMenuDivider(),e.addMenuItem(i.EDIT_INDENT),e.addMenuItem(i.EDIT_UNINDENT),e.addMenuItem(i.EDIT_DUPLICATE),e.addMenuItem(i.EDIT_DELETE_LINES),e.addMenuItem(i.EDIT_LINE_UP),e.addMenuItem(i.EDIT_LINE_DOWN),e.addMenuDivider(),e.addMenuItem(i.EDIT_LINE_COMMENT),e.addMenuItem(i.EDIT_BLOCK_COMMENT),e.addMenuDivider(),e.addMenuItem(i.SHOW_CODE_HINTS),e.addMenuDivider(),e.addMenuItem(i.TOGGLE_CLOSE_BRACKETS),e=u.addMenu(a.FIND_MENU,u.AppMenuBar.FIND_MENU),e.addMenuItem(i.CMD_FIND),e.addMenuItem(i.CMD_FIND_NEXT),e.addMenuItem(i.CMD_FIND_PREVIOUS),e.addMenuItem(i.CMD_FIND_ALL_AND_SELECT),e.addMenuItem(i.CMD_ADD_NEXT_MATCH),e.addMenuItem(i.CMD_SKIP_CURRENT_MATCH),e.addMenuDivider(),e.addMenuItem(i.CMD_FIND_IN_FILES),e.addMenuItem(i.CMD_FIND_IN_SELECTED),e.addMenuDivider(),e.addMenuItem(i.CMD_REPLACE),e.addMenuItem(i.CMD_REPLACE_IN_FILES),e.addMenuItem(i.CMD_REPLACE_IN_SELECTED),e=u.addMenu(a.VIEW_MENU,u.AppMenuBar.VIEW_MENU),e.addMenuItem(i.CMD_THEMES_OPEN_SETTINGS),e.addMenuDivider(),e.addMenuItem(i.VIEW_HIDE_SIDEBAR),e.addMenuDivider(),e.addMenuItem(i.VIEW_INCREASE_FONT_SIZE),e.addMenuItem(i.VIEW_DECREASE_FONT_SIZE),e.addMenuItem(i.VIEW_RESTORE_FONT_SIZE),e.addMenuDivider(),e.addMenuItem(i.TOGGLE_ACTIVE_LINE),e.addMenuItem(i.TOGGLE_LINE_NUMBERS),e.addMenuItem(i.TOGGLE_WORD_WRAP),e.addMenuDivider(),e.addMenuItem(i.FILE_LIVE_HIGHLIGHT),e.addMenuDivider(),e.addMenuItem(i.VIEW_TOGGLE_INSPECTION),e=u.addMenu(a.NAVIGATE_MENU,u.AppMenuBar.NAVIGATE_MENU),e.addMenuItem(i.NAVIGATE_QUICK_OPEN),e.addMenuItem(i.NAVIGATE_GOTO_LINE),e.addMenuItem(i.NAVIGATE_GOTO_DEFINITION),e.addMenuItem(i.NAVIGATE_JUMPTO_DEFINITION),e.addMenuItem(i.NAVIGATE_GOTO_FIRST_PROBLEM),e.addMenuDivider(),e.addMenuItem(i.NAVIGATE_NEXT_DOC),e.addMenuItem(i.NAVIGATE_PREV_DOC),e.addMenuDivider(),e.addMenuItem(i.NAVIGATE_SHOW_IN_FILE_TREE),e.addMenuDivider(),e.addMenuItem(i.TOGGLE_QUICK_EDIT),e.addMenuItem(i.QUICK_EDIT_PREV_MATCH),e.addMenuItem(i.QUICK_EDIT_NEXT_MATCH),e.addMenuItem(i.CSS_QUICK_EDIT_NEW_RULE),e.addMenuDivider(),e.addMenuItem(i.TOGGLE_QUICK_DOCS),e=u.addMenu(a.HELP_MENU,u.AppMenuBar.HELP_MENU),e.addMenuItem(i.HELP_CHECK_FOR_UPDATE),e.addMenuDivider(),brackets.config.how_to_use_url&&e.addMenuItem(i.HELP_HOW_TO_USE_BRACKETS),brackets.config.support_url&&e.addMenuItem(i.HELP_SUPPORT),brackets.config.suggest_feature_url&&e.addMenuItem(i.HELP_SUGGEST),brackets.config.release_notes_url&&e.addMenuItem(i.HELP_RELEASE_NOTES),brackets.config.get_involved_url&&e.addMenuItem(i.HELP_GET_INVOLVED),e.addMenuDivider(),e.addMenuItem(i.HELP_SHOW_EXT_FOLDER);var t=brackets.platform!=="mac"||!brackets.nativeMenus;(t||brackets.config.homepage_url||brackets.config.twitter_url)&&e.addMenuDivider(),brackets.config.homepage_url&&e.addMenuItem(i.HELP_HOMEPAGE),brackets.config.twitter_url&&e.addMenuItem(i.HELP_TWITTER),t&&e.addMenuItem(i.HELP_ABOUT);var n=u.registerContextMenu(u.ContextMenuIds.PROJECT_MENU);n.addMenuItem(i.FILE_NEW),n.addMenuItem(i.FILE_NEW_FOLDER),n.addMenuItem(i.FILE_RENAME),n.addMenuItem(i.FILE_DELETE),n.addMenuItem(i.NAVIGATE_SHOW_IN_OS),n.addMenuDivider(),n.addMenuItem(i.CMD_FIND_IN_SUBTREE),n.addMenuItem(i.CMD_REPLACE_IN_SUBTREE),n.addMenuDivider(),n.addMenuItem(i.FILE_REFRESH);var r=u.registerContextMenu(u.ContextMenuIds.WORKING_SET_MENU);r.addMenuItem(i.FILE_SAVE),r.addMenuItem(i.FILE_SAVE_AS),r.addMenuItem(i.FILE_RENAME),r.addMenuItem(i.NAVIGATE_SHOW_IN_FILE_TREE),r.addMenuItem(i.NAVIGATE_SHOW_IN_OS),r.addMenuDivider(),r.addMenuItem(i.CMD_FIND_IN_SUBTREE),r.addMenuItem(i.CMD_REPLACE_IN_SUBTREE),r.addMenuDivider(),r.addMenuItem(i.FILE_CLOSE);var s=u.registerContextMenu(u.ContextMenuIds.WORKING_SET_SETTINGS_MENU);s.addMenuItem(i.SORT_WORKINGSET_BY_ADDED),s.addMenuItem(i.SORT_WORKINGSET_BY_NAME),s.addMenuItem(i.SORT_WORKINGSET_BY_TYPE),s.addMenuDivider(),s.addMenuItem(i.SORT_WORKINGSET_AUTO);var f=u.registerContextMenu(u.ContextMenuIds.EDITOR_MENU);f.addMenuItem(i.TOGGLE_QUICK_EDIT),f.addMenuItem(i.TOGGLE_QUICK_DOCS),f.addMenuItem(i.EDIT_SELECT_ALL);var l=u.registerContextMenu(u.ContextMenuIds.INLINE_EDITOR_MENU);l.addMenuItem(i.TOGGLE_QUICK_EDIT),l.addMenuItem(i.EDIT_SELECT_ALL),l.addMenuDivider(),l.addMenuItem(i.QUICK_EDIT_PREV_MATCH),l.addMenuItem(i.QUICK_EDIT_NEXT_MATCH),$("#editor-holder").on("contextmenu",function(e){if($(e.target).parents(".CodeMirror-gutter").length!==0)return;var t=o.getFocusedEditor(),n=o.getFocusedInlineWidget();t&&(t.hasSelection()||t.selectWordAt(t.getCursorPos()),n?l.open(e):f.open(e))}),$("#project-files-container").on("contextmenu",function(e){n.open(e)}),$("#open-files-container").on("contextmenu",function(e){r.open(e)}),u.ContextMenu.assignContextMenuToSelector("#working-set-option-btn",s),$(window).contextmenu(function(e){e.preventDefault()}),$(window.document).on("mousedown",".dropdown",function(e){e.preventDefault()}),$(window.document).on("mouseenter","#titlebar .dropdown",function(e){var t=$(this).siblings(".open");t.length>0&&(t.removeClass("open"),$(this).addClass("open"))})})}),define("editor/EditorStatusBar",["require","exports","module","thirdparty/lodash","utils/AnimationUtils","utils/AppInit","widgets/DropdownButton","editor/EditorManager","editor/Editor","utils/KeyEvent","language/LanguageManager","widgets/StatusBar","strings","utils/StringUtils"],function(e,t,n){function E(e,t,n){return p.format(e>1?n:t,e)}function S(e){var t=e.document,n=t.getLanguage();d.$button.css("width","auto"),d.$button.prop("disabled",t.isUntitled()),d.$button.text(n.getName())}function x(e){var t=e.lineCount();m.text(E(t,h.STATUSBAR_LINE_COUNT_SINGULAR,h.STATUSBAR_LINE_COUNT_PLURAL))}function T(e){var t=a.getUseTabChar(e);g.text(t?h.STATUSBAR_TAB_SIZE:h.STATUSBAR_SPACES),g.attr("title",t?h.STATUSBAR_INDENT_TOOLTIP_SPACES:h.STATUSBAR_INDENT_TOOLTIP_TABS),y.attr("title",t?h.STATUSBAR_INDENT_SIZE_TOOLTIP_TABS:h.STATUSBAR_INDENT_SIZE_TOOLTIP_SPACES)}function N(e){return a.getUseTabChar(e)?a.getTabSize(e):a.getSpaceUnits(e)}function C(e){var t=N(e);y.text(t),b.val(t)}function k(){var e=u.getActiveEditor(),t=e&&e.document.file.fullPath;a.setUseTabChar(!a.getUseTabChar(t),t),T(t),C(t)}function L(e,t){t=t||u.getActiveEditor();var n=t.getCursorPos(!0),r=p.format(h.STATUSBAR_CURSOR_POSITION,n.line+1,n.ch+1),i=t.getSelections(),s="";if(i.length>1)s=p.format(h.STATUSBAR_SELECTION_MULTIPLE,i.length);else if(t.hasSelection()){var o=i[0];if(o.start.line!==o.end.line){var a=o.end.line-o.start.line+1;o.end.ch===0&&a--,s=E(a,h.STATUSBAR_SELECTION_LINE_SINGULAR,h.STATUSBAR_SELECTION_LINE_PLURAL)}else{var f=t.getColOffset(o.end)-t.getColOffset(o.start);s=E(f,h.STATUSBAR_SELECTION_CH_SINGULAR,h.STATUSBAR_SELECTION_CH_PLURAL)}}v.text(r+s)}function A(e,t){y.removeClass("hidden"),b.addClass("hidden"),b.off("blur keyup"),u.focusEditor();var n=parseInt(t,10);if(a.getUseTabChar(e)){if(!a.setTabSize(n,e))return}else if(!a.setSpaceUnits(n,e))return;C(e),L()}function O(e,t,n,r){if(w.text()===(n?h.STATUSBAR_OVERWRITE:h.STATUSBAR_INSERT))return;w.text(n?h.STATUSBAR_OVERWRITE:h.STATUSBAR_INSERT),r||i.animateUsingClass(w[0],"flash",1500)}function M(e){var t=u.getActiveEditor(),n=!t._codeMirror.state.overwrite;O(e,t,n,!0),t.toggleOverwrite(n)}function _(e){e.toggleOverwrite(w.text()===h.STATUSBAR_OVERWRITE)}function D(e,t,n){n&&($(n).off(".statusbar"),$(n.document).off(".statusbar"),n.document.releaseRef());if(!t)c.hide();else{var r=t.document.file.fullPath;c.show(),$(t).on("cursorActivity.statusbar",L),$(t).on("optionChange.statusbar",function(){T(r),C(r)}),$(t).on("change.statusbar",function(){window.setTimeout(function(){x(t)},0)}),$(t).on("overwriteToggle.statusbar",O),t.document.addRef(),$(t.document).on("languageChanged.statusbar",function(){S(t)}),L(null,t),S(t),x(t),_(t),T(r),C(r)}}function P(){var e=r.values(l.getLanguages()).filter(function(e){return!e.isBinary()});e.sort(function(e,t){return e.getName().toLowerCase().localeCompare(t.getName().toLowerCase())}),d.items=e}function H(){v=$("#status-cursor"),m=$("#status-file"),g=$("#indent-type"),y=$("#indent-width-label"),b=$("#indent-width-input"),w=$("#status-overwrite"),d=new o("",[],function(e,t){var n=u.getActiveEditor().document,i=l.getLanguageForPath(n.file.fullPath,!0),s=r.escape(e.getName());return e===i&&(s+=" <span class='default-language'>"+h.STATUSBAR_DEFAULT_LANG+"</span>"),e===n.getLanguage()&&(s="<span class='checked-language'></span>"+s),s}),d.dropdownExtraClasses="dropdown-status-bar",d.$button.addClass("btn-status-bar"),$("#status-language").append(d.$button),g.on("click",k),y.on("click",function(){var e=u.getActiveEditor();b.val(N(e)),y.addClass("hidden"),b.removeClass("hidden"),b.focus(),b.on("blur",function(){A(e,b.val())}).on("keyup",function(t){t.keyCode===f.DOM_VK_RETURN?b.blur():t.keyCode===f.DOM_VK_ESCAPE&&A(e,!1)})}),b.focus(function(){b.select()}),$(d).on("select",function(e,t,n){var r=u.getActiveEditor().document,i=r.file.fullPath,s=l.getLanguageForPath(i,!0);r.setLanguageOverride(t===s?null:t)}),w.on("click",M),D(null,u.getActiveEditor(),null)}var r=e("thirdparty/lodash"),i=e("utils/AnimationUtils"),s=e("utils/AppInit"),o=e("widgets/DropdownButton").DropdownButton,u=e("editor/EditorManager"),a=e("editor/Editor").Editor,f=e("utils/KeyEvent"),l=e("language/LanguageManager"),c=e("widgets/StatusBar"),h=e("strings"),p=e("utils/StringUtils"),d,v,m,g,y,b,w;$(u).on("activeEditorChange",D),s.htmlReady(H),s.appReady(P)}),define("editor/EditorCommandHandlers",["require","exports","module","command/Commands","strings","command/CommandManager","editor/EditorManager","utils/StringUtils","utils/TokenUtils","thirdparty/CodeMirror2/lib/codemirror","thirdparty/lodash"],function(e,t,n){function p(e,t){var n,r,i=[],s="";for(n=e.length;n<t.length;n++)r=t.charAt(n),i.push(s+"[^"+u.regexEscape(r)+"]"),s&&i.push(s+"$"),s+=r;return new RegExp("^\\s*"+u.regexEscape(e)+"($|"+i.join("|")+")")}function d(e,t,n){var r=[],i,s;return e.forEach(function(e){i=u.regexEscape(e),s=!0,t&&t.indexOf(e)===0&&(r.push(p(e,t)),s=!1),n&&t!==n&&n.indexOf(e)===0&&(r.push(p(e,n)),s=!1),s&&r.push(new RegExp("^\\s*"+i))}),r}function v(e,t){return t.some(function(t){return e.match(t)})}function m(e,t,n){var r=null;return t.forEach(function(t,i){e.match(t)&&(r&&r.length<n[i].length||!r)&&(r=n[i])}),r}function g(e,t,n,r){var i,s,o=!1;for(i=t;i<=n;i++){s=e.document.getLine(i);if(s.match(/\S/)&&!v(s,r)){o=!0;break}}return o}function y(e,t,n,r,i){var s=e.document,o=i.selectionForEdit,u=i.selectionsToTrack,a=d(t,n,r),c=o.start.line,h=o.end.line,p=[];o.end.ch===0&&h--;var v,y,b,w,E=g(e,c,h,a),S=!1;if(E){for(v=c;v<=h;v++)p.push({text:t[0],start:{line:v,ch:0}});l.each(u,function(e){e.start.ch===0&&f.cmpPos(e.start,e.end)!==0?(e.start={line:e.start.line,ch:0},e.end={line:e.end.line,ch:e.end.line===h?e.end.ch+t[0].length:0}):e.isBeforeEdit=!0})}else{for(v=c;v<=h;v++)y=s.getLine(v),b=m(y,a,t),b&&(w=y.indexOf(b),p.push({text:"",start:{line:v,ch:w},end:{line:v,ch:w+b.length}}));l.each(u,function(e){e.isBeforeEdit=!0})}return{edit:p,selection:u}}function b(e,t,n,r,i,s){var o=a.moveSkippingWhitespace(a.movePrevToken,e);while(o&&v(e.token.string,s))o=a.moveSkippingWhitespace(a.movePrevToken,e);return o&&e.token.type==="comment"?!e.token.string.match(r)&&!e.token.string.match(i)?!0:t===n&&e.token.string.length===t.length?!b(e,t,n,r,i,s):e.token.string.match(r):!1}function w(e,t,n,r,i,s){var o=e.document,c=a.getInitialContext(e._codeMirror,{line:i.start.line,ch:i.start.ch}),h=e.indexFromPos(i.end),p=d(r,t,n),m=new RegExp("^"+u.regexEscape(t),"g"),y=new RegExp(u.regexEscape(n)+"$","g"),w=null,E=null,S=!0,x=!1,T=!1,N=!1,C=!1,k=!0,L=[],A,O,M,_,D,P;s||(s=[l.cloneDeep(i)]),!c.token.type&&!/\S/.test(c.token.string)&&(k=a.moveSkippingWhitespace(a.moveNextToken,c));while(k&&c.token.type!=="comment")k=a.moveSkippingWhitespace(a.moveNextToken,c)&&e.indexFromPos(c.pos)<=h,S=!1;if(k&&c.token.type==="comment"){v(c.token.string,p)?c.token.start===0&&!c.token.string.match(/^\\s*/)&&S?(O=a.getInitialContext(e._codeMirror,{line:c.pos.line,ch:c.token.start}),x=b(O,t,n,m,y,p)):x=!1:(x=!0,c.token.string===t&&t===n&&(O=a.getInitialContext(e._codeMirror,{line:c.pos.line,ch:c.token.start}),M=b(O,t,n,m,y,p),M?a.moveSkippingWhitespace(a.movePrevToken,c):a.moveSkippingWhitespace(a.moveNextToken,c)));if(x){D=l.cloneDeep(c.pos),k=!0;while(k&&!c.token.string.match(m))k=a.moveSkippingWhitespace(a.movePrevToken,c);w=k&&{line:c.pos.line,ch:c.token.start},c.token.string===t&&t===n&&(c=a.getInitialContext(e._codeMirror,l.cloneDeep(D)));while(k&&!c.token.string.match(y))k=a.moveSkippingWhitespace(a.moveNextToken,c);E=k&&{line:c.pos.line,ch:c.token.end-n.length};do k=a.moveSkippingWhitespace(a.moveNextToken,c)&&e.indexFromPos(c.pos)<=h;while(k&&!c.token.string.match(m));N=k&&!!c.token.string.match(m),_=E&&{line:E.line,ch:E.ch+n.length};if(_&&f.cmpPos(i.start,_)>0||w&&f.cmpPos(i.end,w)<0)T=!0}else P=i.end.line,i.end.ch===0&&e.hasSelection()&&P--,g(e,i.start.line,P,p)?T=!0:C=!0}else T=!0;if(N)A={edit:[],selection:s};else if(C)A=null;else{if(T){var H=i.start.ch===0&&i.end.ch===0&&i.start.line<i.end.line;H?(L.push({text:n+"\n",start:i.end}),L.push({text:t+"\n",start:i.start})):(L.push({text:n,start:i.end}),L.push({text:t,start:i.start})),l.each(s,function(e){function r(e){f.cmpPos(e,i.end)>0&&(H?e.line++:e.line===i.end.line&&(e.ch+=n.length)),f.cmpPos(e,i.start)>=0&&(H?e.line++:e.line===i.start.line&&(e.ch+=t.length))}r(e.start),r(e.end)})}else{var B=o.getLine(w.line).trim(),j=w.ch===0&&t.length===B.length,F=!1;E&&(B=o.getLine(E.line).trim(),F=E.ch===0&&n.length===B.length),E&&(j&&F?L.push({text:"",start:E,end:{line:E.line+1,ch:0}}):L.push({text:"",start:E,end:{line:E.line,ch:E.ch+n.length}})),j&&F?L.push({text:"",start:w,end:{line:w.line+1,ch:0}}):L.push({text:"",start:w,end:{line:w.line,ch:w.ch+t.length}}),l.each(s,function(e){e.isBeforeEdit=!0})}A={edit:L,selection:s}}return A}function E(e,t,n,r){var i=r.selectionForEdit,s=i.start,o=i.end,u;return i.end.line===i.start.line+1&&i.end.ch===0&&(i.end={line:i.start.line,ch:e.document.getLine(i.start.line).length}),w(e,t,n,[],i,r.selectionsToTrack)}function S(e,t){var n=e.convertToLineSelections(t,{mergeAdjacent:!1}),r=[];return l.each(n,function(t){var n=t.selectionForEdit,i=e.getModeForRange(n.start,n.end),s;if(i){var o=e.document.getLanguage().getLanguageForMode(i.name||i);o.hasLineCommentSyntax()?s=y(e,o.getLineCommentPrefixes(),o.getBlockCommentPrefix(),o.getBlockCommentSuffix(),t):o.hasBlockCommentSyntax()&&(s=E(e,o.getBlockCommentPrefix(),o.getBlockCommentSuffix(),t))}s||(s={selection:t.selectionsToTrack}),r.push(s)}),r}function x(e){e=e||o.getFocusedEditor();if(!e)return;e.setSelections(e.document.doMultipleEdits(S(e,e.getSelections())))}function T(e){e=e||o.getFocusedEditor();if(!e)return;var t=[],n=[];l.each(e.getSelections(),function(r){var i=e.getModeForRange(r.start,r.end),s={edit:[],selection:[r]};if(i){var o=e.document.getLanguage().getLanguageForMode(i.name||i);o.hasBlockCommentSyntax()&&(s=w(e,o.getBlockCommentPrefix(),o.getBlockCommentSuffix(),o.getLineCommentPrefixes(),r),s||n.push(r))}s&&t.push(s)}),t.push.apply(t,S(e,n)),e.setSelections(e.document.doMultipleEdits(t))}function N(e){e=e||o.getFocusedEditor();if(!e)return;var t=e.getSelections(),n="",r=[],i=[],s=[],u=e.document;l.each(t,function(e){f.cmpPos(e.start,e.end)===0?s.push(e):i.push(e)});var a=e.convertToLineSelections(s);l.each(a,function(t,i){var s=t.selectionForEdit;s.end.line===e.lineCount()&&(n="\n"),r.push({edit:{text:u.getRange(s.start,s.end)+n,start:s.start}})}),l.each(i,function(e){r.push({edit:{text:u.getRange(e.start,e.end),start:e.start}})}),u.doMultipleEdits(r)}function C(e){e=e||o.getFocusedEditor();if(!e)return;var t=e.document,n,r,i=e.convertToLineSelections(e.getSelections()),s=[];l.each(i,function(i,o){var u=i.selectionForEdit,a=u.start.line;n=u.start,r=u.end,r.line===e.getLastVisibleLine()+1&&(n.line>e.getFirstVisibleLine()&&(n.line-=1,n.ch=t.getLine(n.line).length),r.line-=1,r.ch=t.getLine(r.line).length),s.push({edit:{text:"",start:n,end:r}})}),t.doMultipleEdits(s)}function k(e,t){e=e||o.getFocusedEditor();if(!e)return;var n=e.document,r=e.convertToLineSelections(e.getSelections()),i=!!o.getFocusedInlineWidget(),s=e.getFirstVisibleLine(),u=e.getLastVisibleLine(),a=e.lineCount(),f=0,p=[],d=[],v={};l.each(r,function(e){var r=e.selectionForEdit,o=[];switch(t){case c:if(r.start.line!==s){var d=n.getRange({line:r.start.line-1,ch:0},r.start);r.end.line===u+1&&(i?(d=d.substring(0,d.length-1),f=n.getLine(r.end.line-1).length,o.push({text:"\n",start:{line:r.end.line-1,ch:f}})):d="\n"+d.substring(0,d.length-1)),o.push({text:"",start:{line:r.start.line-1,ch:0},end:r.start}),o.push({text:d,start:{line:r.end.line-1,ch:0}}),l.each(e.selectionsToTrack,function(e){e.start.line--,e.end.line--}),p.push({edit:o,selection:e.selectionsToTrack})}break;case h:if(r.end.line<=u){var v=n.getRange(r.end,{line:r.end.line+1,ch:0}),m=r.end;r.end.line===u&&(i?(r.end.line===a-1&&(v+="\n"),f=n.getLine(r.end.line-1).length,o.push({text:"\n",start:{line:r.end.line,ch:n.getLine(r.end.line).length}})):(v+="\n",m={line:r.end.line-1,ch:n.getLine(r.end.line-1).length})),o.push({text:"",start:m,end:{line:r.end.line+1,ch:0}}),f&&o.push({text:"",start:{line:r.end.line-1,ch:f},end:{line:r.end.line,ch:0}}),o.push({text:v,start:{line:r.start.line,ch:0}}),p.push({edit:o})}}}),p.length&&(d=n.doMultipleEdits(p),v.ch=0,t===c?(e.setSelections(d),v.line=e.getSelection().start.line):t===h?v.line=e.getSelection().end.line:(console.error("EditorCommandHandler.moveLine() called with invalid argument 'direction' = %d",t),v=null),e._codeMirror.scrollIntoView(v))}function L(e){k(e,c)}function A(e){k(e,h)}function O(e,t){e=e||o.getFocusedEditor();if(!e)return;var n=e.getSelections(),r=!!o.getFocusedInlineWidget(),i=e.getLastVisibleLine(),s=e.document,u=[],a,p;s.batchOperation(function(){l.each(n,function(e,o){if(o===0||t===c&&e.start.line>n[o-1].start.line||t===h&&e.end.line>n[o-1].end.line){switch(t){case c:p=e.start.line;break;case h:p=e.end.line,(f.cmpPos(e.start,e.end)===0||e.end.ch!==0)&&p++}var a;p>i&&r?a={line:p-1,ch:s.getLine(p-1).length}:a={line:p,ch:0},u.push({edit:{text:"\n",start:a},selection:{start:a,end:a,primary:e.primary}})}else e.primary&&(u[u.length-1].selections[0].primary=!0)}),a=s.doMultipleEdits(u,"+input"),l.each(a,function(e){s._masterEditor._codeMirror.indentLine(e.start.line,"smart",!0),e.start.ch=null,e.end=e.start})}),e.setSelections(a)}function M(e){O(e,c)}function _(e){O(e,h)}function D(){var e=o.getFocusedEditor();if(!e)return;e._codeMirror.execCommand("indentMore")}function P(){var e=o.getFocusedEditor();if(!e)return;e._codeMirror.execCommand("indentLess")}function H(e){e=e||o.getFocusedEditor(),e&&e.setSelections(l.pluck(e.convertToLineSelections(e.getSelections(),{expandEndAtStartOfLine:!0}),"selectionForEdit"))}function B(e){e=e||o.getFocusedEditor(),e&&e._codeMirror.execCommand("splitSelectionByLine")}function j(e,t){e=e||o.getFocusedEditor();if(e){var n=e.getSelections(),r=[];l.each(n,function(n){var i,s;if(t===-1&&n.start.line>e.getFirstVisibleLine()||t===1&&n.end.line<e.getLastVisibleLine())i=l.clone(t===-1?n.start:n.end),s=e.getColOffset(i),i.line+=t,i.ch=e.getCharIndexForColumn(i.line,s),r.push({start:i,end:i,primary:n.primary}),n.primary=!1}),e.setSelections(n.concat(r))}}function F(e){j(e,-1)}function I(e){j(e,1)}function q(e){var t=o.getFocusedEditor(),n=new $.Deferred;return t?(t[e](),n.resolve()):n.reject(),n.promise()}function R(){return q("undo")}function U(){return q("redo")}function z(){return(new $.Deferred).reject().promise()}function W(){var e=new $.Deferred,t=o.getFocusedEditor();return t?(t.selectAllNoScroll(),e.resolve()):e.reject(),e.promise()}var r=e("command/Commands"),i=e("strings"),s=e("command/CommandManager"),o=e("editor/EditorManager"),u=e("utils/StringUtils"),a=e("utils/TokenUtils"),f=e("thirdparty/CodeMirror2/lib/codemirror"),l=e("thirdparty/lodash"),c=-1,h=1;s.register(i.CMD_INDENT,r.EDIT_INDENT,D),s.register(i.CMD_UNINDENT,r.EDIT_UNINDENT,P),s.register(i.CMD_COMMENT,r.EDIT_LINE_COMMENT,x),s.register(i.CMD_BLOCK_COMMENT,r.EDIT_BLOCK_COMMENT,T),s.register(i.CMD_DUPLICATE,r.EDIT_DUPLICATE,N),s.register(i.CMD_DELETE_LINES,r.EDIT_DELETE_LINES,C),s.register(i.CMD_LINE_UP,r.EDIT_LINE_UP,L),s.register(i.CMD_LINE_DOWN,r.EDIT_LINE_DOWN,A),s.register(i.CMD_OPEN_LINE_ABOVE,r.EDIT_OPEN_LINE_ABOVE,M),s.register(i.CMD_OPEN_LINE_BELOW,r.EDIT_OPEN_LINE_BELOW,_),s.register(i.CMD_SELECT_LINE,r.EDIT_SELECT_LINE,H),s.register(i.CMD_SPLIT_SEL_INTO_LINES,r.EDIT_SPLIT_SEL_INTO_LINES,B),s.register(i.CMD_ADD_CUR_TO_NEXT_LINE,r.EDIT_ADD_CUR_TO_NEXT_LINE,I),s.register(i.CMD_ADD_CUR_TO_PREV_LINE,r.EDIT_ADD_CUR_TO_PREV_LINE,F),s.register(i.CMD_UNDO,r.EDIT_UNDO,R),s.register(i.CMD_REDO,r.EDIT_REDO,U),s.register(i.CMD_CUT,r.EDIT_CUT,z),s.register(i.CMD_COPY,r.EDIT_COPY,z),s.register(i.CMD_PASTE,r.EDIT_PASTE,z),s.register(i.CMD_SELECT_ALL,r.EDIT_SELECT_ALL,W)}),define("editor/EditorOptionHandlers",["require","exports","module","utils/AppInit","editor/Editor","editor/EditorManager","command/Commands","command/CommandManager","preferences/PreferencesManager","strings","thirdparty/lodash"],function(e,t,n){function m(e){var t=v[e];if(!t)return;u.get(t).setChecked(a.get(e))}function g(e){return function(){a.set(e,!a.get(e))}}function y(){l.each(v,function(e,t){u.get(e).setChecked(a.get(t))}),i.getShowLineNumbers()||i._toggleLinePadding(!0)}var r=e("utils/AppInit"),i=e("editor/Editor").Editor,s=e("editor/EditorManager"),o=e("command/Commands"),u=e("command/CommandManager"),a=e("preferences/PreferencesManager"),f=e("strings"),l=e("thirdparty/lodash"),c="showLineNumbers",h="styleActiveLine",p="wordWrap",d="closeBrackets",v={};v[c]=o.TOGGLE_LINE_NUMBERS,v[h]=o.TOGGLE_ACTIVE_LINE,v[p]=o.TOGGLE_WORD_WRAP,v[d]=o.TOGGLE_CLOSE_BRACKETS,Object.keys(v).forEach(function(e){a.on("change",e,function(){m(e)})}),u.register(f.CMD_TOGGLE_LINE_NUMBERS,o.TOGGLE_LINE_NUMBERS,g(c)),u.register(f.CMD_TOGGLE_ACTIVE_LINE,o.TOGGLE_ACTIVE_LINE,g(h)),u.register(f.CMD_TOGGLE_WORD_WRAP,o.TOGGLE_WORD_WRAP,g(p)),u.register(f.CMD_TOGGLE_CLOSE_BRACKETS,o.TOGGLE_CLOSE_BRACKETS,g(d)),r.htmlReady(y)}),define("utils/BuildInfoUtils",["require","exports","module","utils/Global","filesystem/FileSystem","file/FileUtils"],function(e,t,n){function u(e,t){var n=new $.Deferred;if(brackets.inBrowser)n.reject();else{var r=i.getFileForPath(e);s.readAsText(r).done(function(r){if(r.indexOf("ref: ")===0){var i=e.substr(0,e.lastIndexOf("/")),s=r.substr(5).trim(),o=r.substr(16).trim();u(i+"/"+s,t).done(function(e){n.resolve({branch:o,sha:e.sha.trim()})}).fail(function(){n.resolve({branch:o})})}else n.resolve({sha:r})}).fail(function(){n.reject()})}return n.promise()}function a(){var e=new $.Deferred,t=s.getNativeBracketsDirectoryPath(),n=t.substr(0,t.lastIndexOf("/"))+"/.git/HEAD";return u(n).done(function(t){e.resolve(t.branch,t.sha,!0)}).fail(function(){e.resolve(brackets.metadata.repository.branch,brackets.metadata.repository.SHA,!1)}),e.promise()}var r=e("utils/Global"),i=e("filesystem/FileSystem"),s=e("file/FileUtils"),o;t.getBracketsSHA=a}),define("text!htmlContent/about-dialog.html",[],function(){return'<div class="about-dialog modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{Strings.ABOUT}}</h1>\n    </div>\n    <div class="modal-body no-padding">\n        <img class="about-icon" src="{{ABOUT_ICON}}">\n        <div class="about-text">\n            <h2>{{APP_NAME_ABOUT_BOX}}</h2>\n            <div class="about-info">\n                <p class="dialog-message">{{Strings.ABOUT_TEXT_LINE1}} <span id="about-build-number">{{BUILD_INFO}}</span>\n                  {{#BUILD_TIMESTAMP}}\n                  <br><span class="dialog-message">{{Strings.ABOUT_TEXT_BUILD_TIMESTAMP}}{{BUILD_TIMESTAMP}}</span>\n                  {{/BUILD_TIMESTAMP}}\n                </p>\n\n                <p class="dialog-message"><!-- $NON-NLS$ -->Copyright 2012 - 2014 Adobe Systems Incorporated and its licensors. All rights reserved.</p>\n                <p class="dialog-message">{{{Strings.ABOUT_TEXT_WEB_PLATFORM_DOCS}}}</p>\n                <p class="dialog-message">{{{Strings.ABOUT_TEXT_LINE3}}}</p>\n                <p class="dialog-message">{{{Strings.ABOUT_TEXT_LINE4}}}</p>\n                <p class="dialog-message">\n                    {{Strings.ABOUT_TEXT_LINE5}}\n                    <span class="spinner inline"></span>\n                </p>\n                <div class="about-contributors">\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="modal-footer">\n        <button class="dialog-button btn primary" data-button-id="ok">{{Strings.CLOSE}}</button>\n    </div>\n</div>\n'}),define("text!htmlContent/contributors-list.html",[],function(){return'{{#.}}<a href="{{html_url}}" title="{{login}} - {{html_url}}"><img src="{{avatar_url}}?size=30" alt="{{login}}" width="30" height="30" /></a>{{/.}}\n'}),define("help/HelpCommandHandlers",["require","exports","module","utils/AppInit","utils/BuildInfoUtils","command/CommandManager","command/Commands","widgets/Dialogs","file/FileUtils","utils/Global","utils/NativeApp","strings","utils/StringUtils","utils/UpdateNotification","text!htmlContent/about-dialog.html","text!htmlContent/contributors-list.html"],function(e,t,n){function y(){p.checkForUpdate(!0)}function b(e){return function(){if(!e)return;l.openURLInDefaultBrowser(e)}}function w(){brackets.app.showExtensionsFolder(a.convertToNativePath(decodeURI(window.location.href)),function(e){})}function E(){function o(e,t,n,r){r=r||new $.Deferred,n=n||[];var i=h.format(e,m,t);return $.ajax({url:i,dataType:"json",cache:!1}).done(function(i){n=n.concat(i||[]),t&&i.length===m?o(e,t+1,n,r):r.resolve(n)}).fail(function(){n.length?r.resolve(n):r.reject()}),r.promise()}var e={ABOUT_ICON:brackets.config.about_icon,APP_NAME_ABOUT_BOX:brackets.config.app_name_about,BUILD_TIMESTAMP:brackets.config.build_timestamp,BUILD_INFO:g||"",Strings:c};u.showModalDialogUsingTemplate(Mustache.render(d,e));var t=$(".about-dialog.instance"),n=t.find(".about-contributors"),r=t.find(".spinner"),i=brackets.config.contributors_url,s;i.indexOf("{1}")!==-1&&(s=1),r.addClass("spin"),o(i,s).done(function(e){var t=e.length,i=0;e.forEach(function(e){e.avatar_url=e.avatar_url.split("?")[0]}),n.html(Mustache.render(v,e)),n.find("img").one("load",function(){$(this).css("opacity",1),i++,i>=t&&r.removeClass("spin")}).each(function(){this.complete&&$(this).trigger("load")})}).fail(function(){r.removeClass("spin"),n.html(Mustache.render("<p class='dialog-message'>{{ABOUT_TEXT_LINE6}}</p>",c))})}var r=e("utils/AppInit"),i=e("utils/BuildInfoUtils"),s=e("command/CommandManager"),o=e("command/Commands"),u=e("widgets/Dialogs"),a=e("file/FileUtils"),f=e("utils/Global"),l=e("utils/NativeApp"),c=e("strings"),h=e("utils/StringUtils"),p=e("utils/UpdateNotification"),d=e("text!htmlContent/about-dialog.html"),v=e("text!htmlContent/contributors-list.html"),m=100,g;r.appReady(function(){i.getBracketsSHA().done(function(e,t,n){t=t?t.substr(0,9):"";if(e||t)g=h.format("({0} {1})",e,t).trim()})}),s.register(c.CMD_CHECK_FOR_UPDATE,o.HELP_CHECK_FOR_UPDATE,y),s.register(c.CMD_HOW_TO_USE_BRACKETS,o.HELP_HOW_TO_USE_BRACKETS,b(brackets.config.how_to_use_url)),s.register(c.CMD_SUPPORT,o.HELP_SUPPORT,b(brackets.config.support_url)),s.register(c.CMD_SUGGEST,o.HELP_SUGGEST,b(brackets.config.suggest_feature_url)),s.register(c.CMD_RELEASE_NOTES,o.HELP_RELEASE_NOTES,b(brackets.config.release_notes_url)),s.register(c.CMD_GET_INVOLVED,o.HELP_GET_INVOLVED,b(brackets.config.get_involved_url)),s.register(c.CMD_SHOW_EXTENSIONS_FOLDER,o.HELP_SHOW_EXT_FOLDER,w),s.register(c.CMD_HOMEPAGE,o.HELP_HOMEPAGE,b(brackets.config.homepage_url)),s.register(c.CMD_TWITTER,o.HELP_TWITTER,b(brackets.config.twitter_url)),s.register(c.CMD_ABOUT,o.HELP_ABOUT,E)}),define("text!htmlContent/edit-filter-dialog.html",[],function(){return'<div class="file-filter-dialog modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{Strings.FILE_FILTER_DIALOG}}</h1>\n    </div>\n    <div class="modal-body">\n        <div class="dialog-message">\n            {{{instruction}}}\n            <textarea class="exclusions-editor"></textarea>\n            <input type="text" class="exclusions-name" placeholder="{{Strings.FILTER_NAME_PLACEHOLDER}}">\n            <div class="exclusions-filecount">{{Strings.FILTER_COUNTING_FILES}}</div>\n        </div>\n    </div>\n    <div class="modal-footer">\n        <button class="dialog-button btn" data-button-id="cancel">{{Strings.CANCEL}}</button>\n        <button class="dialog-button btn primary" data-button-id="ok">{{Strings.OK}}</button>\n    </div>\n</div>\n'}),define("text!htmlContent/filter-name.html",[],function(){return"<div class='filter-trash-icon'>&times;</div><!-- \n--><span class='recent-filter-name'>{{{filter-name}}}</span><!-- \n--><span class='recent-filter-patterns'>{{{filter-patterns}}}</span><!-- \n--><span class='filter-edit-icon'></span>"}),define("search/FileFilters",["require","exports","module","thirdparty/lodash","project/ProjectManager","widgets/DefaultDialogs","widgets/Dialogs","widgets/DropdownButton","utils/StringUtils","strings","preferences/PreferencesManager","text!htmlContent/edit-filter-dialog.html","text!htmlContent/filter-name.html"],function(e,t,n){function m(e){return r.isArray(e)?e.length>2?e.slice(0,2).join(", ")+" "+a.format(f.FILE_FILTER_CLIPPED_SUFFIX,e.length-2):e.join(", "):""}function g(){var e=[f.NEW_FILE_FILTER,f.CLEAR_FILE_FILTER],t=l.get("fileFilters")||[];t.length&&(e.push("---"),t=t.filter(function(e){return m(e.patterns)!==""}),e=e.concat(t)),v.items=e}function y(e,t){var n=-1,i=!1;return!t||!e.length?n:r.findIndex(e,r.partial(r.isEqual,t))}function b(){var e=l.get("fileFilters")||[],t=l.getViewState("activeFileFilter"),n=l.getViewState("search.exclusions")||[],r=null;return t===undefined&&n.length?(r={name:"",patterns:n},t=y(e,r),t===-1&&(t=e.length,e.push(r),l.set("fileFilters",e)),l.setViewState("activeFileFilter",t)):t>-1&&t<e.length&&(r=e[t]),r}function w(){var e=b();if(e&&e.patterns.length){var t=e.name||m(e.patterns);v.setButtonLabel(a.format(f.EXCLUDE_FILE_FILTER,t))}else v.setButtonLabel(f.NO_FILE_FILTER)}function E(e,t){var n=l.get("fileFilters")||[];if(e){if(t===-1)t=n.length,n.push(e);else{if(!(t>-1&&t<n.length)){console.log("setActiveFilter is called with an invalid index: "+t);return}r.isEqual(n[t],e)||(n[t]=e)}l.set("fileFilters",n),l.setViewState("activeFileFilter",t)}else l.setViewState("activeFileFilter",-1)}function S(e){var t=e.map(function(e){e.substr(0,2)!=="**"&&(e="**"+e);if(e.substr(-2,2)!=="**"){var t=e.lastIndexOf("/");e.indexOf(".",t+1)===-1&&(e+="**")}return e}),n=t.map(function(e){var t="",n;for(n=0;n<e.length;n++){var r=e[n];r==="*"?e[n+1]==="*"?e[n+2]==="/"&&e[n-1]==="/"?(t+="(.*/)?",n+=2):(t+=".*",n++):t+="[^/]*":r==="?"?t+="[^/]":t+=a.regexEscape(r)}return"^"+t+"$"});return n.join("|")}function x(e,t){if(!e)return!0;var n=new RegExp(e);return!t.match(n)}function T(e,t){if(!e)return t;var n=new RegExp(e);return t.filter(function(e){return!e.fullPath.match(n)})}function N(e,t){function h(){var e=l.val().split("\n");return e.filter(function(e){return e.trim().length})}function v(){d.promise.done(function(e){var t=h();if(t.length){var n=T(S(t),e);p.html(a.format(f.FILTER_FILE_COUNT,n.length,e.length,d.label))}else p.html(a.format(f.FILTER_FILE_COUNT_ALL,e.length,d.label))})}function y(){var e=l.val().trim();m.prop("disabled",!e.length)}var n=window.document.activeElement,i={instruction:a.format(f.FILE_FILTER_INSTRUCTIONS,brackets.config.glob_help_url),Strings:f},s=o.showModalDialogUsingTemplate(Mustache.render(c,i)),u=s.getElement().find(".exclusions-name"),l=s.getElement().find(".exclusions-editor");u.val(e.name),l.val(e.patterns.join("\n")).focus(),s.done(function(e){e===o.DIALOG_BTN_OK&&(E({name:u.val(),patterns:h()},t),w(),g()),n.focus()});var p=s.getElement().find(".exclusions-filecount"),m=s.getElement().find(".primary");return l.on("input",y),y(),d?(l.on("input",r.debounce(v,400)),v()):p.hide(),s.getPromise()}function C(e){var t=b();return t&&t.patterns.length?S(t.patterns):""}function k(e){var t=l.get("fileFilters")||[],n=l.getViewState("activeFileFilter"),r=$(e.target).parent().data("index")-p;e.stopPropagation(),t.splice(r,1),l.set("fileFilters",t),n===r?E(null):n>r&&(--n,E(t[n],n)),w(),g(),v.refresh()}function L(e){var t=l.get("fileFilters")||[],n=$(e.target).parent().data("index")-p;e.stopPropagation(),v.closeDropdown(),N(t[n],n)}function A(e,t){var n=l.getViewState("activeFileFilter"),r=n>-1?n+p:-1;v.setChecked(r,!0),t.find(".filter-trash-icon").on("click",k),t.find(".filter-edit-icon").on("click",L)}function O(e){function t(e,t){if(t<p)return"<span class='recent-filter-name'></span>"+r.escape(e);var n=m(e.patterns),i={"filter-name":r.escape(e.name||n),"filter-patterns":e.name?" - "+r.escape(n):""};return Mustache.render(h,i)}return d=e,v=new u("",[],t),w(),g(),v.$button.addClass("file-filter-picker no-focus"),$(v).on("listRendered",A),$(v).on("select",function(e,t,n){n===0?(v.closeDropdown(),N({name:"",patterns:[]},-1)):n===1?(v.setChecked(n,!1),E(null),w()):n>=p&&t&&(E(t,n-p),v.setChecked(n,!0),w())}),v.$button}function M(){v&&v.showDropdown()}function _(){v&&v.closeDropdown()}var r=e("thirdparty/lodash"),i=e("project/ProjectManager"),s=e("widgets/DefaultDialogs"),o=e("widgets/Dialogs"),u=e("widgets/DropdownButton").DropdownButton,a=e("utils/StringUtils"),f=e("strings"),l=e("preferences/PreferencesManager"),c=e("text!htmlContent/edit-filter-dialog.html"),h=e("text!htmlContent/filter-name.html"),p=3,d=null,v=null;t.showDropdown=M,t.closeDropdown=_,t.createFilterPicker=O,t.commitPicker=C,t.getActiveFilter=b,t.setActiveFilter=E,t.editFilter=N,t.compile=S,t.filterPath=x,t.filterFileList=T}),define("text!htmlContent/findreplace-bar.html",[],function(){return'<div class="find-input-group">\n    <div id="find-group"><!--\n        --><div class="search-input-container"><input type="text" id="find-what" placeholder="{{queryPlaceholder}}" value="{{initialQuery}}" /><div class="error"></div><span id="find-counter"></span></div><!--\n        --><button id="find-case-sensitive" class="btn no-focus" tabindex="-1" title="{{Strings.BUTTON_CASESENSITIVE_HINT}}"><div class="button-icon"></div></button><!--\n        --><button id="find-regexp" class="btn no-focus" tabindex="-1" title="{{Strings.BUTTON_REGEXP_HINT}}"><div class="button-icon"></div></button><!--\n        {{^multifile}}\n        --><div class="navigator"><!--\n            --><button id="find-prev" class="btn no-focus" tabindex="-1" title="{{Strings.BUTTON_PREV_HINT}}">{{Strings.BUTTON_PREV}}</button><!--\n            --><button id="find-next" class="btn no-focus" tabindex="-1" title="{{Strings.BUTTON_NEXT_HINT}}">{{Strings.BUTTON_NEXT}}</button><!--\n        --></div><!--\n        {{/multifile}}\n    --></div>\n\n    {{#replace}}\n    <div id="replace-group" {{#scope}}class="has-scope"{{/scope}}><!--\n        --><input type="text" id="replace-with" placeholder="{{Strings.REPLACE_PLACEHOLDER}}"/><!--\n        {{^multifile}}\n        --><button id="replace-yes" class="btn no-focus" tabindex="-1">{{Strings.BUTTON_REPLACE}}</button><!--\n        {{/multifile}}\n        --><button id="replace-all" class="btn no-focus {{#multifile}}solo{{/multifile}}" tabindex="-1">{{replaceAllLabel}}</button></div>\n    {{/replace}}\n</div>\n\n{{#multifile}}\n<div class="scope-group">\n    <div class="no-results-message">{{Strings.FIND_NO_RESULTS}}</div>\n    <div class="message">\n        <span id="searchlabel">{{{scopeLabel}}}</span>\n    </div>\n    <!-- For Find in Files, the filter picker will be added here programmatically. -->\n</div>\n{{/multifile}}\n'}),define("search/FindBar",["require","exports","module","thirdparty/lodash","command/Commands","editor/EditorManager","command/KeyBindingManager","utils/KeyEvent","widgets/ModalBar","preferences/PreferencesManager","strings","utils/ViewUtils","text!htmlContent/findreplace-bar.html"],function(e,t,n){function p(e){var t={multifile:!1,replace:!1,queryPlaceholder:"",initialQuery:"",scopeLabel:""};this._options=r.extend(t,e),this._closed=!1,this._enabled=!0}var r=e("thirdparty/lodash"),i=e("command/Commands"),s=e("editor/EditorManager"),o=e("command/KeyBindingManager"),u=e("utils/KeyEvent"),a=e("widgets/ModalBar").ModalBar,f=e("preferences/PreferencesManager"),l=e("strings"),c=e("utils/ViewUtils"),h=e("text!htmlContent/findreplace-bar.html");p._addFindBar=function(e){p._bars=p._bars||[],p._bars.push(e)},p._removeFindBar=function(e){p._bars&&r.pull(p._bars,e)},p._closeFindBars=function(){var e=p._bars;e&&(e.forEach(function(e){e.close(!0,!1)}),e=[])},p.prototype._options=null,p.prototype._closed=!1,p.prototype._enabled=!0,p.prototype._modalBar=null,p.prototype.$=function(e){return this._modalBar?$(e,this._modalBar.getRoot()):$()},p.prototype._updateSearchBarFromPrefs=function(){this.$("#find-case-sensitive").toggleClass("active",!!f.getViewState("caseSensitive")),this.$("#find-regexp").toggleClass("active",!!f.getViewState("regexp"))},p.prototype._updatePrefsFromSearchBar=function(){f.setViewState("caseSensitive",this.$("#find-case-sensitive").is(".active")),f.setViewState("regexp",this.$("#find-regexp").is(".active"))},p.prototype._addShortcutToTooltip=function(e,t){var n=o.getKeyBindings(t)[0];if(n){var r=e.attr("title");r=r?r+" ":"",e.attr("title",r+"("+o.formatKeyDescriptor(n.displayKey)+")")}},p.prototype.open=function(){var e=this;p._closeFindBars();var t=r.clone(this._options);t.Strings=l,t.replaceAllLabel=t.multifile?l.BUTTON_REPLACE_ALL_IN_FILES:l.BUTTON_REPLACE_ALL,this._modalBar=new a(Mustache.render(h,t),!0),$(this._modalBar).on("close",function(t){e.showError(null),e._modalBar=null,e._closed=!0,p._removeFindBar(e),s.focusEditor(),$(e).trigger("close")}),p._addFindBar(this);var n=this._modalBar.getRoot();n.on("input","#find-what",function(){$(e).triggerHandler("queryChange")}).on("click","#find-case-sensitive, #find-regexp",function(t){$(t.currentTarget).toggleClass("active"),e._updatePrefsFromSearchBar(),$(e).triggerHandler("queryChange")}).on("keydown","#find-what, #replace-with",function(t){t.keyCode===u.DOM_VK_RETURN&&(t.preventDefault(),t.stopPropagation(),e._options.multifile?$(t.target).is("#find-what")?e._options.replace?e.focusReplace():$(e).triggerHandler("doFind"):$(e).triggerHandler("doReplaceAll"):$(e).triggerHandler("doFind",[t.shiftKey]))}),this._options.multifile||(this._addShortcutToTooltip($("#find-next"),i.CMD_FIND_NEXT),this._addShortcutToTooltip($("#find-prev"),i.CMD_FIND_PREVIOUS),n.on("click","#find-next",function(t){$(e).triggerHandler("doFind",!1)}).on("click","#find-prev",function(t){$(e).triggerHandler("doFind",!0)})),this._options.replace&&(this._addShortcutToTooltip($("#replace-yes"),i.CMD_REPLACE),n.on("click","#replace-yes",function(t){$(e).triggerHandler("doReplace")}).on("click","#replace-all",function(t){$(e).triggerHandler("doReplaceAll")}).on("keydown",function(t){t.keyCode===u.DOM_VK_TAB&&!t.ctrlKey&&!t.metaKey&&!t.altKey&&(t.target.id==="replace-with"&&!t.shiftKey?(e.$("#find-what").focus(),t.preventDefault()):t.target.id==="find-what"&&t.shiftKey&&(e.$("#replace-with").focus(),t.preventDefault()))})),this._updateSearchBarFromPrefs(),this.focusQuery()},p.prototype.close=function(e){this._modalBar&&this._modalBar.close(!0,!e)},p.prototype.isClosed=function(){return this._closed},p.prototype.getOptions=function(){return this._options},p.prototype.getQueryInfo=function(){return{query:this.$("#find-what").val()||"",isCaseSensitive:this.$("#find-case-sensitive").is(".active"),isRegexp:this.$("#find-regexp").is(".active")}},p.prototype.showError=function(e,t){var n=this.$(".error");e?(t?n.html(e):n.text(e),n.show()):n.hide()},p.prototype.showFindCount=function(e){this.$("#find-counter").text(e)},p.prototype.showNoResults=function(e,t){c.toggleClass(this.$("#find-what"),"no-results",e);var n=this.$(".no-results-message");t?n.show():n.hide()},p.prototype.getReplaceText=function(){return this.$("#replace-with").val()||""},p.prototype.enable=function(e){var t=this;this.$("#find-what, #replace-with, #find-prev, #find-next, #find-case-sensitive, #find-regexp").prop("disabled",!e),this._enabled=e},p.prototype.isEnabled=function(){return this._enabled},p.prototype.isReplaceEnabled=function(){return this.$("#replace-yes").is(":enabled")},p.prototype.enableNavigation=function(e){this.isEnabled()&&this.$("#find-prev, #find-next").prop("disabled",!e)},p.prototype.enableReplace=function(e){this.isEnabled&&this.$("#replace-yes, #replace-all").prop("disabled",!e)},p.prototype._focus=function(e){this.$(e).focus().get(0).select()},p.prototype.focusQuery=function(){this._focus("#find-what")},p.prototype.focusReplace=function(){this._focus("#replace-with")},f.stateManager.definePreference("caseSensitive","boolean",!1),f.stateManager.definePreference("regexp","boolean",!1),f.convertPreferences(n,{caseSensitive:"user",regexp:"user"},!0),t.FindBar=p}),define("search/SearchModel",["require","exports","module","thirdparty/lodash","file/FileUtils","utils/StringUtils"],function(e,t,n){function o(){this.clear()}var r=e("thirdparty/lodash"),i=e("file/FileUtils"),s=e("utils/StringUtils");o.MAX_TOTAL_RESULTS=1e5,o.prototype.results=null,o.prototype.queryInfo=null,o.prototype.queryExpr=null,o.prototype.isReplace=!1,o.prototype.replaceText=null,o.prototype.scope=null,o.prototype.filter=null,o.prototype.numMatches=0,o.prototype.foundMaximum=!1,o.prototype.clear=function(){this.results={},this.queryInfo=null,this.queryExpr=null,this.isReplace=!1,this.replaceText=null,this.scope=null,this.numMatches=0,this.foundMaximum=!1},o.prototype.setQueryInfo=function(e){this.queryInfo=e,this.queryExpr=null;if(!e||!e.query)return{empty:!0};var t="gm";e.isCaseSensitive||(t+="i");if(e.isRegexp)try{this.queryExpr=new RegExp(e.query,t)}catch(n){return{valid:!1,error:n.message}}else this.queryExpr=new RegExp(s.regexEscape(e.query),t);return{valid:!0}},o.prototype.setResults=function(e,t){this.removeResults(e);if(this.foundMaximum||!t.matches.length)return;t.collapsed=!!t.collapsed,this.results[e]=t,this.numMatches+=t.matches.length,this.numMatches>=o.MAX_TOTAL_RESULTS&&(this.foundMaximum=!0)},o.prototype.removeResults=function(e){this.results[e]&&(this.numMatches-=this.results[e].matches.length,delete this.results[e])},o.prototype.hasResults=function(){return Object.keys(this.results).length>0},o.prototype.countFilesMatches=function(){return{files:Object.keys(this.results).length,matches:this.numMatches}},o.prototype.getSortedFiles=function(e){return Object.keys(this.results).sort(function(t,n){return e===t?-1:e===n?1:i.comparePaths(t,n)})},o.prototype.fireChanged=function(e){$(this).triggerHandler("change",e)},t.SearchModel=o}),define("search/FindUtils",["require","exports","module","utils/Async","document/DocumentManager","filesystem/FileSystem","file/FileUtils","project/ProjectManager","strings","utils/StringUtils","thirdparty/CodeMirror2/lib/codemirror","thirdparty/lodash"],function(e,t,n){function h(e,t){return e=e.replace(/(\$+)(\d{1,2}|&)/g,function(e,n,r){if(n.length%2===1){if(r==="&")return n.substr(1)+(t[0]||"");var i=parseInt(r,10);if(i!==0)return n.substr(1)+(t[i]||"")}return e}),e=e.replace(/\$\$/g,"$"),e}function p(e,n,r,i){return e.diskTimestamp.getTime()!==n.timestamp.getTime()?(new $.Deferred).reject(t.ERROR_FILE_CHANGED).promise():(e.batchOperation(function(){n.matches.reverse().forEach(function(t){t.isChecked&&e.replaceRange(i?h(r,t.result):r,t.start,t.end)})}),(new $.Deferred).resolve().promise())}function d(e,n,u,a){var f=s.getFileForPath(e);return i.getDocumentText(f,!0).then(function(e,i,s){if(i.getTime()!==n.timestamp.getTime())return(new $.Deferred).reject(t.ERROR_FILE_CHANGED).promise();var l=[],c=0;n.matches.forEach(function(t){t.isChecked&&(l.push(e.slice(c,t.startOffset)),l.push(a?h(u,t.result):u),c=t.endOffset)}),l.push(e.slice(c));var p=l.join("");return s===o.LINE_ENDINGS_CRLF&&(p=p.replace(/\n/g,"\r\n")),r.promisify(f,"write",p)})}function v(e,t,n,r){var s=i.getOpenDocumentForPath(e);return r=r||{},!s&&(r.forceFilesOpen||i.findInWorkingSet(e)!==-1)?i.getDocumentForPath(e).then(function(e){return p(e,t,n,r.isRegexp)}):s?p(s,t,n,r.isRegexp):d(e,t,n,r.isRegexp)}function m(e){return e.matches.some(function(e){return e.isChecked})}function g(e,t,n){return r.doInParallel_aggregateErrors(Object.keys(e),function(r){return v(r,e[r],t,n)}).done(function(){if(n&&n.forceFilesOpen){var t=i.getCurrentDocument();if(!t||!e[t.file.fullPath]||!m(e[t.file.fullPath])){var r=Object.keys(e).sort(o.comparePaths),s=c.find(r,function(t){return m(e[t])});if(s){var u=i.getOpenDocumentForPath(s);u&&i.setCurrentDocument(u)}}}})}function y(e){return e?f.format(a.FIND_IN_FILES_SCOPED,f.breakableUrl(u.makeProjectRelativeIfPossible(e.fullPath))):a.FIND_IN_FILES_NO_SCOPE}var r=e("utils/Async"),i=e("document/DocumentManager"),s=e("filesystem/FileSystem"),o=e("file/FileUtils"),u=e("project/ProjectManager"),a=e("strings"),f=e("utils/StringUtils"),l=e("thirdparty/CodeMirror2/lib/codemirror"),c=e("thirdparty/lodash");t.parseDollars=h,t.hasCheckedMatches=m,t.performReplacements=g,t.labelForScope=y,t.ERROR_FILE_CHANGED="fileChanged"}),define("search/FindInFiles",["require","exports","module","thirdparty/lodash","search/FileFilters","utils/Async","utils/StringUtils","project/ProjectManager","document/Document","document/DocumentManager","filesystem/FileSystem","language/LanguageManager","search/SearchModel","utils/PerfUtils","search/FindUtils"],function(e,t,n){function w(){$(a).off("documentChange",g),l.off("change",y),$(f).off("fileNameChange",b)}function E(){m.hasResults()&&(w(),$(a).on("documentChange",g),l.on("change",y),$(f).on("fileNameChange",b))}function S(e,t){if(m.foundMaximum||e.search(t)===-1)return[];var n,r,i,s,u,a,f,l,c=o.getLines(e),p=[];while((n=t.exec(e))!==null){r=o.offsetToLineNum(c,n.index),i=c[r],s=n.index-e.lastIndexOf("\n",n.index)-1,a=n[0].split("\n"),f=a.length,u=n[0].length,l=a[a.length-1].length,i=i.substr(0,Math.min(200,i.length)),p.push({start:{line:r,ch:s},end:{line:r+f-1,ch:f===1?s+u:l},startOffset:n.index,endOffset:n.index+u,line:i,result:n,isChecked:!0});if(p.length>=h.MAX_TOTAL_RESULTS){t.lastIndex=0;break}}return p}function x(e,t){var n,r,i,s,o,u,a=!1,f=e.file.fullPath,l=m.results[f];m.removeResults(f),t.forEach(function(t){s=[],o=0,u=0;if(!t.from||!t.to)l={matches:S(e.getText(),m.queryExpr),timestamp:e.diskTimestamp},a=!0;else{for(n=0;n<t.text.length;n++)s.push(e.getLine(t.from.line+n));r=s.length-1-(t.to.line-t.from.line),l&&(l.matches.forEach(function(e){e.end.line<t.from.line?o++:e.end.line<=t.to.line?u++:(e.start.line+=r,e.end.line+=r)}),u>0&&l.matches.splice(o,u),a=!0),i=S(s.join("\r\n"),m.queryExpr),i.length&&(i.forEach(function(e,n){i[n].start.line+=t.from.line,i[n].end.line+=t.from.line}),l?Array.prototype.splice.apply(l.matches,[o,0].concat(i)):l={matches:i,collapsed:!1,timestamp:e.diskTimestamp},a=!0)}}),l&&l.matches.length&&m.setResults(f,l),a&&m.fireChanged(!0)}function T(e,t){return t?t.isDirectory?e.fullPath.indexOf(t.fullPath)===0:e.fullPath===t.fullPath:!0}function N(e){return!c.getLanguageForPath(e).isBinary()}function C(e){function t(t){return T(t,e)&&N(t.fullPath)}return e&&e.isFile?(new $.Deferred).resolve(t(e)?[e]:[]).promise():u.getAllFiles(t,!0)}function k(e){if(m&&m.scope){if(!T(e,m.scope))return!1}else if(e.fullPath.indexOf(u.getProjectRoot().fullPath)!==0){var t=f.getWorkingSet().some(function(t){return t.fullPath===e.fullPath});if(!t)return!1}return N(e.fullPath)?i.filterPath(m.filter,e.fullPath):!1}function L(e){var t=new $.Deferred;return f.getDocumentText(e).done(function(n,r){var i=S(n,m.queryExpr);m.setResults(e.fullPath,{matches:i,timestamp:r}),t.resolve(!!i.length)}).fail(function(){t.resolve(!1)}),t.promise()}function A(e,n,r){m.filter=r;var o=m.setQueryInfo(e);if(!o.valid)return null;var a=m.scope?m.scope.fullPath:u.getProjectRoot().fullPath,f=p.markStart("FindIn: "+a+" - "+e.query);return n.then(function(e){return e=i.filterFileList(r,e),e.length?s.doInParallel(e,L):v}).then(function(e){return t._searchDone=!0,p.addMeasurement(f),E(),e===v?e:m.results},function(e){return console.log("find in files failed: ",e),p.finalizeMeasurement(f),e})}function O(){w(),m.clear()}function M(e,t,n,r,i){return O(),m.scope=t,r!==undefined&&(m.isReplace=!0,m.replaceText=r),i=i||C(t),A(e,i,n)}function _(e,n,r){return d.performReplacements(e,n,r).always(function(){t._replaceDone=!0})}var r=e("thirdparty/lodash"),i=e("search/FileFilters"),s=e("utils/Async"),o=e("utils/StringUtils"),u=e("project/ProjectManager"),a=e("document/Document"),f=e("document/DocumentManager"),l=e("filesystem/FileSystem"),c=e("language/LanguageManager"),h=e("search/SearchModel").SearchModel,p=e("utils/PerfUtils"),d=e("search/FindUtils"),v={},m=new h,g,y,b;g=function(e,t,n){k(t.file)&&x(t,n)},b=function(e,t,n){var i=!1;r.forEach(m.results,function(e,r){r.indexOf(t)===0&&(m.removeResults(r),m.setResults(r.replace(t,n),e),i=!0)}),i&&m.fireChanged()},y=function(e,t,n,r){function o(e){Object.keys(m.results).forEach(function(t){t.indexOf(e.fullPath)===0&&(m.removeResults(t),i=!0)})}function a(e){var t=[],n=new $.Deferred,r=function(e){return u.shouldShow(e)?(e.isFile&&N(e.name)&&k(e)&&t.push(e),!0):!1};return e.visit(r,function(e){if(e){n.reject(e);return}s.doInParallel(t,function(e){return L(e).done(function(e){i=i||e})}).always(n.resolve)}),n.promise()}var i=!1;if(!t)return;var f;if(t.isDirectory)if(!n||!r){o(t);var l=$.Deferred();f=l.promise(),t.getContents(function(e,t){s.doInParallel(t,a).always(l.resolve)})}else r.forEach(o),f=s.doInParallel(n,a);else o(t),f=a(t);f.always(function(){i&&m.fireChanged()})},t.searchModel=m,t.doSearchInScope=M,t.doReplace=_,t.getCandidateFiles=C,t.clearSearch=O,t.ZERO_FILES_TO_SEARCH=v,t._documentChangeHandler=g,t._fileNameChangeHandler=b,t._fileSystemChangeHandler=y}),define("text!htmlContent/search-panel.html",[],function(){return'<div id="{{panelID}}" class="search-results bottom-panel vert-resizable top-resizer no-focus">\n    <div class="toolbar simple-toolbar-layout">\n        <div class="title"></div>\n        <a href="#" class="close">&times;</a>\n    </div>\n    <div class="table-container resizable-content"></div>\n</div>\n'}),define("text!htmlContent/search-results.html",[],function(){return'<table class="bottom-panel-table table table-striped table-condensed row-highlight">\n    <tbody>\n        {{#searchList}}\n        <tr class="file-section" data-file-index="{{fileIndex}}">\n            {{#replace}}<td class="checkbox-column"><input type="checkbox" class="check-one-file" {{#isChecked}}checked="true"{{/isChecked}} /></td>{{/replace}}\n            <td colspan="2">\n                <span class="disclosure-triangle expanded" title="{{Strings.FIND_IN_FILES_EXPAND_COLLAPSE}}"></span>\n                {{{filename}}}\n            </td>\n        </tr>\n        {{#items}}\n        <tr data-file-index="{{fileIndex}}" data-item-index="{{itemIndex}}" data-match-index="{{matchIndex}}">\n            {{#replace}}<td class="checkbox-column"><input type="checkbox" class="check-one" {{#isChecked}}checked="true"{{/isChecked}} /></td>{{/replace}}\n            <td class="line-number">{{line}}</td>\n            <td class="line-text">{{pre}}<span class="highlight">{{highlight}}</span>{{post}}</td>\n        </tr>\n        {{/items}}\n        {{/searchList}}\n    </tbody>\n</table>\n'}),define("text!htmlContent/search-summary.html",[],function(){return'{{#replace}}\n<div class="fixed-col"><input type="checkbox" class="check-all" {{#allChecked}}checked="checked"{{/allChecked}} /></div>\n{{/replace}}\n<div class="fixed-col">{{titleLabel}} &quot;</div>\n<div class="contracting-col">{{query}}</div>\n<div class="fixed-col">&quot;</div>\n{{#replace}}\n<div class="fixed-col">&nbsp;{{Strings.FIND_REPLACE_TITLE_WITH}} &quot;</div>\n<div class="contracting-col">{{replaceWith}}</div>\n<div class="fixed-col">&quot;</div>\n{{/replace}}\n{{#scope}}\n<div class="contracting-col">{{{scope}}}</div>\n{{/scope}}\n<div class="fixed-col">&nbsp;{{{summary}}}</div>\n{{#hasPages}}\n<div class="pagination-col">\n    <span class="first-page {{^hasPrev}}disabled{{/hasPrev}}"></span>\n    <span class="prev-page {{^hasPrev}}disabled{{/hasPrev}}"></span>\n    {{{results}}}\n    <span class="next-page {{^hasNext}}disabled{{/hasNext}}"></span>\n    <span class="last-page {{^hasNext}}disabled{{/hasNext}}"></span>\n</div>\n{{/hasPages}}\n{{#replace}}\n<div class="replace-col">\n    <button class="btn small replace-checked">{{Strings.BUTTON_REPLACE}}</button>\n</div>\n{{/replace}}'}),define("search/SearchResultsView",["require","exports","module","command/CommandManager","command/Commands","document/DocumentManager","editor/EditorManager","project/ProjectManager","project/FileViewController","file/FileUtils","search/FindUtils","view/PanelManager","utils/StringUtils","strings","thirdparty/lodash","text!htmlContent/search-panel.html","text!htmlContent/search-results.html","text!htmlContent/search-summary.html"],function(e,t,n){function w(e,t,n){var r=Mustache.render(v,{panelID:t});this._panel=c.createBottomPanel(n,$(r),100),this._$summary=this._panel.$panel.find(".title"),this._$table=this._panel.$panel.find(".table-container"),this._model=e}var r=e("command/CommandManager"),i=e("command/Commands"),s=e("document/DocumentManager"),o=e("editor/EditorManager"),u=e("project/ProjectManager"),a=e("project/FileViewController"),f=e("file/FileUtils"),l=e("search/FindUtils"),c=e("view/PanelManager"),h=e("utils/StringUtils"),p=e("strings"),d=e("thirdparty/lodash"),v=e("text!htmlContent/search-panel.html"),m=e("text!htmlContent/search-results.html"),g=e("text!htmlContent/search-summary.html"),y=100,b=400;w.prototype._model=null,w.prototype._searchList=[],w.prototype._panel=null,w.prototype._initialFilePath=null,w.prototype._currentStart=0,w.prototype._allChecked=!1,w.prototype._$selectedRow=null,w.prototype._$summary=null,w.prototype._$table=null,w.prototype._timeoutID=null,w.prototype._handleModelChange=function(e){if(this._model.isReplace){this.close();return}var t=this;this._timeoutID&&window.clearTimeout(this._timeoutID),e?this._timeoutID=window.setTimeout(function(){t._updateResults(),t._timeoutID=null},b):this._updateResults()},w.prototype._addPanelListeners=function(){function t(t){var n=e._panel.$panel.find(".file-section"),r=n.filter(function(e){return $(this).find(".check-one-file").is(":checked")});r.length===n.length&&t.prop("checked",!0)}function n(n,r){var i=n.data("item-index")===0?n:n.prevUntil(".file-section").last(),s=i.prev(),o=s.nextUntil(".file-section"),u=s.find(".check-one-file"),a=e._panel.$panel.find(".check-all");if(r){if(!u.is(":checked")){var f=o.filter(function(e){return $(this).find(".check-one").is(":checked")});f.length===o.length&&(u.prop("checked",!0),a.is(":checked")||t(a))}}else a.is(":checked")&&a.prop("checked",!1),u.is(":checked")&&u.prop("checked",!1)}var e=this;this._panel.$panel.off(".searchResults").on("click.searchResults",".close",function(){e.close()}).on("click.searchResults",".first-page:not(.disabled)",function(){e._currentStart=0,e._render()}).on("click.searchResults",".prev-page:not(.disabled)",function(){e._currentStart-=y,e._render()}).on("click.searchResults",".next-page:not(.disabled)",function(){e._currentStart+=y,e._render()}).on("click.searchResults",".last-page:not(.disabled)",function(){e._currentStart=e._getLastCurrentStart(),e._render()}).on("dblclick.searchResults",".table-container tr:not(.file-section)",function(t){var n=e._searchList[$(this).data("file-index")];a.addToWorkingSetAndSelect(n.fullPath)}).on("click.searchResults .table-container",function(t){var n=$(t.target).closest("tr");if(n.length){e._$selectedRow&&e._$selectedRow.removeClass("selected"),n.addClass("selected"),e._$selectedRow=n;var s=e._searchList[n.data("file-index")],u=s.fullPath;if(n.hasClass("file-section")){var a,f=!e._model.results[u].collapsed;t.metaKey||t.ctrlKey?a=$(t.target).closest("table").find(".file-section"):a=n,a.each(function(){u=e._searchList[$(this).data("file-index")].fullPath,s=e._model.results[u],s.collapsed!==f&&(s.collapsed=f,$(this).nextUntil(".file-section").toggle(),$(this).find(".disclosure-triangle").toggleClass("expanded").toggleClass("collapsed"))}),(t.metaKey||t.ctrlKey)&&d.forEach(e._model.results,function(e){e.collapsed=f})}else{var l=s.items[n.data("item-index")];r.execute(i.FILE_OPEN,{fullPath:u}).done(function(e){o.getCurrentFullEditor().setSelection(l.start,l.end,!0)})}}}),this._model.isReplace&&this._panel.$panel.on("click.searchResults",".check-all",function(t){var n=$(this).is(":checked");d.forEach(e._model.results,function(e){e.matches.forEach(function(e){e.isChecked=n})}),e._$table.find(".check-one").prop("checked",n),e._$table.find(".check-one-file").prop("checked",n),e._allChecked=n}).on("click.searchResults",".check-one-file",function(n){var r=$(this).is(":checked"),i=$(n.target).closest("tr"),s=e._searchList[i.data("file-index")],o=i.nextUntil(".file-section"),u=e._panel.$panel.find(".check-all");s&&e._model.results[s.fullPath].matches.forEach(function(e){e.isChecked=r}),o.find(".check-one").prop("checked",r),r?u.is(":checked")||t(u):u.is(":checked")&&u.prop("checked",!1),n.stopPropagation()}).on("click.searchResults",".check-one",function(t){var r=$(t.target).closest("tr"),i=e._searchList[r.data("file-index")],s=e._model.results[i.fullPath].matches[r.data("match-index")];s.isChecked=$(this).is(":checked"),n(r,s.isChecked),t.stopPropagation()}).on("click.searchResults",".replace-checked",function(t){$(e).triggerHandler("replaceAll")})},w.prototype._showSummary=function(){var e=this._model.countFilesMatches(),t=this._getLastIndex(e.matches),n=Object.keys(this._model.results),r,i;r=h.format(p.FIND_NUM_FILES,e.files,e.files>1?p.FIND_IN_FILES_FILES:p.FIND_IN_FILES_FILE),i=h.format(p.FIND_TITLE_SUMMARY,this._model.foundMaximum?p.FIND_IN_FILES_MORE_THAN:"",String(e.matches),e.matches>1?p.FIND_IN_FILES_MATCHES:p.FIND_IN_FILES_MATCH,r),this._$summary.html(Mustache.render(g,{query:this._model.queryInfo.query&&this._model.queryInfo.query.toString()||"",replaceWith:this._model.replaceText,titleLabel:this._model.isReplace?p.FIND_REPLACE_TITLE_LABEL:p.FIND_TITLE_LABEL,scope:this._model.scope?"&nbsp;"+l.labelForScope(this._model.scope)+"&nbsp;":"",summary:i,allChecked:this._allChecked,hasPages:e.matches>y,results:h.format(p.FIND_IN_FILES_PAGING,this._currentStart+1,t),hasPrev:this._currentStart>0,hasNext:t<e.matches,replace:this._model.isReplace,Strings:p}))},w.prototype._render=function(){var e,t,n,r,i,s=this._model.countFilesMatches(),o=this._model.getSortedFiles(this._initialFilePath),a=this._getLastIndex(s.matches),l=0,c=!1,d=!0,v=this;this._showSummary(),this._searchList=[],o.some(function(s){c=!0,r=v._model.results[s];if(l+r.matches.length<v._currentStart)l+=r.matches.length,c=!1;else if(l<v._currentStart)n=v._currentStart-l,l=v._currentStart;else{if(!(l<a))return!0;n=0}if(c&&n<r.matches.length){e=[],d=!0;while(n<r.matches.length&&l<a)t=r.matches[n],i=t.start.line!==t.end.line,e.push({fileIndex:v._searchList.length,itemIndex:e.length,matchIndex:n,line:t.start.line+1,pre:t.line.substr(0,t.start.ch),highlight:t.line.substring(t.start.ch,i?undefined:t.end.ch),post:i?"…":t.line.substr(t.end.ch),start:t.start,end:t.end,isChecked:t.isChecked}),t.isChecked||(d=!1),l++,n++;var o=f.getDirectoryPath(u.makeProjectRelativeIfPossible(s)),m=f.getDirectoryPath(o),g=h.format(p.FIND_IN_FILES_FILE_PATH,h.breakableUrl(f.getBaseName(s)),h.breakableUrl(m),m?"&mdash;":"");v._searchList.push({fileIndex:v._searchList.length,filename:g,fullPath:s,isChecked:d,items:e})}}),this._$table.empty().append(Mustache.render(m,{replace:this._model.isReplace,searchList:this._searchList,Strings:p})).find(".file-section").each(function(){var e=v._searchList[$(this).data("file-index")].fullPath;v._model.results[e].collapsed&&(v._model.results[e].collapsed=!1,$(this).trigger("click"))}),this._$selectedRow&&(this._$selectedRow.removeClass("selected"),this._$selectedRow=null),this._panel.show(),this._$table.scrollTop(0)},w.prototype._updateResults=function(){if(this._panel.isVisible()){var e=this._$table.scrollTop(),t=this._$selectedRow?this._$selectedRow.index():null,n=this._model.countFilesMatches().matches;this._currentStart>n&&(this._currentStart=this._getLastCurrentStart(n)),this._render(),this._$table.scrollTop(e),t&&(this._$selectedRow=this._$table.find("tr:eq("+t+")"),this._$selectedRow.addClass("selected"))}},w.prototype._getLastIndex=function(e){return Math.min(this._currentStart+y,e)},w.prototype._getLastCurrentStart=function(e){return e=e||this._model.countFilesMatches().matches,Math.floor((e-1)/y)*y},w.prototype.open=function(){this._currentStart=0,this._$selectedRow=null,this._allChecked=!0;var e=s.getCurrentDocument();this._initialFilePath=e?e.file.fullPath:null,this._render(),this._addPanelListeners(),$(this._model).on("change.SearchResultsView",this._handleModelChange.bind(this))},w.prototype.close=function(){this._panel&&this._panel.isVisible()&&(this._$table.empty(),this._panel.hide(),this._panel.$panel.off(".searchResults"),$(this._model).off("change.SearchResultsView"),$(this).triggerHandler("close"))},t.SearchResultsView=w}),define("search/FindInFilesUI",["require","exports","module","utils/AppInit","command/CommandManager","command/Commands","widgets/Dialogs","widgets/DefaultDialogs","editor/EditorManager","search/FileFilters","file/FileUtils","search/FindBar","search/FindInFiles","search/FindUtils","document/InMemoryFile","project/ProjectManager","search/SearchResultsView","widgets/StatusBar","strings","utils/StringUtils","thirdparty/lodash"],function(e,t,n){function T(e,t,n,r,i){return h.doSearchInScope(e,t,n,r,i).done(function(e){if(h.searchModel.hasResults())S.open(),x&&x.close();else{S.close();if(x){var t=!1;x.enable(!0),x.focusQuery(),e===h.ZERO_FILES_TO_SEARCH?x.showError(b.format(y.FIND_IN_FILES_ZERO_FILES,p.labelForScope(h.searchModel.scope)),!0):t=!0,x.showNoResults(!0,t)}}g.hideBusyIndicator()}).fail(function(e){console.log("find in files failed: ",e),g.hideBusyIndicator()})}function N(e,t){function l(){var e=x.getQueryInfo(),t=h.searchModel.setQueryInfo(e);x.enableReplace(t.valid),t.valid||t.empty?(x.showNoResults(!1),x.showError(null)):(x.showNoResults(!0,!1),x.showError(t.error))}function v(t){var n=x.getQueryInfo();if(n&&n.query){x.enable(!1),g.showBusyIndicator(!0);var r;u?r=f.commitPicker(u):r=null,T(n,e,r,t,o)}return null}function m(){v(x.getReplaceText())}if(e&&a.getCustomViewerForPath(e.fullPath))return;if(e instanceof d){i.execute(s.FILE_OPEN,{fullPath:e.fullPath}).done(function(){i.execute(s.CMD_FIND)});return}var n=a.getActiveEditor(),r=n&&n.getSelectedText();x&&!x.isClosed()&&(r=x.getQueryInfo().query),h.clearSearch(),x&&x.close(),x=new c({multifile:!0,replace:t,initialQuery:r,queryPlaceholder:y.FIND_QUERY_PLACEHOLDER,scopeLabel:p.labelForScope(e)}),x.open(),x._modalBar.isLockedOpen=function(){return!x.isEnabled()||$(".modal.instance .exclusions-editor").length>0};var o=h.getCandidateFiles(e),u;$(x).on("doFind.FindInFiles",function(){v()}).on("queryChange.FindInFiles",l).on("close.FindInFiles",function(e){$(x).off(".FindInFiles"),x=null}),t&&$(x).on("doReplaceAll.FindInFiles",m);var b=x._modalBar.height();if(!e||e.isDirectory){var w={label:p.labelForScope(e),promise:o};u=f.createFilterPicker(w),x._modalBar.getRoot().find(".scope-group").append(u)}l();var E=a.getCurrentFullEditor(),S;E&&(S=E.getScrollPos(),S.y-=b),a.resizeEditor(),E&&E._codeMirror.scrollTo(S.x,S.y+x._modalBar.height())}function C(e){function a(e){g.showBusyIndicator(!0),h.doReplace(n,t,{forceFilesOpen:e,isRegexp:i}).fail(function(e){var t=y.REPLACE_IN_FILES_ERRORS+l.makeDialogFileList(e.map(function(e){return v.makeProjectRelativeIfPossible(e.item)}));o.showModalDialog(u.DIALOG_ID_ERROR,y.REPLACE_IN_FILES_ERRORS_TITLE,t,[{className:o.DIALOG_BTN_CLASS_PRIMARY,id:o.DIALOG_BTN_OK,text:y.BUTTON_REPLACE_WITHOUT_UNDO}])}).always(function(){g.hideBusyIndicator()})}var t=e.replaceText;if(t===null)return;var n=w.cloneDeep(e.results),r=Object.keys(n).filter(function(e){return p.hasCheckedMatches(n[e])}),i=e.queryInfo.isRegexp,s;r.length<=E?(S.close(),a(!0)):o.showModalDialog(u.DIALOG_ID_INFO,y.REPLACE_WITHOUT_UNDO_WARNING_TITLE,b.format(y.REPLACE_WITHOUT_UNDO_WARNING,E),[{className:o.DIALOG_BTN_CLASS_NORMAL,id:o.DIALOG_BTN_CANCEL,text:y.CANCEL},{className:o.DIALOG_BTN_CLASS_PRIMARY,id:o.DIALOG_BTN_OK,text:y.BUTTON_REPLACE_WITHOUT_UNDO}]).done(function(e){e===o.DIALOG_BTN_OK&&(S.close(),a(!1))})}function k(){N(null,!0)}function L(){var e=v.getSelectedItem();N(e)}function A(){var e=v.getSelectedItem();N(e,!0)}function O(){x&&x.close()}var r=e("utils/AppInit"),i=e("command/CommandManager"),s=e("command/Commands"),o=e("widgets/Dialogs"),u=e("widgets/DefaultDialogs"),a=e("editor/EditorManager"),f=e("search/FileFilters"),l=e("file/FileUtils"),c=e("search/FindBar").FindBar,h=e("search/FindInFiles"),p=e("search/FindUtils"),d=e("document/InMemoryFile"),v=e("project/ProjectManager"),m=e("search/SearchResultsView").SearchResultsView,g=e("widgets/StatusBar"),y=e("strings"),b=e("utils/StringUtils"),w=e("thirdparty/lodash"),E=20,S=null,x=null;r.htmlReady(function(){var e=h.searchModel;S=new m(e,"find-in-files-results","find-in-files.results"),$(S).on("replaceAll",function(){C(e)}).on("close",function(){h.clearSearch()})}),$(v).on("beforeProjectClose",function(){S.close()}),i.register(y.CMD_FIND_IN_FILES,s.CMD_FIND_IN_FILES,N),i.register(y.CMD_FIND_IN_SELECTED,s.CMD_FIND_IN_SELECTED,L),i.register(y.CMD_FIND_IN_SUBTREE,s.CMD_FIND_IN_SUBTREE,L),i.register(y.CMD_REPLACE_IN_FILES,s.CMD_REPLACE_IN_FILES,k),i.register(y.CMD_REPLACE_IN_SELECTED,s.CMD_REPLACE_IN_SELECTED,A),i.register(y.CMD_REPLACE_IN_SUBTREE,s.CMD_REPLACE_IN_SUBTREE,A),t.searchAndShowResults=T,t._showFindBar=N,t._closeFindBar=O}),define("search/ScrollTrackMarkers",["require","exports","module","thirdparty/lodash","editor/Editor","editor/EditorManager","view/PanelManager"],function(e,t,n){function c(e){return $(e.getRootElement()).children(".CodeMirror-vscrollbar")}function h(){var e=c(u);f=e[0].offsetHeight;if(f>0)brackets.platform==="win"?a=0:brackets.platform==="mac"?a=4:a=2,f-=a*2;else{var t=$(u.getRootElement()).find("> .CodeMirror-scroll > .CodeMirror-sizer > div > .CodeMirror-lines > div")[0];f=t.offsetHeight,a=t.offsetTop}}function p(e){var t="";e.forEach(function(e){var n=Math.round(e.line/u.lineCount()*f)+a;n--,t+="<div class='tickmark' style='top:"+n+"px'></div>"}),$(".tickmark-track",u.getRootElement()).append($(t))}function d(){u&&($(".tickmark-track",u.getRootElement()).empty(),l=[])}function v(e,t){if(t&&e===u||!t&&!u)return;if(t){console.assert(!u),u=e;if(u.isTextSubset())return;var n=c(u),i=$("<div class='tickmark-track'></div>");n.parent().append(i),h(),$(o).on("editorAreaResize.ScrollTrackMarkers",r.debounce(function(){l.length&&(h(),$(".tickmark-track",u.getRootElement()).empty(),p(l))},300))}else console.assert(u===e),$(".tickmark-track",e.getRootElement()).remove(),u=null,l=[],$(o).off("editorAreaResize.ScrollTrackMarkers")}function m(e,t){console.assert(u===e),l=l.concat(t),p(t)}function g(){return l}var r=e("thirdparty/lodash"),i=e("editor/Editor"),s=e("editor/EditorManager"),o=e("view/PanelManager"),u,a,f,l=[];t._getTickmarks=g,t.clear=d,t.setVisible=v,t.addTickmarks=m}),define("search/FindReplace",["require","exports","module","command/CommandManager","utils/AppInit","command/Commands","document/DocumentManager","project/ProjectManager","strings","utils/StringUtils","editor/Editor","editor/EditorManager","search/FindBar","search/FindUtils","search/FindInFilesUI","search/ScrollTrackMarkers","view/PanelManager","utils/Resizer","widgets/StatusBar","preferences/PreferencesManager","thirdparty/lodash","thirdparty/CodeMirror2/lib/codemirror"],function(e,t,n){function C(){this.searchStartPos=null,this.parsedQuery=null,this.queryInfo=null,this.foundAny=!1,this.marked=[]}function k(e){return e._searchState||(e._searchState=new C),e._searchState}function L(e,t,n){return e.getSearchCursor(t.parsedQuery,n,!t.queryInfo.isCaseSensitive)}function A(e){N&&N.showError(null);if(!e||!e.query)return"";if(!e.isRegexp)return e.query;try{return new RegExp(e.query,e.isCaseSensitive?"":"i")}catch(t){return N&&N.showError(t.message),""}}function O(e,t){e.queryInfo=t,t?e.parsedQuery=A(t):e.parsedQuery=null}function M(e,t,n,r){var i=e._codeMirror,s=k(i),o=L(i,s,n||e.getCursorPos(!1,t?"start":"end"));return s.lastMatch=o.find(t),!s.lastMatch&&r!==!1&&(o=L(i,s,t?{line:i.lineCount()-1}:{line:0,ch:0}),s.lastMatch=o.find(t)),s.lastMatch?{start:o.from(),end:o.to()}:(i.setCursor(e.getCursorPos()),null)}function _(e,t,n,r){var i=w.find(t,function(e){return e.primary})||w.last(t),s=e.isLineVisible(i.start.line),o=l.BOUNDARY_CHECK_NORMAL;r&&s&&(o=l.BOUNDARY_IGNORE_TOP);var u=w.find(t,function(e){return e.primary});u||(u=w.last(t)),e._codeMirror.scrollIntoView({from:u.start,to:u.end}),e.setSelections(t,n,o)}function D(e,t){var n=e._codeMirror,r=t.ch,i=r,s=n.getLine(t.line);while(r&&E.isWordChar(s.charAt(r-1)))--r;while(i<s.length&&E.isWordChar(s.charAt(i)))++i;return{start:{line:t.line,ch:r},end:{line:t.line,ch:i},text:s.slice(r,i)}}function P(e,t){return E.cmpPos(e.start,t.start)===0&&E.cmpPos(e.end,t.end)===0}function H(e,t){e=e||c.getActiveEditor();if(!e)return;var n=e.getSelections(),r,i,s,o=!1;w.each(n,function(n,o){var u=E.cmpPos(n.start,n.end)===0;n.primary&&(r=n,i=o,u||(s=e.document.getRange(r.start,r.end)));if(u){var a=D(e,n.start);n.start=a.start,n.end=a.end,n.primary&&t&&(s=a.text)}});if(s&&s.length){var u=k(e._codeMirror);O(u,{query:s,isCaseSensitive:!1,isRegexp:!1});var a=r.end,f,l;do{f=M(e,!1,a);if(f){l=w.find(n,w.partial(P,f)),a=f.end;if(E.cmpPos(a,r.end)===0){f=null;break}}}while(f&&l);f&&(f.primary=!0,n.push(f),o=!0)}t&&n.splice(i,1),o?_(e,n,!0,!0):_(e,n,!1)}function B(e){return H(e,!0)}function j(e){e=e||c.getActiveEditor();if(!e)return;var t=e.getSelection(),n=[];E.cmpPos(t.start,t.end)===0&&(t=D(e,t.start));if(E.cmpPos(t.start,t.end)!==0){var r={line:0,ch:0},i=k(e._codeMirror),s;O(i,{query:e.document.getRange(t.start,t.end),isCaseSensitive:!1,isRegexp:!1});while((s=M(e,!1,r,!1))!==null)P(t,s)&&(s.primary=!0),n.push(s),r=s.end;n.length&&e.setSelections(n,!1)}}function F(e,t,n,r){var i=e._codeMirror;i.operation(function(){var s=M(e,t,r);s?_(e,[s],!0,n):i.setCursor(e.getCursorPos())})}function I(e,t){e.operation(function(){t.marked.forEach(function(e){e.clear()})}),t.marked.length=0,v.clear()}function q(e){e.operation(function(){var t=k(e);if(!t.parsedQuery)return;O(t,null),I(e,t)})}function R(e,t){t?$(e.getRootElement()).addClass("find-highlighting"):$(e.getRootElement()).removeClass("find-highlighting"),v.setVisible(e,t)}function U(e){function r(e){N.showNoResults(!n.foundAny&&N.getQueryInfo().query),N.enableNavigation(n.foundAny&&e>1),N.enableReplace(n.foundAny)}var t=e._codeMirror,n=k(t);t.operation(function(){n.marked&&I(t,n);if(!n.parsedQuery){N.showFindCount(""),n.foundAny=!1,r();return}var i=L(t,n);if(t.getValue().length<=S){var s=[];while(i.findNext())s.push(i.pos);if(s.length<=x){R(e,!0),s.forEach(function(e){n.marked.push(t.markText(e.from,e.to,{className:"CodeMirror-searching",startStyle:"searching-first",endStyle:"searching-last"}))});var o=s.map(function(e){return e.from});v.addTickmarks(e,o)}var u;s.length===0?u=a.FIND_NO_RESULTS:s.length===1?u=a.FIND_RESULT_COUNT_SINGLE:u=f.format(a.FIND_RESULT_COUNT,s.length),N.showFindCount(u),n.foundAny=s.length>0,r(s.length)}else N.showFindCount(""),n.foundAny=i.findNext(),r()})}function z(e,t,n){O(t,N.getQueryInfo()),U(e),t.parsedQuery?F(e,!1,!0,t.searchStartPos):n||e._codeMirror.setCursor(t.searchStartPos)}function W(e,t){var n=e._codeMirror,r=k(n);r.searchStartPos=e.getCursorPos(!1,"start");var i;if(N)i=N.getQueryInfo().query;else{var s=e.getSelection();i=n.getRange(s.start,s.end);var o=i.indexOf("\n");o!==-1&&(i=i.substr(0,o))}N&&N.close(),N=new h({multifile:!1,replace:t,initialQuery:i,queryPlaceholder:a.FIND_QUERY_PLACEHOLDER}),N.open(),$(N).on("queryChange.FindReplace",function(t){z(e,r)}).on("doFind.FindReplace",function(t,n){F(e,n)}).on("close.FindReplace",function(t){I(n,r),R(e,!1),$(N).off(".FindReplace"),N=null}),z(e,r,!0)}function X(e,t){var n=k(e._codeMirror);if(n.parsedQuery){F(e,t);return}W(e,!1)}function V(){N&&N.close()}function J(e,t){var n=e._codeMirror,r=k(n),i=N.getReplaceText();t?(N.close(),d.searchAndShowResults(r.queryInfo,e.document.file,null,i)):(n.replaceSelection(r.queryInfo.isRegexp?p.parseDollars(i,r.lastMatch):i),U(e),F(e),r.lastMatch||N.close())}function K(e){if(N&&N.getOptions().replace&&N.isReplaceEnabled()){J(e,!1);return}W(e,!0),$(N).on("doReplace.FindReplace",function(t){J(e,!1)}).on("doReplaceAll.FindReplace",function(t){J(e,!0)})}function Q(){var e=c.getActiveEditor();e&&(q(e._codeMirror),X(e,!1))}function G(){var e=c.getActiveEditor();e&&X(e)}function Y(){var e=c.getActiveEditor();e&&X(e,!0)}function Z(){var e=c.getActiveEditor();e&&K(e)}var r=e("command/CommandManager"),i=e("utils/AppInit"),s=e("command/Commands"),o=e("document/DocumentManager"),u=e("project/ProjectManager"),a=e("strings"),f=e("utils/StringUtils"),l=e("editor/Editor"),c=e("editor/EditorManager"),h=e("search/FindBar").FindBar,p=e("search/FindUtils"),d=e("search/FindInFilesUI"),v=e("search/ScrollTrackMarkers"),m=e("view/PanelManager"),g=e("utils/Resizer"),y=e("widgets/StatusBar"),b=e("preferences/PreferencesManager"),w=e("thirdparty/lodash"),E=e("thirdparty/CodeMirror2/lib/codemirror"),S=5e5,x=2e3,T=null,N;$(o).on("currentDocumentChange",V),r.register(a.CMD_FIND,s.CMD_FIND,Q),r.register(a.CMD_FIND_NEXT,s.CMD_FIND_NEXT,G),r.register(a.CMD_REPLACE,s.CMD_REPLACE,Z),r.register(a.CMD_FIND_PREVIOUS,s.CMD_FIND_PREVIOUS,Y),r.register(a.CMD_FIND_ALL_AND_SELECT,s.CMD_FIND_ALL_AND_SELECT,j),r.register(a.CMD_ADD_NEXT_MATCH,s.CMD_ADD_NEXT_MATCH,H),r.register(a.CMD_SKIP_CURRENT_MATCH,s.CMD_SKIP_CURRENT_MATCH,B),t._getWordAt=D,t._expandWordAndAddNextToSelection=H,t._findAllAndSelect=j}),define("text!htmlContent/install-extension-dialog.html",[],function(){return'<div class="install-extension-dialog modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">\n            {{#isUpdate}}{{Strings.UPDATE_EXTENSION_TITLE}}{{/isUpdate}}\n            {{^isUpdate}}{{Strings.INSTALL_EXTENSION_TITLE}}{{/isUpdate}}\n        </h1>\n    </div>\n    <div class="modal-body">\n        <div class="field-container input-field">\n            <input type="text" placeholder="{{INSTALL_EXTENSION_HINT}}" class="url" />\n        </div>\n        <div class="field-container message-field">\n            <div class="message"></div>\n        </div>\n    </div>\n    <div class="modal-footer">\n        {{#includeBrowseExtensions}}<button class="btn left browse-extensions">{{Strings.BROWSE_EXTENSIONS}}</button>{{/includeBrowseExtensions}}\n        <button class="dialog-button btn" data-button-id="cancel">{{Strings.CANCEL}}</button>\n        <button class="dialog-button btn primary" data-button-id="ok" disabled>{{Strings.INSTALL}}</button>\n    </div>\n</div>\n'}),define("extensibility/InstallExtensionDialog",["require","exports","module","widgets/Dialogs","filesystem/File","utils/StringUtils","strings","command/Commands","command/CommandManager","filesystem/FileSystem","utils/KeyEvent","extensibility/Package","utils/NativeApp","text!htmlContent/install-extension-dialog.html"],function(e,t,n){function C(e,t){this._installer=e,this._state=d,this._installResult=null,this._isUpdate=t,this._cancelTimeout=1e4}function k(e){this._isLocalFile=e}function L(){var e=new C(new k);return e.show()}function A(e,t){var n=e instanceof i,r=new C(new k(n),t);return r.show(e.fullPath||e)}function O(e){return A(e,!0)}var r=e("widgets/Dialogs"),i=e("filesystem/File"),s=e("utils/StringUtils"),o=e("strings"),u=e("command/Commands"),a=e("command/CommandManager"),f=e("filesystem/FileSystem"),l=e("utils/KeyEvent"),c=e("extensibility/Package"),h=e("utils/NativeApp"),p=e("text!htmlContent/install-extension-dialog.html"),d=0,v=1,m=2,g=3,y=4,b=5,w=6,E=7,S=8,x=9,T=10,N=11;C.prototype.$dlg=null,C.prototype.$url=null,C.prototype.$okButton=null,C.prototype.$cancelButton=null,C.prototype.$inputArea=null,C.prototype.$msgArea=null,C.prototype.$msg=null,C.prototype.$browseExtensionsButton=null,C.prototype._dialogDeferred=null,C.prototype._installer=null,C.prototype._state=null,C.prototype._enterState=function(e){var t,n,i=this,u=this._state;this._state=e;switch(e){case v:this.$msg.find(".spinner").remove(),this.$msgArea.hide(),this.$inputArea.show(),this.$okButton.prop("disabled",!0).text(o.INSTALL);break;case m:this.$okButton.prop("disabled",!1);break;case g:t=this.$url.val().trim(),this.$inputArea.hide(),this.$browseExtensionsButton.hide(),this.$msg.text(s.format(o.INSTALLING_FROM,t)).append("<span class='spinner inline spin'/>"),this.$msgArea.show(),this.$okButton.prop("disabled",!0),this._installer.install(t).done(function(e){i._installResult=e,e.installationStatus===c.InstallationStatuses.ALREADY_INSTALLED||e.installationStatus===c.InstallationStatuses.OLDER_VERSION||e.installationStatus===c.InstallationStatuses.SAME_VERSION?i._enterState(x):e.installationStatus===c.InstallationStatuses.NEEDS_UPDATE?i._enterState(N):i._enterState(y)}).fail(function(e){e==="CANCELED"?(console.assert(i._state===w||i._state===E),i._enterState(S)):(i._errorMessage=c.formatError(e),i._enterState(b))});break;case w:this.$cancelButton.prop("disabled",!0),this.$msg.text(o.CANCELING_INSTALL),this._installer.cancel(),window.setTimeout(function(){i._state===w&&i._enterState(E)},this._cancelTimeout);break;case E:this.$msg.text(o.CANCELING_HUNG),this.$okButton.removeAttr("disabled").text(o.CLOSE);break;case y:case b:case S:case N:e===y?n=o.INSTALL_SUCCEEDED:e===b?n=o.INSTALL_FAILED:e===N?n=o.EXTENSION_UPDATE_INSTALLED:n=o.INSTALL_CANCELED,this.$msg.html($("<strong/>").text(n)),this._errorMessage&&this.$msg.append($("<p/>").text(this._errorMessage)),this.$okButton.removeAttr("disabled").text(o.CLOSE),this.$cancelButton.hide();break;case x:var a=this._installResult,f=a.installationStatus,l=o["EXTENSION_"+f];f===c.InstallationStatuses.OLDER_VERSION&&(l=s.format(l,a.metadata.version,a.installedVersion)),this.$msg.text(l),this.$okButton.prop("disabled",!1).text(o.OVERWRITE);break;case T:this._enterState(d);break;case d:$(document.body).off(".installDialog"),r.cancelModalDialogIfOpen("install-extension-dialog"),u===y||u===N||u===T?this._dialogDeferred.resolve(this._installResult):this._dialogDeferred.reject()}},C.prototype._handleCancel=function(){if(this._state===g)this._enterState(w);else if(this._state===x){if(this._installResult&&this._installResult.localPath&&!this._installResult.keepFile){var e=this._installResult.localPath;f.getFileForPath(e).unlink()}this._enterState(d)}else this._state!==w&&this._enterState(d)},C.prototype._handleOk=function(){this._state===y||this._state===b||this._state===S||this._state===E||this._state===N?this._enterState(d):this._state===m?this._enterState(g):this._state===x&&this._enterState(T)},C.prototype._handleKeyUp=function(e){e.keyCode===l.DOM_VK_ESCAPE&&this._handleCancel()},C.prototype._handleUrlInput=function(e){var t=this.$url.val().trim(),n=t!=="";!n&&this._state===m?this._enterState(v):n&&this._state===v&&this._enterState(m)},C.prototype._close=function(){this._state!==d&&this._enterState(d)},C.prototype.show=function(e){if(this._state!==d)return this._dialogDeferred.promise();var t={Strings:o,isUpdate:this._isUpdate,includeBrowseExtensions:!!brackets.config.extension_listing_url};return r.showModalDialogUsingTemplate(Mustache.render(p,t),!1),this.$dlg=$(".install-extension-dialog.instance"),this.$url=this.$dlg.find(".url").focus(),this.$okButton=this.$dlg.find(".dialog-button[data-button-id='ok']"),this.$cancelButton=this.$dlg.find(".dialog-button[data-button-id='cancel']"),this.$inputArea=this.$dlg.find(".input-field"),this.$msgArea=this.$dlg.find(".message-field"),this.$msg=this.$msgArea.find(".message"),this.$browseExtensionsButton=this.$dlg.find(".browse-extensions"),this.$okButton.on("click",this._handleOk.bind(this)),this.$cancelButton.on("click",this._handleCancel.bind(this)),this.$url.on("input",this._handleUrlInput.bind(this)),this.$browseExtensionsButton.on("click",function(){h.openURLInDefaultBrowser(brackets.config.extension_listing_url)}),$(document.body).on("keyup.installDialog",this._handleKeyUp.bind(this)),this._enterState(v),e&&(this.$url.val(e),this._enterState(m),this._enterState(g)),this._dialogDeferred=new $.Deferred,this._dialogDeferred.promise()},k.prototype.install=function(e){if(this.pendingInstall)return console.error("Extension installation already pending"),(new $.Deferred).reject("DOWNLOAD_ID_IN_USE").promise();if(this._isLocalFile){var t=new $.Deferred;this.pendingInstall={promise:t.promise(),cancel:function(){}},c.installFromPath(e).then(function(e){e.keepFile=!0,t.resolve(e)},t.reject)}else this.pendingInstall=c.installFromURL(e);var n=this.pendingInstall.promise,r=this;return this.pendingInstall.promise.always(function(){r.pendingInstall=null}),n},k.prototype.cancel=function(){this.pendingInstall.cancel()},t.showDialog=L,t.installUsingDialog=A,t.updateUsingDialog=O,t._Dialog=C}),define("extensibility/registry_utils",["require","exports","module"],function(e,t,n){function r(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}t.lastVersionDate=function(){var e;return this.versions&&this.versions.length&&(e=this.versions[this.versions.length-1].published,e&&(e=new Date(e),e=e.toLocaleDateString(brackets.getLocale(),{year:"numeric",month:"2-digit",day:"2-digit"}))),e||""},t.formatUserId=function(){var e;if(this.owner){var t=this.owner.split(":");e=t[1]}return e},t.ownerLink=function(){var e;if(this.owner){var t=this.owner.split(":");t[0]==="github"&&(e="https://github.com/"+t[1])}return e},t.authorInfo=function(){var e="",n=t.ownerLink.call(this),i=t.formatUserId.call(this);return this.metadata&&this.metadata.author?e=r(this.metadata.author.name||this.metadata.author):i&&(e=r(i)),n&&(e="<a href='"+r(n)+"' title='"+r(n)+"'>"+e+"</a>"),e},t.sortRegistry=function(e,t){function n(e){return e.versions?(new Date(e.versions[e.versions.length-1].published)).getTime():Number.NEGATIVE_INFINITY}var r=[];return Object.keys(e).forEach(function(t){r.push(e[t])}),r.sort(function(e,r){return n(t&&r[t]||r)-n(t&&e[t]||e)}),r}}),define("utils/LocalizationUtils",["require","exports","module","strings"],function(e,t,n){function i(e){var t="LOCALE_"+e.toUpperCase().replace("-","_"),n=r[t];return n===undefined?e:n}var r=e("strings");t.getLocalizedLabel=i}),define("text!htmlContent/extension-manager-view-item.html",[],function(){return'<tr>\n    <td class="ext-info">\n        <span class="ext-name">{{#metadata.title}}{{metadata.title}}{{/metadata.title}}{{^metadata.title}}{{metadata.name}}{{/metadata.title}}</span>\n        {{#authorInfo}}\n            <span class="muted ext-author">{{{authorInfo}}}</span>\n        {{/authorInfo}}\n        <span class="muted ext-version">{{metadata.version}}</span>\n        {{#hasVersionInfo}}\n            <span class="muted ext-date"> &mdash; {{lastVersionDate}}</span>\n        {{/hasVersionInfo}}\n    </td>\n    <td class="ext-desc">\n        {{#showInstallButton}}\n            <!-- Warnings when trying to install extension where latest/all versions not compatible -->\n            {{^isCompatible}}\n                <div class="alert warning">\n                    {{#requiresNewer}}{{Strings.EXTENSION_INCOMPATIBLE_NEWER}}{{/requiresNewer}}\n                    {{^requiresNewer}}{{Strings.EXTENSION_INCOMPATIBLE_OLDER}}{{/requiresNewer}}\n                </div>\n            {{/isCompatible}}\n            {{#isCompatible}}\n                {{^isCompatibleLatest}}\n                    <div class="alert warning">\n                        {{installWarning}}\n                    </div>\n                {{/isCompatibleLatest}}\n            {{/isCompatible}}\n        {{/showInstallButton}}\n        <span class="ext-full-description">\n            {{#metadata.shortdescription}}\n                {{metadata.shortdescription}}\n            {{/metadata.shortdescription}}\n            {{^metadata.shortdescription}}\n                {{#metadata.description}}\n                    {{metadata.description}}\n                {{/metadata.description}}\n                {{^metadata.description}}\n                    <p class="muted"><em>{{Strings.EXTENSION_NO_DESCRIPTION}}</em></p>\n                {{/metadata.description}}\n            {{/metadata.shortdescription}}\n        </span>\n        {{#metadata.shortdescription}}\n        <a data-extension-id="{{metadata.name}}" data-toggle-desc="expand-desc" title="{{Strings.VIEW_COMPLETE_DESCRIPTION}}" href="#">...</a>\n        {{/metadata.shortdescription}}\n        {{#metadata.homepage}}\n            <p><a title="{{metadata.homepage}}" href="{{metadata.homepage}}">{{Strings.EXTENSION_MORE_INFO}}</a></p>\n        {{/metadata.homepage}}\n        {{#translated}}\n            <br/>\n            <span class="ext-translated" title="{{translatedLangs}}">{{extensionTranslated}}</span>\n        {{/translated}}\n    </td>\n    <td class="ext-action">\n        {{#showInstallButton}}\n            <button class="btn btn-mini install" data-extension-id="{{metadata.name}}" {{^allowInstall}}disabled{{/allowInstall}}>\n                {{^isInstalled}}{{Strings.INSTALL}}{{/isInstalled}}\n                {{#isInstalled}}{{Strings.EXTENSION_INSTALLED}}{{/isInstalled}}\n            </button>\n        {{/showInstallButton}}\n        {{#isInstalled}}\n            {{#showUpdateButton}}\n                <button class="btn btn-mini update" data-extension-id="{{metadata.name}}" {{^allowUpdate}}disabled title="{{updateNotAllowedReason}}"{{/allowUpdate}}>\n                    {{Strings.UPDATE}}\n                </button>\n            {{/showUpdateButton}}\n            {{#removalAllowed}}\n                <button class="btn btn-mini remove" data-extension-id="{{metadata.name}}" {{^allowRemove}}disabled title="{{Strings.CANT_REMOVE_DEV}}"{{/allowRemove}}>\n                    {{Strings.REMOVE}}\n                </button>\n            {{/removalAllowed}}\n            {{#failedToStart}}\n                {{^isMarkedForRemoval}}\n                    {{Strings.EXTENSION_ERROR}} {{#allowRemove}}(<a class="remove" data-extension-id="{{metadata.name}}">{{Strings.REMOVE}}</a>){{/allowRemove}}\n                {{/isMarkedForRemoval}}\n            {{/failedToStart}}\n            {{#isMarkedForRemoval}}\n                {{Strings.MARKED_FOR_REMOVAL}} (<a class="undo-remove" data-extension-id="{{metadata.name}}" href="#">{{Strings.UNDO_REMOVE}}</a>)\n            {{/isMarkedForRemoval}}\n            {{#isMarkedForUpdate}}\n                {{Strings.MARKED_FOR_UPDATE}} (<a class="undo-update" data-extension-id="{{metadata.name}}" href="#">{{Strings.UNDO_UPDATE}}</a>)\n            {{/isMarkedForUpdate}}\n        {{/isInstalled}}\n    </td>\n</tr>\n'}),define("extensibility/ExtensionManagerView",["require","exports","module","strings","utils/StringUtils","extensibility/ExtensionManager","extensibility/registry_utils","extensibility/InstallExtensionDialog","utils/LocalizationUtils","text!htmlContent/extension-manager-view-item.html"],function(e,t,n){function l(){}var r=e("strings"),i=e("utils/StringUtils"),s=e("extensibility/ExtensionManager"),o=e("extensibility/registry_utils"),u=e("extensibility/InstallExtensionDialog"),a=e("utils/LocalizationUtils"),f=e("text!htmlContent/extension-manager-view-item.html");l.prototype.initialize=function(e){var t=this,n=new $.Deferred;return this.model=e,this._itemTemplate=Mustache.compile(f),this._itemViews={},this.$el=$("<div class='extension-list tab-pane' id='"+this.model.source+"'/>"),this._$emptyMessage=$("<div class='empty-message'/>").appendTo(this.$el),this._$infoMessage=$("<div class='info-message'/>").appendTo(this.$el).html(this.model.infoMessage),this._$table=$("<table class='table'/>").appendTo(this.$el),this.model.initialize().done(function(){t._setupEventHandlers()}).always(function(){t._render(),n.resolve()}),n.promise()},l.prototype.$el=null,l.prototype.model=null,l.prototype._$emptyMessage=null,l.prototype._$table=null,l.prototype._itemTemplate=null,l.prototype._itemViews=null,l.prototype._setupEventHandlers=function(){var e=this;$(this.model).on("filter",function(){e._render()}).on("change",function(t,n){var r=e.model.extensions,i=e._itemViews[n];e._updateMessage();if(e.model.filterSet.indexOf(n)===-1)i&&(i.remove(),delete e._itemViews[n]);else{var s=e._renderItem(r[n],e.model._getEntry(n));i&&(i.replaceWith(s),e._itemViews[n]=s)}}),this.$el.on("click","a",function(e){var t=$(e.target);t.hasClass("undo-remove")?s.markForRemoval(t.attr("data-extension-id"),!1):t.hasClass("remove")?s.markForRemoval(t.attr("data-extension-id"),!0):t.hasClass("undo-update")?s.removeUpdate(t.attr("data-extension-id")):t.attr("data-toggle-desc")==="expand-desc"?s.toggleDescription(t.attr("data-extension-id"),t,!0):t.attr("data-toggle-desc")==="trunc-desc"&&s.toggleDescription(t.attr("data-extension-id"),t,!1)}).on("click","button.install",function(t){e._installUsingDialog($(t.target).attr("data-extension-id"))}).on("click","button.update",function(t){e._installUsingDialog($(t.target).attr("data-extension-id"),!0)}).on("click","button.remove",function(e){s.markForRemoval($(e.target).attr("data-extension-id"),!0)})},l.prototype._renderItem=function(e,t){var n=$.extend({},t);n.Strings=r,n.isInstalled=!!e.installInfo,n.failedToStart=e.installInfo&&e.installInfo.status===s.START_FAILED,n.hasVersionInfo=!!t.versions;if(e.registryInfo){var u=s.getCompatibilityInfo(e.registryInfo,brackets.metadata.apiVersion);n.isCompatible=u.isCompatible,n.requiresNewer=u.requiresNewer,n.isCompatibleLatest=u.isLatestVersion;if(!n.isCompatibleLatest){var f=n.requiresNewer?r.EXTENSION_LATEST_INCOMPATIBLE_NEWER:r.EXTENSION_LATEST_INCOMPATIBLE_OLDER;n.installWarning=i.format(f,e.registryInfo.versions[e.registryInfo.versions.length-1].version,u.compatibleVersion)}}else n.isCompatible=n.isCompatibleLatest=!0;t.metadata.description!==undefined&&(t.metadata.shortdescription=i.truncate(t.metadata.description,200)),n.isMarkedForRemoval=s.isMarkedForRemoval(t.metadata.name),n.isMarkedForUpdate=s.isMarkedForUpdate(t.metadata.name),n.showInstallButton=this.model.source===this.model.SOURCE_REGISTRY&&!n.updateAvailable,n.showUpdateButton=n.updateAvailable&&!n.isMarkedForUpdate&&!n.isMarkedForRemoval,n.allowInstall=n.isCompatible&&!n.isInstalled;if(Array.isArray(t.metadata.i18n)&&t.metadata.i18n.length>0){var l=brackets.getLocale(),c=l.split("-")[0];n.translated=!0,n.translatedLangs=t.metadata.i18n.map(function(e){return{name:a.getLocalizedLabel(e),locale:e}}).sort(function(e,t){var n=[e.locale,t.locale],r=n.indexOf(l);return r>-1?r:(r=n.indexOf(c),r>-1?r:e.name.localeCompare(t.name))}).map(function(e){return e.name}).join(", "),n.translatedLangs=i.format(r.EXTENSION_TRANSLATED_LANGS,n.translatedLangs);var h=brackets.isLocaleDefault()&&t.metadata.i18n.indexOf(c)>-1||t.metadata.i18n.indexOf(l)>-1;n.extensionTranslated=i.format(h?r.EXTENSION_TRANSLATED_USER_LANG:r.EXTENSION_TRANSLATED_GENERAL,t.metadata.i18n.length)}var p=e.installInfo&&e.installInfo.locationType===s.LOCATION_USER;return n.allowRemove=p,n.allowUpdate=n.showUpdateButton&&n.isCompatible&&n.updateCompatible&&p,n.allowUpdate||(n.updateNotAllowedReason=p?r.CANT_UPDATE:r.CANT_UPDATE_DEV),n.removalAllowed=this.model.source==="installed"&&!n.failedToStart&&!n.isMarkedForUpdate&&!n.isMarkedForRemoval,["lastVersionDate","authorInfo"].forEach(function(e){n[e]=o[e]}),$(this._itemTemplate(n))},l.prototype._updateMessage=function(){return this.model.message?(this._$emptyMessage.css("display","block"),this._$emptyMessage.html(this.model.message),this._$infoMessage.css("display","none"),this._$table.css("display","none"),!0):(this._$emptyMessage.css("display","none"),this._$infoMessage.css("display",this.model.infoMessage?"block":"none"),this._$table.css("display",""),!1)},l.prototype._render=function(){var e=this,t;this._$table.empty(),this._updateMessage(),this.model.filterSet.forEach(function(t){var n=e._itemViews[t];n||(n=e._renderItem(e.model.extensions[t],e.model._getEntry(t)),e._itemViews[t]=n),n.appendTo(e._$table)}),$(this).triggerHandler("render")},l.prototype._installUsingDialog=function(e,t){var n=this.model.extensions[e];if(n&&n.registryInfo){var r=s.getCompatibilityInfo(n.registryInfo,brackets.metadata.apiVersion),i=s.getExtensionURL(e,r.compatibleVersion);t?u.updateUsingDialog(i).done(s.updateFromDownload):u.installUsingDialog(i)}},l.prototype.filter=function(e){this.model.filter(e)},t.ExtensionManagerView=l}),define("extensibility/ExtensionManagerViewModel",["require","exports","module","thirdparty/lodash","extensibility/ExtensionManager","extensibility/Package","extensibility/registry_utils","strings"],function(e,t,n){function f(){this._handleStatusChange=this._handleStatusChange.bind(this),$(i).on("statusChange."+this.source,this._handleStatusChange).on("registryUpdate."+this.source,this._handleStatusChange)}function l(){f.call(this),this.infoMessage=u.REGISTRY_SANITY_CHECK_WARNING}function c(){f.call(this);var e=this;$(i).on("registryDownload",function(){e._sortFullSet(),e._setInitialFilter()})}var r=e("thirdparty/lodash"),i=e("extensibility/ExtensionManager"),s=e("extensibility/Package"),o=e("extensibility/registry_utils"),u=e("strings"),a=[["metadata","name"],["metadata","title"],["metadata","description"],["metadata","author","name"],["metadata","keywords"],["owner"]];f.prototype.SOURCE_REGISTRY="registry",f.prototype.SOURCE_INSTALLED="installed",f.prototype.extensions=null,f.prototype.source=null,f.prototype.filterSet=null,f.prototype.sortedFullSet=null,f.prototype._lastQuery=null,f.prototype.infoMessage=null,f.prototype.message=null,f.prototype.notifyCount=0,f.prototype._initializeFromSourcePromise=null,f.prototype.dispose=function(){$(i).off("."+this.source)},f.prototype._setInitialFilter=function(){this.filterSet=r.clone(this.sortedFullSet),$(this).triggerHandler("filter")},f.prototype._sortFullSet=function(){},f.prototype.initialize=function(){var e=this;return this._initializeFromSourcePromise=this._initializeFromSource().always(function(){e._updateMessage()}),this._initializeFromSourcePromise},f.prototype._handleStatusChange=function(e,t){$(this).triggerHandler("change",t)},f.prototype.filter=function(e,t){function s(e,t){var r=[];return e.forEach(function(e){var i=n._getEntry(e);i&&n._entryMatchesQuery(i,t)&&r.push(e)}),r}var n=this,r;!t&&this._lastQuery&&e.indexOf(this._lastQuery)===0?r=this.filterSet:r=this.sortedFullSet;var i=e.toLowerCase().split(/\s+/),o,u=r;for(o=0;o<i.length;o++)u=s(u,i[o]);this._lastQuery=e,this.filterSet=u,this._updateMessage(),$(this).triggerHandler("filter")},f.prototype._updateMessage=function(){this._initializeFromSourcePromise&&this._initializeFromSourcePromise.state()==="rejected"?this.message=u.EXTENSION_MANAGER_ERROR_LOAD:this.filterSet&&this.filterSet.length===0?this.message=this.sortedFullSet&&this.sortedFullSet.length?u.NO_EXTENSION_MATCHES:u.NO_EXTENSIONS:this.message=null},f.prototype._getEntry=function(e){return null},f.prototype._entryMatchesQuery=function(e,t){return t===""||a.some(function(n){var r,i=e;for(r=0;r<n.length;r++){i=i[n[r]];if(!i)return!1}if(Array.isArray(i))return i.some(function(e){return e.toLowerCase().indexOf(t)!==-1});if(n[n.length-1]==="owner"){var s=i.split(":");if(s[1].toLowerCase().indexOf(t)!==-1)return!0}else if(i.toLowerCase().indexOf(t)!==-1)return!0})},l.prototype=Object.create(f.prototype),l.prototype.constructor=l,l.prototype.source=f.prototype.SOURCE_REGISTRY,l.prototype._initializeFromSource=function(){var e=this;return i.downloadRegistry().done(function(){e.extensions=i.extensions,e.sortedFullSet=o.sortRegistry(e.extensions,"registryInfo").filter(function(e){return e.registryInfo!==undefined}).map(function(e){return e.registryInfo.metadata.name}),e._setInitialFilter()}).fail(function(){e.extensions=[],e.sortedFullSet=[],e.filterSet=[]})},l.prototype._getEntry=function(e){var t=this.extensions[e];return t?t.registryInfo:t},c.prototype=Object.create(f.prototype),c.prototype.constructor=c,c.prototype.source=f.prototype.SOURCE_INSTALLED,c.prototype._initializeFromSource=function(){var e=this;return this.extensions=i.extensions,this.sortedFullSet=Object.keys(this.extensions).filter(function(t){return e.extensions[t].installInfo&&e.extensions[t].installInfo.locationType!==i.LOCATION_DEFAULT}),this._sortFullSet(),this._setInitialFilter(),this._countUpdates(),(new $.Deferred).resolve().promise()},c.prototype._sortFullSet=function(){var e=this;this.sortedFullSet=this.sortedFullSet.sort(function(t,n){var r=e.extensions[t].installInfo.updateAvailable,i=e.extensions[n].installInfo.updateAvailable;if(r&&!i)return-1;if(!r&&i)return 1;var s=e.extensions[t].installInfo.metadata,o=e.extensions[n].installInfo.metadata,u=(s.title||s.name).toLocaleLowerCase(),a=(o.title||o.name).toLocaleLowerCase();return u.localeCompare(a)})},c.prototype._countUpdates=function(){var e=this;this.notifyCount=0,this.sortedFullSet.forEach(function(t){e.extensions[t].installInfo.updateCompatible&&!i.isMarkedForUpdate(t)&&e.notifyCount++})},c.prototype._handleStatusChange=function(e,t){var n=this.sortedFullSet.indexOf(t),r=!1;n!==-1&&!this.extensions[t].installInfo?(this.sortedFullSet.splice(n,1),this._countUpdates(),r=!0):n===-1&&this.extensions[t].installInfo&&(this.sortedFullSet.push(t),this._sortFullSet(),r=!0),r&&this.filter(this._lastQuery||"",!0),this.extensions[t].installInfo&&this._countUpdates(),f.prototype._handleStatusChange.call(this,e,t)},c.prototype._getEntry=function(e){var t=this.extensions[e];return t?t.installInfo:t},t.RegistryViewModel=l,t.InstalledViewModel=c}),define("text!htmlContent/extension-manager-dialog.html",[],function(){return'<div class="extension-manager-dialog modal">\n    <div class="modal-header">\n        <ul class="nav nav-tabs">\n            {{#showRegistry}}\n                <li><a href="#registry" class="registry" data-toggle="tab"><img src="styles/images/extension-manager-registry.svg"/><br/>{{Strings.EXTENSIONS_AVAILABLE_TITLE}}</a></li>\n                <!--<li><a href="#updates" class="updates" data-toggle="tab"><img src="styles/images/extension-manager-updates.svg"/><br/>{{Strings.EXTENSIONS_UPDATES_TITLE}}</a></li>-->\n            {{/showRegistry}}\n            <li><a href="#installed" class="installed" data-toggle="tab"><span class="notification"></span><img src="styles/images/extension-manager-installed.svg"/><br/>{{Strings.EXTENSIONS_INSTALLED_TITLE}}</a></li>\n        </ul>\n        <div>\n            <button class="search-clear">&times;</button>\n            <input class="search" type="text" placeholder="{{EXTENSION_SEARCH_PLACEHOLDER}}">\n        </div>\n    </div>\n    <div class="modal-body no-padding table-striped tab-content">\n        <div class=\'spinner large spin\'/>\n    </div>\n    <div class="modal-footer">\n        <span id="install-drop-zone" class="btn left drag">\n            <span class="install-drag-message">{{Strings.INSTALL_EXTENSION_DRAG}} <a class="install-from-url">{{Strings.INSTALL_FROM_URL}}</a></span>\n            <span class="install-drop-message">{{Strings.INSTALL_EXTENSION_DROP}}</span>\n            <span class="install-validating-message">{{Strings.INSTALL_EXTENSION_VALIDATING}}</span>\n            <div id="install-drop-zone-mask"></div>\n        </span>\n        <button class="dialog-button btn primary" data-button-id="close">{{Strings.CLOSE}}</button>\n    </div>\n</div>\n'}),!function(e){var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active:last a")[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var i=n.find("> .active"),s=r&&e.support.transition&&i.hasClass("fade");s?i.one(e.support.transition.end,o):o(),i.removeClass("in")}};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(window.jQuery),define("widgets/bootstrap-tab",function(){}),define("extensibility/ExtensionManagerDialog",["require","exports","module","thirdparty/lodash","widgets/Dialogs","widgets/DefaultDialogs","filesystem/FileSystem","file/FileUtils","extensibility/Package","strings","utils/StringUtils","command/Commands","command/CommandManager","extensibility/InstallExtensionDialog","utils/AppInit","utils/Async","extensibility/ExtensionManager","extensibility/ExtensionManagerView","extensibility/ExtensionManagerViewModel","text!htmlContent/extension-manager-dialog.html","widgets/bootstrap-tab"],function(e,t,n){function E(e){e.stopPropagation(),e.preventDefault()}function S(){var e=m.hasExtensionsToRemove(),t=m.hasExtensionsToUpdate();if(!e&&!t)return;var n=f.CHANGE_AND_RELOAD;e&&!t?n=f.REMOVE_AND_RELOAD:t&&!e&&(n=f.UPDATE_AND_RELOAD);var r=i.showModalDialog(s.DIALOG_ID_CHANGE_EXTENSIONS,f.CHANGE_AND_RELOAD_TITLE,f.CHANGE_AND_RELOAD_MESSAGE,[{className:i.DIALOG_BTN_CLASS_NORMAL,id:i.DIALOG_BTN_CANCEL,text:f.CANCEL},{className:i.DIALOG_BTN_CLASS_PRIMARY,id:i.DIALOG_BTN_OK,text:n}],!1),o=r.getElement();o.one("buttonClick",function(e,t){t===i.DIALOG_BTN_OK?(o.find(".dialog-button").prop("disabled",!0),o.find(".close").hide(),o.find(".dialog-message").text(f.PROCESSING_EXTENSIONS).append("<span class='spinner inline spin'/>"),m.removeMarkedExtensions().done(function(){m.updateExtensions().done(function(){r.close(),h.execute(c.APP_RELOAD)}).fail(function(e){r.close();var t=[];e.forEach(function(e){t.push(e.item),e.error&&e.error.forEach&&(console.error("Errors for ",e.item),e.error.forEach(function(e){console.error(a.formatError(e))}))}),i.showModalDialog(s.DIALOG_ID_ERROR,f.EXTENSION_MANAGER_UPDATE,l.format(f.EXTENSION_MANAGER_UPDATE_ERROR,t.join(", "))).done(function(){h.execute(c.APP_RELOAD)})})}).fail(function(e){r.close(),m.cleanupUpdates();var t=[];e.forEach(function(e){t.push(e.item)}),i.showModalDialog(s.DIALOG_ID_ERROR,f.EXTENSION_MANAGER_REMOVE,l.format(f.EXTENSION_MANAGER_REMOVE_ERROR,t.join(", "))).done(function(){h.execute(c.APP_RELOAD)})})):(r.close(),m.cleanupUpdates(),m.unmarkAllForRemoval())})}function x(){var e=[],t=[],n=new $.Deferred,r;return brackets.app.getDroppedFiles(function(i,s){if(i){console.error(i),n.resolve();return}r=v.doInParallel_aggregateErrors(s,function(n){var r=new $.Deferred;return o.resolve(n,function(i,s){var o=u.getFileExtension(n),l=s.isFile&&o==="zip",c;i?c=u.getFileErrorString(i):l||(c=f.INVALID_ZIP_FILE);if(c){r.reject(c);return}a.validate(n,{requirePackageJSON:!0}).done(function(n){if(n.errors.length){r.reject(a.formatError(n.errors));return}var i=n.metadata.name,o=m.extensions[i],u=o&&!!o.installInfo;u?t.push(s):e.push(s),r.resolve()}).fail(function(e){r.reject(a.formatError(e))})}),r.promise()}),r.done(function(){var r=v.doSequentially(e,function(e){return p.installUsingDialog(e)}),i=r.then(function(){return v.doSequentially(t,function(e){return p.updateUsingDialog(e).done(function(e){m.updateFromDownload(e)})})});i.always(n.resolve)}).fail(function(e){n.reject(e)})}),n.promise()}function T(){function d(){var e=h[w],t=o.val()===""&&(!e.filterSet||e.filterSet.length===0);return o.prop("disabled",t),a.prop("disabled",t),t}function T(e){var n=h[e],r=t.find(".nav-tabs li").eq(e).find(".notification");n.notifyCount?(r.text(n.notifyCount),r.show()):r.hide()}var e,t,n=[],o,a,c={Strings:f,showRegistry:!!brackets.config.extension_registry},h=[];c.showRegistry&&h.push(new y.RegistryViewModel),h.push(new y.InstalledViewModel),e=i.showModalDialogUsingTemplate(Mustache.render(b,c)),e.done(function(){h.forEach(function(e){e.dispose()}),S()}),t=e.getElement(),o=$(".search",t),a=$(".search-clear",t),t.find(".nav-tabs a").on("click",function(e){h[w].scrollPos=$(".modal-body",t).scrollTop(),$(this).tab("show"),$(".modal-body",t).scrollTop(h[w].scrollPos||0),a.click()});var N=v.doInParallel(h,function(e,t){var r=new g,i=r.initialize(e),s;return i.always(function(){n[t]=r,s=e.notifyCount,T(t)}),$(e).on("change",function(){s!==e.notifyCount&&(s=e.notifyCount,T(t))}),i},!0);N.always(function(){$(".spinner",t).remove(),n.forEach(function(e){e.$el.appendTo($(".modal-body",t))}),$("a[data-toggle='tab']",t).each(function(e,n){$(n).on("show",function(n){w=e,d()||t.find(".search").focus()})}),t.on("input",".search",function(e){var t=$(this).val();n.forEach(function(e){e.filter(t)})}).on("click",".search-clear",function(e){o.val(""),n.forEach(function(e,t){e.filter("")}),d()||o.focus()}),h.forEach(function(e,t){$(e).on("change",function(){w===t&&d()})}),$("#toolbar-extension-manager").hasClass("updatesAvailable")?t.find(".nav-tabs a.installed").tab("show"):t.find(".nav-tabs a:first").tab("show")}),$(".extension-manager-dialog .install-from-url").click(function(){p.showDialog().done(m.updateFromDownload)});var C=$("#install-drop-zone"),k=$("#install-drop-zone-mask");return C.on("dragover",function(e){E(e);if(!e.originalEvent.dataTransfer.files)return;var t=e.originalEvent.dataTransfer.items,n=!1;n=r.every(t,function(e){if(e.kind==="file"){var t=e.webkitGetAsEntry(),n=u.getFileExtension(t.fullPath);return t.isFile&&n==="zip"}return!1}),n?(C.width(C.width()),C.removeClass("drag"),C.addClass("drop")):e.originalEvent.dataTransfer.dropEffect="none"}).on("drop",E),k.on("dragover",function(e){E(e),e.originalEvent.dataTransfer.dropEffect="copy"}).on("dragleave",function(){C.removeClass("drop"),C.addClass("drag")}).on("drop",function(e){E(e),e.originalEvent.dataTransfer.files&&(x().fail(function(e){var t=f.INSTALL_EXTENSION_DROP_ERROR;t+="<ul class='dialog-list'>",e.forEach(function(e){t+="<li><span class='dialog-filename'>",t+=l.breakableUrl(e.item),t+="</span>: "+e.error+"</li>"}),t+="</ul>",i.showModalDialog(s.DIALOG_ID_ERROR,f.EXTENSION_MANAGER_TITLE,t)}).always(function(){C.removeClass("validating"),C.addClass("drag")}),C.removeClass("drop"),C.addClass("validating"))}),(new $.Deferred).resolve(e).promise()}var r=e("thirdparty/lodash"),i=e("widgets/Dialogs"),s=e("widgets/DefaultDialogs"),o=e("filesystem/FileSystem"),u=e("file/FileUtils"),a=e("extensibility/Package"),f=e("strings"),l=e("utils/StringUtils"),c=e("command/Commands"),h=e("command/CommandManager"),p=e("extensibility/InstallExtensionDialog"),d=e("utils/AppInit"),v=e("utils/Async"),m=e("extensibility/ExtensionManager"),g=e("extensibility/ExtensionManagerView").ExtensionManagerView,y=e("extensibility/ExtensionManagerViewModel"),b=e("text!htmlContent/extension-manager-dialog.html");e("widgets/bootstrap-tab");var w;h.register(f.CMD_EXTENSION_MANAGER,c.FILE_EXTENSION_MANAGER,T),d.appReady(function(){$("#toolbar-extension-manager").click(T)}),t._performChanges=S}),define("text!htmlContent/image-holder.html",[],function(){return'<div id="image-holder">\n    <div id="img-centering">\n        <div id="img-header">\n            <div id="img-data"></div>\n            <div id="img-path"></div>	\n        </div>\n        <div id="img">\n            <div id="img-scale"></div>\n            <img id="img-preview" src="file:///{{fullPath}}">\n            <div id="img-tip">\n                <table class="tip-container">\n                    <tr>\n                        <td class="variable">x: </td>\n                        <td id="x-value"></td>\n                    </tr>\n                    <tr>\n                        <td class="variable">y: </td>\n                        <td id="y-value"></td>\n                    </tr>\n                </table>\n            </div>\n            <div id="horiz-guide" class="img-guide"></div>\n            <div id="vert-guide" class="img-guide"></div>\n        </div>\n    </div>\n</div>'}),define("editor/ImageViewer",["require","exports","module","document/DocumentManager","editor/EditorManager","text!htmlContent/image-holder.html","view/PanelManager","project/ProjectManager","strings","utils/StringUtils","filesystem/FileSystem","file/FileUtils"],function(e,t,n){function m(e){e&&e<h?(d=e/h*100,$("#img-scale").text(Math.floor(d)+"%").css("left",$("#img-preview").position().left+5).show()):(d=100,v=null,$("#img-scale").text("").hide())}function g(){$("#img-tip").hide(),$(".img-guide").hide()}function y(){g(),m($("#img-preview").width())}function b(e,t,n){var r=u.makeProjectRelativeIfPossible(t),i=$("#img-path").text();if(i===r){var s=u.makeProjectRelativeIfPossible(n);$("#img-path").text(s).attr("title",s)}}function w(e,t){var n=$("#img-preview").position(),r=$("#img-scale").position(),i=$("#img-preview").width(),s=$("#img-preview").height(),o,u,a,f;v?(o=v.left,u=v.top,a=v.right,f=v.bottom,i+n.left<a&&(a=i+n.left),s+n.top<f&&(f=s+n.top)):(o=r.left,u=r.top,a=$("#img-scale").width()+o,f=$("#img-scale").height()+u);if(v){if(e<o||e>a||t<u||t>f)v=null,$("#img-scale").show()}else e>=o&&e<=a&&t>=u&&t<=f&&e<n.left+i&&t<n.top+s&&(v={left:r.left,top:r.top,right:a,bottom:f},$("#img-scale").hide())}function E(e){var t=$(e.target),n=t.position(),r=$("#img-preview").position(),i=r.left+$("#img-preview").width(),s=r.top+$("#img-preview").height(),o=n.left+e.offsetX,u=n.top+e.offsetY;if(o<r.left||o>=i||u<r.top||u>=s)g(),v&&(v=null,$("#img-scale").show())}function S(e){if(Math.floor(d)===0)return;var t=Math.round(e.offsetX*100/d),n=Math.round(e.offsetY*100/d),r=$(e.target),i=$("#img-preview").position(),s=e.offsetX+i.left,o=e.offsetY+i.top,u=$("#img-preview").width(),a=$("#img-preview").height(),f=$(window).width(),l=h.toString().length===4,c=112,v=120,m=10,g=-54,y=-82,b=-90;if(t<0||t>=h||n<0||n>=p){E(e),$("#img-preview").css("cursor","auto");return}$("#img-preview").css("cursor","none"),w(s,o);if(e.pageX+c>f||l&&e.pageX+v>f)m=l?b:y;$("#x-value").text(t+"px"),$("#y-value").text(n+"px"),$("#img-tip").css({left:s+m,top:o+g}).show(),$("#horiz-guide").css({left:i.left,top:o,width:u-1}).show(),$("#vert-guide").css({left:s,top:i.top,height:a-1}).show()}function x(){$(o).off("editorAreaResize",y),$(r).off("fileNameChange",b),$("#img").off("mousemove","#img-preview",S).off("mouseleave","#img-preview",E)}function T(e,t){var n=u.makeProjectRelativeIfPossible(e),i=$(Mustache.render(s,{fullPath:e}));return t.append(i),d=100,v=null,$("#img-path").text(n).attr("title",n),$("#img-preview").on("load",function(){h=this.naturalWidth,p=this.naturalHeight;var t=c.getFileExtension(e),n=h+" &times; "+this.naturalHeight+" "+a.UNIT_PIXELS;t==="ico"&&(n+=" ("+a.IMAGE_VIEWER_LARGEST_ICON+")");var i=l.getFileForPath(e);i.stat(function(e,t){if(e)$("#img-data").html(n);else{var r="";t.size&&(r=" &mdash; "+f.prettyPrintBytes(t.size,2));var i=n+r;$("#img-data").html(i).attr("title",i.replace("&times;","x").replace("&mdash;","-"))}}),$("#image-holder").show(),$(o).on("editorAreaResize",y),$(r).on("fileNameChange",b),$("#img-tip").hide(),$(".img-guide").hide(),$("#img").on("mousemove","#img-preview",S).on("mouseleave","#img-preview",E),m($(this).width())}),i}var r=e("document/DocumentManager"),i=e("editor/EditorManager"),s=e("text!htmlContent/image-holder.html"),o=e("view/PanelManager"),u=e("project/ProjectManager"),a=e("strings"),f=e("utils/StringUtils"),l=e("filesystem/FileSystem"),c=e("file/FileUtils"),h=0,p=0,d=100,v=null;i.registerCustomViewer("image",{render:T,onRemove:x}),t.render=T,t.onRemove=x}),define("project/FileIndexManager",["require","exports","module","project/ProjectManager","file/FileUtils"],function(e,t,n){function s(){console.error("Warning: FileIndexManager is deprecated. Use ProjectManager.getAllFiles() instead")}function o(e){if(e==="css")return r.getLanguageFilter("css");if(e==="all")return null;throw new Error("Invalid index name:",e)}function u(e){return s(),r.getAllFiles(o(e))}function a(e,t){s();var n=o(e);return r.getAllFiles(function(e){return n&&!n(e)?!1:e.name===t})}var r=e("project/ProjectManager"),i=e("file/FileUtils");t.getFileInfoList=u,t.getFilenameMatches=a}),define("file/NativeFileError",[],function(){var e={};return e.NOT_FOUND_ERR="NotFoundError",e.SECURITY_ERR="SecurityError",e.ABORT_ERR="AbortError",e.NOT_READABLE_ERR="NotReadableError",e.NO_MODIFICATION_ALLOWED_ERR="NoModificationAllowedError",e.INVALID_STATE_ERR="InvalidStateError",e.SYNTAX_ERR="SyntaxError",e.INVALID_MODIFICATION_ERR="InvalidModificationError",e.QUOTA_EXCEEDED_ERR="QuotaExceededError",e.TYPE_MISMATCH_ERR="TypeMismatchError",e.PATH_EXISTS_ERR="PathExistsError",e}),define("file/NativeFileSystem",["require","exports","module","filesystem/FileSystem","filesystem/File","filesystem/Directory","file/NativeFileError"],function(e,t,n){function u(e,t){console.error("Warning: '"+e+"' is deprecated. Use '"+t+"' instead")}var r=e("filesystem/FileSystem"),i=e("filesystem/File"),s=e("filesystem/Directory"),o=e("file/NativeFileError"),a={showOpenDialog:function(e,t,n,i,s,o,a){u("NativeFileSystem.showOpenDialog()","FileSystem.showOpenDialog()"),r.showOpenDialog(e,t,n,i,s,function(e,t){e?a&&a(e):o(t)})},showSaveDialog:function(e,t,n,i,s){u("NativeFileSystem.showSaveDialog()","FileSystem.showSaveDialog()"),r.showSaveDialog(e,t,n,function(e,t){e?s&&s(e):i(t)})},requestNativeFileSystem:function(e,t,n){u("NativeFileSystem.requestNativeFileSystem()","FileSystem.resolve()"),r.resolve(e,function(e,r){if(e)n(e);else{var i={root:r};t(i)}})},resolveNativeFileSystemPath:function(e,t,n){u("NativeFileSystem.resolveNativeFileSystemPath()","FileSystem.resolve()"),r.resolve(e,function(e,r){e?n(e):t(r)})}};a.FileEntry=function(e){return u("new NativeFileSystem.FileEntry()","FileSystem.getFileForPath()"),r.getFileForPath(e)},a.DirectoryEntry=function(e){return u("new NativeFileSystem.DirectoryEntry()","FileSystem.getDirectoryForPath()"),r.getDirectoryForPath(e)},i.prototype.createWriter=function(e){u("File.createWriter()","File.write()");var t=this;e({write:function(e){var n=this;n.onwritestart&&n.onwritestart(),t.write(e,function(e){e?n.onerror&&n.onerror(e):(n.onwrite&&n.onwrite(),n.onwriteend&&n.onwriteend())})}})},s.prototype.createReader=function(){u("Directory.createReader()","Directory.getContents()");var e=this;return{readEntries:function(t,n){e.getContents(function(e,r){e?n(e):t(r)})}}},s.prototype.getFile=function(e,t,n,i){if(t&&t.create)throw new Error("Directory.getFile() is deprecated and no longer supports 'create: true'. Use File.write(\"\") instead.");u("Directory.getFile()","FileSystem.resolve()"),e[0]!=="/"&&e[1]!==":"&&(e=this.fullPath+e),r.resolve(e,function(e,t){e?i(e):t.isDirectory?i(o.TYPE_MISMATCH_ERR):n(t)})},s.prototype.getDirectory=function(){throw new Error("Directory.getDirectory() has been removed. Use FileSystem.getDirectoryForPath() and/or Directory.create() instead.")},t.NativeFileSystem=a}),define("brackets",["require","exports","module","widgets/bootstrap-dropdown","widgets/bootstrap-modal","widgets/bootstrap-twipsy-mod","thirdparty/path-utils/path-utils.min","thirdparty/smart-auto-complete-local/jquery.smart_autocomplete","thirdparty/CodeMirror2/addon/fold/xml-fold","thirdparty/CodeMirror2/addon/edit/matchtags","thirdparty/CodeMirror2/addon/edit/matchbrackets","thirdparty/CodeMirror2/addon/edit/closebrackets","thirdparty/CodeMirror2/addon/edit/closetag","thirdparty/CodeMirror2/addon/scroll/scrollpastend","thirdparty/CodeMirror2/addon/selection/active-line","thirdparty/CodeMirror2/addon/selection/mark-selection","thirdparty/CodeMirror2/addon/mode/multiplex","thirdparty/CodeMirror2/addon/mode/overlay","thirdparty/CodeMirror2/addon/search/match-highlighter","thirdparty/CodeMirror2/addon/search/searchcursor","thirdparty/CodeMirror2/keymap/sublime","utils/Global","utils/AppInit","language/LanguageManager","project/ProjectManager","document/DocumentManager","editor/EditorManager","editor/CSSInlineEditor","language/JSUtils","project/WorkingSetView","project/WorkingSetSort","document/DocumentCommandHandlers","project/FileViewController","project/FileSyncManager","command/KeyBindingManager","command/Commands","command/CommandManager","editor/CodeHintManager","utils/PerfUtils","filesystem/FileSystem","search/QuickOpen","command/Menus","file/FileUtils","text!htmlContent/main-view.html","strings","widgets/Dialogs","widgets/DefaultDialogs","utils/ExtensionLoader","project/SidebarView","utils/Async","utils/UpdateNotification","utils/UrlParams","preferences/PreferencesManager","utils/Resizer","LiveDevelopment/main","utils/NodeConnection","utils/NodeDomain","utils/ExtensionUtils","utils/DragAndDrop","utils/ColorUtils","language/CodeInspection","utils/NativeApp","utils/DeprecationWarning","view/ViewCommandHandlers","view/ThemeManager","thirdparty/lodash","thirdparty/CodeMirror2/lib/codemirror","command/DefaultMenus","document/ChangedDocumentTracker","editor/EditorStatusBar","editor/EditorCommandHandlers","editor/EditorOptionHandlers","help/HelpCommandHandlers","search/FindInFilesUI","search/FindReplace","extensibility/InstallExtensionDialog","extensibility/ExtensionManagerDialog","editor/ImageViewer","utils/CollectionUtils","project/FileIndexManager","file/NativeFileSystem","file/NativeFileError","language/CSSUtils","document/Document","LiveDevelopment/Agents/DOMAgent","filesystem/File","search/FileFilters","file/FileUtils","search/FindInFiles","search/FindInFilesUI","language/HTMLInstrumentation","LiveDevelopment/Inspector/Inspector","extensibility/InstallExtensionDialog","LiveDevelopment/LiveDevelopment","LiveDevelopment/LiveDevServerManager","editor/MultiRangeInlineEditor","LiveDevelopment/Agents/RemoteAgent","search/ScrollTrackMarkers","utils/UpdateNotification"],function(e,t,n){function G(){brackets.test={CodeHintManager:b,CodeInspection:U,CommandManager:y,Commands:g,CSSUtils:e("language/CSSUtils"),DefaultDialogs:L,Dialogs:k,DocumentCommandHandlers:p,DocumentManager:u,DocumentModule:e("document/Document"),DOMAgent:e("LiveDevelopment/Agents/DOMAgent"),DragAndDrop:q,EditorManager:a,ExtensionLoader:A,ExtensionUtils:I,File:e("filesystem/File"),FileFilters:e("search/FileFilters"),FileSyncManager:v,FileSystem:E,FileViewController:d,FileUtils:e("file/FileUtils"),FindInFiles:e("search/FindInFiles"),FindInFilesUI:e("search/FindInFilesUI"),HTMLInstrumentation:e("language/HTMLInstrumentation"),Inspector:e("LiveDevelopment/Inspector/Inspector"),InstallExtensionDialog:e("extensibility/InstallExtensionDialog"),JSUtils:l,KeyBindingManager:m,LanguageManager:s,LiveDevelopment:e("LiveDevelopment/LiveDevelopment"),LiveDevServerManager:e("LiveDevelopment/LiveDevServerManager"),Menus:x,MultiRangeInlineEditor:e("editor/MultiRangeInlineEditor").MultiRangeInlineEditor,NativeApp:z,PerfUtils:w,PreferencesManager:P,ProjectManager:o,RemoteAgent:e("LiveDevelopment/Agents/RemoteAgent"),ScrollTrackMarkers:e("search/ScrollTrackMarkers"),UpdateNotification:e("utils/UpdateNotification"),WorkingSetView:c,doneLoading:!1},i.appReady(function(){brackets.test.doneLoading=!0})}function Y(){w.addMeasurement("window.document Ready"),a.setEditorHolder($("#editor-holder"));var e=/Mac OS X 10\D([\d+])\D/.exec(navigator.userAgent);if(e&&e[1]&&Number(e[1])>=7){var t=$("<div style='position:fixed;left:-50px;width:50px;height:50px;overflow:auto;'><div style='width:100px;height:100px;'/></div>").appendTo(window.document.body);t.outerWidth()===t.get(0).clientWidth&&$(".sidebar").removeClass("quiet-scrollbars"),t.remove()}M.waitForAll([s.ready,P.ready]).always(function(){var e=Q.get("extensions"),t=A.init(e?e.split(","):null);t.always(function(){X.restoreFontSize();var e=o.getInitialProjectPath();o.openProject(e).always(function(){G();var t=new $.Deferred;!Q.get("skipSampleProjectLoad")&&!P.getViewState("afterFirstLaunch")?(P.setViewState("afterFirstLaunch","true"),o.isWelcomeProjectPath(e)?E.resolve(e+"index.html",function(e,n){if(!e){var r=y.execute(g.FILE_ADD_TO_WORKING_SET,{fullPath:n.fullPath});r.then(t.resolve,t.reject)}else t.reject()}):t.resolve()):t.resolve(),t.always(function(){i._dispatchReady(i.APP_READY),w.addMeasurement("Application Startup"),P._isUserScopeCorrupt()&&k.showModalDialog(L.DIALOG_ID_ERROR,C.ERROR_PREFS_CORRUPT_TITLE,C.ERROR_PREFS_CORRUPT).done(function(){y.execute(g.FILE_OPEN_PREFERENCES)})}),brackets.app.getPendingFilesToOpen&&brackets.app.getPendingFilesToOpen(function(e,t){q.openDroppedFiles(t)})})})}),!Q.get("skipUpdateCheck")&&!brackets.inBrowser&&i.appReady(function(){_.launchAutomaticUpdate()})}function Z(){$("body").addClass("platform-"+brackets.platform),brackets.inBrowser?$("body").addClass("in-browser"):$("body").addClass("in-appshell"),brackets.nativeMenus?$("body").addClass("has-appshell-menus"):function(){var e=$.fn.focus;$.fn.focus=function(){if(!this.hasClass("dropdown-toggle"))return e.apply(this,arguments)}}(),$("body").html(Mustache.render(N,C)),$("title").text(brackets.config.app_title),$(window.document.body).on("dragover",function(e){var t="none";e.originalEvent.dataTransfer.files&&(e.stopPropagation(),e.preventDefault(),$(".modal.instance").length===0&&q.isValidDrop(e.originalEvent.dataTransfer.items)&&(t="copy"),e.originalEvent.dataTransfer.dropEffect=t)}).on("drop",function(e){e.originalEvent.dataTransfer.files&&(e.stopPropagation(),e.preventDefault(),brackets.app.getDroppedFiles(function(e,t){e||q.openDroppedFiles(t)}))}),$(window).focus(function(){v.syncOpenDocuments()}),$("html").on("mousedown",".inline-widget",function(e){e.button===1&&e.preventDefault()}),$("html").on("mousedown",".no-focus",function(e){var t=$(e.target),n=t.is("input[type=text]")||t.is("input[type=number]")||t.is("input[type=password]")||t.is("input:not([type])")||t.is("textarea")||t.is("select");n||e.preventDefault()}),window.document.body.addEventListener("click",function(e){var t=e.target,n;while(t){if(t.tagName==="A"){n=t.getAttribute("href"),n&&!n.match(/^#/)&&z.openURLInDefaultBrowser(n),e.preventDefault();break}t=t.parentElement}},!0)}e("widgets/bootstrap-dropdown"),e("widgets/bootstrap-modal"),e("widgets/bootstrap-twipsy-mod"),e("thirdparty/path-utils/path-utils.min"),e("thirdparty/smart-auto-complete-local/jquery.smart_autocomplete"),e("thirdparty/CodeMirror2/addon/fold/xml-fold"),e("thirdparty/CodeMirror2/addon/edit/matchtags"),e("thirdparty/CodeMirror2/addon/edit/matchbrackets"),e("thirdparty/CodeMirror2/addon/edit/closebrackets"),e("thirdparty/CodeMirror2/addon/edit/closetag"),e("thirdparty/CodeMirror2/addon/scroll/scrollpastend"),e("thirdparty/CodeMirror2/addon/selection/active-line"),e("thirdparty/CodeMirror2/addon/selection/mark-selection"),e("thirdparty/CodeMirror2/addon/mode/multiplex"),e("thirdparty/CodeMirror2/addon/mode/overlay"),e("thirdparty/CodeMirror2/addon/search/match-highlighter"),e("thirdparty/CodeMirror2/addon/search/searchcursor"),e("thirdparty/CodeMirror2/keymap/sublime");var r=e("utils/Global"),i=e("utils/AppInit"),s=e("language/LanguageManager"),o=e("project/ProjectManager"),u=e("document/DocumentManager"),a=e("editor/EditorManager"),f=e("editor/CSSInlineEditor"),l=e("language/JSUtils"),c=e("project/WorkingSetView"),h=e("project/WorkingSetSort"),p=e("document/DocumentCommandHandlers"),d=e("project/FileViewController"),v=e("project/FileSyncManager"),m=e("command/KeyBindingManager"),g=e("command/Commands"),y=e("command/CommandManager"),b=e("editor/CodeHintManager"),w=e("utils/PerfUtils"),E=e("filesystem/FileSystem"),S=e("search/QuickOpen"),x=e("command/Menus"),T=e("file/FileUtils"),N=e("text!htmlContent/main-view.html"),C=e("strings"),k=e("widgets/Dialogs"),L=e("widgets/DefaultDialogs"),A=e("utils/ExtensionLoader"),O=e("project/SidebarView"),M=e("utils/Async"),_=e("utils/UpdateNotification"),D=e("utils/UrlParams").UrlParams,P=e("preferences/PreferencesManager"),H=e("utils/Resizer"),B=e("LiveDevelopment/main"),j=e("utils/NodeConnection"),F=e("utils/NodeDomain"),I=e("utils/ExtensionUtils"),q=e("utils/DragAndDrop"),R=e("utils/ColorUtils"),U=e("language/CodeInspection"),z=e("utils/NativeApp"),W=e("utils/DeprecationWarning"),X=e("view/ViewCommandHandlers"),V=e("view/ThemeManager"),J=e("thirdparty/lodash"),K=e("thirdparty/CodeMirror2/lib/codemirror");Object.defineProperty(window,"CodeMirror",{get:function(){return W.deprecationWarning('Use brackets.getModule("thirdparty/CodeMirror2/lib/codemirror") instead of global CodeMirror.',!0),K}}),e("command/DefaultMenus"),e("document/ChangedDocumentTracker"),e("editor/EditorStatusBar"),e("editor/EditorCommandHandlers"),e("editor/EditorOptionHandlers"),e("help/HelpCommandHandlers"),e("search/FindInFilesUI"),e("search/FindReplace"),e("extensibility/InstallExtensionDialog"),e("extensibility/ExtensionManagerDialog"),e("editor/ImageViewer"),e("utils/CollectionUtils"),e("project/FileIndexManager"),e("file/NativeFileSystem"),e("file/NativeFileError"),w.addMeasurement("brackets module dependencies resolved");var Q=new D;Q.parse();var et=w.markStart("User viewstate loading");P._smUserScopeLoading.always(function(){w.addMeasurement(et),Z(),i._dispatchReady(i.HTML_READY),$(window.document).ready(Y)})}),require.config({paths:{text:"thirdparty/text/text",i18n:"thirdparty/i18n/i18n",fileSystemImpl:"filesystem/impls/appshell/AppshellFileSystem"}}),window.location.search.indexOf("testEnvironment")>-1&&require.config({paths:{"preferences/PreferencesImpl":"../test/TestPreferencesImpl"}}),require.config({locale:window.localStorage.getItem("locale")||(typeof brackets!="undefined"?brackets.app.language:navigator.language)}),define("main",["require","exports","module","brackets"],function(e,t,n){e("brackets")});